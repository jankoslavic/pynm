
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Reševanje enačb &#8212; Numerične metode v ekosistemu Pythona</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Numerično odvajanje" href="Predavanje%2010%20-%20Numeri%C4%8Dno%20odvajanje.html" />
    <link rel="prev" title="Aproksimacija" href="Predavanje%2008%20-%20Aproksimacija.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Numerične metode v ekosistemu Pythona</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Numerične metode v ekosistemu Pythona, Janko Slavič, 2022
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="%C5%A0tudijski%20in%20izpitni%20red.html">
   Študijski in izpitni red: 2022/23
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2001%20-%20Uvod%20v%20Python.html">
   Uvod v Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2002%20-%20Print%2C%20delo%20z%20datotekami%2C%20funkcije%2C%20moduli.html">
   Funkcije, izjeme, moduli
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2003%20-%20Moduli%2C%20numpy%2C%20matplotlib.html">
   Numpy, matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2004%20-%20Objektno%20programiranje%2C%20simbolno%20ra%C4%8Dunanje.html">
   Objektno programiranje, simbolno računanje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2005%20-%20Uvod%20v%20numeri%C4%8Dne%20metode%20in%20sistemi%20linearnih%20ena%C4%8Db%201.html">
   Uvod v numerične metode in sistemi linearnih enačb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2006%20-%20Sistemi%20linearnih%20ena%C4%8Db%202.html">
   Sistemi linearnih enačb - nadaljevanje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2007%20-%20Interpolacija.html">
   Interpolacija
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2008%20-%20Aproksimacija.html">
   Aproksimacija
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Reševanje enačb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2010%20-%20Numeri%C4%8Dno%20odvajanje.html">
   Numerično odvajanje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2011%20-%20Numeri%C4%8Dno%20integriranje.html">
   Numerično integriranje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2012%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20za%C4%8Detni%20problem.html">
   Numerično reševanje diferencialnih enačb - začetni problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2013%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20robni%20problem.html">
   Numerično reševanje diferencialnih enačb - robni problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2014%20-%20Testiranje%20pravilnosti%20kode%2C%20uporabni%C5%A1ki%20vmesnik.html">
   Testiranje pravilnosti kode, uporabniški vmesnik
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jankoslavic/pynm/master?urlpath=tree/notebooks/notebooks/Predavanje 09 - Reševanje enačb.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jankoslavic/pynm"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jankoslavic/pynm/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Predavanje 09 - Reševanje enačb.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/Predavanje 09 - Reševanje enačb.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Reševanje enačb
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uvod">
   Uvod
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#omejitve-funkcije-f-x">
     Omejitve funkcije
     <span class="math notranslate nohighlight">
      \(f(x)\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zgled">
     Zgled
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inkrementalna-metoda">
   Inkrementalna metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numericna-implementacija">
     Numerična implementacija
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iterativna-inkrementalna-metoda">
   Iterativna inkrementalna metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Numerična implementacija
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bisekcijska-metoda">
   Bisekcijska metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ocena-napake">
     Ocena napake
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Numerična implementacija
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iskanje-nicle-v-okolici-pola">
       Iskanje ničle v okolici pola
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-scipy-optimize-bisect">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.bisect
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sekantna-metoda">
   Sekantna metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Ocena napake
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#konvergenca-in-red-konvergence">
     Konvergenca in red konvergence
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Numerična implementacija
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-scipy-optimize-newton">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.newton
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newtonova-metoda">
   Newtonova metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#red-konvergence">
     Red konvergence
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Numerična implementacija
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.newton
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resevanje-sistemov-nelinarnih-enacb">
   Reševanje sistemov nelinarnih enačb*
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Numerična implementacija
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-scipy-optimize-root">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.root
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nekaj-vprasanj-za-razmislek">
   Nekaj vprašanj za razmislek!
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dodatno">
   Dodatno
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-sympy-solve-za-resevanje-enacb">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy.solve
      </span>
     </code>
     za reševanje enačb
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Reševanje enačb</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Reševanje enačb
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uvod">
   Uvod
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#omejitve-funkcije-f-x">
     Omejitve funkcije
     <span class="math notranslate nohighlight">
      \(f(x)\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zgled">
     Zgled
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inkrementalna-metoda">
   Inkrementalna metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numericna-implementacija">
     Numerična implementacija
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iterativna-inkrementalna-metoda">
   Iterativna inkrementalna metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Numerična implementacija
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bisekcijska-metoda">
   Bisekcijska metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ocena-napake">
     Ocena napake
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Numerična implementacija
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iskanje-nicle-v-okolici-pola">
       Iskanje ničle v okolici pola
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-scipy-optimize-bisect">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.bisect
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sekantna-metoda">
   Sekantna metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Ocena napake
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#konvergenca-in-red-konvergence">
     Konvergenca in red konvergence
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Numerična implementacija
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-scipy-optimize-newton">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.newton
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newtonova-metoda">
   Newtonova metoda
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#red-konvergence">
     Red konvergence
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Numerična implementacija
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.newton
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resevanje-sistemov-nelinarnih-enacb">
   Reševanje sistemov nelinarnih enačb*
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Numerična implementacija
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-scipy-optimize-root">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.root
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nekaj-vprasanj-za-razmislek">
   Nekaj vprašanj za razmislek!
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dodatno">
   Dodatno
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uporaba-sympy-solve-za-resevanje-enacb">
     Uporaba
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy.solve
      </span>
     </code>
     za reševanje enačb
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="resevanje-enacb">
<h1>Reševanje enačb<a class="headerlink" href="#resevanje-enacb" title="Permalink to this headline">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h1>Uvod<a class="headerlink" href="#uvod" title="Permalink to this headline">#</a></h1>
<p>Za uvod si oglejmo spodnji video:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;17d55KE8SIU&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="800"
    height="300"
    src="https://www.youtube.com/embed/17d55KE8SIU"
    frameborder="0"
    allowfullscreen

></iframe>
</div></div>
</div>
<p>V okviru reševanja enačb obravnavamo poljubno enačbo, ki je odvisna od spremenljivke <span class="math notranslate nohighlight">\(x\)</span> in iščemo rešitev:</p>
<div class="math notranslate nohighlight">
\[f(x)=0.\]</div>
<p>Rešitvam enačbe rečemo tudi <em>koreni</em> (angl. <em>roots</em>). Koren enačbe <span class="math notranslate nohighlight">\(f(x)=0\)</span> je hkrati tudi ničla funkcije <span class="math notranslate nohighlight">\(y=f(x)\)</span>.</p>
<p>Funkcija <span class="math notranslate nohighlight">\(y=f(x)\)</span> ima lahko ničle stopnje:</p>
<ul class="simple">
<li><p>ničla prve stopnje: funkcija seka abscisno os pod neničelnim kotom,</p></li>
<li><p>ničle sode stopnje: funkcija se dotika abscisne osi, vendar je ne seka,</p></li>
<li><p>ničle lihe stopnje: funkcija seka abscisno os, pri ničli stopnje 3 in več imamo prevoj (tangenta je vzporedna z abscisno osjo).</p></li>
</ul>
<p>Tukaj je pomembno izpostaviti, da iščemo rešitev poljubne enačbe <span class="math notranslate nohighlight">\(f(x)=0\)</span>. Če za linearne, kvadratne ali kubične enačbe, lahko določimo analitične rešitve; za večino nelinearnih enačb analitične rešitve ne moremo določiti. Iz tega razloga so numerični pristopi toliko bolj pomembni.</p>
<section id="omejitve-funkcije-f-x">
<h2>Omejitve funkcije <span class="math notranslate nohighlight">\(f(x)\)</span><a class="headerlink" href="#omejitve-funkcije-f-x" title="Permalink to this headline">#</a></h2>
<p>Za funkcijo <span class="math notranslate nohighlight">\(y=f(x)\)</span> zahtevamo, da je na zaprtem intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> zvezna. Pri računanju ničel, se bomo omejili samo na ničle prve stopnje.</p>
</section>
<section id="zgled">
<h2>Zgled<a class="headerlink" href="#zgled" title="Permalink to this headline">#</a></h2>
<p>Poljubno funkcijo <span class="math notranslate nohighlight">\(y=f(x)\)</span> lahko definiramo s <em>Pythonovo funkcijo</em>; za zgled tukaj definirajmo polinom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<p>Ker pa gre za polinom <span class="math notranslate nohighlight">\(x^3-10x^2+5\)</span> s koeficienti <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">-10,</span> <span class="pre">0,</span> <span class="pre">5]</span></code> pa je bolje, da ga definiramo s pomočjo <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.poly1d.html"><code class="docutils literal notranslate"><span class="pre">np.poly1d</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">c_or_r</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c_or_r</span></code> koeficienti polinoma s padajočo potenco ali če je <code class="docutils literal notranslate"><span class="pre">r=True</span></code> ničle polinoma,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> je privzeto <code class="docutils literal notranslate"><span class="pre">False</span></code>, kar pomeni, da se podajo koeficienti polinoma,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> spremenljivka, ki se izpiše pri uporabi funkcije <code class="docutils literal notranslate"><span class="pre">print()</span></code>.</p></li>
</ul>
<p>Uvozimo <code class="docutils literal notranslate"><span class="pre">numpy</span></code> in definirajmo polinom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># uvozimo numpy</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="c1"># definiramo koeficiente polinoma</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># prikažemo polinom</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3      2
1 x - 10 x + 5
</pre></div>
</div>
</div>
</div>
<p>Prikažimo funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>       <span class="c1"># uvozimo matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">x_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># horizontalna črta,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_r</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span> <span class="c1"># da je ničla nekje blizu $x = 0.7$.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 09 - Reševanje enačb_15_0.png" src="../_images/Predavanje 09 - Reševanje enačb_15_0.png" />
</div>
</div>
<p>Opazimo, da so ničle funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> blizu -0,7 in +0,7. Objekt <code class="docutils literal notranslate"><span class="pre">poly1d</span></code> ima atribut <code class="docutils literal notranslate"><span class="pre">roots</span></code> ali tudi <code class="docutils literal notranslate"><span class="pre">r</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.poly1d.html">glejte dokumentacijo</a>), ki vrne te ničle:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 9.94949106,  0.73460351, -0.68409457])
</pre></div>
</div>
</div>
</div>
<p>V nadaljevanju bo naš cilj numerično določiti ničlo za poljubno funkcijo <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="inkrementalna-metoda">
<h1>Inkrementalna metoda<a class="headerlink" href="#inkrementalna-metoda" title="Permalink to this headline">#</a></h1>
<p>Inkrementalno reševanje temelji na ideji, da v kolikor ima funkcija <span class="math notranslate nohighlight">\(f(x)\)</span> pri <span class="math notranslate nohighlight">\(x_0\)</span> in <span class="math notranslate nohighlight">\(x_1\)</span> različna predznaka, potem je vmes vsaj ena ničla. Zaprti interval <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> razdelimo torej na odseke širine <span class="math notranslate nohighlight">\(\Delta x\)</span>; na odseku, kjer opazimo spremembo predznaka, je vsaj ena ničla funkcije.</p>
<p>Metoda je prikazana na sliki.
<img src='./fig/inkrementalna.png' width=400></p>
<p>Za ničlo zahtevamo:</p>
<div class="math notranslate nohighlight">
\[\left|x_{i+1}-x_i\right|&lt;\varepsilon\quad\textrm{in}\quad \left|f(x_{i+1})\right|+\left|f(x_{i})\right|&lt;D,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\epsilon\)</span> zahtevana natančnost rešitve in <span class="math notranslate nohighlight">\(D\)</span> izbrana majhna vrednost, ki prepreči, da bi kot ničlo razpoznali pol (kar sicer zaradi pogoja zveznosti ni mogoče).</p>
<p>Inkrementalna metoda ima nekatere slabosti:</p>
<ul class="simple">
<li><p>je zelo počasna,</p></li>
<li><p>lahko zgreši dve ničli, ki sta si zelo blizu,</p></li>
<li><p>večkratne sode ničle (lokalni ekstrem, ki se samo dotika abscise) ne zazna.</p></li>
</ul>
<p>Inkrementalna metoda spada med t. i. <em>zaprte</em> (angl. <em>bracketed</em>) metode, saj išče ničle funkcije samo na intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>. Pozneje bomo spoznali tudi <em>odprte</em> metode, ki lahko konvergirajo k ničli zunaj podanega intervala.</p>
<p>Zaradi vseh zgoraj navedenih slabosti inkrementalno metodo pogosto uporabimo samo za izračun začetnega približka ničle.</p>
<section id="numericna-implementacija">
<h2>Numerična implementacija<a class="headerlink" href="#numericna-implementacija" title="Permalink to this headline">#</a></h2>
<p>Poglejmo si sedaj inkrementalno iskanje ničel funkcije:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inkrementalna</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">dx</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Vrne prvi interval (x1, x2) kjer leži ničla</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničle iščemo</span>
<span class="sd">    :param x1:  spodnja meja iskanja</span>
<span class="sd">    :param x2:  zgornja meja iskanja</span>
<span class="sd">    :param dx:  inkrement iskanja</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>   <span class="c1"># pripravimo x vrednosti</span>
    <span class="n">f_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x_d</span><span class="p">))</span>       <span class="c1"># pripravimo predznake funkcije</span>
    <span class="n">f_d</span> <span class="o">=</span> <span class="n">f_d</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="n">f_d</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>        <span class="c1"># pomnožimo sosednje elemente</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">f_d</span><span class="p">)</span>            <span class="c1"># prvi prehod skozi ničlo</span>
    <span class="c1"># vsota abs funk vrednosti</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">x_d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x_d</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">]),</span> <span class="n">D</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo sedaj uporabo na zgoraj definiranem polinomu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez_inkr</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">inkrementalna</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">rez_inkr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.734, 0.735])
</pre></div>
</div>
</div>
</div>
<p>Ničla je izolirana z natančnostjo 0,001, preverimo še vsoto absolutnih funkcijskih vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.013071529000000304
</pre></div>
</div>
</div>
</div>
<p>Ugotovimo, da je relativno majhna; bomo pa se s sledečimi metodami trudili rezultat bistveno izboljšati.</p>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_r</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># horizontalna črta</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># vertikalna črta</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># vetrikalna črta</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">),</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inkrementalna metoda&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.73</span><span class="p">,</span><span class="mf">0.74</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 09 - Reševanje enačb_36_0.png" src="../_images/Predavanje 09 - Reševanje enačb_36_0.png" />
</div>
</div>
<p>Da smo torej na intervalu <span class="math notranslate nohighlight">\([0, 1]\)</span> izračunali rešitev z natančnostjo <span class="math notranslate nohighlight">\(\Delta x=0,001\)</span>, smo morali 1000-krat klicati funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>. Gre za zelo neučinkovito metodo, zato bomo iskali boljše načine; najprej s preprostim iterativnim inkrementalnim pristopom.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="iterativna-inkrementalna-metoda">
<h1>Iterativna inkrementalna metoda<a class="headerlink" href="#iterativna-inkrementalna-metoda" title="Permalink to this headline">#</a></h1>
<p>Iterativna inkrementalna metoda v prvi iteraciji z inkrementalno metodo omeji interval iskanja ničel pri relativno velikem koraku. Interval, najden v prvi iteraciji, se v drugi iteraciji razdeli na manjše intervale in ponovi se inkrementalno iskanje ničle. Tretja iteracija se nato omeji na interval določen v drugi in tako dalje. Z iteracijami zaključimo, ko smo dosegli predpisano natančnost rešitve <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<p>Metoda je prikazana na sliki:
<img src='./fig/iterativna_inkrementalna.png' width=400></p>
<section id="id1">
<h2>Numerična implementacija<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inkrementalna_super</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">iteracij</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Vrne interval (x0, x1) kjer leži ničla</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničlo iščemo</span>
<span class="sd">    :param x0:  spodnja meja iskanja</span>
<span class="sd">    :param x1:  zgornja meja iskanja</span>
<span class="sd">    :iteraci:   število iteracij inkrementalne metode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iteracij</span><span class="p">):</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
        <span class="n">x0x1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">inkrementalna</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x0x1</span>
    <span class="c1"># vsota abs funk vrednosti</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>        
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">]),</span> <span class="n">D</span>
</pre></div>
</div>
</div>
</div>
<p>S 30 klici funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> tako dobimo podobno natančnost kot prej v 1000:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez30</span><span class="p">,</span> <span class="n">D30</span> <span class="o">=</span> <span class="n">inkrementalna_super</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">iteracij</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">rez30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.734, 0.735])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez_inkr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.734, 0.735])
</pre></div>
</div>
</div>
</div>
<p>Seveda pa lahko natančnost bistveno izboljšamo z večanjem števila iteracij:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez80</span><span class="p">,</span> <span class="n">D80</span> <span class="o">=</span> <span class="n">inkrementalna_super</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">iteracij</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">rez80</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.7346035 , 0.73460351])
</pre></div>
</div>
</div>
</div>
<p>Preverimo še kriterij vsote absolutnih funkcijskih vrednosti, ki mora biti majhen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D80</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3073143190212022e-07
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bisekcijska-metoda">
<h1>Bisekcijska metoda<a class="headerlink" href="#bisekcijska-metoda" title="Permalink to this headline">#</a></h1>
<p>Na intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>, kjer vemo, da obstaja ničla funkcije (predznaka <span class="math notranslate nohighlight">\(f(x_0)\)</span> in <span class="math notranslate nohighlight">\(f(x_1)\)</span> se razlikujeta), lahko uporabimo <em>bisekcijsko metodo</em>.</p>
<p>Ideja metode je:</p>
<ul class="simple">
<li><p>interval <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> razdelimo na pol (od tukaj ime: <em>bi-sekcija</em>): <span class="math notranslate nohighlight">\(x_2 = (x_0+x_1)/2\)</span>,</p></li>
<li><p>če imata <span class="math notranslate nohighlight">\(f(x_0)\)</span> in <span class="math notranslate nohighlight">\(f(x_2)\)</span> različne predznake, je nov interval iskanja ničle <span class="math notranslate nohighlight">\([x_0, x_2]\)</span>, sicer pa: <span class="math notranslate nohighlight">\([x_2, x_1]\)</span>,</p></li>
<li><p>glede na predhodni korak definiramo nov zaprt interval <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> in nadaljujemo z iterativnim postopkom, dokler ne dosežemo želene natančnosti <span class="math notranslate nohighlight">\(\left|x_1-x_0\right|&lt;\varepsilon\)</span>.</p></li>
</ul>
<p>Slika metode:
<img src='./fig/bisekcijska.png' width=400></p>
<p>Bisekcijska metoda spada med <em>zaprte</em> metode, ki vrne ničlo funkcije na podanem intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>.</p>
<section id="ocena-napake">
<h2>Ocena napake<a class="headerlink" href="#ocena-napake" title="Permalink to this headline">#</a></h2>
<p>Če v začetku začnemo z intervalom <span class="math notranslate nohighlight">\(\Delta x = \left|x_1-x_0\right|\)</span>, potem je natančnost bisekcijske metode po prvem koraku bisekcije:
$<span class="math notranslate nohighlight">\(\varepsilon_1 = \Delta x/2,\)</span><span class="math notranslate nohighlight">\(
po drugem koraku: 
\)</span><span class="math notranslate nohighlight">\(\varepsilon_2 = \Delta x/2^2\)</span><span class="math notranslate nohighlight">\(
in po \)</span>n<span class="math notranslate nohighlight">\( korakih: 
\)</span><span class="math notranslate nohighlight">\(\varepsilon_n = \Delta x/2^n.\)</span>$</p>
<p>Ponavadi zahtevamo, da je rešitev podana z natančnostjo <span class="math notranslate nohighlight">\(\varepsilon\)</span> in iz zgornje enačbe lahko izpeljemo število potrebnih korakov bisekcijske metode:</p>
<div class="math notranslate nohighlight">
\[n = \frac{\log\left(\frac{\Delta x}{\varepsilon}\right)}{\log(2)}.\]</div>
<p>Seveda je število korakov celo število.</p>
</section>
<section id="id2">
<h2>Numerična implementacija<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bisekcija</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">Dtol</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Vrne ničlo z natančnostjo tol</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničlo iščemo</span>
<span class="sd">    :param x0:  spodnja meja iskanja</span>
<span class="sd">    :param x1:  zgornja meja iskanja</span>
<span class="sd">    :param tol: zahtevana natančnost</span>
<span class="sd">    :param Dtol:največja vsota absolutnih vrednosti rešitve </span>
<span class="sd">    :izpis:     ali na koncu izpiše kratko poročilo</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Ničla ni izolirana. Root is not bracketed.&#39;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">tol</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># števil iteracij</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">f3</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span><span class="o">!=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)):</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">x2</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">D</span> <span class="o">&gt;</span> <span class="n">Dtol</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Verjetnost pola ali več ničel.&#39;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
        <span class="n">decimalk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tol</span><span class="p">))</span> <span class="c1"># ne deluje vedno in za vse primere:)    </span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rešitev: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">5.</span><span class="si">{</span><span class="n">decimalk</span><span class="si">}</span><span class="s1">f</span><span class="si">}</span><span class="s1">, število iteracij: </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">g</span><span class="si">}</span><span class="s1">, D: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">5.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj poskusimo najti ničlo z natančnostjo <code class="docutils literal notranslate"><span class="pre">1e-3</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisekcija</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: 0.735, število iteracij: 10, D: 0.01277
</pre></div>
</div>
</div>
</div>
<p>V desetih iteracijah smo dobili isto natančen rezultat kakor zgoraj pri iterativni inkrementalni metodi <code class="docutils literal notranslate"><span class="pre">rez30</span></code>. Poglejmo še izračun ničle s še večjo natančnostjo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisekcija</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: 0.734603, število iteracij: 20, D: 0.00001
</pre></div>
</div>
</div>
</div>
<p>Hitrost izvajanja lahko preverimo s t. i. <em>magic funkcijo</em> <code class="docutils literal notranslate"><span class="pre">timeit</span></code> (<a class="reference external" href="http://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">dokumentacija</a>), ki večkrat požene funkcijo in analizira čas izvajanja. Če je pred magic funkcijo dvojni znak <code class="docutils literal notranslate"><span class="pre">%%</span></code>, se izvede in meri čas celotne celice, če pa le enojni <code class="docutils literal notranslate"><span class="pre">%</span></code>, pa samo ene vrstice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">bisekcija</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>670 µs ± 124 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<section id="iskanje-nicle-v-okolici-pola">
<h3>Iskanje ničle v okolici pola<a class="headerlink" href="#iskanje-nicle-v-okolici-pola" title="Permalink to this headline">#</a></h3>
<p>Poglejmo sedaj iskanje ničle funkcije <code class="docutils literal notranslate"><span class="pre">tan</span></code> v okolici pola (ničla dejansko ne obstaja):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x_t</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tan(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 09 - Reševanje enačb_67_0.png" src="../_images/Predavanje 09 - Reševanje enačb_67_0.png" />
</div>
</div>
<p>V primeru iskanja na intervalu <span class="math notranslate nohighlight">\([-1, 1]\)</span> najdemo pravo ničlo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisekcija</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: -0.000, število iteracij: 11, D: 0.00098
</pre></div>
</div>
</div>
</div>
<p>V primeru iskanja v okolici pola, pa nas program na to opozori (klic funkcije je tukaj zakomentiran, sicer se avtomatsko generiranje tukaj prekine):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bisekcija(np.tan, -3, 0, tol=1e-6)</span>
</pre></div>
</div>
</div>
</div>
<p>V <code class="docutils literal notranslate"><span class="pre">scipy</span></code> vgrajena bisekcijska metoda takega preverjanja nima (zaradi hitrosti) in bo vrnila rezultat, ki bo pa napačen. Pri uporabi moramo torej biti previdni.</p>
</section>
</section>
<section id="uporaba-scipy-optimize-bisect">
<h2>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.bisect</span></code><a class="headerlink" href="#uporaba-scipy-optimize-bisect" title="Permalink to this headline">#</a></h2>
<p>Bisekcijska metoda je <em>počasna</em>, vendar zanesljiva metoda iskanja ničel in je implementirana znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code>. Najprej jo uvozimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">bisect</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">2e-12</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">8.8817841970012523e-16</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> 
    <span class="n">full_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">bisect</span></code> zahteva tri parametre: funkijo <code class="docutils literal notranslate"><span class="pre">f</span></code> ter parametra <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">b</span></code>, ki definirata zaprti interval <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b]</span></code>. Predznaka <code class="docutils literal notranslate"><span class="pre">f(a)</span></code> in <code class="docutils literal notranslate"><span class="pre">f(b)</span></code> morata biti različna. Ostali parametri, npr. absolutna <code class="docutils literal notranslate"><span class="pre">xtol</span></code> in relativna <code class="docutils literal notranslate"><span class="pre">rtol</span></code> napaka ter največje število iteracij <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> so opcijski - imajo privzete vrednosti. Za več glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.bisect.html">dokumentacijo</a>.</p>
<p>Poglejmo uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7353515625
</pre></div>
</div>
</div>
</div>
<p>in hitrost:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> bisect(f, 0, 1, xtol=1e-3)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>135 µs ± 12 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Ugotovimo, da je <em>naša</em> implementacija bisekcijske metode približno 5-krat počasnejša.</p>
<p>Preverimo še lahko funkcijo <code class="docutils literal notranslate"><span class="pre">tan(x)</span></code>, najprej na intervalu, kjer je funkcija zvezna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>Potem še v okolici pola, kjer ni zvezna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.5707963267941523
</pre></div>
</div>
</div>
</div>
<p>kar je napačna rešitev!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="sekantna-metoda">
<h1>Sekantna metoda<a class="headerlink" href="#sekantna-metoda" title="Permalink to this headline">#</a></h1>
<p>Sekantna metoda zahteva dva začetna približka <span class="math notranslate nohighlight">\(x_0\)</span> in <span class="math notranslate nohighlight">\(x_1\)</span> in funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>. Ob predpostavki linearne interpolacije med točkama <span class="math notranslate nohighlight">\(x_0, f(x_0)\)</span> in <span class="math notranslate nohighlight">\(x_1, f(x_1)\)</span> (skozi točki potegnemo <em>sekanto</em>, od tukaj tudi ime), se določi <span class="math notranslate nohighlight">\(x_2\)</span>, kjer ima linearna interpolacijska funkcija ničlo. <span class="math notranslate nohighlight">\(x_2\)</span> predstavlja nov približek ničle.</p>
<p>Glede na sliko:
<img src='./fig/sekantna.png' width=400></p>
<p>lahko zapišemo (podobna trikotnika sta na sliki označena z rumeno):</p>
<div class="math notranslate nohighlight">
\[\frac{f(x_1)}{x_2 − x_1}= \frac{f(x_0) − f(x_1)}{x_1 − x_0}.\]</div>
<p>Sledi, da je nov približek ničle:</p>
<div class="math notranslate nohighlight">
\[x_2= x_1-f(x_1)\,\frac{x_1 − x_0}{f(x_1) - f(x_0)}.\]</div>
<p>V naslednjem koraku pri sekantni metodi izvedemo sledeče zamenjave: <span class="math notranslate nohighlight">\(x_0=x_1\)</span> in <span class="math notranslate nohighlight">\(x_1=x_2\)</span>.</p>
<p>Sekantna metoda spada med <em>odprte</em> metode, saj lahko najde ničlo funkcije, ki se nahaja zunaj območja <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>.</p>
<section id="id3">
<h2>Ocena napake<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>Konzervativno lahko napako ocenimo iz razlike med dvema zaporednima približkoma:</p>
<div class="math notranslate nohighlight">
\[\varepsilon = \left|x_{n-1} -x_{n}\right|\]</div>
</section>
<section id="konvergenca-in-red-konvergence">
<h2>Konvergenca in red konvergence<a class="headerlink" href="#konvergenca-in-red-konvergence" title="Permalink to this headline">#</a></h2>
<p>Konvergenca pomeni, da zaporedje približkov konvergira k rešitvi enačbe <span class="math notranslate nohighlight">\(\alpha\)</span> (<span class="math notranslate nohighlight">\(\alpha\)</span> je rešitev enačbe).</p>
<p><strong>Red konvergence</strong> označuje hitrost konvergiranja.</p>
<p>Če <span class="math notranslate nohighlight">\(\varepsilon\)</span> označimo napako približka in napako z vsakim korakom iteracije linearno zmanjšamo (<span class="math notranslate nohighlight">\(C\)</span> je konstanta):</p>
<div class="math notranslate nohighlight">
\[\varepsilon_n = C\,\varepsilon_{n-1}^1,\]</div>
<p>govorimo o <strong>redu konvergence 1</strong> (<span class="math notranslate nohighlight">\(\varepsilon\)</span> ima potenco 1)!</p>
<p>Pri predhodno obravnavani bisekcijski metodi napako na vsakem koraku zmanjšamo za <span class="math notranslate nohighlight">\(1/2\)</span> (<span class="math notranslate nohighlight">\(\varepsilon_n/\varepsilon_{n-1} = C = 1/2\)</span>). <em>Bisekcijska metoda ima red konvergence 1.</em></p>
<p>Red konvergence <em>sekantne metode je višji</em> in jo je mogoče oceniti z:</p>
<div class="math notranslate nohighlight">
\[\varepsilon_n = C\,\varepsilon_{n-1}^{1.618}.\]</div>
<p>Iz zgornje ocene sledi, da se na vsakem koraku iteracije število točnih cifer poveča za približno 60%. Ker je red konvergence višji od 1 in manjši od kvadratične, tako konvergenco imenujemo <em>superlinearna</em> konvergenca.</p>
<p>Še boljšo, kvadratično, konvergenco ima Newtonova metoda. Pri kvadratični konvergenci se na vsakem koraku iteracije število točnih cifer podvoji. Isti red konvergence ima tudi <em>Ridderjeva</em>  metoda, ki je implementirana v paketu <code class="docutils literal notranslate"><span class="pre">scipy</span></code> (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.ridder.html">dokumentacijo</a>) in je zaprtega tipa ter sorodna sekantni metodi. Kljub uporabnosti si je tukaj ne bomo podrobno ogledali.</p>
</section>
<section id="id4">
<h2>Numerična implementacija<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sekantna</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">Dtol</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Vrne ničlo z natančnostjo tol</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničlo iščemo</span>
<span class="sd">    :param x0:  spodnja meja iskanja</span>
<span class="sd">    :param x1:  zgornja meja iskanja</span>
<span class="sd">    :param tol: zahtevana natančnost</span>
<span class="sd">    :max_iter:  maksimalno število iteracij preden se izvajanje prekine</span>
<span class="sd">    :param Dtol:največja vsota absolutnih vrednosti rešitve </span>
<span class="sd">    :izpis:     ali na koncu izpiše kratko poročilo</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Ničla ni izolirana. Root is not bracketed.&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">f0</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">f1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:g}</span><span class="s1">. korak: x0=</span><span class="si">{:g}</span><span class="s1">, x1=</span><span class="si">{:g}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">D</span> <span class="o">&gt;</span> <span class="n">Dtol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Verjetnost pola ali več ničel.&#39;</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
                <span class="n">decimalk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tol</span><span class="p">))</span> <span class="c1"># ne deluje vedno in za vse primere:)    </span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rešitev: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">5.</span><span class="si">{</span><span class="n">decimalk</span><span class="si">}</span><span class="s1">f</span><span class="si">}</span><span class="s1">, D: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">5.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">r</span>        
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sekantna</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.e-8</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. korak: x0=1, x1=0.555556.
2. korak: x0=0.555556, x1=0.707845.
3. korak: x0=0.707845, x1=0.737957.
4. korak: x0=0.737957, x1=0.734549.
5. korak: x0=0.734549, x1=0.734603.
6. korak: x0=0.734603, x1=0.734604.
7. korak: x0=0.734604, x1=0.734604.
Rešitev: 0.73460351, D: 0.00000
</pre></div>
</div>
</div>
</div>
<p>in hitrost</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> sekantna(f, 0, 1., tol=1.e-8, izpis=False)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>235 µs ± 10.3 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Kakor smo zapisali zgoraj, je sekantna metoda odprtega tipa. Rešitev enačbe je lahko zunaj podanega intervala. Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sekantna</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. korak: x0=2, x1=1.41615.
2. korak: x0=1.41615, x1=1.85165.
3. korak: x0=1.85165, x1=1.69887.
4. korak: x0=1.69887, x1=1.97485.
5. korak: x0=1.97485, x1=2.09379.
6. korak: x0=2.09379, x1=2.43519.
7. korak: x0=2.43519, x1=2.76579.
8. korak: x0=2.76579, x1=3.05013.
9. korak: x0=3.05013, x1=3.13625.
10. korak: x0=3.13625, x1=3.14158.
11. korak: x0=3.14158, x1=3.14159.
Rešitev: 3.142, D: 0.00002
</pre></div>
</div>
</div>
</div>
</section>
<section id="uporaba-scipy-optimize-newton">
<h2>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code><a class="headerlink" href="#uporaba-scipy-optimize-newton" title="Permalink to this headline">#</a></h2>
<p>Znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je sekantna metoda definirana v okviru <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code> funkcije. Če le-tej namreč ne podamo funkcije, ki definira prvi odvod, potem je uporabljena sekantna metoda (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.newton.html">dokumentacijo</a>).</p>
<p>Najprej jo uvozimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">newton</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.48e-08</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">fprime2</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">newton</span></code> zahteva dva parametra: funkcijo <code class="docutils literal notranslate"><span class="pre">func</span></code> ter začetno vrednost <code class="docutils literal notranslate"><span class="pre">x0</span></code>. Opcijska parametra sta še <code class="docutils literal notranslate"><span class="pre">fprime</span></code> in <code class="docutils literal notranslate"><span class="pre">fprime2</span></code> za prvi in drugi odvod funkcije <code class="docutils literal notranslate"><span class="pre">func</span></code>; če nista podana, se uporabi sekantna metoda (več o odvodih spodaj pri Newtonovi metodi). Največje število iteracij definira <code class="docutils literal notranslate"><span class="pre">maxiter</span></code>.</p>
<p>V primeru sekantne metode, se druga meja intervala izračuna glede na kodo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x0</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-4</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-4</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1e-4</span>
</pre></div>
</div>
<p>Poglejmo si uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.e-8</span><span class="p">)</span>
<span class="sa">f</span><span class="s1">&#39;Rezultat: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">2.8f</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Rezultat: 0.73460351&#39;
</pre></div>
</div>
</div>
</div>
<p>in hitrost</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> newton(f, x0=0.1, tol=1.e-8)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>365 µs ± 32.7 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Ugotovimo, da je naša implementacija sekantne metode podobno hitra.</p>
<p>Uporabimo še Ridderjevo metodo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">ridder</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">ridder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1.e-8</span><span class="p">)</span>
<span class="sa">f</span><span class="s1">&#39;Rezultat: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">2.8f</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Rezultat: 0.73460350&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="newtonova-metoda">
<h1>Newtonova metoda<a class="headerlink" href="#newtonova-metoda" title="Permalink to this headline">#</a></h1>
<p>V literaturi za <strong>Newtonovo</strong> metodo tudi najdemo izraza <strong>tangentna</strong> in <strong>Newton-Raphsonova</strong> metoda. Potrebuje en začetni približek <span class="math notranslate nohighlight">\(x_0\)</span>, poleg definicije funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> pa tudi njen odvod <span class="math notranslate nohighlight">\(f'(x)\)</span>.</p>
<p>Princip delovanja metode je prikazan na sliki:
<img src="./fig/newtonova.png" width=400></p>
<p>Metodo bi lahko izpeljali grafično (s  slike), tukaj pa si poglejmo izpeljavo s pomočjo Taylorjeve vrste:
$<span class="math notranslate nohighlight">\(f(x_{i+1})=f(x_i)+f'(x_i)\,\left(x_{i+1}-x_i\right)+O^2\left(x_{i+1}-x_i\right),\)</span><span class="math notranslate nohighlight">\(
če naj bo pri \)</span>x_{i+1}<span class="math notranslate nohighlight">\( vrednost funkcije nič, potem velja:
\)</span><span class="math notranslate nohighlight">\(0=f(x_i)+f'(x_i)\,\left(x_{i+1}-x_i\right)+O^2\left(x_{i+1}-x_i\right).\)</span>$</p>
<p>Naredimo napako metode in zanemarimo člene višjega reda v Taylorjevi vrsti. Lahko izpeljemo:</p>
<div class="math notranslate nohighlight">
\[x_{i+1}=x_i-\frac{f(x_i)}{f'(x_i)}.\]</div>
<p><span class="math notranslate nohighlight">\(x_{i+1}\)</span> je tako nov približek iskane ničle.</p>
<p>Algoritem Newtonove metode je:</p>
<ol class="simple">
<li><p>izračunamo nov približek <span class="math notranslate nohighlight">\(x_{i+1}\)</span>,</p></li>
<li><p>računanje prekinemo, če je največje število iteracij doseženo (rešitve enačbe nismo našli),</p></li>
<li><p>če velja <span class="math notranslate nohighlight">\(\left|x_{i+1}-x_i\right|&lt;\varepsilon\)</span> računanje prekinemo (izračunali smo približek ničle), sicer povečamo indeks <span class="math notranslate nohighlight">\(i\)</span> in gremo v prvi korak.</p></li>
</ol>
<p>Opombi:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\varepsilon\)</span> je zahtevana absolutna natančnost,</p></li>
<li><p><em>Newtonova</em> metoda lahko divergira, zato v algoritmu predpišemo največje število iteracij.</p></li>
</ul>
<p>Zgoraj smo omenili, da je Newtonova metoda ena izmed boljših metod za iskanje ničel funkcij. Ima pa tudi nekaj slabosti/omejitev:</p>
<ul class="simple">
<li><p>spada med <em>odprte</em> metode,</p></li>
<li><p>kvadratična konvergenca je zagotovljena le v dovolj majhni okolici rešitve enačbe,</p></li>
<li><p>poznati moramo odvod funkcije.</p></li>
</ul>
<section id="red-konvergence">
<h2>Red konvergence<a class="headerlink" href="#red-konvergence" title="Permalink to this headline">#</a></h2>
<p>Red konvergence Newtonove metode je kvadraten:
$<span class="math notranslate nohighlight">\(\varepsilon_n = C\,\varepsilon_{n-1}^{2},\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>C<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(C=-\frac{f''(x)}{2\,f'(x)}.\)</span>$</p>
<p>Konvergenca je torej hitra, v vsaki novi iteraciji se število točnih števk v približku podvoji.</p>
</section>
<section id="id5">
<h2>Numerična implementacija<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newtonova</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">dfun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">Dtol</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> 
    <span class="c1"># ime `newtonova` zato ker je `newton` vgrajena funkcija v `scipy`</span>
    <span class="sd">&quot;&quot;&quot; Vrne ničlo z natančnostjo tol</span>
<span class="sd">    </span>
<span class="sd">    :param fun:  funkcija katere ničlo iščemo</span>
<span class="sd">    :param dfun: f&#39;</span>
<span class="sd">    :param x0:   začetni približek</span>
<span class="sd">    :param tol:  zahtevana natančnost</span>
<span class="sd">    :max_iter:  maksimalno število iteracij preden se izvajanje prekine</span>
<span class="sd">    :param Dtol:največja vsota absolutnih vrednosti rešitve </span>
<span class="sd">    :izpis:     ali na koncu izpiše kratko poročilo</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">dfun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">D</span> <span class="o">&gt;</span> <span class="n">Dtol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Verjetnost pola ali več ničel.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
                <span class="n">decimalk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tol</span><span class="p">))</span> <span class="c1"># ne deluje vedno in za vse primere:)    </span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rešitev: </span><span class="si">{</span><span class="n">x1</span><span class="si">:</span><span class="s1">5.</span><span class="si">{</span><span class="n">decimalk</span><span class="si">}</span><span class="s1">f</span><span class="si">}</span><span class="s1">, število iteracij: </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">, D: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">5.8f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x1</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Metoda po </span><span class="si">{:g}</span><span class="s1"> iteracijah ne konvergira&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_iter</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo polinom <code class="docutils literal notranslate"><span class="pre">f</span></code> in njegov prvi odvod <code class="docutils literal notranslate"><span class="pre">df</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span>
<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">20</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo sedaj ničlo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtonova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">dfun</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: 0.73460351, število iteracij: 5, D: 0.00000000
</pre></div>
</div>
</div>
</div>
<p>Preverimo hitrost izvajanja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> newtonova(fun=f, dfun=df, x0=1, tol=1e-8, izpis=False)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14 µs ± 1.38 µs per loop (mean ± std. dev. of 7 runs, 100,000 loops each)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h2>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code><a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h2>
<p>Znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je Newtonova metoda definirana v okviru <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code> funkcije, ki smo jo že spoznali zgoraj pri sekantni metodi (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.newton.html">dokumentacijo</a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.48e-08</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">fprime2</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Če v funkcijo <code class="docutils literal notranslate"><span class="pre">newton</span></code> poleg funkcije <code class="docutils literal notranslate"><span class="pre">func</span></code> in začetne vrednosti <code class="docutils literal notranslate"><span class="pre">x0</span></code> podamo tudi prvi odvod <code class="docutils literal notranslate"><span class="pre">fprime</span></code>, se dejansko uporabi Newtonova metoda.</p>
<p>Če podamo tudi drugi odvod <code class="docutils literal notranslate"><span class="pre">fprime2</span></code>, se uporabi Halleyeva metoda, ki temelji na izrazu:</p>
<div class="math notranslate nohighlight">
\[x_{n+1}=x_{n}-\frac{2f(x_{n})f'(x_{n})}{2\,f'^{2}(x_{n})-f(x_{n})f''(x_{n})}\]</div>
<p>Poglejmo si primer uporabe Newtonove metode v <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="sa">f</span><span class="s1">&#39;Rezultat: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">2.8f</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Rezultat: 0.73460351&#39;
</pre></div>
</div>
</div>
</div>
<p>In izmerimo hitrost:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> newton(func=f, x0=1., fprime=df)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>131 µs ± 11.4 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resevanje-sistemov-nelinarnih-enacb">
<h1>Reševanje sistemov nelinarnih enačb*<a class="headerlink" href="#resevanje-sistemov-nelinarnih-enacb" title="Permalink to this headline">#</a></h1>
<p>Rešujemo sistem enačb, ki ga v vektorski obliki zapišemo takole:
$<span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x})=\mathbf{0}.\)</span><span class="math notranslate nohighlight">\(
V skalarni obliki zgornji vektorski izraz zapišemo:
\)</span><span class="math notranslate nohighlight">\(\begin{array}{rcl}
f_0(x_0,x_1,\dots, x_{n-1})&amp;=&amp;0\\
f_1(x_0,x_1,\dots, x_{n-1})&amp;=&amp;0\\
&amp;\vdots&amp;\\
f_{n-1}(x_0,x_1,\dots, x_{n-1})&amp;=&amp;0.\\
\end{array}\)</span>$</p>
<p>Reševanje sistema <span class="math notranslate nohighlight">\(n\)</span> nelinearnih enačb je bistveno bolj zahtevno kot reševanje ene same nelinearne enačbe. Tak sistem enačb ima lahko več rešitev in katero izračunamo, je odvisno od začetnih pogojev. Ponavadi nam pri dobri izbiri začetnih pogojev pomaga fizikalni problem, ki ga rešujemo.</p>
<p>Za računanje rešitve sistema enačb se <em>Newtonova</em> metoda izkaže kot najenostavnejša in pogosto tudi najboljša (obstajajo tudi druge metode, ki pa so velikokrat variacije Newtonove metode).</p>
<p>Podobno kot pri izpeljavi Newtonove metode za reševanje ene enačbe, tudi tukaj začnemo z razvojem funkcije <span class="math notranslate nohighlight">\(f_i\)</span> v Taylorjevo vrsto:
$<span class="math notranslate nohighlight">\(f_i(\mathbf{x}+\Delta \mathbf{x})=f_i(\mathbf{x})+\sum_{j=1}^n \frac{\partial f_i}{\partial x_j}\,\Delta x_j+O^2(\mathbf{\Delta x}).\)</span>$</p>
<p>Naredimo napako metode, ko zanemarimo člene drugega in višjih redov ter zapišemo izraz v matrični obliki:
$<span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x}+\Delta \mathbf{x})=\mathbf{f}(\mathbf{x})+\mathbf{J}(\mathbf{x})\,\Delta \mathbf{x},\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>\mathbf{J}(\mathbf{x})<span class="math notranslate nohighlight">\( *Jakobijeva* matrika pri vrednostih \)</span>\mathbf{x}<span class="math notranslate nohighlight">\(. Elementi Jakobijeve matrike so: 
\)</span><span class="math notranslate nohighlight">\(J_{ij}=\frac{\partial f_i}{\partial x_j}.\)</span>$</p>
<p>Če naj bo <span class="math notranslate nohighlight">\(\mathbf{x}+\Delta \mathbf{x}\)</span> rešitev sistema enačb, mora veljati:
$<span class="math notranslate nohighlight">\(\mathbf{0}=\mathbf{f}(\mathbf{x})+\mathbf{J}(\mathbf{x})\,\Delta \mathbf{x}\)</span><span class="math notranslate nohighlight">\(
in torej sledi:
\)</span><span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x})\,\Delta \mathbf{x}=-\mathbf{f}(\mathbf{x}).\)</span>$</p>
<p>Izpeljali smo sistem linearnih enačb, matrika koeficientov je označena z <span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x})\)</span>, vektor neznank je <span class="math notranslate nohighlight">\(\Delta\mathbf{x}\)</span> in vektor konstant <span class="math notranslate nohighlight">\(-\mathbf{f}(\mathbf{x}).\)</span></p>
<p>Opomba: analitično računanje Jakobijeve matrike je lahko zamudno in zato jo pogosto približno izračunamo pri <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> numerično:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f_i}{\partial x_j}\approx
\frac{f_i(\mathbf{x}+\mathbf{e}_j\,h)-f_i(\mathbf{x})}{h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(h\)</span> majhen premik in je <span class="math notranslate nohighlight">\(\mathbf{e}_j\)</span> enotski pomik v smeri <span class="math notranslate nohighlight">\(x_j\)</span>. Če se Jakobijeva matrika izračuna numerično, govorimo o sekantni metodi in ne Newtonovi.</p>
<p>Pri numeričnem izračunu si lahko pomagamo s funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.optimize.approx_fprime</span></code> (za podrobnosti glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.approx_fprime.html">dokumentacijo</a>).</p>
<section id="id7">
<h2>Numerična implementacija<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h2>
<p>Algoritem torej je:</p>
<ol class="simple">
<li><p>Izberemo začetni približek <span class="math notranslate nohighlight">\(\mathbf{x}_0\)</span>, največje število iteracij in postavimo indeks na nič: <span class="math notranslate nohighlight">\(i=0\)</span>.</p></li>
<li><p>Izračunamo Jakobijevo matriko <span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x_i})\)</span> in rešimo linearni sistem: <span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x}_i)\,\Delta \mathbf{x}_i=-\mathbf{f}(\mathbf{x}_i)\)</span>.</p></li>
<li><p>Izračunamo nov približek: <span class="math notranslate nohighlight">\(\mathbf{x}_{i+1}=\mathbf{x}_{i}+\Delta\mathbf{x}_i\)</span>.</p></li>
<li><p>Če je napaka manjša od zahtevane, se postopek prekine*. Postopek prekinemo tudi, če je število iteracij večje od dovoljenega, sicer povečamo indeks <span class="math notranslate nohighlight">\(i=i+1\)</span> in se vrnemo v korak 2.</p></li>
</ol>
<p>* Opomba:</p>
<p>Napako lahko ocenimo z normo razlike dveh zaporednih približkov:</p>
<div class="math notranslate nohighlight">
\[\sum_j^{n-1}\left|x_{i,j}-x_{i-1,j}\right|&lt;\varepsilon,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(i\)</span> indeks iteracije in <span class="math notranslate nohighlight">\(j\)</span> indeks elementa.</p>
</section>
<section id="uporaba-scipy-optimize-root">
<h2>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root</span></code><a class="headerlink" href="#uporaba-scipy-optimize-root" title="Permalink to this headline">#</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root</span></code> ima obsežno <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html">dokumentacijo</a> in omogoča večje število različnih pristopov:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hybr&#39;</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Če uporabimo privzete parametre, moramo definirati zgolj vektorsko funkcijo <code class="docutils literal notranslate"><span class="pre">fun</span></code> in začetno vrednost <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<p>Uvozimo funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si uporabo na zgledu (gre za zgled na str. 76, Jože Petrišič, Reševanje enačb, 1996, FS, UNI-LJ):</p>
<div class="math notranslate nohighlight">
\[f_0(\mathbf{x})=x_0^2+x_0\,x_1-10=0,\]</div>
<div class="math notranslate nohighlight">
\[f_1(\mathbf{x})=x_1+3\,x_0\,x_1^2-57=0,\]</div>
<p>kjer je vektor <span class="math notranslate nohighlight">\(\mathbf{x}=[x_0, x_1]\)</span>.</p>
<p>Najprej definirajmo Python funkcijo, ki vrne seznam rezultatov funkcij <span class="math notranslate nohighlight">\([f_0(\mathbf{x}),f_1(\mathbf{x})]\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">57</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo še Jakobijevo matriko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                     <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>   <span class="mi">1</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
</pre></div>
</div>
</div>
</div>
<p>Uporabimo začetne vrednosti <span class="math notranslate nohighlight">\(x_0=1,5\)</span> in <span class="math notranslate nohighlight">\(x_1=3,5\)</span> ter rešimo problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span> <span class="n">jac</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">rešitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    fjac: array([[-0.22347867, -0.97470882],
       [ 0.97470882, -0.22347867]])
     fun: array([-6.97220059e-12,  3.14770432e-11])
 message: &#39;The solution converged.&#39;
    nfev: 10
    njev: 1
     qtf: array([-2.83570821e-08, -1.32374877e-08])
       r: array([-29.54114937, -37.8158159 ,  -6.93953536])
  status: 1
 success: True
       x: array([2., 3.])
</pre></div>
</div>
</div>
</div>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">root</span></code> vrne obsežen rezultat. Najbolj pomembna sta atribut <code class="docutils literal notranslate"><span class="pre">x</span></code>, ki predstavlja iskano rešitev, in atribut <code class="docutils literal notranslate"><span class="pre">success</span></code>, ki pove, ali je rešitev konvergirala:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2., 3.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span><span class="o">.</span><span class="n">success</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h1>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this headline">#</a></h1>
<ol>
<li><p>V simbolni obliki definirajte izraz:
$<span class="math notranslate nohighlight">\(f(x) = x^4 - 6.4\,x^3 + 6.45\,x^2 + 20.538\,x - 31.752.\)</span>$</p></li>
<li><p>Narišite funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>. Koliko ničel pričakujemo za funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>?</p></li>
<li><p>V simbolni obliki določite ničlo polinoma <span class="math notranslate nohighlight">\(f(x)\)</span> (uporabite sympy).</p></li>
<li><p>Kako preverimo, ali je ničla ekstrem?</p></li>
<li><p>Numerično najdite vse ničle z bisekcijsko metodo (uporabite <code class="docutils literal notranslate"><span class="pre">scipy</span></code>).</p></li>
<li><p>Numerično najdite vse ničle s sekantno metodo (uporabite <code class="docutils literal notranslate"><span class="pre">scipy</span></code>).</p></li>
<li><p>Numerično najdite vse ničle z Newtonovo metodo (uporabite <code class="docutils literal notranslate"><span class="pre">scipy</span></code>).</p></li>
<li><p>Podatke:
$<span class="math notranslate nohighlight">\(x=[0, 1, 2, 3, 4, 5]\)</span><span class="math notranslate nohighlight">\(
 \)</span><span class="math notranslate nohighlight">\(y=[0.95, 0.93, 0.87, 0.77, 0.64, 0.49]\)</span><span class="math notranslate nohighlight">\(
aproksimirajte s funkcijo \)</span>\cos(a,x)<span class="math notranslate nohighlight">\( (z uporabo ``scipy.optimize.curve_fit`` določite konstanto \)</span>a$).</p></li>
<li><p>Na intervalu <span class="math notranslate nohighlight">\(x=[0, 50]\)</span> z bisekcijsko metodo poiščite vse ničle najdene funkcije <span class="math notranslate nohighlight">\(\cos(a\,x)\)</span>.</p></li>
<li><p>Na intervalu <span class="math notranslate nohighlight">\(x=[0, 50]\)</span> z Newtonovo metodo poiščite vse ničle najdene funkcije <span class="math notranslate nohighlight">\(\cos(a\,x)\)</span>.</p></li>
<li><p>S pomočjo <code class="docutils literal notranslate"><span class="pre">sympy</span></code> najdite simbolno rešitev za:
$<span class="math notranslate nohighlight">\(x^2 + y -2=0\qquad\textrm{in}\qquad  y^2 - 4=0.\)</span>$</p></li>
<li><p>Zgoraj definirani problem rešite še numerično s pomočjo <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root</span></code>.</p></li>
<li><p>Na predhodnem vprašanju preizkusite različne metode (glejte pomoč).</p></li>
<li><p>Z uporabo bisekcijske metode dimenzionirajte prikazani upogibno obremenjeni nosilec dolžine <span class="math notranslate nohighlight">\(L\)</span> (obremenjen s točkovno silo <span class="math notranslate nohighlight">\(F\)</span>). Določite velikost polnega krožnega prereza <span class="math notranslate nohighlight">\(d\)</span>.
<img src="./fig/nal-num_iskanje_nicel-1.jpg">
<span class="math notranslate nohighlight">\(F = 1 \mathrm{kN}\)</span></p>
<p><span class="math notranslate nohighlight">\(L = 1 \mathrm{m}\)</span><br>
<span class="math notranslate nohighlight">\(\sigma_{dop} = 120 \mathrm{MPa}\)</span></p>
<p>Reševanje:</p>
<p><span class="math notranslate nohighlight">\(\sigma_u \leq \sigma_{dop} \to \frac{F\,L}{W} = \frac{F\,L\,32}{\pi\,d^3} = \sigma_{dop}\)</span></p>
</li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h1>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this headline">#</a></h1>
<p>Tisti, ki ste navdušeni nad <a class="reference external" href="https://www.raspberrypi.org/">Raspberry Pi</a> in uporabljate njihovo kamero (npr. <a class="reference external" href="https://www.raspberrypi.org/products/pi-noir-camera/">tole brez infrardečega filtra</a>), vas bo morebiti zanimala knjižnica <a class="reference external" href="http://picamera.readthedocs.org/">picamera</a>.</p>
<section id="uporaba-sympy-solve-za-resevanje-enacb">
<h2>Uporaba <code class="docutils literal notranslate"><span class="pre">sympy.solve</span></code> za reševanje enačb<a class="headerlink" href="#uporaba-sympy-solve-za-resevanje-enacb" title="Permalink to this headline">#</a></h2>
<p>Za manjše sisteme lahko rešitev najdemo tudi simbolno. Poglejmo si zgornji primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">funkcije</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">57</span><span class="p">]</span>
<span class="n">funkcije</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 09 - Reševanje enačb_175_0.png" src="../_images/Predavanje 09 - Reševanje enačb_175_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">funkcije</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Število rešitev: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Prva rešitev: </span><span class="si">{</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Število rešitev: 4
Prva rešitev: (2, 3)
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Predavanje%2008%20-%20Aproksimacija.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Aproksimacija</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Predavanje%2010%20-%20Numeri%C4%8Dno%20odvajanje.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Numerično odvajanje</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Janko Slavič<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>