
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Numerično integriranje &#8212; Numerične metode v ekosistemu Pythona</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Numerično reševanje diferencialnih enačb - začetni problem" href="Predavanje%2012%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20za%C4%8Detni%20problem.html" />
    <link rel="prev" title="Numerično odvajanje" href="Predavanje%2010%20-%20Numeri%C4%8Dno%20odvajanje.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Numerične metode v ekosistemu Pythona</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Numerične metode v ekosistemu Pythona, Janko Slavič, 2022
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="%C5%A0tudijski%20in%20izpitni%20red.html">
   Študijski in izpitni red: 2022/23
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2001%20-%20Uvod%20v%20Python.html">
   Uvod v Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2002%20-%20Print%2C%20delo%20z%20datotekami%2C%20funkcije%2C%20moduli.html">
   Funkcije, izjeme, moduli
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2003%20-%20Moduli%2C%20numpy%2C%20matplotlib.html">
   Numpy, matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2004%20-%20Objektno%20programiranje%2C%20simbolno%20ra%C4%8Dunanje.html">
   Objektno programiranje, simbolno računanje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2005%20-%20Uvod%20v%20numeri%C4%8Dne%20metode%20in%20sistemi%20linearnih%20ena%C4%8Db%201.html">
   Uvod v numerične metode in sistemi linearnih enačb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2006%20-%20Sistemi%20linearnih%20ena%C4%8Db%202.html">
   Sistemi linearnih enačb - nadaljevanje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2007%20-%20Interpolacija.html">
   Interpolacija
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2008%20-%20Aproksimacija.html">
   Aproksimacija
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2009%20-%20Re%C5%A1evanje%20ena%C4%8Db.html">
   Reševanje enačb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2010%20-%20Numeri%C4%8Dno%20odvajanje.html">
   Numerično odvajanje
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Numerično integriranje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2012%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20za%C4%8Detni%20problem.html">
   Numerično reševanje diferencialnih enačb - začetni problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2013%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20robni%20problem.html">
   Numerično reševanje diferencialnih enačb - robni problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Predavanje%2014%20-%20Testiranje%20pravilnosti%20kode%2C%20uporabni%C5%A1ki%20vmesnik.html">
   Testiranje pravilnosti kode, uporabniški vmesnik
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jankoslavic/pynm/master?urlpath=tree/notebooks/notebooks/Predavanje 11 - Numerično integriranje.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jankoslavic/pynm"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jankoslavic/pynm/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Predavanje 11 - Numerično integriranje.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/Predavanje 11 - Numerično integriranje.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Numerično integriranje
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uvod">
   Uvod
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivacijski-primer">
     Motivacijski primer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-cotesov-pristop">
   Newton-Cotesov pristop
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trapezno-pravilo">
     Trapezno pravilo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numericna-implementacija">
       Numerična implementacija
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numericni-zgled">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#napaka-trapeznega-pravila">
       Napaka trapeznega pravila
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sestavljeno-trapezno-pravilo">
     Sestavljeno trapezno pravilo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Numerična implementacija
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#napaka-sestavljenega-trapeznega-pravila">
       Napaka sestavljenega trapeznega pravila
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boljsi-priblizek-integrala">
       Boljši približek integrala
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numpy-implementacija-sestavljenega-trapeznega-pravila">
       <code class="docutils literal notranslate">
        <span class="pre">
         numpy
        </span>
       </code>
       implementacija sestavljenega trapeznega pravila
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simpsonova-in-druge-metode">
     Simpsonova in druge metode
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#izpeljava-trapeznega-pravila-z-uporabo-lagrangevih-polinomov">
       Izpeljava trapeznega pravila z uporabo Lagrangevih polinomov
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#izracun-utezi-za-simpsonovo-pravilo">
       Izračun uteži za Simpsonovo pravilo
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-newton-cotes">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.newton_cotes
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#izracun-utezi-za-simpsonovo-3-8-pravilo">
       Izračun uteži za Simpsonovo 3/8 pravilo
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sestavljeno-simpsonovo-pravilo">
     Sestavljeno Simpsonovo pravilo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boljsa-ocena-integrala">
       Boljša ocena integrala
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simpsonova-metoda-v-scipy-integrate-simps">
       Simpsonova metoda v
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.simps
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rombergova-metoda">
     Rombergova metoda*
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rombergova-metoda-v-scipy-integrate-romb">
       Rombergova metoda v
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.romb
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussov-integracijski-pristop">
   Gaussov integracijski pristop
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussova-kvadratura-z-enim-vozliscem">
     Gaussova kvadratura z enim vozliščem
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#standardne-meje-a-1-in-b-1">
       Standardne meje:
       <span class="math notranslate nohighlight">
        \(a=-1\)
       </span>
       in
       <span class="math notranslate nohighlight">
        \(b=1\)
       </span>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#strojno-izpeljevanje-utezi-in-gaussove-tocke">
       Strojno izpeljevanje uteži in Gaussove točke
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussova-integracijska-metoda-z-vec-vozlisci">
     Gaussova integracijska metoda z več vozlišči
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#strojno-izpeljevanje">
       Strojno izpeljevanje
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Numerična implementacija
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-fixed-quad">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.fixed_quad
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scipy-integrate">
   <code class="docutils literal notranslate">
    <span class="pre">
     scipy.integrate
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intergracijske-funkcije-ki-zahtevajo-definicijsko-funkcijo">
     Intergracijske funkcije, ki zahtevajo definicijsko
     <em>
      funkcijo
     </em>
     :
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-quad">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.quad
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-dblquad">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.dblquad
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intergracijske-funkcije-ki-zahtevajo-tabelo-vrednosti">
     Intergracijske funkcije, ki zahtevajo tabelo vrednosti:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nekaj-vprasanj-za-razmislek">
   Nekaj vprašanj za razmislek!
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dodatno">
   Dodatno
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Numerično integriranje</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Numerično integriranje
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uvod">
   Uvod
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivacijski-primer">
     Motivacijski primer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-cotesov-pristop">
   Newton-Cotesov pristop
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trapezno-pravilo">
     Trapezno pravilo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numericna-implementacija">
       Numerična implementacija
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numericni-zgled">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#napaka-trapeznega-pravila">
       Napaka trapeznega pravila
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sestavljeno-trapezno-pravilo">
     Sestavljeno trapezno pravilo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Numerična implementacija
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#napaka-sestavljenega-trapeznega-pravila">
       Napaka sestavljenega trapeznega pravila
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boljsi-priblizek-integrala">
       Boljši približek integrala
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numpy-implementacija-sestavljenega-trapeznega-pravila">
       <code class="docutils literal notranslate">
        <span class="pre">
         numpy
        </span>
       </code>
       implementacija sestavljenega trapeznega pravila
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simpsonova-in-druge-metode">
     Simpsonova in druge metode
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#izpeljava-trapeznega-pravila-z-uporabo-lagrangevih-polinomov">
       Izpeljava trapeznega pravila z uporabo Lagrangevih polinomov
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#izracun-utezi-za-simpsonovo-pravilo">
       Izračun uteži za Simpsonovo pravilo
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-newton-cotes">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.newton_cotes
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#izracun-utezi-za-simpsonovo-3-8-pravilo">
       Izračun uteži za Simpsonovo 3/8 pravilo
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sestavljeno-simpsonovo-pravilo">
     Sestavljeno Simpsonovo pravilo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boljsa-ocena-integrala">
       Boljša ocena integrala
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Numerični zgled
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simpsonova-metoda-v-scipy-integrate-simps">
       Simpsonova metoda v
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.simps
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rombergova-metoda">
     Rombergova metoda*
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rombergova-metoda-v-scipy-integrate-romb">
       Rombergova metoda v
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.romb
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussov-integracijski-pristop">
   Gaussov integracijski pristop
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussova-kvadratura-z-enim-vozliscem">
     Gaussova kvadratura z enim vozliščem
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#standardne-meje-a-1-in-b-1">
       Standardne meje:
       <span class="math notranslate nohighlight">
        \(a=-1\)
       </span>
       in
       <span class="math notranslate nohighlight">
        \(b=1\)
       </span>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#strojno-izpeljevanje-utezi-in-gaussove-tocke">
       Strojno izpeljevanje uteži in Gaussove točke
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussova-integracijska-metoda-z-vec-vozlisci">
     Gaussova integracijska metoda z več vozlišči
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#strojno-izpeljevanje">
       Strojno izpeljevanje
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Numerična implementacija
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-fixed-quad">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.fixed_quad
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scipy-integrate">
   <code class="docutils literal notranslate">
    <span class="pre">
     scipy.integrate
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intergracijske-funkcije-ki-zahtevajo-definicijsko-funkcijo">
     Intergracijske funkcije, ki zahtevajo definicijsko
     <em>
      funkcijo
     </em>
     :
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-quad">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.quad
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integrate-dblquad">
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy.integrate.dblquad
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intergracijske-funkcije-ki-zahtevajo-tabelo-vrednosti">
     Intergracijske funkcije, ki zahtevajo tabelo vrednosti:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nekaj-vprasanj-za-razmislek">
   Nekaj vprašanj za razmislek!
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dodatno">
   Dodatno
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="numericno-integriranje">
<h1>Numerično integriranje<a class="headerlink" href="#numericno-integriranje" title="Permalink to this headline">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h1>Uvod<a class="headerlink" href="#uvod" title="Permalink to this headline">#</a></h1>
<p>V okviru tega poglavja bomo za dano funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span> izračunali določen integral:
$<span class="math notranslate nohighlight">\(\int_a^b\,f(x)\,\textrm{d}x\)</span><span class="math notranslate nohighlight">\(
kjer sta \)</span>a<span class="math notranslate nohighlight">\( in \)</span>b<span class="math notranslate nohighlight">\( meji integriranja, \)</span>f(x)$ pa so vrednosti funkcije, ki jih pridobimo iz tabele vrednosti ali s pomočjo analitične funkcije.</p>
<p>Pri numeričnem integriranju integral ocenimo z <span class="math notranslate nohighlight">\(I\)</span> in velja
$<span class="math notranslate nohighlight">\(\int_a^b\,f(x)\,\textrm{d}x= I + E,\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>E$ napaka ocene integrala.</p>
<p>Numerični integral bomo računali na podlagi diskretne vsote:
$<span class="math notranslate nohighlight">\(I=\sum_{i=0}^{m}A_i\,f(x_i),\)</span><span class="math notranslate nohighlight">\(
kjer so \)</span>A_i<span class="math notranslate nohighlight">\( uteži, \)</span>x_i<span class="math notranslate nohighlight">\( pa vozlišča na intervalu \)</span>[a, b]<span class="math notranslate nohighlight">\( in je \)</span>m+1$ število vozlišč.</p>
<p>Ogledali si bomo dva različna pristopa k numerični integraciji:</p>
<ol class="simple">
<li><p><em>Newton-Cotesov pristop</em>, ki temelji na ekvidistantnih vozliščih (konstanten korak integracije) in</p></li>
<li><p><em>Gaussov integracijski pristop</em>, kjer so vozlišča postavljena tako, da se doseže natančnost za polinome.</p></li>
</ol>
<section id="motivacijski-primer">
<h2>Motivacijski primer<a class="headerlink" href="#motivacijski-primer" title="Permalink to this headline">#</a></h2>
<p>Pri numeričnem integriranju si bomo pomagali s konkretnim primerom:</p>
<div class="math notranslate nohighlight">
\[\int_1^2 x\,\sin(x)\,\textrm{d}x\]</div>
<p>Pripravimo si vozlišča. Osnovni korak naj bo <span class="math notranslate nohighlight">\(h=0.25\)</span>, v tem primeru imamo štiri podintervale in pet vozlišč, pri koraku <span class="math notranslate nohighlight">\(2h\)</span> so tri vozliščne točke in pri koraku <span class="math notranslate nohighlight">\(4h\)</span> samo dve (skrajni):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">xg</span><span class="p">,</span> <span class="n">hg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># goste točke (za prikaz)</span>
<span class="n">x2v</span><span class="p">,</span> <span class="n">h2v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h2v = 1 (2 vozlišči)</span>
<span class="n">x3v</span><span class="p">,</span> <span class="n">h3v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h3v = 0.5 (3 vozlišča)</span>
<span class="n">x4v</span><span class="p">,</span> <span class="n">h4v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h4v = 0.33.. (4 vozlišča)</span>
<span class="n">x5v</span><span class="p">,</span> <span class="n">h5v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h5v = 0.25 (5 vozlišč)</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo še funkcijske vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yg</span> <span class="o">=</span> <span class="n">xg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
<span class="n">y2v</span> <span class="o">=</span> <span class="n">x2v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x2v</span><span class="p">)</span>
<span class="n">y3v</span> <span class="o">=</span> <span class="n">x3v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x3v</span><span class="p">)</span>
<span class="n">y4v</span> <span class="o">=</span> <span class="n">x4v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x4v</span><span class="p">)</span>
<span class="n">y5v</span> <span class="o">=</span> <span class="n">x5v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x5v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo prikaz podatkov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span> <span class="c1"># to uvozimo, da so fonti na sliki latex ustrezni</span>
<span class="c1">#rc(&#39;font&#39;,**{&#39;family&#39;:&#39;sans-serif&#39;,&#39;sans-serif&#39;:[&#39;Helvetica&#39;]})</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">def</span> <span class="nf">fig_motivacija</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\int_1^2\,x\,\sin(x)\,\textrm</span><span class="si">{d}</span><span class="s1">x$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h2v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo podatke:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_motivacija</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_15_0.png" src="../_images/Predavanje 11 - Numerično integriranje_15_0.png" />
</div>
</div>
<p>Analitično izračunajmo točen rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">I_točno</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">evalf</span><span class="p">())</span>
<span class="n">I_točno</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_17_0.png" src="../_images/Predavanje 11 - Numerično integriranje_17_0.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="newton-cotesov-pristop">
<h1>Newton-Cotesov pristop<a class="headerlink" href="#newton-cotesov-pristop" title="Permalink to this headline">#</a></h1>
<p>Na sliki je prikazan splošen primer, kjer je razdalja med vozlišči <span class="math notranslate nohighlight">\(x_i\)</span> enaka <span class="math notranslate nohighlight">\(h\)</span> (gre za <strong>ekvidistantno delitev</strong>).
<img src='./fig/integriranje.png' width=400></p>
<p>V okviru tega poglavja si bomo najprej pogledali trapezno ter sestavljeno trapezno pravilo, pozneje pa bosta sledili še Simpsonova ter Rombergova metoda.</p>
<section id="trapezno-pravilo">
<h2>Trapezno pravilo<a class="headerlink" href="#trapezno-pravilo" title="Permalink to this headline">#</a></h2>
<p>Trapezno pravilo vrednosti podintegralske funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> na (pod)intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> interpolira z linearno funkcijo. Za dve vozliščni točki to pomeni, da površino pod grafom funkcije približno izračunamo kot:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{trapezno}}=\sum_{i=0}^{n=1}A_i\,f(x_i)=\frac{h}{2}\cdot\left(f(x_0)+f(x_1)\right).\]</div>
<p>In so uteži:</p>
<div class="math notranslate nohighlight">
\[A_0 = A_1 = \frac{1}{2}\,h.\]</div>
<section id="numericna-implementacija">
<h3>Numerična implementacija<a class="headerlink" href="#numericna-implementacija" title="Permalink to this headline">#</a></h3>
<p>Numerična implementacija je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trapezno</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trapezno pravilo integriranja.</span>
<span class="sd">    </span>
<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="numericni-zgled">
<h3>Numerični zgled<a class="headerlink" href="#numericni-zgled" title="Permalink to this headline">#</a></h3>
<p>V konkretnem primeru to pomeni, da prvo in zadnjo funkcijsko vrednost utežimo s <span class="math notranslate nohighlight">\(h/2\)</span>. V našem primeru je <span class="math notranslate nohighlight">\(h=1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_trapezno</span> <span class="o">=</span> <span class="n">trapezno</span><span class="p">(</span><span class="n">y2v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h2v</span><span class="p">)</span>
<span class="n">I_trapezno</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_27_0.png" src="../_images/Predavanje 11 - Numerično integriranje_27_0.png" />
</div>
</div>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_trapezno</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm</span><span class="si">{trapezno}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h2v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_trapezno</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_31_0.png" src="../_images/Predavanje 11 - Numerično integriranje_31_0.png" />
</div>
</div>
</section>
<section id="napaka-trapeznega-pravila">
<h3>Napaka trapeznega pravila<a class="headerlink" href="#napaka-trapeznega-pravila" title="Permalink to this headline">#</a></h3>
<p>Razlika med analitično vrednostjo integrala in numeričnim približkom <span class="math notranslate nohighlight">\(I\)</span> je napaka metode:</p>
<div class="math notranslate nohighlight">
\[E = \int_a^bf(x)\,d x-I,\]</div>
<p>Če je funkcija <span class="math notranslate nohighlight">\(f(x)\)</span> vsaj dvakrat odvedljiva, se lahko (glejte npr. vir: Burden, Faires, Burden: Numerical Analysis 10th Ed) izpelje ocena napake, ki velja samo za trapezni približek prek celega integracijskega intervala:
$<span class="math notranslate nohighlight">\(E_{\textrm{trapezno}}=-\frac{h^3}{12}f''(\xi),\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>h=b-a<span class="math notranslate nohighlight">\( in \)</span>\xi<span class="math notranslate nohighlight">\( neznana vrednost na intervalu \)</span>[a,b]$.</p>
</section>
</section>
<section id="sestavljeno-trapezno-pravilo">
<h2>Sestavljeno trapezno pravilo<a class="headerlink" href="#sestavljeno-trapezno-pravilo" title="Permalink to this headline">#</a></h2>
<p>Če razdelimo interval <span class="math notranslate nohighlight">\([a, b]\)</span> na <span class="math notranslate nohighlight">\(n\)</span> podintervalov in na vsakem uporabimo trapezno pravilo integriranja,  govorimo o <em>sestavljenem trapeznem pravilu</em> (angl. <em>composite trapezoidal rule</em>).</p>
<p>V tem primeru za vsak podinterval <span class="math notranslate nohighlight">\(i\)</span> uporabimo trapezno pravilo in torej za meje podinterval <span class="math notranslate nohighlight">\(x_i\)</span> in <span class="math notranslate nohighlight">\(x_{i+1}\)</span> uporabimo uteži <span class="math notranslate nohighlight">\(A_i=A_{i+i}=h/2\)</span>. Ker so notranja vozlišča podvojena, sledi:
$<span class="math notranslate nohighlight">\(A_0=A_{n}=\frac{h}{2}\quad\textrm{in za ostala vozlišča:}\quad A_i=h.\)</span><span class="math notranslate nohighlight">\(
Pri tem smo predpostavili podintervale enake širine:
\)</span><span class="math notranslate nohighlight">\(h=\frac{x_{n}-x_0}{n}\)</span>$</p>
<p>Sledi torej:
$<span class="math notranslate nohighlight">\(I_{\textrm{trapezno sest}}=\sum_{i=0}^{n}A_i\,f(x_i)=\left(\frac{y_0}{2} + y_1+y_2+\cdots+y_{n-1}+\frac{y_{n}}{2}\right)\,h.\)</span>$</p>
<section id="id1">
<h3>Numerična implementacija<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Numerična implementacija je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trapezno_sest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sestavljeno trapezno pravilo integriranja.</span>
<span class="sd">    </span>
<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">h</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>Numerični zgled<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>Zgoraj smo že pripravili podatke za dva podintervala (tri vozlišča):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x3v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1. , 1.5, 2. ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h3v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_44_0.png" src="../_images/Predavanje 11 - Numerično integriranje_44_0.png" />
</div>
</div>
<p>Izračunajmo oceno integrala s sestavljenim trapeznim pravilom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_trapezno_sest</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y3v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h3v</span><span class="p">)</span>
<span class="n">I_trapezno_sest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_46_0.png" src="../_images/Predavanje 11 - Numerično integriranje_46_0.png" />
</div>
</div>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_trapezno_sest</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{trapezno sestavljeno}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_trapezno_sest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_50_0.png" src="../_images/Predavanje 11 - Numerično integriranje_50_0.png" />
</div>
</div>
</section>
<section id="napaka-sestavljenega-trapeznega-pravila">
<h3>Napaka sestavljenega trapeznega pravila<a class="headerlink" href="#napaka-sestavljenega-trapeznega-pravila" title="Permalink to this headline">#</a></h3>
<p>Napaka sestavljenega trapeznega pravila izhaja iz napake trapeznega pravila; pri tem tako napako naredimo <span class="math notranslate nohighlight">\(n\)</span>-krat.</p>
<p>Ker velja <span class="math notranslate nohighlight">\(h\cdot n=b-a\)</span>, izpeljemo napako sestavljenega trapeznega pravila kot:</p>
<div class="math notranslate nohighlight">
\[E_{\textrm{trapezno sest}}=-\frac{h^2(b-a)}{12}f''(\eta),\]</div>
<p><span class="math notranslate nohighlight">\(\eta\)</span> je vrednost na intervalu <span class="math notranslate nohighlight">\([a,b]\)</span>. Napaka je drugega reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span>.</p>
</section>
<section id="boljsi-priblizek-integrala">
<h3>Boljši približek integrala<a class="headerlink" href="#boljsi-priblizek-integrala" title="Permalink to this headline">#</a></h3>
<p>V nadaljevanju si bomo pogledali t. i. <strong>Richardsonovo ekstrapolacijo</strong>, pri kateri na podlagi ocene integrala s korakom <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> izračunamo boljši približek.</p>
<p>V kolikor integral <span class="math notranslate nohighlight">\(I\)</span> numerično izračunamo pri dveh različnih korakih <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2\,h\)</span>, velja:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,\textrm{d}x = I_h + E_h = I_{2h} + E_{2h},\]</div>
<p>kjer sta <span class="math notranslate nohighlight">\(I_h\)</span> in <span class="math notranslate nohighlight">\(I_{2h}\)</span> približka integrala s korakom <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> ter <span class="math notranslate nohighlight">\(E_h\)</span> in <span class="math notranslate nohighlight">\(E_{2h}\)</span> oceni napake pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span>. Izpeljemo <span class="math notranslate nohighlight">\(I_{2h}-I_{h} = E_{h}-E_{2h}\)</span></p>
<p>Naprej zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_h=-\frac{h^2(b-a)}{12}f''(\eta)=h^2\,K.\]</div>
<p>Ob predpostavki, da je <span class="math notranslate nohighlight">\(f''\left (\eta \right )\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> enak (<span class="math notranslate nohighlight">\(\eta\)</span> je pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> dejansko različen), zapišemo:
$<span class="math notranslate nohighlight">\(E_{2h}=-\frac{(2h)^2(b-a)}{12}f''(\eta)=4\,h^2\,K\)</span>$</p>
<p>Sledi:</p>
<div class="math notranslate nohighlight">
\[I_{2h}-I_h=-3K\,h^2.\]</div>
<p>Sedaj lahko ocenimo napako pri koraku <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_h=h^2\,K=\frac{I_h-I_{2h}}{3}.\]</div>
<p>Na podlagi ocene napake lahko izračunamo boljši numerični približek  <span class="math notranslate nohighlight">\(I_{h}^*\)</span>:
$<span class="math notranslate nohighlight">\(I_h^* = I_h + \frac{1}{3}\,(I_{h}-I_{2h})\)</span><span class="math notranslate nohighlight">\(
ali
\)</span><span class="math notranslate nohighlight">\(I_h^* = \frac{4}{3}\,I_h - \frac{1}{3}\,I_{2h}\)</span>$</p>
</section>
<section id="id3">
<h3>Numerični zgled<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Predhodno smo s trapeznim pravilom že izračunali integral pri koraku <span class="math notranslate nohighlight">\(h=1\)</span> in pri koraku <span class="math notranslate nohighlight">\(h=0,5\)</span>, rezultata sta bila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">I_trapezno</span><span class="p">,</span> <span class="n">I_trapezno_sest</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_61_0.png" src="../_images/Predavanje 11 - Numerično integriranje_61_0.png" />
</div>
</div>
<p>S pomočjo zgornje formule izračunamo boljši približek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_trapezno_boljši</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I_trapezno_sest</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I_trapezno</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Točen rezultat:   </span><span class="si">{</span><span class="n">I_točno</span><span class="si">}</span><span class="se">\n</span><span class="s1">Boljši približek: </span><span class="si">{</span><span class="n">I_trapezno_boljši</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Točen rezultat:   1.4404224209802097
Boljši približek: 1.4408392930139313
</pre></div>
</div>
</div>
</div>
</section>
<section id="numpy-implementacija-sestavljenega-trapeznega-pravila">
<h3><code class="docutils literal notranslate"><span class="pre">numpy</span></code> implementacija sestavljenega trapeznega pravila<a class="headerlink" href="#numpy-implementacija-sestavljenega-trapeznega-pravila" title="Permalink to this headline">#</a></h3>
<p>Sestavljeno trapezno pravilo je implementirano tudi v paketu <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, s funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.trapz</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> predstavlja tabelo funkcijskih vrednosti,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> je opcijski parameter in definira vozlišča; če parameter ni definiran, se privzame ekvidistančna vozlišča na razdalji <code class="docutils literal notranslate"><span class="pre">dx</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code> definira (konstanten) korak integracije, ima privzeto vrednost 1,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> definira <em>os</em> po kateri se integrira (v primeru, da je <code class="docutils literal notranslate"><span class="pre">y</span></code> večdimenzijsko numerično polje).</p></li>
</ul>
<p>Funkcija vrne izračunani integral po sestavljenem trapeznem pravilu. Več informacij lahko najdete v <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.trapz.html">dokumentaciji</a>.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">I_trapezno_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y3v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h3v</span><span class="p">)</span>
<span class="n">I_trapezno_np</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_67_0.png" src="../_images/Predavanje 11 - Numerično integriranje_67_0.png" />
</div>
</div>
</section>
</section>
<section id="simpsonova-in-druge-metode">
<h2>Simpsonova in druge metode<a class="headerlink" href="#simpsonova-in-druge-metode" title="Permalink to this headline">#</a></h2>
<p>Zgoraj smo si pogledali trapezno pravilo, ki temelji na linearni interpolacijski funkciji na posameznem podintervalu. Z interpolacijo višjega reda lahko izpeljemo še druge integracijske metode.</p>
<p>Izračunati moramo:
$<span class="math notranslate nohighlight">\(\int_{a}^b f(x)\,dx.\)</span>$</p>
<p>Tabeliramo podintegralsko funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span> in tabelo interpoliramo z Lagrangevim interpolacijskim polinomom <span class="math notranslate nohighlight">\(P_n(x)\)</span> stopnje <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="math notranslate nohighlight">
\[P_n(x)=\sum_{i=0}^{n}\,f(x_i)\,l_i(x),\]</div>
<p>kjer so <span class="math notranslate nohighlight">\(y_i=f(x_i)\)</span> funkcijske vrednosti v vozliščih <span class="math notranslate nohighlight">\(x_i\)</span> in je Lagrangev polinom <span class="math notranslate nohighlight">\(l_i\)</span> definiran kot:</p>
<div class="math notranslate nohighlight">
\[l_i(x)=\prod_{j=0, j\ne i}^n \frac{x-x_j}{x_i-x_j}.\]</div>
<p>Za numerični izračun integrala <span class="math notranslate nohighlight">\(\int_{a}^b f(x)\,dx\)</span> (meje so: <span class="math notranslate nohighlight">\(a=x_0\)</span>, <span class="math notranslate nohighlight">\(b=x_n\)</span>) namesto funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> vstavimo v integral interpolacijski polinom <span class="math notranslate nohighlight">\(P_n(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[I=\int_{x_0}^{x_{n}} P_n(x)\,dx=\int_{x_0}^{x_{n}} \sum_{i=0}^{n}\,f(x_i)\,l_i(x)\,dx.\]</div>
<p>Ker je integriranje linearna operacija, lahko zamenjamo integriranje in vsoto:</p>
<div class="math notranslate nohighlight">
\[I=\sum_{i=0}^{n}\,f(x_i)\,\underbrace{\int_{x_0}^{x_{n}} l_i(x)\,dx}_{A_i}.\]</div>
<p>Lagrangev polinom integriramo in dobimo uteži <span class="math notranslate nohighlight">\(A_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[A_i = \int_{x_0}^{x_{n}} l_i(x)\,dx\]</div>
<section id="izpeljava-trapeznega-pravila-z-uporabo-lagrangevih-polinomov">
<h3>Izpeljava trapeznega pravila z uporabo Lagrangevih polinomov<a class="headerlink" href="#izpeljava-trapeznega-pravila-z-uporabo-lagrangevih-polinomov" title="Permalink to this headline">#</a></h3>
<p>Poglejmo si kako z Lagrangevim interpolacijskim polinomom prve stopnje strojno izpeljemo uteži <span class="math notranslate nohighlight">\(A_i\)</span> v primeru trapeznega pravila.</p>
<p>Najprej v simbolni obliki definirajmo spremenljivko <code class="docutils literal notranslate"><span class="pre">x</span></code>, vozlišči <code class="docutils literal notranslate"><span class="pre">x0</span></code> in <code class="docutils literal notranslate"><span class="pre">x1</span></code> ter korak <code class="docutils literal notranslate"><span class="pre">h</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x x0, x1, h&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo Python funkcijo, ki v simbolni obliki vrne seznam <span class="math notranslate nohighlight">\(n\)</span> koeficientov Lagrangevih polinomov <span class="math notranslate nohighlight">\([l_0(x), l_1(x),\dots, l_{n-1}(x)]\)</span> stopnje <span class="math notranslate nohighlight">\(n-1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lagrange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">vozlišča_predpona</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vozlišča_predpona</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">vozlišča</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">vozlišča_predpona</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">numer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span>    <span class="o">-</span> <span class="n">vozlišča</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">denom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vozlišča</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">vozlišča</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        
        <span class="n">numer</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">numer</span><span class="p">)</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">denom</span><span class="p">)</span>

        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numer</span><span class="o">/</span><span class="n">denom</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeffs</span>    
</pre></div>
</div>
</div>
</div>
<p>Najprej poglejmo Lagrangeva polinoma za linearno interpolacijo (<span class="math notranslate nohighlight">\(n=2\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lag</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">lag</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_80_0.png" src="../_images/Predavanje 11 - Numerično integriranje_80_0.png" />
</div>
</div>
<p>Sedaj Lagrangev polinom <span class="math notranslate nohighlight">\(l_0(x)\)</span> integriramo čez celotni interval:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">lag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span>
<span class="n">int0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_82_0.png" src="../_images/Predavanje 11 - Numerično integriranje_82_0.png" />
</div>
</div>
<p>Izraz poenostavimo in dobimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int1</span> <span class="o">=</span> <span class="n">int0</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="n">int1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_84_0.png" src="../_images/Predavanje 11 - Numerično integriranje_84_0.png" />
</div>
</div>
<p>Ker je širina podintervala konstantna je <span class="math notranslate nohighlight">\(x_1=h_0+h\)</span>, izvedemo zamenjavo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">}</span>
<span class="n">int1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_86_0.png" src="../_images/Predavanje 11 - Numerično integriranje_86_0.png" />
</div>
</div>
<p>Zgornje korake za Lagrangev polinom  <span class="math notranslate nohighlight">\(l_0(x)\)</span> lahko posplošimo za seznam Lagrangevih polinomov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_trapez</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>  <span class="c1"># za vsak lagrangev polimom `li` v seznamu lagrange(2,x)</span>
<span class="n">A_trapez</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_88_0.png" src="../_images/Predavanje 11 - Numerično integriranje_88_0.png" />
</div>
</div>
<p>Izpeljali smo uteži, ki smo jih uporabili pri trapezni metodi:</p>
<div class="math notranslate nohighlight">
\[A_0=h/2\qquad A_1=h/2.\]</div>
<p>Trapezno pravilo je:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{trapezno}}=\frac{h}{2}\left(y_0+y_1\right)\]</div>
<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):
$<span class="math notranslate nohighlight">\(E_{\textrm{trapezno}}= -\frac{h^3}{12}f''(\xi).\)</span>$</p>
</section>
<section id="izracun-utezi-za-simpsonovo-pravilo">
<h3>Izračun uteži za Simpsonovo pravilo<a class="headerlink" href="#izracun-utezi-za-simpsonovo-pravilo" title="Permalink to this headline">#</a></h3>
<p>Potem ko smo zgoraj pokazali strnjen izračun za trapezno pravilo, lahko podobno izvedemo za kvadratno interpolacijo čez tri točke (<span class="math notranslate nohighlight">\(n=3\)</span>).</p>
<p>Izračun uteži je analogen zgornjemu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, x2, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_Simpson1_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> 
             <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
<span class="n">A_Simpson1_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_93_0.png" src="../_images/Predavanje 11 - Numerično integriranje_93_0.png" />
</div>
</div>
<p>Simpsonovo pravilo (to pravilo se imenuje tudi Simpsonovo 1/3 pravilo) je:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{Simpsonovo}}=\frac{h}{3}\left(y_0+4\,y_1+y_2\right)\]</div>
<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):
$<span class="math notranslate nohighlight">\(E_{\textrm{Simpsonovo}}= -\frac{h^5}{90}f^{(4)}(\xi).\)</span>$</p>
<p>Pri tem je treba izpostaviti, da je napaka lokalno 5 reda  <span class="math notranslate nohighlight">\(\mathcal{O}(h^5)\)</span> in definirana z neznano vrednostjo četrtega odvoda <span class="math notranslate nohighlight">\(f^{(4)}(\xi)\)</span>, posledično je to pravilo točno za polinome stopnje 3 ali manj.</p>
<p>Primer uporabe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps</span> <span class="o">=</span> <span class="n">h3v</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y3v</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">I_Simps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_96_0.png" src="../_images/Predavanje 11 - Numerično integriranje_96_0.png" />
</div>
</div>
<p>Pripravimo sliko. Ker Simsonovo pravilo temelji na kvadratni interpolaciji, moramo naprej pripraviti interpolacijski polinom (pomagamo si s <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm</span><span class="si">{Simpsonovo}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_Simpsonovo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_101_0.png" src="../_images/Predavanje 11 - Numerično integriranje_101_0.png" />
</div>
</div>
</section>
<section id="scipy-integrate-newton-cotes">
<h3><code class="docutils literal notranslate"><span class="pre">scipy.integrate.newton_cotes</span></code><a class="headerlink" href="#scipy-integrate-newton-cotes" title="Permalink to this headline">#</a></h3>
<p>Koeficiente integracijskega pristopa Newton-Cotes pridobimo tudi s pomočjo <code class="docutils literal notranslate"><span class="pre">scipy.integrate.newton_cotes()</span></code> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.newton_cotes.html#scipy.integrate.newton_cotes">dokumentacija</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newton_cotes</span><span class="p">(</span><span class="n">rn</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer sta parametra:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rn</span></code>, ki definira število podintervalov (mogoč je tudi nekonstanten korak, glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.newton_cotes.html#scipy.integrate.newton_cotes">dokumentacijo</a>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">equal</span></code>, ki definira ali se zahteva konstantno široke podintervale.</p></li>
</ul>
<p>Funkcija vrne terko, pri čemer prvi element predstavlja numerično polje uteži in drugi člen oceno napake.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="n">integrate</span><span class="o">.</span><span class="n">newton_cotes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0.33333333, 1.33333333, 0.33333333]), -0.011111111111111112)
</pre></div>
</div>
</div>
</div>
</section>
<section id="izracun-utezi-za-simpsonovo-3-8-pravilo">
<h3>Izračun uteži za Simpsonovo 3/8 pravilo<a class="headerlink" href="#izracun-utezi-za-simpsonovo-3-8-pravilo" title="Permalink to this headline">#</a></h3>
<p>Nadaljujemo lahko s kubično interpolacijo čez štiri točke (<span class="math notranslate nohighlight">\(n=4\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, x2, x3, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">x3</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_Simpson3_8</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x3</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> 
                <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
<span class="n">A_Simpson3_8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_107_0.png" src="../_images/Predavanje 11 - Numerično integriranje_107_0.png" />
</div>
</div>
<p>Simpsonovo 3/8 pravilo je:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{Simpsonovo 3/8}}=\frac{3h}{8}\left(y_0+3\,y_1+3\,y_2+y_3\right)\]</div>
<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):
$<span class="math notranslate nohighlight">\(E_{\textrm{Simpsonovo 3/8}}= -\frac{3\,h^5}{80}f^{(4)}(\xi).\)</span>$</p>
<p>Poglejmo si primer uporabe. Uporabimo pripravljeno tabelo vrednosti funkcije v štirih točkah:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y4v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.84147098, 1.2959172 , 1.65901326, 1.81859485])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps38</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">h4v</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y4v</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">I_Simps38</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_111_0.png" src="../_images/Predavanje 11 - Numerično integriranje_111_0.png" />
</div>
</div>
<p>Pripravimo še prikaz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo38</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="n">y4v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y4v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{Simpsonovo 3/8}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.47</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="n">y4v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h4v</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_Simpsonovo38</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_115_0.png" src="../_images/Predavanje 11 - Numerično integriranje_115_0.png" />
</div>
</div>
</section>
</section>
<section id="sestavljeno-simpsonovo-pravilo">
<h2>Sestavljeno Simpsonovo pravilo<a class="headerlink" href="#sestavljeno-simpsonovo-pravilo" title="Permalink to this headline">#</a></h2>
<p>Interval <span class="math notranslate nohighlight">\([a, b]\)</span> razdelimo na sodo število <span class="math notranslate nohighlight">\(n\)</span> podintervalov enake širine <span class="math notranslate nohighlight">\(h=(b - a)/n\)</span>, s čimer so definirana vozlišča <span class="math notranslate nohighlight">\(x_i=a+i\,h\)</span> za <span class="math notranslate nohighlight">\(i=0,1,\dots,n\)</span>. V tem primeru zapišemo sestavljeno Simpsonovo pravilo:</p>
<div class="math notranslate nohighlight">
\[\int_{a}^{b}f(x)\,\textrm{d}x=
\frac{h}{3}\left(
f(x_0)
+4\sum_{i=1}^{n/2}f(x_{2i-1})
+2\sum_{i=1}^{n/2-1}f(x_{2i})
+f(x_n)
\right)
\underbrace{
-\frac{b-a}{180}h^4\,f^{(4)}(\eta)
}_{E_{\textrm{Sestavljeno Simpsonovo 1/3}}}
,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\eta\)</span> neznana vrednost na intervalu <span class="math notranslate nohighlight">\([a, b]\)</span>. Napaka je četrtega reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^4)\)</span>.</p>
<p>Numerična implementacija:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simpsonovo_sest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sestavljeno Simpsonovo pravilo integriranja.</span>

<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">h</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps_sest</span> <span class="o">=</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y5v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h5v</span><span class="p">)</span>
<span class="n">I_Simps_sest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_121_0.png" src="../_images/Predavanje 11 - Numerično integriranje_121_0.png" />
</div>
</div>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo_sest</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="n">y5v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>       
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y5v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{Simpsonovo sestavljeno}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.70</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="n">y5v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h5v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_Simpsonovo_sest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_125_0.png" src="../_images/Predavanje 11 - Numerično integriranje_125_0.png" />
</div>
</div>
<section id="boljsa-ocena-integrala">
<h3>Boljša ocena integrala<a class="headerlink" href="#boljsa-ocena-integrala" title="Permalink to this headline">#</a></h3>
<p>Napaka sestavljene Simpsonove metode je definirana z:
$<span class="math notranslate nohighlight">\(E_{\textrm{Sestavljeno Simpsonovo 1/3}}= 
-\frac{b-a}{180}h^4\,f^{(4)}(\eta),\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>\eta<span class="math notranslate nohighlight">\( neznana vrednost na intervalu \)</span>[a, b]$.</p>
<p>Izboljšano oceno integrala določimo na podoben način kakor pri sestavljeni trapezni metodi; integral <span class="math notranslate nohighlight">\(I\)</span> ocenjujemo pri dveh različnih korakih <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2\,h\)</span>, velja natančno:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,\textrm{d}x = I_h + E_h = I_{2h} + E_{2h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(I_h\)</span> približek integrala s korakom <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(E_h\)</span> ocena napake pri koraku <span class="math notranslate nohighlight">\(h\)</span>; analogno velja za <span class="math notranslate nohighlight">\(I_{2h}\)</span> in <span class="math notranslate nohighlight">\(E_{2h}\)</span>.</p>
<p>Če predpostavimo, da je <span class="math notranslate nohighlight">\(f^{(4)}\left (\eta \right )\)</span> v obeh primerih enak, lahko določimo razliko <span class="math notranslate nohighlight">\(I_{2h}-I_{h} = E_{h}-E_{2h}\)</span>.</p>
<p>Naprej zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_h=-\frac{b-a}{180}h^4\,f^{(4)}(\eta)=h^4\,K.\]</div>
<p>Ob predpostavki, da je <span class="math notranslate nohighlight">\(f^{(4)}\left (\eta \right )\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> enak (<span class="math notranslate nohighlight">\(\eta\)</span> je pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> dejansko različen), zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_{2h}=-\frac{(b-a)}{180}(2h)^4\,f^{(4)}(\eta)=16\,h^4\,K\]</div>
<p>Sledi:</p>
<div class="math notranslate nohighlight">
\[I_{2h}-I_h=-15K\,h^4.\]</div>
<p>Sedaj lahko ocenimo napako pri koraku <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_h=h^4\,K=\frac{I_h-I_{2h}}{15}.\]</div>
<p>Na podlagi ocene napake lahko izračunamo boljši približek  <span class="math notranslate nohighlight">\(I_{h}^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[I_h^* = I_h + \frac{1}{15}\,(I_{h}-I_{2h})\]</div>
<p>ali</p>
<div class="math notranslate nohighlight">
\[I_h^* = \frac{16}{15}\,I_h - \frac{1}{15}\,I_{2h}\]</div>
</section>
<section id="id4">
<h3>Numerični zgled<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>Predhodno smo s Simpsonovim pravilom že izračunali integral pri koraku <span class="math notranslate nohighlight">\(h=0,5\)</span> in pri koraku <span class="math notranslate nohighlight">\(h=0,25\)</span>, rezultata sta bila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">I_Simps</span><span class="p">,</span> <span class="n">I_Simps_sest</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_135_0.png" src="../_images/Predavanje 11 - Numerično integriranje_135_0.png" />
</div>
</div>
<p>S pomočjo zgornje formule izračunamo boljši približek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps_boljši</span> <span class="o">=</span> <span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">I_Simps_sest</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">I_Simps</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Točen rezultat:   </span><span class="si">{</span><span class="n">I_točno</span><span class="si">}</span><span class="se">\n</span><span class="s1">Boljši približek: </span><span class="si">{</span><span class="n">I_Simps_boljši</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Točen rezultat:   1.4404224209802097
Boljši približek: 1.4404218714139077
</pre></div>
</div>
</div>
</div>
<p>Pridobimo boljši numerični približek, izgubimo pa oceno napake!</p>
</section>
<section id="simpsonova-metoda-v-scipy-integrate-simps">
<h3>Simpsonova metoda v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.simps</span></code><a class="headerlink" href="#simpsonova-metoda-v-scipy-integrate-simps" title="Permalink to this headline">#</a></h3>
<p>V <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je implementirano sestavljeno Simpsonovo pravilo v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.simps()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.simps.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="s1">&#39;avg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> tabela funkcijskih vrednosti, ki jih integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> vozlišča, gre za opcijski parameter, če je <code class="docutils literal notranslate"><span class="pre">x=None</span></code>, se predpostavi ekvidistantne podintervale širine <code class="docutils literal notranslate"><span class="pre">dx</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code> širina ekvidistantnih podintervalov oz korak integriranja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> os integriranja (pomembno v primeru večdimenzijskega numeričnega polja)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">even</span></code> je lahko {<code class="docutils literal notranslate"><span class="pre">'avg'</span></code>, <code class="docutils literal notranslate"><span class="pre">'first'</span></code>, <code class="docutils literal notranslate"><span class="pre">'last'</span></code>} in definira način integriranja v primeru lihega števila podintervalov.</p></li>
</ul>
<p>Poglejmo si primer, najprej uvozimo funkcijo <code class="docutils literal notranslate"><span class="pre">simps</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">simps</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">simps</span><span class="p">(</span><span class="n">y5v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h5v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_143_0.png" src="../_images/Predavanje 11 - Numerično integriranje_143_0.png" />
</div>
</div>
</section>
</section>
<section id="rombergova-metoda">
<h2>Rombergova metoda*<a class="headerlink" href="#rombergova-metoda" title="Permalink to this headline">#</a></h2>
<p>Rombergova metoda temelji na Richardsonovi ekstrapolaciji. Predpostavimo, da integral <span class="math notranslate nohighlight">\(\int_a^b f(x)\textrm{d}x\)</span> integriramo na intervalu <span class="math notranslate nohighlight">\([a,b]\)</span>, ki ga razdelimo na <span class="math notranslate nohighlight">\(2^{n-1}\)</span> podintervalov (<span class="math notranslate nohighlight">\(n=1,2,4,8, \dots\)</span>).</p>
<p>Rezultat trapeznega pravila pri <span class="math notranslate nohighlight">\(n=1\)</span> označimo z <span class="math notranslate nohighlight">\(R_{\underbrace{1}_{n},\underbrace{1}_{j}}\)</span>, pri čemer <span class="math notranslate nohighlight">\(j\)</span> označuje natančnost pridobljenega rezultata <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2j})\)</span>.</p>
<p>Če uporabimo trapezno integracijsko pravilo pri <span class="math notranslate nohighlight">\(n=1,2,4 \dots\)</span> podintervalih, izračunamo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{1,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_1=h\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_1^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{2,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_2=h/2\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_2^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{3,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_3=h/4\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_3^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{4,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_4=h/8\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_4^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\dots\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{n,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_4=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^2)\)</span>.</p></li>
</ul>
<p>Na podlagi Richardsonove ekstrapolacije izračunamo boljši približek</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{2,2} = R_{2,1} + \frac{1}{3}\left(R_{2,1}-R_{1,1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_2=h/2\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_2^4)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{3,2} = R_{3,1} + \frac{1}{3}\left(R_{3,1}-R_{2,1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_3=h/4\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_3^4)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\dots\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{n,2} = R_{n,1} + \frac{1}{3}\left(R_{n,1}-R_{n-1,1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_n=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^4)\)</span>.</p></li>
</ul>
<p>Nato nadaljujemo z Richardsonovo ekstrapolacijo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{3,3} = R_{3,2} + \frac{1}{15}\left(R_{3,2}-R_{2,2}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_3=h/4\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_3^6)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\dots\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{n,3} = R_{n,2} + \frac{1}{15}\left(R_{n,2}-R_{n-1,2}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_n=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^6)\)</span>.</p></li>
</ul>
<p>Richardsonovo extrapolacijo lahko posplošimo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{n,j} = R_{n,j-1} + \frac{1}{4^{j-1}-1}\left(R_{n,j-1}-R_{n-1,j-1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_n=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^{2j})\)</span></p></li>
</ul>
<p>Pri tem je boljši približek <span class="math notranslate nohighlight">\(R_{2,2}\)</span> pri koraku <span class="math notranslate nohighlight">\(h/2\)</span> enak rezultatu, ki ga dobimo po Simpsonovi metodi pri koraku <span class="math notranslate nohighlight">\(h/2\)</span>. Podobno je boljši približek <span class="math notranslate nohighlight">\(R_{3,2}\)</span> pri koraku <span class="math notranslate nohighlight">\(h/4\)</span> enak numeričnemu integralu Simpsonove metode pri koraku <span class="math notranslate nohighlight">\(h/4\)</span>. In je dalje <span class="math notranslate nohighlight">\(R_{3,3}\)</span> enak popravljenemu približku Simpsonove metode pri koraku <span class="math notranslate nohighlight">\(h/4\)</span>.</p>
<p>Pripravimo numerične podatke:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x9v</span><span class="p">,</span> <span class="n">h9v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h9v = 0.125 (9 vozlišč)</span>
<span class="n">y9v</span> <span class="o">=</span> <span class="n">x9v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x9v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si primer od zgoraj. Najprej s sestavljeno trapezno metodo izračunamo integral pri različnih korakih (drugi red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h^2)</span>
<span class="n">R1_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">8</span><span class="p">],</span> <span class="mi">8</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=1.0</span>
<span class="n">R2_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.5</span>
<span class="n">R3_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.25</span>
<span class="n">R4_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.125</span>
<span class="p">[</span><span class="n">R1_1</span><span class="p">,</span> <span class="n">R2_1</span><span class="p">,</span> <span class="n">R3_1</span><span class="p">,</span> <span class="n">R4_1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_154_0.png" src="../_images/Predavanje 11 - Numerično integriranje_154_0.png" />
</div>
</div>
<p>Nato izračunamo boljše približke (dobimo četrti red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h^4)</span>
<span class="n">R2_2</span> <span class="o">=</span> <span class="n">R2_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R2_1</span> <span class="o">-</span> <span class="n">R1_1</span><span class="p">)</span>
<span class="n">R3_2</span> <span class="o">=</span> <span class="n">R3_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R3_1</span> <span class="o">-</span> <span class="n">R2_1</span><span class="p">)</span>
<span class="n">R4_2</span> <span class="o">=</span> <span class="n">R4_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_1</span> <span class="o">-</span> <span class="n">R3_1</span><span class="p">)</span>
<span class="p">[</span><span class="n">R2_2</span><span class="p">,</span> <span class="n">R3_2</span><span class="p">,</span> <span class="n">R4_2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_156_0.png" src="../_images/Predavanje 11 - Numerično integriranje_156_0.png" />
</div>
</div>
<p>Rezultati predstavljajo rezultat Simpsonove metode pri koraku <span class="math notranslate nohighlight">\(h=0,5\)</span>, <span class="math notranslate nohighlight">\(h=0,25\)</span> in <span class="math notranslate nohighlight">\(h=0.125\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_158_0.png" src="../_images/Predavanje 11 - Numerično integriranje_158_0.png" />
</div>
</div>
<p>Ponovno izračunamo boljše približke (dobimo šesti red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h6)</span>
<span class="n">R3_3</span> <span class="o">=</span> <span class="n">R3_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">R3_2</span> <span class="o">-</span> <span class="n">R2_2</span><span class="p">)</span>
<span class="n">R4_3</span> <span class="o">=</span> <span class="n">R4_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_2</span> <span class="o">-</span> <span class="n">R3_2</span><span class="p">)</span>

<span class="p">[</span><span class="n">R3_3</span><span class="p">,</span> <span class="n">R4_3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_160_0.png" src="../_images/Predavanje 11 - Numerično integriranje_160_0.png" />
</div>
</div>
<p>Rezultat predstavlja boljši rezultat Simpsonove pri koraku <span class="math notranslate nohighlight">\(h=0,25\)</span> in <span class="math notranslate nohighlight">\(h=0.125\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a4h</span><span class="p">,</span> <span class="n">a2h</span><span class="p">,</span> <span class="n">ah</span> <span class="o">=</span> <span class="p">[</span><span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a2h</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a4h</span><span class="p">,</span> <span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">ah</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a2h</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_162_0.png" src="../_images/Predavanje 11 - Numerično integriranje_162_0.png" />
</div>
</div>
<p>Ponovno izračunamo boljše približke (dobimo osmi red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h8)</span>
<span class="n">R4_4</span> <span class="o">=</span> <span class="n">R4_3</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">63</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_3</span> <span class="o">-</span> <span class="n">R3_3</span><span class="p">)</span>
<span class="n">R4_4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_164_0.png" src="../_images/Predavanje 11 - Numerično integriranje_164_0.png" />
</div>
</div>
<p>Rombergova metoda nam torej ponuja visoko natančnost rezultata za relativno majhno numerično ceno. Napako pa ocenimo:</p>
<div class="math notranslate nohighlight">
\[E = \left|R_{n,n}-R_{n-1,n-1}\right|.\]</div>
<section id="rombergova-metoda-v-scipy-integrate-romb">
<h3>Rombergova metoda v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.romb</span></code><a class="headerlink" href="#rombergova-metoda-v-scipy-integrate-romb" title="Permalink to this headline">#</a></h3>
<p>V <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je implementirana Rombergova metoda v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.romb()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.romb.html#scipy.integrate.romb">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">romb</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> tabela funkcijskih vrednosti, ki jih integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code> širina ekvidistantnih podintervalov oz korak integriranja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> or integriranja (pomembno v primeru večdimenzijskega numeričnega polja),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show</span></code> če je <code class="docutils literal notranslate"><span class="pre">True</span></code> prikaže elemente Richardsonove ekstrapolacije.</p></li>
</ul>
<p>Poglejmo si primer od zgoraj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">romb</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y9v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.84147098, 1.01505104, 1.18623077, 1.34872795, 1.49624248,
       1.62261343, 1.72197541, 1.78891084, 1.81859485])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">romb</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h9v</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Richardson Extrapolation Table for Romberg Integration       
====================================================================
 1.33003 
 1.41314  1.44084 
 1.43362  1.44045  1.44042 
 1.43872  1.44042  1.44042  1.44042 
====================================================================
</pre></div>
</div>
<img alt="../_images/Predavanje 11 - Numerično integriranje_171_1.png" src="../_images/Predavanje 11 - Numerično integriranje_171_1.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="gaussov-integracijski-pristop">
<h1>Gaussov integracijski pristop<a class="headerlink" href="#gaussov-integracijski-pristop" title="Permalink to this headline">#</a></h1>
<p>Newton-Cotesov pristop temelji na polinomu <span class="math notranslate nohighlight">\(n\)</span>-te stopnje in napaka je <span class="math notranslate nohighlight">\(n+1\)</span> stopnje. To pomeni, da integracija daje točen rezultat, če je integrirana funkcija polinom stopnje <span class="math notranslate nohighlight">\(n\)</span> ali manj.</p>
<p>Gaussov integracijski pristop je v principu drugačen: cilj je integral funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> nadomestiti z uteženo vsoto vrednosti funkcije pri diskretnih vrednostih <span class="math notranslate nohighlight">\(f(x_i)\)</span>:
$<span class="math notranslate nohighlight">\(\int_a^bf(x)\,\textrm{d}x\approx \sum_{i=0}^{n-1} w_i\, f(x_i).\)</span><span class="math notranslate nohighlight">\(
Pri tem je neznana utež \)</span>w_i<span class="math notranslate nohighlight">\( in tudi lega vozlišča \)</span>x_i<span class="math notranslate nohighlight">\(. Za stopnje polinoma \)</span>n<span class="math notranslate nohighlight">\( bomo potrebovali tudi več  točk \)</span>(x_i, f(x_i))$.</p>
<p>V nadaljevanju bomo spoznali, da lahko zelo učinkovito izračunamo numerično točen integral. Prednost Gaussove integracije je tudi, da lahko izračuna integral funkcij s singularnostmi (npr: <span class="math notranslate nohighlight">\(\int_0^1\sin(x)/\sqrt{(x)}\,dx\)</span>).</p>
<section id="gaussova-kvadratura-z-enim-vozliscem">
<h2>Gaussova kvadratura z enim vozliščem<a class="headerlink" href="#gaussova-kvadratura-z-enim-vozliscem" title="Permalink to this headline">#</a></h2>
<p>Predpostavimo, da želimo integrirati polinom stopnje <span class="math notranslate nohighlight">\(n=1\)</span> (linearna funkcija):</p>
<div class="math notranslate nohighlight">
\[f(x)=P_1(x)=A_0+A_1\,x.\]</div>
<p>Izračunajmo:</p>
<div class="math notranslate nohighlight">
\[\int_a^bP_1(x)\,\textrm{d}x=\left(A_0\,x+A_1\,\frac{x^2}{2}\right)_a^b=-A_0\,a+A_0\,b-\frac{A_1\,a^2}{2}+\frac{A_1\,b^2}{2}.\]</div>
<p>Po drugi strani pa želimo integral izračunati glede na ustrezno uteženo <span class="math notranslate nohighlight">\(w_0\)</span> vrednost funkcije <span class="math notranslate nohighlight">\(f(x_0)\)</span> v neznanem vozlišču <span class="math notranslate nohighlight">\(x_0\)</span> (samo eno vozlišče!):</p>
<div class="math notranslate nohighlight">
\[\int_a^bP_1(x)\,\textrm{d}x = w_0\,P_1(x_0)= w_0\,A_0+w_0\,A_1\,x_0.\]</div>
<p>Z enačenjem zgornjih izrazov izpeljemo:</p>
<div class="math notranslate nohighlight">
\[-A_0\,a+A_0\,b-\frac{A_1\,a^2}{2}+\frac{A_1\,b^2}{2}=w_0\,A_0+w_0\,A_1\,x_0.\]</div>
<p><span class="math notranslate nohighlight">\(A_0\)</span> in <span class="math notranslate nohighlight">\(A_1\)</span> sta koeficienta linearne funkcije, ki lahko zavzame poljubne vrednosti, zato velja:</p>
<div class="math notranslate nohighlight">
\[A_0\,\left(-a+b-w_0\right)=0\qquad\textrm{in}\qquad A_1\left(-\frac{a^2}{2}+\frac{b^2}{2}-w_0\,x_0\right)=0.\]</div>
<p>Gre za sistem linearnih enačb z rešitvijo:</p>
<div class="math notranslate nohighlight">
\[w_0= b-a, \qquad x_0=\frac{b+a}{2}.\]</div>
<p>Če je integrirana funkcija linearna, bomo samo na podlagi vrednosti v eni točki izračunali pravo vrednost!</p>
<p>Da je Gaussov integracijski pristop neodvisen od mej integriranja <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, pa uvedemo standardne meje.</p>
<section id="standardne-meje-a-1-in-b-1">
<h3>Standardne meje: <span class="math notranslate nohighlight">\(a=-1\)</span> in <span class="math notranslate nohighlight">\(b=1\)</span><a class="headerlink" href="#standardne-meje-a-1-in-b-1" title="Permalink to this headline">#</a></h3>
<p>Zaradi splošnosti meje <span class="math notranslate nohighlight">\(x\in[a,b]\)</span> transformiramo v <span class="math notranslate nohighlight">\(\xi\in[-1, +1]\)</span> s pomočjo:</p>
<div class="math notranslate nohighlight">
\[x=\frac{b+a}{2}+\frac{b-a}{2}\xi\]</div>
<p>in
$<span class="math notranslate nohighlight">\(\textrm{d}x=\frac{b-a}{2}\textrm{d}\xi.\)</span>$</p>
<p>Velja:</p>
<div class="math notranslate nohighlight">
\[\int_a^bf(x)\,\textrm{d}x=\int_{-1}^1 g\left(\xi\right)\,\textrm{d}\xi,\]</div>
<p>kjer je:</p>
<div class="math notranslate nohighlight">
\[g(\xi)=\frac{b-a}{2}\,f\left(\frac{b+a}{2}+\frac{b-a}{2}\xi\right).\]</div>
<p>V primeru standardnih mej je pri eni Gaussovi točki utež <span class="math notranslate nohighlight">\(w_0=2\)</span> in <span class="math notranslate nohighlight">\(x_0=0\)</span> vrednost, pri kateri moramo izračunati funkcijo <span class="math notranslate nohighlight">\(f(x_0)\)</span>.</p>
</section>
<section id="strojno-izpeljevanje-utezi-in-gaussove-tocke">
<h3>Strojno izpeljevanje uteži in Gaussove točke<a class="headerlink" href="#strojno-izpeljevanje-utezi-in-gaussove-tocke" title="Permalink to this headline">#</a></h3>
<p>Definirajmo simbole in nastavimo enačbo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A0</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;A0, A1, x, a, b, w0, x0&#39;</span><span class="p">)</span> <span class="c1"># simboli</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">A0</span> <span class="o">+</span> <span class="n">A1</span><span class="o">*</span><span class="n">x</span>                                                   <span class="c1"># linearni polinom</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">integrate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span> <span class="n">w0</span><span class="o">*</span><span class="n">P1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">))</span> <span class="c1"># teoretični integral = ocen z utežmi</span>
<span class="n">eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_189_0.png" src="../_images/Predavanje 11 - Numerično integriranje_189_0.png" />
</div>
</div>
<p>Pripravimo dve enačbi (za prvo predpostavimo <span class="math notranslate nohighlight">\(A_0=0, A_1=1\)</span>, za drugo predpostavimo <span class="math notranslate nohighlight">\(A_0=1, A_1=0\)</span>) ter rešimo sistem za <code class="docutils literal notranslate"><span class="pre">w0</span></code> in <code class="docutils literal notranslate"><span class="pre">x0</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">w0</span><span class="p">,</span> <span class="n">x0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_191_0.png" src="../_images/Predavanje 11 - Numerično integriranje_191_0.png" />
</div>
</div>
<p>Za dodatno razlago priporočam <a class="reference external" href="https://www.youtube.com/watch?v=iQ5-4hx25Rw">video posnetek</a>.</p>
</section>
</section>
<section id="gaussova-integracijska-metoda-z-vec-vozlisci">
<h2>Gaussova integracijska metoda z več vozlišči<a class="headerlink" href="#gaussova-integracijska-metoda-z-vec-vozlisci" title="Permalink to this headline">#</a></h2>
<p>Izpeljati želimo Gaussovo integracijsko metodo, ki bo upoštevala na intervalu <span class="math notranslate nohighlight">\([a,b]\)</span> <span class="math notranslate nohighlight">\(v\)</span> vozlišč in bo točno izračunala integral polinomov do stopnje <span class="math notranslate nohighlight">\(n=2v-1\)</span>. Veljati mora:</p>
<div class="math notranslate nohighlight">
\[\int_a^bP_{2v-1}(x)\,\textrm{d}x = \sum_{i=0}^{v-1} w_i\,P_{2v-1}(x_i).\]</div>
<p>Pri izpeljavi se bomo omejili na standardne meje <span class="math notranslate nohighlight">\(a=-1\)</span>, <span class="math notranslate nohighlight">\(b=1\)</span>,</p>
<p>kjer je polinom stopnje <span class="math notranslate nohighlight">\(n=2v-1\)</span> definiran kot:
$<span class="math notranslate nohighlight">\(P_{2v-1}(x)=\sum_{i=0}^{2v-1} A_i\,x^i.\)</span>$</p>
<p>Z dvema Gaussovima točkama/vozliščema točno izračunamo integral polinoma do tretjega reda, s tremi Gausovimi vozlišči pa točno izračunamo integral polinoma do petega reda!</p>
<section id="strojno-izpeljevanje">
<h3>Strojno izpeljevanje<a class="headerlink" href="#strojno-izpeljevanje" title="Permalink to this headline">#</a></h3>
<p>Pripravimo si najprej simbolni zapis polinoma in ustreznih spremenljivk:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P_etc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>                       <span class="c1"># n je stopnja polinoma</span>
    <span class="n">Ai</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># seznam A_i</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                              <span class="c1"># spremenljivka x</span>
    <span class="k">return</span> <span class="n">Ai</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">Ai</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj pa poiščimo uteži <span class="math notranslate nohighlight">\(w_i\)</span> in vozlišča <span class="math notranslate nohighlight">\(x_i\)</span> za primer dveh Gaussovih vozlišč; polinom je torej tretje stopnje.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># število vozlišč</span>
<span class="n">Ai</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">P_etc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># seznam x_i</span>
<span class="n">wi</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;w:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># seznam w_i</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Vozlišča: </span><span class="si">{</span><span class="n">xi</span><span class="si">}</span><span class="se">\n</span><span class="s1">Uteži:    </span><span class="si">{</span><span class="n">wi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vozlišča: (x0, x1)
Uteži:    (w0, w1)
</pre></div>
</div>
</div>
</div>
<p>Polinom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_202_0.png" src="../_images/Predavanje 11 - Numerično integriranje_202_0.png" />
</div>
</div>
<p>Podobno kakor zgoraj za eno vozlišče, tukaj definirajmo enačbe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">integrate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">A_</span><span class="p">),</span>\
              <span class="nb">sum</span><span class="p">([</span><span class="n">wi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> \
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">A_</span><span class="p">))</span> \
       <span class="k">for</span> <span class="n">A_</span> <span class="ow">in</span> <span class="n">Ai</span><span class="p">]</span>
<span class="n">eqs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_204_0.png" src="../_images/Predavanje 11 - Numerično integriranje_204_0.png" />
</div>
</div>
<p>Rešimo jih za za neznane <span class="math notranslate nohighlight">\(x_i\)</span> in <span class="math notranslate nohighlight">\(w_i\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">flatten</span><span class="p">((</span><span class="n">xi</span><span class="p">,</span> <span class="n">wi</span><span class="p">)))</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_206_0.png" src="../_images/Predavanje 11 - Numerično integriranje_206_0.png" />
</div>
</div>
<p>Določili smo seznam dveh (enakih) rešitev.</p>
<p>Najprej sta definirani vozlišči: <span class="math notranslate nohighlight">\(x_0=-\sqrt{3}/3\)</span> in <span class="math notranslate nohighlight">\(x_1=\sqrt{3}/3\)</span>, katerima pripadata uteži <span class="math notranslate nohighlight">\(w_0=w_1=1\)</span>.</p>
<p>Koda zgoraj je izpeljana v splošnem - število vozlišč <code class="docutils literal notranslate"><span class="pre">v</span></code> lahko povečate ter izračunate vozlišča ter pripadajoče uteži.</p>
<p>Spodaj je podana tabela vozlišč in uteži za eno, dve in tri vozlišča (za meje <span class="math notranslate nohighlight">\(a=-1\)</span>, <span class="math notranslate nohighlight">\(b=1\)</span>):</p>
<p><strong>Število točk 1:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="text-align:center head"><p>Vozlišče  <span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="text-align:center head"><p>Utež <span class="math notranslate nohighlight">\(w_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>2</p></td>
</tr>
</tbody>
</table>
<p><strong>Število točk 2:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="text-align:center head"><p>Vozlišče  <span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="text-align:center head"><p>Utež <span class="math notranslate nohighlight">\(w_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(-\frac{\sqrt{3}}{3}\)</span></p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(+\frac{\sqrt{3}}{3}\)</span></p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
</tbody>
</table>
<p><strong>Število točk 3:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="text-align:center head"><p>Vozlišče  <span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="text-align:center head"><p>Utež <span class="math notranslate nohighlight">\(w_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(-\frac{\sqrt{15}}{5}\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\frac{5}{9}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\frac{8}{9}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\frac{\sqrt{15}}{5}\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\frac{5}{9}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Za več vozlišč in tudi oceno napake, glejte <a class="reference external" href="http://mathworld.wolfram.com/Legendre-GaussQuadrature.html">Mathworld  Legendre-Gauss Quadrature</a>.</p>
<p>Za primer treh Gaussovih točk numerični integral izračunamo (standardne meje):</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{Gauss3}}= \frac{5}{9}\,f\left(-\frac{\sqrt{15}}{5}\right) + \frac{8}{9}\,f\left(0\right)+\frac{5}{9}\,f\left(\frac{\sqrt{15}}{5}\right).\]</div>
</section>
<section id="id5">
<h3>Numerična implementacija<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>Numerična implementacija (vključno s transformacijo mej) za eno, dve ali tri vozlišča:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Gaussova integracijska metoda.</span>

<span class="sd">    :param fun: objekt funkcije, ki jo integriramo</span>
<span class="sd">    :param a:   spodnja meja</span>
<span class="sd">    :param b:   zgornja meja</span>
<span class="sd">    :param vozlišča: število vozlišč (1, 2 ali 3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">xi</span><span class="p">):</span> <span class="c1"># funkcija za transformacijo mej</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fun</span><span class="p">((</span><span class="n">b</span><span class="o">+</span><span class="n">a</span> <span class="o">+</span><span class="n">xi</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>        
    <span class="k">elif</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si zgled. Najprej definirajmo funkcijo, ki jo želimo integrirati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj pa funkcijo (v konkretnem primeru <code class="docutils literal notranslate"><span class="pre">f</span></code>) in ne vrednosti (npr. <code class="docutils literal notranslate"><span class="pre">f(0.)</span></code>) posredujemo funkciji <code class="docutils literal notranslate"><span class="pre">Gaussova</span></code>. Najprej za eno vozlišče, nato dve in tri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_217_0.png" src="../_images/Predavanje 11 - Numerično integriranje_217_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_218_0.png" src="../_images/Predavanje 11 - Numerično integriranje_218_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_219_0.png" src="../_images/Predavanje 11 - Numerično integriranje_219_0.png" />
</div>
</div>
</section>
<section id="scipy-integrate-fixed-quad">
<h3><code class="docutils literal notranslate"><span class="pre">scipy.integrate.fixed_quad</span></code><a class="headerlink" href="#scipy-integrate-fixed-quad" title="Permalink to this headline">#</a></h3>
<p>Znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je Gaussova integracijska metoda implementirana v okviru funkcije <code class="docutils literal notranslate"><span class="pre">scipy.integrate.fixed_quad()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.fixed_quad.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fixed_quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> je ime funkcije, ki jo kličemo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> je spodnja meja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> je zgornja meja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code> je terka morebitnih dodatnih argumentov funkcije <code class="docutils literal notranslate"><span class="pre">func</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> je število vozlišč Gaussove integracije, privzeto <code class="docutils literal notranslate"><span class="pre">n=5</span></code>.</p></li>
</ul>
<p>Funkcija vrne terko z rezultatom integriranja <code class="docutils literal notranslate"><span class="pre">val</span></code> in vrednost <code class="docutils literal notranslate"><span class="pre">None</span></code>: <code class="docutils literal notranslate"><span class="pre">(val,</span> <span class="pre">None)</span></code></p>
<p>Poglejmo primer od zgoraj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">fixed_quad</span>
<span class="n">fixed_quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_222_0.png" src="../_images/Predavanje 11 - Numerično integriranje_222_0.png" />
</div>
</div>
<p>Rezultat je enak predhodnemu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_224_0.png" src="../_images/Predavanje 11 - Numerično integriranje_224_0.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="scipy-integrate">
<h1><code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code><a class="headerlink" href="#scipy-integrate" title="Permalink to this headline">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> je močno orodje za numerično integriranje (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html">dokumentacijo</a>). V nadaljevanju si bomo pogledali nekatere funkcije.</p>
<section id="intergracijske-funkcije-ki-zahtevajo-definicijsko-funkcijo">
<h2>Intergracijske funkcije, ki zahtevajo definicijsko <em>funkcijo</em>:<a class="headerlink" href="#intergracijske-funkcije-ki-zahtevajo-definicijsko-funkcijo" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">quad(func,</span> <span class="pre">a,</span> <span class="pre">b[,</span> <span class="pre">args,</span> <span class="pre">full_output,</span> <span class="pre">...])</span></code>	izračuna določeni integral <code class="docutils literal notranslate"><span class="pre">func(x)</span></code> v mejah [<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>],</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dblquad(func,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">gfun,</span> <span class="pre">hfun[,</span> <span class="pre">args,</span> <span class="pre">...])</span></code>	izračuna določeni integral <code class="docutils literal notranslate"><span class="pre">func(x,y)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tplquad(func,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">gfun,</span> <span class="pre">hfun,</span> <span class="pre">qfun,</span> <span class="pre">rfun)</span></code>	izračuna določeni integral <code class="docutils literal notranslate"><span class="pre">func(x,y,z)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nquad(func,</span> <span class="pre">ranges[,</span> <span class="pre">args,</span> <span class="pre">opts,</span> <span class="pre">full_output])</span></code>	izračuna določeni integral <span class="math notranslate nohighlight">\(n\)</span> dimenzijske funkcije <code class="docutils literal notranslate"><span class="pre">func(</span> <span class="pre">...)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">romberg(function,</span> <span class="pre">a,</span> <span class="pre">b[,</span> <span class="pre">args,</span> <span class="pre">tol,</span> <span class="pre">rtol,</span> <span class="pre">...])</span></code>	integracija Romberg za funkcijo <code class="docutils literal notranslate"><span class="pre">function</span></code>,</p></li>
</ul>
<section id="scipy-integrate-quad">
<h3><code class="docutils literal notranslate"><span class="pre">scipy.integrate.quad</span></code><a class="headerlink" href="#scipy-integrate-quad" title="Permalink to this headline">#</a></h3>
<p>Poglejmo si zelo uporabno funkcijo za integriranje, <code class="docutils literal notranslate"><span class="pre">scipy.integrate.quad()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> 
     <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wopts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxp1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">limlst</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Izbrani parametri so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> Python funkcija, ki jo integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> spodnja meja integriranja (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> zgornja meja integriranja (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full_output</span></code> za prikaz vseh rezultatov, privzeto 0,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsabs</span></code> dovoljena absolutna napaka,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsrel</span></code> dovoljena relativna napaka.</p></li>
</ul>
<p>Poglejmo primer od zgoraj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_230_0.png" src="../_images/Predavanje 11 - Numerično integriranje_230_0.png" />
</div>
</div>
</section>
<section id="scipy-integrate-dblquad">
<h3><code class="docutils literal notranslate"><span class="pre">scipy.integrate.dblquad</span></code><a class="headerlink" href="#scipy-integrate-dblquad" title="Permalink to this headline">#</a></h3>
<p>Gre za podobno funkcijo kot <code class="docutils literal notranslate"><span class="pre">quad</span></code>, vendar za integriranje po dveh spremenljivkah (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.dblquad.html#scipy.integrate.dblquad">dokumentacija</a>).
Funkcija <code class="docutils literal notranslate"><span class="pre">scipy.integrate.dblquad()</span></code> izračuna dvojni integral <code class="docutils literal notranslate"><span class="pre">func(y,</span> <span class="pre">x)</span></code> v mejah od <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">[a,</span> <span class="pre">b]</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">[gfun(x),</span> <span class="pre">hfun(x)]</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dblquad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">gfun</span><span class="p">,</span> <span class="n">hfun</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">)</span>
</pre></div>
</div>
<p>Izbrani parametri so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> je Python funkcija, ki jo integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> je spodnja meja integriranja <code class="docutils literal notranslate"><span class="pre">x</span></code> (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> je zgornja meja integriranja <code class="docutils literal notranslate"><span class="pre">x</span></code> (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gfun</span></code> je Python funkcija, ki definira spodnjo mejo <code class="docutils literal notranslate"><span class="pre">y</span></code> v odvisnosti od <code class="docutils literal notranslate"><span class="pre">x</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hfun</span></code> je Python funkcija, ki definira zgornjo mejo <code class="docutils literal notranslate"><span class="pre">y</span></code> v odvisnosti od <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
<p>Poglejmo primer izračuna površine polkroga s polmerom 1:</p>
<div class="math notranslate nohighlight">
\[\int_{-1}^{1}\left(\int_0^{\sqrt{1-x^2}}1\,\textrm{d}y\right)\,\textrm{d}x=\frac{\pi}{2}\]</div>
<p>Definirajmo ustrezne Python funkcije in izračunajmo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="c1"># integracijska funkcija je enostavna, konstanta = 1!</span>
    <span class="k">return</span> <span class="mf">1.</span>
<span class="k">def</span> <span class="nf">gfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>    <span class="c1"># spodnja meja = 0</span>
    <span class="k">return</span> <span class="mf">0.</span>
<span class="k">def</span> <span class="nf">hfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>    <span class="c1"># zgornja meja</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gfun</span><span class="o">=</span><span class="n">gfun</span><span class="p">,</span> <span class="n">hfun</span><span class="o">=</span><span class="n">hfun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_234_0.png" src="../_images/Predavanje 11 - Numerično integriranje_234_0.png" />
</div>
</div>
</section>
</section>
<section id="intergracijske-funkcije-ki-zahtevajo-tabelo-vrednosti">
<h2>Intergracijske funkcije, ki zahtevajo tabelo vrednosti:<a class="headerlink" href="#intergracijske-funkcije-ki-zahtevajo-tabelo-vrednosti" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trapz(y[,</span> <span class="pre">x,</span> <span class="pre">dx,</span> <span class="pre">axis])</span></code> sestavljeno trapezno pravilo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cumtrapz(y[,</span> <span class="pre">x,</span> <span class="pre">dx,</span> <span class="pre">axis,</span> <span class="pre">initial])</span></code> kumulativni integral podintegralske funkcije (vrne rezultat v vsakem vozlišču),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simps(y[,</span> <span class="pre">x,</span> <span class="pre">dx,</span> <span class="pre">axis,</span> <span class="pre">even])</span></code>	Simpsonova metoda,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">romb(y[,</span> <span class="pre">dx,</span> <span class="pre">axis,</span> <span class="pre">show])</span></code>	Rombergova metoda.</p></li>
</ul>
<p>Tukaj si bomo na primeru ogledali funkcijo <code class="docutils literal notranslate"><span class="pre">cumtrapz</span></code>. Kot primer si, ko na maso <span class="math notranslate nohighlight">\(m=1\)</span> (enote izpustimo) deluje sila <span class="math notranslate nohighlight">\(F=\sin(t)\)</span>. Iz 2. Newtonovega zakona sledi: <span class="math notranslate nohighlight">\(F=m\,\ddot x\)</span>. Pospešek integriramo, da izračunamo hitrost; nato integriramo še enkrat za pomik. Definirajmo najprej funkcijo za pospešek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pospešek</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">/</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Zanima nas dogajanje v času 3 sekund:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo tabelo pospeškov ter nato integrirajmo za hitrost (pri tem je pomembno, da definiramo začetno vrednost):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pospešek</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hitrost sedaj še enkrat integrirajmo, da izračunamo pot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pospesek&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hitrost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Predavanje 11 - Numerično integriranje_245_0.png" src="../_images/Predavanje 11 - Numerično integriranje_245_0.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h1>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this headline">#</a></h1>
<ol class="simple">
<li><p>Na sliki (vir: J. Slavič: Dinamika, meh. nihanja …, 2014) je prikazan trikotnik s stranicami dolžine <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, z debelino <span class="math notranslate nohighlight">\(h\)</span> in gostoto <span class="math notranslate nohighlight">\(\rho\)</span>.
<img src="./fig/Slavic_2014_str_242_slika_5.4.png" width=200>
V simbolni obliki določite masni vztrajnostni moment glede na prikazano os <span class="math notranslate nohighlight">\(y\)</span>:
$<span class="math notranslate nohighlight">\(J_{yy}=\int_0^b y^2\,\rho\,h\,(a-a/b\,y)\,\textrm{d}y.\)</span><span class="math notranslate nohighlight">\(
Upoštevajte tudi: \)</span>m=a,b,h,\rho/2$. Za izmišljene vrednosti izračunajte numerični rezultat.</p></li>
<li><p>Izračunajte integral tudi numerično. Uporabite <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> in integrirajte glede na pravila: trapezno, Simpsonovo 1/3. Rezultat primerjajte tudi z Gaussovo kvadraturo.
Raziščite natančnost in hitrost metod.</p></li>
<li><p>Preštudirajte <code class="docutils literal notranslate"><span class="pre">scipy.special.legendre</span></code>, ki vam vrne objekt <code class="docutils literal notranslate"><span class="pre">orthopoly1d</span></code>. Ta objekt ima metodo <code class="docutils literal notranslate"><span class="pre">weights</span></code>, ki vrne seznam <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">w,</span> <span class="pre">mu0]</span></code> vrednosti, ki jih uporabimo pri Gaussovi kvadraturi. (Če vsega ne razumete, ne skrbite preveč, bo asistent pokazal/komentiral). Opazite lahko, da smo vrednosti izpeljali na predavanjih!</p></li>
<li><p>S pomočjo zgoraj pridobljenih uteži in vozlišč izračunajte integral s pomočjo Gaussove kvadrature: <span class="math notranslate nohighlight">\(\sum_iw_i\,f(x_i)\)</span>. Pazite na transformacijo mej.</p></li>
<li><p>Preprost integral <span class="math notranslate nohighlight">\(\int_0^2x^2\,dx\)</span> izrabite za prikaz trapeznega in Simpsonovega 1/3 pravila (osnovno pravilo, ne sestavljeno). Uteži izračunajte z uporabo <code class="docutils literal notranslate"><span class="pre">scipy</span></code>.</p></li>
<li><p>Integral predhodne točke razširite za sestavljeno trapezno pravilo (lastna koda). Prikažite vpliv števila podintervalov, primerjajte napako izračuna s predhodnim številom podintervalov in prikažite konvergenco.</p></li>
<li><p>Integral predhodne točke razširite za sestavljeno Simpsonovo 1/3 pravilo (lastna koda). Prikažite vpliv števila podintervalov, primerjajte napako izračuna s predhodnim številom podintervalov in prikažite konvergenco.</p></li>
<li><p>Z različnimi metodami izračunajte integrala (namig: vse metode niso primerne):
$<span class="math notranslate nohighlight">\(\int_1^2\frac{\sin(x)}{\sqrt{x}}.\)</span>$</p></li>
<li><p>S pomočjo numeričnega integriranja določite ekvivalentno silo porazdeljene obremenitve (<span class="math notranslate nohighlight">\(Q\)</span>) ter njeno prijemališče vzdolž nosilca (<span class="math notranslate nohighlight">\(x_Q\)</span>) dolžine <span class="math notranslate nohighlight">\(L = 2\,\)</span>m. Konstanta obremenitve: <span class="math notranslate nohighlight">\(q_0 = 5\,\)</span>kN/m.
<img src="./fig/nal-num_integriranje_1-1.jpg" width=350>
Rešitev:
ekvivalentna obremenitev <span class="math notranslate nohighlight">\(Q = \int_0^L{q(x) \mathrm{d}x}\)</span>, pozicija (težišče) <span class="math notranslate nohighlight">\(x_Q = \frac{ \int_0^L{x\,q(x) \mathrm{d}x} }{ \int_0^L{q(x) \mathrm{d}x} }\)</span></p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h1>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this headline">#</a></h1>
<ol class="simple">
<li><p>Obravnavajte prikazan enoosni primer, obremenjen s porazdeljeno obremenitvijo <span class="math notranslate nohighlight">\(n(x)\)</span> ter točkovno silo <span class="math notranslate nohighlight">\(F=10\,\)</span>kN. Dolžina palice je <span class="math notranslate nohighlight">\(L = 2\,\)</span>m, konstanta <span class="math notranslate nohighlight">\(n_0 = 15\,\)</span>kN/m in <span class="math notranslate nohighlight">\(EA = 200000\,\mathrm{MPa} \times 50×50\, \mathrm{mm^2}\)</span>.
<img src="./fig/nal-num_integriranje_2-2.jpg" width=350>
Naloga:</p>
<ol class="simple">
<li><p>S pomočjo simbolnega integriranja določite funkcijo notranje osne sile <span class="math notranslate nohighlight">\(N(x)\)</span>.</p></li>
<li><p>S pomočjo numeričnega integriranja izračunajte pomik prostega konca palice <span class="math notranslate nohighlight">\(u_0\)</span>.</p></li>
</ol>
</li>
</ol>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Predavanje%2010%20-%20Numeri%C4%8Dno%20odvajanje.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Numerično odvajanje</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Predavanje%2012%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20za%C4%8Detni%20problem.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Numerično reševanje diferencialnih enačb - začetni problem</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Janko Slavič<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>