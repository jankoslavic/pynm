

<!DOCTYPE html>


<html lang="sl" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Numerične metode v ekosistemu Pythona</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'README';</script>
    <link rel="index" title="Abecedni seznam" href="genindex.html" />
    <link rel="search" title="Išči" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="sl"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="#">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Numerične metode v ekosistemu Pythona, Janko Slavič, 2023/24
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">






































































































</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jankoslavic/pynm" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Izvorno skladišče"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jankoslavic/pynm/issues/new?title=Issue%20on%20page%20%2FREADME.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Odprite številko"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Celozaslonski način"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Išči" aria-label="Išči" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Numerične metode v ekosistemu Pythona, Janko Slavič, 2023/24</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Vsebina </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Študijski in izpitni red">Študijski in izpitni red: 2023/24</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#predavanja-vaje">Predavanja / vaje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#sprotni-studij">Sprotni študij</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#izpit">Izpit</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#literatura">Literatura</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#pogoji-za-poslusanje-v-naprej">Pogoji za poslušanje v naprej?</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 01 - Uvod v Python">Uvod v Python</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#namestitev-pythona">Namestitev Pythona</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#jupyter-notebook-jupyter-lab">Jupyter notebook (Jupyter lab)</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#prvi-program-in-pep">Prvi program in PEP</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#osnove-pythona">Osnove Pythona</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#za-konec-plonk-list">Za konec: plonk list :)</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 02 - Print, delo z datotekami, funkcije, moduli">Funkcije, izjeme, moduli</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#funkcije">Funkcije</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#obravnavanje-izjem">Obravnavanje izjem</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#osnove-modulov">Osnove modulov</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uporaba-modulov-iz-spleta">Uporaba modulov iz spleta</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 03 - Moduli, numpy, matplotlib">Numpy, matplotlib</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#modul-numpy">Modul <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#modul-matplotlib">Modul <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 04 - Objektno programiranje, simbolno računanje">Objektno programiranje, simbolno računanje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#objektno-programiranje">Objektno programiranje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#simbolno-racunanje-s-sympy">Simbolno računanje s <code class="docutils literal notranslate"><span class="pre">SymPy</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 05 - Uvod v numerične metode in sistemi linearnih enačb 1">Uvod v numerične metode in sistemi linearnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod-v-numericne-metode">Uvod v numerične metode</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod-v-sisteme-linearnih-enacb">Uvod v sisteme linearnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#gaussova-eliminacija">Gaussova eliminacija</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 06 - Sistemi linearnih enačb 2">Sistemi linearnih enačb - nadaljevanje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#razcep-lu">Razcep LU</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#pivotiranje">Pivotiranje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#modul-scipy">Modul <code class="docutils literal notranslate"><span class="pre">SciPy</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#racunanje-inverzne-matrike">Računanje inverzne matrike</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#resevanje-predolocenih-sistemov">Reševanje predoločenih sistemov</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#iterativne-metode">Iterativne metode</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 07 - Interpolacija">Interpolacija</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#interpolacija-s-polinomom">Interpolacija s polinomom</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#lagrangeva-metoda">Lagrangeva metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#kubicni-zlepki">Kubični zlepki</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 08 - Aproksimacija">Aproksimacija</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-najmanjsih-kvadratov-za-linearno-funkcijo">Metoda najmanjših kvadratov za linearno funkcijo</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-najmanjsih-kvadratov-za-poljubni-polinom">Metoda najmanjših kvadratov za poljubni polinom</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#aproksimacija-s-poljubno-funkcijo">Aproksimacija s poljubno funkcijo</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 09 - Reševanje enačb">Reševanje enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#inkrementalna-metoda">Inkrementalna metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#iterativna-inkrementalna-metoda">Iterativna inkrementalna metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#bisekcijska-metoda">Bisekcijska metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#sekantna-metoda">Sekantna metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#newtonova-metoda">Newtonova metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#resevanje-sistemov-nelinarnih-enacb">Reševanje sistemov nelinarnih enačb*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 10 - Numerično odvajanje">Numerično odvajanje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#aproksimacija-prvega-odvoda-po-metodi-koncnih-razlik">Aproksimacija prvega odvoda po metodi končnih razlik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#centralna-diferencna-shema">Centralna diferenčna shema</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#necentralna-diferencna-shema">Necentralna diferenčna shema</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uporaba-numpy-gradient">Uporaba <code class="docutils literal notranslate"><span class="pre">numpy.gradient</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#zaokrozitvena-napaka-pri-numericnem-odvajanju">Zaokrožitvena napaka pri numeričnem odvajanju*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#aproksimacija-odvoda-s-kompleksnim-korakom">Aproksimacija odvoda s kompleksnim korakom*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 11 - Numerično integriranje">Numerično integriranje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#newton-cotesov-pristop">Newton-Cotesov pristop</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#gaussov-integracijski-pristop">Gaussov integracijski pristop</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#scipy-integrate"><code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 12 - Numerično reševanje diferencialnih enačb - začetni problem">Numerično reševanje diferencialnih enačb - začetni problem</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#eulerjeva-metoda">Eulerjeva metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-runge-kutta-drugega-reda">Metoda Runge-Kutta drugega reda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-runge-kutta-cetrtega-reda">Metoda Runge-Kutta četrtega reda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uporaba-scipy-za-resevanje-navadnih-diferencialnih-enacb">Uporaba <code class="docutils literal notranslate"><span class="pre">scipy</span></code> za reševanje navadnih diferencialnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#sistem-navadnih-diferencialnih-enacb">Sistem navadnih diferencialnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#stabilnost-resevanja-diferencialnih-enacb">Stabilnost reševanja diferencialnih enačb*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 13 - Numerično reševanje diferencialnih enačb - robni problem">Numerično reševanje diferencialnih enačb - robni problem</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#resevanje-dvotockovnih-robnih-problemov">Reševanje dvotočkovnih robnih problemov</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#strelska-metoda">Strelska metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-koncnih-razlik">Metoda končnih razlik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno-simbolna-resitev-nosilca">Dodatno: simbolna rešitev nosilca</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 14 - Testiranje pravilnosti kode, uporabniški vmesnik">Testiranje pravilnosti kode, uporabniški vmesnik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#testiranje-pravilnosti-kode">Testiranje pravilnosti kode</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#graficni-uporabniski-vmesnik">Grafični uporabniški vmesnik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="numericne-metode-v-ekosistemu-pythona-janko-slavic-2023-24">
<h1>Numerične metode v ekosistemu Pythona, Janko Slavič, 2023/24<a class="headerlink" href="#numericne-metode-v-ekosistemu-pythona-janko-slavic-2023-24" title="Permalink to this heading">#</a></h1>
<p>Tukaj predstavljena vsebina je osnova za predmet Numerične metode, ki se poučujeta na <span class="xref myst">Fakulteti za strojništvo (Univerza v Ljubljani)</span>:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.ladisk.si/?what=incfl&amp;flnm=NM.php">Numerične metode 2l. RR</a></p></li>
</ul>
<p>Predloge predavanj se nahajajo v mapi <code class="docutils literal notranslate"><span class="pre">notebooks</span></code>, lahko pa si jih ogledate v <a class="reference external" href="https://jankoslavic.github.io/pynm/README.html">spletni knjigi</a> (povezave so navedene spodaj).</p>
<p>Prosimo, da si preberete <a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/%C5%A0tudijski%20in%20izpitni%20red.html">študijski in izpitni red</a>, tam so navedene ključne informacije v zvezi z opravljanjem predmeta.</p>
<p><strong>Razpored predavanj</strong></p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2001%20-%20Uvod%20v%20Python.html">2.okt: Uvod v Python, 1. del</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2001%20-%20Uvod%20v%20Python.html">9.okt: Uvod v Python, 2. del</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2002%20-%20Print,%20delo%20z%20datotekami,%20funkcije,%20moduli.html">16.okt: Print, delo z datotekami, funkcije, moduli</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2003%20-%20Moduli,%20numpy,%20matplotlib.html">23.okt: Moduli, numpy, matplotlib</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2004%20-%20Objektno%20programiranje,%20simbolno%20ra%C4%8Dunanje.html">6.nov: Objektno programiranje, simbolno računanje</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2005%20-%20Uvod%20v%20numeri%C4%8Dne%20metode%20in%20sistemi%20linearnih%20ena%C4%8Db%201.html">13.nov: Uvod v numerične metode in sistemi linearnih enačb 1</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2006%20-%20Sistemi%20linearnih%20ena%C4%8Db%202.html">20.nov: Sistemi linearnih enačb 2</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2007%20-%20Interpolacija.html">27.nov: Interpolacija</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2008%20-%20Aproksimacija.html">4.dec: Aproksimacija</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2009%20-%20Re%C5%A1evanje%20ena%C4%8Db.html">11.dec: Reševanje enačb</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2010%20-%20Numeri%C4%8Dno%20odvajanje.html">18.dec: Numerično odvajanje</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2011%20-%20Numeri%C4%8Dno%20integriranje.html">8.jan: Numerično integriranje</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2012%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20za%C4%8Detni%20problem.html">15.jan: Numerično reševanje diferencialnih enačb - začetni problem</a> in <a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2013%20-%20Numeri%C4%8Dno%20re%C5%A1evanje%20diferencialnih%20ena%C4%8Db%20-%20robni%20problem.html">robni problem</a></p></li>
<li><p><a class="reference external" href="https://jankoslavic.github.io/pynm/notebooks/Predavanje%2014%20-%20Testiranje%20pravilnosti%20kode,%20uporabni%C5%A1ki%20vmesnik.html">Testiranje pravilnosti kode, uporabniški vmesnik</a></p></li>
<li><p>Uvod v Mathematico*</p></li>
</ol>
<p>* Fakultativno predavanje, študentje Fakultete za strojništvo UNI-LJ imate možnost pridobiti licenčno verzijo programa Mathematica na tej <a class="reference external" href="http://www.fs.uni-lj.si/studijska_dejavnost/it_podpora/programska_oprema_za_studente/2015071415154271/Registracija%20Mathematica/">povezavi</a>.</p>
<section id="dovoljenje-za-uporabo-license">
<h2>Dovoljenje za uporabo (License)<a class="headerlink" href="#dovoljenje-za-uporabo-license" title="Permalink to this heading">#</a></h2>
<p>To delo je prosto za nekomercialno uporabo pri čemer morate navesti vir, avtorja in Fakulteto za strojništvo, Univerze v Ljubljani.</p>
</section>
<div class="toctree-wrapper compound">
<span id="document-notebooks/Študijski in izpitni red"></span><section class="tex2jax_ignore mathjax_ignore" id="studijski-in-izpitni-red-2023-24">
<h2>Študijski in izpitni red: 2023/24<a class="headerlink" href="#studijski-in-izpitni-red-2023-24" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="predavanja-vaje">
<h2>Predavanja / vaje<a class="headerlink" href="#predavanja-vaje" title="Permalink to this heading">#</a></h2>
<p><strong>Predavanja</strong>:</p>
<ul class="simple">
<li><p><strong>Ponedeljek</strong> 11:00 V/2: <strong>Prof. dr. Janko Slavič</strong> (DS-P3, 01 4771 226, <a class="reference external" href="mailto:janko&#46;slavic&#37;&#52;&#48;fs&#46;uni-lj&#46;si">janko<span>&#46;</span>slavic<span>&#64;</span>fs<span>&#46;</span>uni-lj<span>&#46;</span>si</a>)</p></li>
</ul>
<p><strong>Vaje</strong>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Ura</p></th>
<th class="head"><p>as. dr. Domen Gorjup</p></th>
<th class="head"><p>as. dr. Klemen Zaletelj</p></th>
<th class="head"><p>as. Gašper Krivic</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8:00</p></td>
<td><p><strong>Č1</strong> (II/1)</p></td>
<td><p></p></td>
<td><p><strong>Č2</strong> (I/4)</p></td>
</tr>
<tr class="row-odd"><td><p>10:00</p></td>
<td><p></p></td>
<td><p><strong>Č3</strong> (II/1)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>12:00</p></td>
<td><p><strong>Č5</strong> (II/1)</p></td>
<td><p></p></td>
<td><p><strong>Č4</strong> (I/4)</p></td>
</tr>
<tr class="row-odd"><td><p>8:00</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><strong>P1</strong> (I/4)</p></td>
</tr>
<tr class="row-even"><td><p>10:00</p></td>
<td><p><strong>P2</strong> (II/1)</p></td>
<td><p></p></td>
<td><p><strong>P3</strong> (I/4)</p></td>
</tr>
</tbody>
</table>
<p><strong>Govorilne ure:</strong></p>
<ul class="simple">
<li><p><strong>četrtek 11:30 - 12:00</strong> v učilnici <strong>II/1</strong></p></li>
</ul>
<p><strong>Asistenti:</strong></p>
<ul class="simple">
<li><p>as. dr. Domen Gorjup (DS-P5, 01 4771 228, <a class="reference external" href="mailto:domen&#46;gorjup&#37;&#52;&#48;fs&#46;uni-lj&#46;si">domen<span>&#46;</span>gorjup<span>&#64;</span>fs<span>&#46;</span>uni-lj<span>&#46;</span>si</a>)</p></li>
<li><p>as. dr. Klemen Zaletelj (DS-P5, 01 4771 228, <a class="reference external" href="mailto:klemen&#46;zaletelj&#37;&#52;&#48;fs&#46;uni-lj&#46;si">klemen<span>&#46;</span>zaletelj<span>&#64;</span>fs<span>&#46;</span>uni-lj<span>&#46;</span>si</a>)</p></li>
<li><p>as. Gašper Krivic (DS-P5, 01 4771 228, <a class="reference external" href="mailto:gasper&#46;krivic&#37;&#52;&#48;fs&#46;uni-lj&#46;si">gasper<span>&#46;</span>krivic<span>&#64;</span>fs<span>&#46;</span>uni-lj<span>&#46;</span>si</a>)</p></li>
</ul>
<p><strong>Spremljanje sprotnega študija, obvestila itd</strong></p>
<p>Sproten študij bomo izvajali s pomočjo: <a class="reference external" href="http://moj.ladisk.si/">moj.ladisk.si</a>. Za prijavo uporabite email, ki ga imate v VIS-u: <a class="reference external" href="https://youtu.be/e3_NUBwOjQ4">video prikaz prijave</a>.</p>
<p><strong>Vprašanja in odgovori:</strong></p>
<p>Vprašanja na temo predmeta ali tudi širše lahko postavite/odgovorite na portalu: <a class="reference external" href="http://pinm.ladisk.si">pinm.ladisk.si</a>.</p>
<p><strong>Spletna učilnica (<a class="reference external" href="http://e-ucilnica.fs.uni-lj.si">e-ucilnica.fs.uni-lj.si</a>)</strong></p>
<p>Vsebine, povezane s predmetom, najdete tudi v <a class="reference external" href="https://e-ucilnica.fs.uni-lj.si/course/view.php?id=140">e-učilnici</a>.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="sprotni-studij">
<h2>Sprotni študij<a class="headerlink" href="#sprotni-studij" title="Permalink to this heading">#</a></h2>
<img src="./fig/flowchart_pridobitev_ocene.png"><section id="sestava-ocene">
<h3>Sestava ocene<a class="headerlink" href="#sestava-ocene" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>5% sodelovanje pri predavanjih</p></li>
<li><p>20% sodelovanje pri vajah* (vsaj 50%)</p></li>
<li><p>10% tedenske domače naloge (vsaj 50%)</p></li>
<li><p>30% individualni projekt (vsaj 50%)</p></li>
<li><p>35% preizkus iz teorije (vsaj 50%): <a class="reference external" href="https://github.com/jankoslavic/pynm/blob/main/primeri%20nalog%20in%20izpita/NM_teorija.pdf">glejte pretekle preizkuse</a></p></li>
</ul>
<p>* Na predavanja in vaje morate priti pripravljeni; uporabili bomo nekatere principe obratnega učenja!</p>
</section>
<section id="sodelovanje-na-vajah">
<h3>Sodelovanje na vajah<a class="headerlink" href="#sodelovanje-na-vajah" title="Permalink to this heading">#</a></h3>
<p>Sodelovenje na vajah se ocenjuje s kratkimi, napovedanimi pisnimi testi.</p>
<p>Testi se izvajajona vajah v računalniški učilnici, praviloma na začetku vaje. Rešujejo se v okolju Jupyter Notebook in se oddajajo ter ocenjujejo v sistemu sprotnega dela <a class="reference external" href="http://moj.ladisk.si">moj.ladisk.si</a> (na enak način, kot domače naloge).</p>
<section id="popravljanje-ocen-sodelovanja-na-vajah">
<h4>Popravljanje ocen sodelovanja na vajah<a class="headerlink" href="#popravljanje-ocen-sodelovanja-na-vajah" title="Permalink to this heading">#</a></h4>
<p>Popravljati je mogoče <em>oceno enega kratkega testa</em>, v dogovorjenem terminu, praviloma na koncu semestra.</p>
<p>V primeru upravičene odsotnosti (npr. zdravniško opravičilo) je možno oceno testa na zamujeni vaji pridobiti zgolj na prvem naslednjem terminu govorilnih ur.</p>
</section>
</section>
<section id="individualni-projekt">
<h3>Individualni projekt<a class="headerlink" href="#individualni-projekt" title="Permalink to this heading">#</a></h3>
<p>Se navezuje na poljubno vsebino katerega-koli predmeta na FS in ga študent definira sam.
Projekt mora vsebovati sledeče vsebine:</p>
<ul class="simple">
<li><p><em>simbolno reševanje</em>,</p></li>
<li><p><em>sistemi linearnih enačb</em>,</p></li>
<li><p><em>interpolacija ali aproksimacija</em>,</p></li>
<li><p><em>iskanje ničel</em>,</p></li>
<li><p><em>integriranje ali odvajanje</em>,</p></li>
<li><p><em>reševanje diferencialnih enačb</em>.</p></li>
</ul>
<p>Ocena individualnega projekta je sestavljena iz:</p>
<ul class="simple">
<li><p><em>numerična pravilnost</em> (30%),</p></li>
<li><p><em>struktura, urejenost, uporaba lastnih modulov, stil kode (docstringi)</em> (30%),</p></li>
<li><p><em>lasten odnos / kreativni dodatek</em> (30%),*</p></li>
<li><p><em>pripravljeni testi kode in/ali uporabniški vmesnik</em> (10%).</p></li>
</ul>
<p><strong>Navodila za oddajo projekta:</strong></p>
<ul class="simple">
<li><p>Rok za oddajo projekta je naveden spodaj, med pomembnimi datumi.</p></li>
<li><p>Za izdelavo projekta uporabite <strong>predlogo</strong>, ki jo najdete <a class="reference external" href="https://github.com/jankoslavic/pynm/blob/main/projekt/Individualni%20projekt%20-%20predloga.ipynb">tukaj</a></p></li>
<li><p>Projekt oddajte v obliki <code class="docutils literal notranslate"><span class="pre">zip</span></code> datoteke z imenom: <strong>Ime in priimek, vpisna številka.zip</strong>. Primer: <code class="docutils literal notranslate"><span class="pre">Janez</span> <span class="pre">Novak,</span> <span class="pre">23201111.zip</span></code>.</p></li>
<li><p>Velikost <code class="docutils literal notranslate"><span class="pre">zip</span></code> datoteke naj ne presega <strong>20 MB</strong>.</p></li>
<li><p><strong>ZIP d oddate v <a class="reference external" href="https://e-ucilnica.fs.uni-lj.si/course/view.php?id=140#section-1">e-učilnici</a>.</strong></p></li>
</ul>
<p><strong>Pred oddajo:</strong></p>
<ol class="arabic simple">
<li><p>v projektu zakomentirajte (dodajte <strong>#</strong>) morebitno namestitev dodatnih paketov in funkcije <code class="docutils literal notranslate"><span class="pre">%%timeit</span></code>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># !pip install ime_paketa</span>
<span class="c1"># %%timeit</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>naredite <code class="docutils literal notranslate"><span class="pre">Kernel</span></code> <span class="math notranslate nohighlight">\(\to\)</span> <code class="docutils literal notranslate"><span class="pre">Restart</span></code> in nato <code class="docutils literal notranslate"><span class="pre">Cell</span></code> <span class="math notranslate nohighlight">\(\to\)</span> <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">All</span></code>. Prepričajte, da se vse celice izvedejo pravilno.</p></li>
</ol>
<p>* Kot <strong>kreativni dodatek</strong> se tretira programska vsebina, ki na predavanjih in vajah ni bila posebej obravnavana. Kot na primer:</p>
<ul class="simple">
<li><p>animacija rezultatov z uporabo matplotlib-a,</p></li>
<li><p>druge oblike naprednih prikazov (Plotly, Bokeh, vispy, pyqtgraph, VTK…),</p></li>
<li><p>avtomatsko branje podatkov iz spleta, pošiljanje rezultatov po elektronski pošti,</p></li>
<li><p>strojno generiranje poročila,</p></li>
<li><p>uporaba knjižnjice Pandas, zapis rezultatov v bazo podatkov, MS Excel,</p></li>
<li><p>uporaba platform Raspberry Pi, Arduino, zajem podatkov,</p></li>
<li><p>izdelava spletne aplikacije (Flask, Django),</p></li>
<li><p>uporaba modulov in knjižnic, kot so scikit-learn, TensorFlow, PyOpenCV.</p></li>
</ul>
</section>
<section id="domace-naloge-moj-ladisk-si">
<h3>Domače naloge (<a class="reference external" href="http://moj.ladisk.si">moj.ladisk.si</a>)<a class="headerlink" href="#domace-naloge-moj-ladisk-si" title="Permalink to this heading">#</a></h3>
<p><strong>Splošna navodila za reševanje</strong></p>
<p>Tedenske domače naloge vam dodelimo v sistemu <a class="reference external" href="https://moj.ladisk.si/">moj.ladisk.si</a>. Domače naloge rešujete v okolju Jupyter Notebook.</p>
<ul class="simple">
<li><p>Datoteke, ki jih prenesete s spleta, shranite v obliki <code class="docutils literal notranslate"><span class="pre">.zip</span></code> arhiva (če vaš brskalnik datoteki ne doda končnice <code class="docutils literal notranslate"><span class="pre">.zip</span></code>, to storite sami).</p></li>
<li><p>Arhiv z datotekami, ki ga prenesete s spleta, razpakirate v celoti.</p></li>
<li><p>V mapi z razpakiranimi datotekami odprete ukazno okno in poženete ukaz <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code>.</p></li>
<li><p>Celice v <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> datoteki z domačo nalogo poganjate po vrsti (tudi celice povsem na vrhu datoteke!).</p></li>
<li><p>Rezultati so pri reševanju posredovani v spletni sistem <a class="reference external" href="http://moj.ladisk.si">moj.ladisk.si</a> in se samodejno sprotno preverjajo. Pri reševanju je <strong>nujna povezava s spletom</strong>.</p></li>
</ul>
<p>Pripravili smo tudi <a class="reference external" href="https://youtu.be/wedX7AdORvY">video navodila za reševanje</a>.</p>
<p><strong>Časovna omejitev reševanja domačih nalog</strong></p>
<p>Domače naloge imajo definiran čas <em>okna za reševanje</em>:</p>
<ul class="simple">
<li><p>Do odprtja okna za reševanje je možno <strong>predčasno reševanje naloge brez časovne omejitve</strong>.</p></li>
<li><p>V oknu za reševanje je dovoljen čas reševanja naloge omejen. Časovna omejitev teče od trenutka, ko <em>znotraj okna za reševanje</em> nalogo prvič odprete.</p></li>
<li><p>Po zaprtju okna se naloga zapre, reševanje <strong>ni več možno</strong>.</p></li>
</ul>
<p>Svetujemo vam, da <em>čim večji del naloge rešite v času predčasnega reševanja, pred odprtjem okna za reševanje</em>.</p>
<p><strong>Uporaba Jokerja za premik obveznosti</strong></p>
<p>Vsakemu študentu sta pri predmetu na voljo dva Jokerja, ki jih lahko uporabite za premik obveznosti v prihodnost.</p>
<ul class="simple">
<li><p>Z uporabo Jokerja lahko okno za reševanje domače naloge premaknete za <span class="math notranslate nohighlight">\(\leq\)</span> 14 dni naprej.</p></li>
<li><p>Uporaba jokerja <strong>ni možna, če ste nalogo že odprli</strong>.</p></li>
<li><p>Pred pričetkom okna za reševanje je za premik naloge potreben en Joker, v času okna za reševanje pa dva.</p></li>
</ul>
</section>
<section id="predlog-ocene-na-podlagi-sprotnega-studija">
<h3>Predlog ocene na podlagi sprotnega študija<a class="headerlink" href="#predlog-ocene-na-podlagi-sprotnega-studija" title="Permalink to this heading">#</a></h3>
<p>Predlog ocene:</p>
<ul class="simple">
<li><p>50,0 do 57,5%: 6/6</p></li>
<li><p>62,5 do 67,5%: 7/7</p></li>
<li><p>72,5 do 77,5%: 8/8</p></li>
<li><p>82,5 do 87,5%: 9/9</p></li>
<li><p>92,5 do 100%: 10/10</p></li>
</ul>
<p>(Nedefinirana področja so vmesne ocene.)</p>
<p>Individualni projekt in predlog ocene se zagovarja na ustnem zagovoru.</p>
<p>Pri zagovoru upoštevamo tudi kvalitativno oceno sodelovanja na vajah, predavanjih ali <a class="reference external" href="http://pinm.ladisk.si">pinm.ladisk.si</a> (1000 točk je ekvivalent 1xP). Glejte <a class="reference external" href="http://lab.fs.uni-lj.si/ladisk/data/wiki/my.ladisk.si/doku.php?id=start#kaj_pomenijo_oznake_v_stolpcu_komentar">tudi</a>.</p>
</section>
<section id="pomembni-datumi">
<h3>Pomembni datumi<a class="headerlink" href="#pomembni-datumi" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Oddaja individualnega projekta: (15. jan 2024 do 12h)*</p></li>
<li><p>Preizkus iz teorije se piše na zimskem izpitnem roku.</p></li>
<li><p>Zagovori: po izpitnem roku.</p></li>
</ol>
<p>* V primeru oddaje vsaj 1 teden <strong>pred rokom</strong>, se uspeh množi z <span class="math notranslate nohighlight">\(1.1\)</span>; v primeru <strong>zamude</strong> pa se upeh množi z <span class="math notranslate nohighlight">\(0.9^n\)</span>, kjer je <span class="math notranslate nohighlight">\(n\)</span> število začetih dni zamude.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="izpit">
<h2>Izpit<a class="headerlink" href="#izpit" title="Permalink to this heading">#</a></h2>
<p><strong>Izpolnjevanje pogojev za pristop k izpitu</strong>: vsak posamični dogodek (razen teorije in sodelovanja pri predvanjih), ki sestavlja oceno mora biti večji od 40%.</p>
<p>Izpit se opravlja v dveh delih: 50 min preverjanje uporabe numeričnih metod za računalnikom (tipično dve nalogi, s sabo imate lahko poljubne pisne vire, dostopa do interneta ni), nato 60 min za tri teoretična vprašanja (<a class="reference external" href="https://github.com/jankoslavic/pynm/tree/main/primeri%20nalog%20in%20izpita">glejte primer izpita</a>). Za pozitivno oceno morata biti oba dela pozitivna.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="literatura">
<h2>Literatura<a class="headerlink" href="#literatura" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Slavič J.: Programiranje in numerične metode s Pythonom, <a class="reference external" href="https://github.com/jankoslavic/pynm/tree/main/notebooks">izvršljiva knjiga</a> ali <a class="reference external" href="https://jankoslavic.github.io/pynm/README.html">spletna knjiga</a>, 2015-</p></li>
<li><p>Petrišič J.: Uvod v Matlab za inženirje, 2011</p></li>
<li><p>Demšar J. Python za programerje, 2012 (glejte spletno učilnico: <a class="reference external" href="http://goo.gl/n4pVUe">http://goo.gl/n4pVUe</a>)</p></li>
<li><p>Nicolas P. Rougier: From Python to Numpy, 2017 <a class="reference external" href="http://www.labri.fr/perso/nrougier/from-python-to-numpy/">spletna knjiga</a></p></li>
<li><p>Kiusalaas J: Numerical Methods in Engineering with Python 3, 2013</p></li>
<li><p>Fangohr H. Python for Computational Science and Engineering, 2014  (dosegljiva na spletu: <a class="reference external" href="http://goo.gl/nCOfY0">http://goo.gl/nCOfY0</a>)</p></li>
<li><p>Bucky R. Python 3.4 Programming Tutorials (videi dosegljivi na: <a class="reference external" href="http://goo.gl/ie6nfD">http://goo.gl/ie6nfD</a>)</p></li>
<li><p><a class="reference external" href="https://www.projekt-tomo.si">Projekt TOMO</a> (več vsebin, glejte predvsem predmete na FMF in FRI)</p></li>
<li><p><a class="reference external" href="http://www.scipy-lectures.org/">Scipy Lecture Notes</a></p></li>
<li><p>Uporaba paketov Numpy, Scipy itd za inženirje <a class="reference external" href="https://www.youtube.com/channel/UCKaYxkHrmsQePZFpzF9b7sQ">Mr. P Solver (YouTube)</a></p></li>
</ol>
<p>Nekatere spletne učilnice na temo Pythona najdete na <a class="reference external" href="http://pinm.ladisk.si/9/katera-so-najbolj%C5%A1e-spletne-u%C4%8Dilnice-za-u%C4%8Denje-pythona">pinm.ladisk.si</a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pogoji-za-poslusanje-v-naprej">
<h2>Pogoji za poslušanje v naprej?<a class="headerlink" href="#pogoji-za-poslusanje-v-naprej" title="Permalink to this heading">#</a></h2>
<p>Predmeta ni mogoče opravljati v naprej.</p>
</section>
<span id="document-notebooks/Predavanje 01 - Uvod v Python"></span><section class="tex2jax_ignore mathjax_ignore" id="uvod-v-python">
<h2>Uvod v Python<a class="headerlink" href="#uvod-v-python" title="Permalink to this heading">#</a></h2>
<section id="kaj-je-ekosistem-pythona">
<h3>Kaj je ekosistem Pythona?<a class="headerlink" href="#kaj-je-ekosistem-pythona" title="Permalink to this heading">#</a></h3>
<p>Marsikaterega bralca beseda <em>ekosistem</em> zmoti/zmede. <a class="reference external" href="http://www.fran.si/130/sskj-slovar-slovenskega-knjiznega-jezika/3539971/ekosistem?page=4&amp;Query=sistem&amp;All=sistem&amp;FilteredDictionaryIds=130&amp;View=1">Slovar slovenskega knjižnega jezika</a> danes pozna samo rabo v povezavi z ekologijo. V računalništvu pa se v zadnjih desetletjih beseda ekosistem uporablja tudi v kontekstu t. i. digitalnega ekosistema; v primeru Pythona to pomeni vso množico različih paketov (samo <a class="reference external" href="https://pypi.org">pypi.org</a> trenutno hrani več kot 480 tisoč različnih paketov), ki temeljijo na programskem jeziku Python in so med seboj povezani.</p>
<p><strong>Ekosistem Pythona je veliko več kot pa samo programski jezik Python!</strong> Ta knjiga se v okviru prvih štirih predavanj osredotoča na tisti del tega ekosistema, ki je zanimiv in koristen predvsem za inženirske poklice.</p>
<p>Python je <strong>visokonivojski</strong> programski jezik, z visokim nivojim abstrakcije. <strong>Nizkonivojski</strong> programski jeziki, v nasprotju, imajo nizek nivo abstrakcije (npr. strojna koda).</p>
<p>Poglemo si izračun <a class="reference external" href="http://sl.wikipedia.org/wiki/Fibonaccijevo_%C5%A1tevilo">Fibonaccijevega števila</a>, ki sledi definiciji:
$<span class="math notranslate nohighlight">\(F_1 = F_2 = 1\qquad\textrm{in}\qquad F_n = F_{n-1} + F_{n-2}.\)</span>$</p>
<p>Izračun <span class="math notranslate nohighlight">\(F_n\)</span> v <a class="reference external" href="http://en.wikipedia.org/wiki/Low-level_programming_language">strojni kodi</a>:
<img width=400 src="./fig/strojna_koda.png"></p>
<p>MASM koda
<img width=400 src="./fig/mash_koda.png"></p>
<p>C</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">Fibonacci</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">   </span><span class="k">else</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Fibonacci</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Fibonacci</span><span class="p">(</span><span class="n">n</span><span class="mi">-2</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span>
</pre></div>
</div>
<p>Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">števila</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="c1"># seznam števil</span>
<span class="p">[</span><span class="n">število</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">število</span> <span class="ow">in</span> <span class="n">števila</span> <span class="k">if</span> <span class="n">število</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[16, 25]
</pre></div>
</div>
</div>
</div>
<p>Python omogoča visok nivo abstrakcije in zato abstraktno kodo. Sedaj si bomo pogledali primer kode Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">števila</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="c1"># seznam števil</span>
<span class="p">[</span><span class="n">število</span> <span class="k">for</span> <span class="n">število</span> <span class="ow">in</span> <span class="n">števila</span> <span class="k">if</span> <span class="n">število</span><span class="o">%</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Čeprav v tem trenutku še nimamo dovolj znanja, poskusimo razumeti/prebrati:</p>
<ol class="arabic simple">
<li><p>prva vrstica definira seznam števil; vse kar sledi znaku # pa predstavlja komentar</p></li>
<li><p>rezultat druge vrstice je seznam, kar definirata oglata oklepaja; znotraj oklepaja beremo:</p>
<ul class="simple">
<li><p>vrni <code class="docutils literal notranslate"><span class="pre">število</span></code> za vsako (<strong>for</strong>) <code class="docutils literal notranslate"><span class="pre">število</span></code> v (<strong>in</strong>) seznamu <code class="docutils literal notranslate"><span class="pre">števila</span></code>, če (<strong>if</strong>) je pri deljenju <code class="docutils literal notranslate"><span class="pre">število</span></code> z 2 ostanek 1.</p></li>
</ul>
</li>
</ol>
<p>Vidimo, da je nivo abstrakcije res visok, saj smo potrebovali veliko besed, da smo pojasnili vsebino!</p>
<p>Poglejmo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">števila</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="c1"># seznam števil</span>
<span class="p">[</span><span class="n">število</span> <span class="k">for</span> <span class="n">število</span> <span class="ow">in</span> <span class="n">števila</span> <span class="k">if</span> <span class="n">število</span><span class="o">%</span><span class="k">2</span>]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 3, 5]
</pre></div>
</div>
</div>
</div>
<p>Kratek pregled začetkov nekaterih programskih jezikov:</p>
<ul class="simple">
<li><p>1957 Fortran, * 1970 Pascal, * 1972 C</p></li>
<li><p>1980 C++, * 1984 Matlab, * 1986 Objective-C</p></li>
<li><p><strong>1991 Python</strong>, * 1995 Java, * 1995 Delphi</p></li>
<li><p>2006 Rust, 2009 Go, 2012 Julija</p></li>
</ul>
</section>
<section id="kdo-se-uci-python-zakaj-ga-uporabljati">
<h3>Kdo se uči Python, zakaj ga uporabljati?<a class="headerlink" href="#kdo-se-uci-python-zakaj-ga-uporabljati" title="Permalink to this heading">#</a></h3>
<p><strong>ZDA</strong></p>
<p><a class="reference external" href="http://goo.gl/mJC1P8">Python je jezik, ki se ga najpogosteje učijo na najboljših Ameriških univerzah.</a>
<img width=400 src="./fig/Top39-700.4.png"></p>
<p>Na univerzi Berkeley v <a class="reference external" href="https://youtu.be/xuNj5paMuow?t=13m18s">začetku študijskega leta 2017/18</a> (več kot 1200 študentov pri predmetu <em>Data science</em>, ki temelji na tehnologiji Jupyter notebook).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">blockquote</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;twitter-tweet&quot;</span> <span class="na">data-lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span> <span class="na">dir</span><span class="o">=</span><span class="s">&quot;ltr&quot;</span><span class="p">&gt;</span>First day of class in Foundations of <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://twitter.com/hashtag/Datascience?src=hash&quot;</span><span class="p">&gt;</span>#Datascience<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> for <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://twitter.com/BerkeleyDataSci&quot;</span><span class="p">&gt;</span>@BerkeleyDataSci<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> - all materials at <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://t.co/yyoJbaKlnL&quot;</span><span class="p">&gt;</span>https://t.co/yyoJbaKlnL<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://t.co/J6DLd0VQTl&quot;</span><span class="p">&gt;</span>pic.twitter.com/J6DLd0VQTl<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span><span class="ni">&amp;mdash;</span> Cathryn Carson (@CathrynCarson) <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://twitter.com/CathrynCarson/status/900408152348270592&quot;</span><span class="p">&gt;</span>August 23, 2017<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">blockquote</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;//platform.twitter.com/widgets.js&quot;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">First day of class in Foundations of <a href="https://twitter.com/hashtag/Datascience?src=hash">#Datascience</a> for <a href="https://twitter.com/BerkeleyDataSci">@BerkeleyDataSci</a> - all materials at <a href="https://t.co/yyoJbaKlnL">https://t.co/yyoJbaKlnL</a> <a href="https://t.co/J6DLd0VQTl">pic.twitter.com/J6DLd0VQTl</a></p>&mdash; Cathryn Carson (@CathrynCarson) <a href="https://twitter.com/CathrynCarson/status/900408152348270592">August 23, 2017</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</div></div>
</div>
<p>Python v zadnjih 10 letih pospešeno pridobiva na popularnosti in je danes eden od najboljših (<a class="reference external" href="https://spectrum.ieee.org/top-programming-languages/#toggle-gdpr">IEEE Spectrum</a>.) in tudi najpopularnejših programskih jezikov (<a class="reference external" href="https://stackoverflow.blog/2017/09/14/python-growing-quickly/">Why is Python Growing so Quickly?</a> in <a class="reference external" href="https://www.techrepublic.com/article/programming-languages-pythons-growth-is-absolutely-explosive-says-anaconda-ceo-and-not-slowing-down/">Python’s explosive growth</a>).</p>
<section id="uporaba-pythona">
<h4>Uporaba Pythona?<a class="headerlink" href="#uporaba-pythona" title="Permalink to this heading">#</a></h4>
<p>Nekatera mednarodna podjetja: <em>Nasa, Google, Cern</em>.</p>
<p>Nekatera podjetja v Sloveniji: <em>Gorenje, Kolektor, Iskra Mehanizmi, Hidria, Mahle, Domel, ebm-papst Slovenia, Efaflex…</em></p>
<p>Čedalje več programov, ki imajo vgrajeno skriptno podporo za Python: <em>Abaqus, Ansys Workbench, MSC (Adams, SimXpert), MS Excel, ParaView, LMS Siemens, AVL.</em></p>
<p>Nekateri komercialni programi v Pythonu:  <em>BitTorrent, Dropbox.</em></p>
<p>Obširni seznam je <a class="reference external" href="http://en.wikipedia.org/wiki/List_of_Python_software">tukaj</a>.</p>
</section>
<section id="python-vs-matlab">
<h4>Python vs Matlab<a class="headerlink" href="#python-vs-matlab" title="Permalink to this heading">#</a></h4>
<p>Matlab je bil v preteklosti pogosto poučevan na univerzah in imel tudi veliko uporabnikov v industriji. Že vrsto let je ekosistem Pythona za večino opravil  bistveno močnejše orodje. Na spletu boste našli ogromno primerjav, npr.: <a class="reference external" href="http://www.pyzo.org/python_vs_matlab.html">Python vs Matlab</a>.</p>
<p>Kratka primerjave glede na <a class="reference external" href="http://www.southampton.ac.uk/~fangohr/training/python/pdfs/Python-for-Computational-Science-and-Engineering-slides.pdf">vir</a>:</p>
<img width=500 src="./fig/py_comparison.png">
<p>Sintaksa je načeloma zelo podobna. Pomembna razlika je, da se indeksi pri <strong>Matlabu</strong> začnejo z 1, v <strong>Pythonu</strong> pa z 0.</p>
<p><strong>Če ste mlajši od 25-30 let, preostanek te celice verjetno lahko preskočite.</strong></p>
<p>Če niste, ste se verjetno učili Matlab in se sprašujete zakaj je v vašem klubu čedalje manj članov. Verjetno je čas za prehod na Python; tukaj prispevek, ki vam lahko pomaga: <a class="reference external" href="https://realpython.com/matlab-vs-python/">MATLAB vs Python: Why and How to Make the Switch</a>.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="namestitev-pythona">
<h2>Namestitev Pythona<a class="headerlink" href="#namestitev-pythona" title="Permalink to this heading">#</a></h2>
<p>Pojdite na <a class="reference external" href="https://www.python.org/downloads/">www.python.org</a> ter namestite Python; <em>pazite, da izberete verzijo 3.10 ali novejšo</em> (64 bit). Pri tem sledite pripravljenim <a class="reference external" href="https://youtu.be/PWSombIVVDw">video navodilom</a>.</p>
<section id="uporaba-githuba-repozitorija-in-posodobitve">
<h3>Uporaba githuba repozitorija in posodobitve<a class="headerlink" href="#uporaba-githuba-repozitorija-in-posodobitve" title="Permalink to this heading">#</a></h3>
<p>Ta knjiga se vedno dopolnjuje, zadnja verzija je dosegljiva na:</p>
<ul class="simple">
<li><p>v izvorni obliki na naslovu <a class="reference external" href="https://github.com/jankoslavic/pynm/">github.com/jankoslavic/pynm</a>,</p></li>
<li><p>v spletni obliki na naslovu <a class="reference external" href="https://jankoslavic.github.io/pynm/">https://jankoslavic.github.io/pynm</a>.</p></li>
</ul>
<p>Najbolje je za sinhronizacijo s spletnim repozitorijem uporabljati kakšnega od Git klientov, npr. <a class="reference external" href="https://desktop.github.com">GitHub Desktop</a> ali znotraj Visual Studio Code (predsatvljen v nadaljevanju). Git je sicer zelo močno orodje in skupini razvojnikov omogoča relativno enostavno delo na isti kodi in kontrolo nad različnimi verzijami datotek.</p>
</section>
<section id="visual-studio-code">
<h3>Visual Studio Code<a class="headerlink" href="#visual-studio-code" title="Permalink to this heading">#</a></h3>
<img width=500 src="./fig/vsc.png"><p>Pri tem predmetu bomo v glavnem programirali v Jupyter Lab/Notebooku znotraj <a class="reference external" href="https://code.visualstudio.com/">Visual Studio Code - VSC</a>, kar nam omogoča zelo učinkovito programiranje ob uporabi polno formatiranega besedila in interaktivnih prikazov.
Za namestitev VSC sledite <a class="reference external" href="https://youtu.be/PWSombIVVDw&amp;t=40">pripravljenim video navodilom</a>.</p>
<p>Kadar želimo programirati obsežnejše in bolj splošno uporabne pakete ter namenske programe, pa se ponavadi poslužimo še drugih funkcij, ki nam jih razvojno okolije (angl.  <em>integrated development environment</em> - IDE) VSC ponuja. V zadnjem obdobju VSC, zaradi hitrosti, enostavnosti uporabe in razširljivosti, pridobiva na priljubljenosti. Kako nam lahko VSC pomaga pri programiranju odlično prikaže video posnetek na temo <a class="reference external" href="https://www.youtube.com/watch?v=6YLMWU-5H9o">produktivnosti z VSC</a>.</p>
</section>
<section id="namescanje-dodatkov-in-posodobitev">
<h3>Nameščanje dodatkov in posodobitev<a class="headerlink" href="#namescanje-dodatkov-in-posodobitev" title="Permalink to this heading">#</a></h3>
<p>Na <a class="reference external" href="https://pypi.org">pypi.org</a> se nahaja veliko različnih paketov! Namestimo jih iz ukazne vrstice* (angl. <em>command prompt</em>) z ukazom <strong>pip</strong>.</p>
<p>* Ukazno vrstico prikličete v operacijskem sistemu Windows tako, da kliknite <code class="docutils literal notranslate"><span class="pre">&quot;Start&quot;</span></code> in napišite <code class="docutils literal notranslate"><span class="pre">&quot;command</span> <span class="pre">prompt&quot;</span></code> ter pritisnete <code class="docutils literal notranslate"><span class="pre">&quot;enter&quot;</span></code> ali pa odprete terminal znotraj VSC (<a class="reference external" href="https://youtu.be/PWSombIVVDw&amp;t=146">video</a>).</p>
<p>Podrobnosti nameščanja dodatkov si bomo pogledali naslednjič. Da boste imeli zadnjo verzijo paketov, izvedite naslednje:</p>
<ol class="arabic">
<li><p>Odprite ukazno vrstico,</p></li>
<li><p>sprožite ukaz za posodobitev paketov, ki jih bomo potrebovali tekom predmeta:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span> <span class="n">scipy</span> <span class="n">matplotlib</span> <span class="n">sympy</span> <span class="n">requests</span> <span class="n">jupyter</span> <span class="o">--</span><span class="n">upgrade</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="jupyter-notebook-jupyter-lab">
<h2>Jupyter notebook (Jupyter lab)<a class="headerlink" href="#jupyter-notebook-jupyter-lab" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://jupyter.org/">Jupyter notebook</a> je  interaktivno okolje, ki deluje kot spletna aplikacija in se lahko uporablja z različnimi programskimi jeziki (npr. Python, Julia, R, C, Fortran … iz prvih treh je nastalo tudi ime JuPyt[e]R).</p>
<p>Jupyter notebook je najlažje preizkusiti tukaj: <a class="reference external" href="https://try.jupyter.org/">try.jupyter.org</a> ali <a class="reference external" href="https://colab.research.google.com">colab.research.google.com</a>.</p>
<p><em>Jupyter notebook</em> zaženemo (v poljubni mapi) iz <em>ukazne vrstice</em> ali iz <em>Raziskovalca/Explorerja</em> z ukazom:
<code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code>,</p>
<img width=500 src="./fig/jupyter_notebook.png">
<p>ali znotraj VSC kot je predsatvljeno v <a class="reference external" href="https://youtu.be/PWSombIVVDw&amp;t=227">posnetku</a>.</p>
<p>Opombe:</p>
<ul class="simple">
<li><p>s sprožitvijo <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code> pridemo do nadgradnje <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code> okolja (rahlo bolj zahtevno okolje, vendar bistveno bolj napredno okolje),</p></li>
<li><p>tukaj predpostavimo, da je pot do datoteke jupyter[.exe] dodana v spremenljivke okolja (in jo lahko prožite iz ukazne vrstice v poljubni mapi),</p></li>
<li><p>če želite ukazno vrstico sprožiti v poljubni mapi, potem v <em>explorerju</em> pridržite <code class="docutils literal notranslate"><span class="pre">shift</span></code> in kliknite mapo z desnim gumbom; nato izberite <em>Odpri ukazno vrsticu tukaj / Open command window here</em>.</p></li>
</ul>
<p>Do Jupyter strežnika dostopamo prek spletnega brskalnika. Najprej se vam prikaže seznam map in datotek do katerih lahko dostopate v okviru mape, v kateri ste sprožili ukaz <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code>. Nato poiščite v desnem kotu zgoraj ikono <em>new</em> in nato kliknite <em>Python 3</em>. S tem boste zagnali vaš prvi Jupyter notebook (v okviru jedra Python). Najdite ukazno vrstico in na desni strani kliknite na <em>Help</em> in nato <em>User interface tour</em>. Poglejte si še <em>Help/Keyboard shortcuts</em>.</p>
<p>Jupyter notebook je sestavjen iz t. i. <em>celic</em> (angl. cell).</p>
<p>Celica ima dve stanji:</p>
<ul class="simple">
<li><p><strong>Ukazno stanje / Command mode</strong>: v to stanje se vstopi s pritiskom [escape],</p></li>
<li><p><strong>Stanje za urejanje / Edit mode</strong> v to stanje se vstopi s pritiskom [enter].</p></li>
</ul>
<p>V obeh primerih se celico izvrši s pritiskom [shift + enter].</p>
<p>Celice so lahko različnega tipa; tukaj bomo uporabljali dva tipa:</p>
<ul class="simple">
<li><p><strong>Code</strong>: v tem primeru celica vsebuje programsko kodo (bližnjica v ukaznem stanju je tipka [y]),</p></li>
<li><p><strong>Markdown</strong>: v tem primeru celica vsebuje besedilo oblikovano po standardu <em>Markdown</em> (bližnjica v ukaznem stanju je tipka [m]).</p></li>
</ul>
<section id="markdown">
<h3>Markdown<a class="headerlink" href="#markdown" title="Permalink to this heading">#</a></h3>
<p>Jupyter notebook omogoča zapis v načinu <em>markdown</em>, ki ga je v letih 2003-2004 predstavil <a class="reference external" href="https://daringfireball.net/projects/markdown/">John Gruber</a>. Namen markdowna je, da se pisec osredotoča na vsebino, pri tem pa za oblikovanje uporablja nekaj preprostih pravil. Pozneje se markdown lahko prevede v spletno obliko, v pdf (npr. prek LaTeX-a) itd. Bistvena pravila (vezana predvsem na uporabu na Githubu) so <a class="reference external" href="https://help.github.com/articles/basic-writing-and-formatting-syntax/">podana tukaj</a>; spodaj jih bomo na kratko ponovili.</p>
<p>Naslove definiramo z znakom #:</p>
<ul class="simple">
<li><p># pomeni naslov prve stopnje,</p></li>
<li><p>## pomeni naslov druge stopnje itd*.</p></li>
</ul>
<p>* Če pogledate kodo opazite, da se znak \ pojavi pred znakom # zato, da se <em>prikaže</em> sam znak # in ne uporabi njegovo funkcijo za naslov prve stopnje. Podobno je tudi pri drugih posebnih znakih.</p>
<p>Oblikovanje besedila definirajo posebni znaki; če želimo besedo (ali več besed) v <em>poševni</em> obliki, moramo tako besedilo vstaviti med dva znaka *: tekst v stanju za urejanje v obliki *primer* bi se prikazal kot <em>primer</em>.</p>
<p>Pregled simbolov, ki definirajo obliko:</p>
<ul class="simple">
<li><p><em>poševno</em>:*</p></li>
<li><p><strong>krepko</strong>: **</p></li>
<li><p>~~prečrtano~~: ~~</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simbol</span></code>: `</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">funkcije</span></code>: ``</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blok</span> <span class="pre">kode</span></code>: ```.</p></li>
</ul>
<p>Opomba: za primer bloka kode Python glejte uvodno poglavje, primer Fibonacci.</p>
<p>V okviru markdowna lahko uporabljamo tudi LaTeX sintakso. LaTeX je zelo zmogljiv sistem za urejanje besedil; na Fakulteti za strojništvo, Univerze v Ljubljani, so predloge za diplomske naloge pripravljene v <a class="reference external" href="http://lab.fs.uni-lj.si/ladisk/?what=incfl&amp;flnm=latex.php">LaTeXu</a> in Wordu. Tukaj bomo LaTeX uporabljali samo za pisanje matematičnih izrazov.</p>
<p>Poznamo dva načina:</p>
<ul class="simple">
<li><p>vrstični način (angl. <em>inline</em>): se začne in konča z znakom \<span class="math notranslate nohighlight">\(, primer: \)</span>a^3=\sqrt{365}$,</p></li>
<li><p>blokovni način (angl. <em>block mode</em>): se začne in konča z znakoma \<span class="math notranslate nohighlight">\(\\\)</span>, primer:
$<span class="math notranslate nohighlight">\(\sum F=m\,\ddot{x}\)</span>$</p></li>
</ul>
<p>Zgoraj smo že uporabljali sezname, ki jih začnemo z znakom * v novi vrstici:</p>
<ul class="simple">
<li><p>lahko pišemo sezname</p>
<ul>
<li><p>z več nivoji</p>
<ul>
<li><p>3<span class="math notranslate nohighlight">\(.\)</span> nivo</p></li>
</ul>
</li>
<li><p>2<span class="math notranslate nohighlight">\(.\)</span> nivo</p></li>
</ul>
</li>
<li><p>lahko pišemo <em>poševno</em></p></li>
<li><p>lahko pišemo <strong>krepko</strong>.</p></li>
</ul>
<p>Če želimo oštevilčene sezname, začnemo z „1.“ nato pa nadaljujemo z „1.“:</p>
<ol class="arabic simple">
<li><p>prvi element</p></li>
<li><p>drugi</p></li>
<li><p>naslednji …</p></li>
</ol>
<p>V dokument lahko vključimo tudi <em>html</em> sintakso (angl. <em>Hypertext Markup Language</em> ali po slovensko jezik za označevanje nadbesedila). Kot html najenostavneje vključimo slike.</p>
<p>Uporabimo:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">img</span> <span class="na">width</span><span class="o">=</span><span class="s">200</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./fig/ladisk.png&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Za prikaz:
<img width=200 src="./fig/ladisk.png"></p>
<p>Vključimo lahko tudi zunanje vire (npr. video posnetek iz Youtube). Ker gre za morebitno varnostno tveganje, tega ne naredimo v celici tipa <em>markdown</em> kakor zgoraj, ampak v celici tipa <em>code</em>, pri tem pa uporabimo t. i. magični ukaz (angl. <em>magic</em>) <code class="docutils literal notranslate"><span class="pre">%%html</span></code>, ki definira, da bo celoten blok v obliki html sintakse (privzeto so celice tipa <em>code</em> Python koda):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span> 
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;560&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;315&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://www.youtube.com/embed/VLcPd07-gnk&quot;</span> <span class="na">frameborder</span><span class="o">=</span><span class="s">&quot;0&quot;</span> <span class="na">allowfullscreen</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><iframe width="560" height="315" src="https://www.youtube.com/embed/VLcPd07-gnk" frameborder="0" allowfullscreen></iframe>
</div></div>
</div>
<p>Magičnih ukazov je v notebooku še veliko (glejte <a class="reference external" href="http://ipython.readthedocs.io/en/stable/interactive/magics.html">dokumentacijo</a>) in nekatere bomo spoznali pozneje, ko jih bomo potrebovali!</p>
<p>Doslej smo že večkrat uporabili sklicevanje na zunanje vire, to naredimo tako:</p>
<p><code class="docutils literal notranslate"><span class="pre">[Ime</span> <span class="pre">povezave](naslov</span> <span class="pre">do</span> <span class="pre">vira)</span></code></p>
<p>Primer: <code class="docutils literal notranslate"><span class="pre">[Spletna</span> <span class="pre">stran</span> <span class="pre">laboratorija</span> <span class="pre">Ladisk](www.ladisk.si)</span></code> se oblikuje kot: <a class="reference external" href="http:%5Cwww.ladisk.si">Spletna stran laboratorija Ladisk</a>.</p>
<p>V okviru markdowna lahko pripravimo preproste tabele. Priprava je relativno enostavna: med besede enostavno vstavimo navpične znake | tam, kjer naj bi bila navpična črta. Po naslovni vrstici sledi vrstica, ki definira poravnavo v tabeli.</p>
<p>Primer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">Ime</span>   <span class="o">|</span> <span class="n">Masa</span> <span class="p">[</span><span class="n">kg</span><span class="p">]</span>  <span class="o">|</span> <span class="n">Višina</span> <span class="p">[</span><span class="n">cm</span><span class="p">]</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">:</span><span class="o">-|-</span><span class="p">:</span><span class="o">|</span><span class="p">:</span><span class="o">-</span><span class="p">:</span><span class="o">|</span>
<span class="o">|</span> <span class="n">Lakotnik</span>  <span class="o">|</span> <span class="mi">180</span>  <span class="o">|</span> <span class="mi">140</span>  <span class="o">|</span>
<span class="o">|</span> <span class="n">Trdonja</span> <span class="o">|</span> <span class="mi">30</span>  <span class="o">|</span> <span class="mi">70</span>  <span class="o">|</span>
<span class="o">|</span> <span class="n">Zvitorepec</span>  <span class="o">|</span> <span class="mi">40</span>  <span class="o">|</span> <span class="mi">100</span>  <span class="o">|</span>
</pre></div>
</div>
<p>Rezultira v:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Ime</p></th>
<th class="head text-right"><p>Masa [kg]</p></th>
<th class="head text-center"><p>Višina [cm]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Lakotnik</p></td>
<td class="text-right"><p>180</p></td>
<td class="text-center"><p>140</p></td>
</tr>
<tr class="row-odd"><td><p>Trdonja</p></td>
<td class="text-right"><p>30</p></td>
<td class="text-center"><p>70</p></td>
</tr>
<tr class="row-even"><td><p>Zvitorepec</p></td>
<td class="text-right"><p>40</p></td>
<td class="text-center"><p>100</p></td>
</tr>
</tbody>
</table>
<p>Opazimo, da dvopičje definira poravnavo teksta v stolpcu (levo <code class="docutils literal notranslate"><span class="pre">:-</span></code>, desno <code class="docutils literal notranslate"><span class="pre">-:</span></code> ali sredinsko <code class="docutils literal notranslate"><span class="pre">:-:</span></code>).</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="prvi-program-in-pep">
<h2>Prvi program in PEP<a class="headerlink" href="#prvi-program-in-pep" title="Permalink to this heading">#</a></h2>
<p>Sedaj smo pripravljeni na prvi program napisan v Pythonu:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>Program lahko zapišemo v poljubnem urejevalniku tekstovnih datotek (npr. <em>Beležka</em>/<em>Notepad</em>) in ga shranimo v datoteko <code class="docutils literal notranslate"><span class="pre">ime.py</span></code>.</p>
<p>Primer <a class="reference download internal" download="" href="_downloads/31868195a960622f85d0c8b9ba4236b5/prvi_program.py"><span class="xref download myst">kode</span></a> v okolju <em>Visual Studio Code</em>:
<img width=400 src="./fig/vsc_prvi_program.png"></p>
<p>To datoteko nato poženemo v ukazni vrstici (predpostavimo, da je pot do datoteke python.exe dodana v spremenljivke okolja, sicer glejte tale <a class="reference external" href="https://docs.python.org/3/using/windows.html#configuring-python">vir</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">ime</span><span class="o">.</span><span class="n">py</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mf">5.0</span>
</pre></div>
</div>
<p>Z znaki <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> označimo rezultat, ki ga dobimo v ukazni vrstici.</p>
<p>Zgornji primer izvajanja Python programa predstavlja t. i. <em>klasični način poganjanja programov</em> od začetka do konca. Tukaj bomo bolj pogosto uporabljali t. i. <em>interaktivni način</em>, ko kodo izvajamo znotraj posamezne celice tipa <em>code</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">5.0</span>  <span class="c1"># to je komentar</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># izpiše vrednost a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<section id="pep-python-enhancements-proposal">
<h3>PEP - Python Enhancements Proposal<a class="headerlink" href="#pep-python-enhancements-proposal" title="Permalink to this heading">#</a></h3>
<p>Python ima visoke standarde glede kakovosti in estetike. Že zgodaj v razvoju jezika se je uveljavil princip predlaganja izboljšav prek t. i. <em>Python Enhancements Proposal</em> (PEP na kratko).</p>
<section id="pep8">
<h4>PEP8<a class="headerlink" href="#pep8" title="Permalink to this heading">#</a></h4>
<p>Eden od bolj pomembnih je <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a>, ki definira stil:</p>
<ul class="simple">
<li><p>zamik: 4 presledki,</p></li>
<li><p>en presledek pri operatorju <code class="docutils literal notranslate"><span class="pre">=</span></code>, torej: <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">5</span></code> in ne <code class="docutils literal notranslate"><span class="pre">a=5</span></code>,</p></li>
<li><p>spremenljivke in imena funkcij naj bodo opisne, pišemo jih s podčrtajem: <code class="docutils literal notranslate"><span class="pre">širina_valja</span> <span class="pre">=</span> <span class="pre">5</span></code>,</p></li>
<li><p>za razrede uporabljamo t. i. format CamelCase.</p></li>
</ul>
<ul class="simple">
<li><p>pri aritmetičnih operaterjih postavimo presledke po občutku: <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">3*a</span> <span class="pre">+</span> <span class="pre">4*b</span></code> ali <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">*</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">4</span> <span class="pre">*</span> <span class="pre">b</span></code>,</p></li>
<li><p>za oklepajem in pred zaklepajem ni presledka, prav tako ni presledka pred oklepajem ob klicu funkcije: <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">sin(x)</span></code>, ne pa <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">sin(</span> <span class="pre">x</span> <span class="pre">)</span></code> ali <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">sin</span> <span class="pre">(x)</span></code>,</p></li>
<li><p>presledek za vejico: <code class="docutils literal notranslate"><span class="pre">range(5,</span> <span class="pre">10)</span></code> in ne <code class="docutils literal notranslate"><span class="pre">range(5,10)</span></code>,</p></li>
<li><p>brez presledkov na koncu vrstice ali v prazni vrstici,</p></li>
</ul>
<ul class="simple">
<li><p>znotraj funkcije lahko občasno dodamo po <em>eno</em> prazno vrstico,</p></li>
<li><p>med funkcije postavimo dve prazni vrstici,</p></li>
<li><p>vsak modul uvozimo (<code class="docutils literal notranslate"><span class="pre">import</span></code>) v ločeni vrstici,</p></li>
<li><p>najprej uvozimo standardne pythonove knjižnice, nato druge knjižnice (npr. numpy) in na koncu lastne.</p></li>
</ul>
<p>Opomba: moderna razvojna orodja nam pomagajo pri oblikovanju kode, ki ustreza PEP8 (v VSC pritisnite <code class="docutils literal notranslate"><span class="pre">ctrl</span></code>+<code class="docutils literal notranslate"><span class="pre">shift</span></code>+<code class="docutils literal notranslate"><span class="pre">P</span></code> ter napišite <em>„Format document“</em> in pritisnite <code class="docutils literal notranslate"><span class="pre">enter</span></code>)!</p>
</section>
<section id="pep20">
<h4>PEP20<a class="headerlink" href="#pep20" title="Permalink to this heading">#</a></h4>
<p><a class="reference external" href="https://www.python.org/dev/peps/pep-0020/">PEP20</a> je naslednji pomemben PEP, ki se imenuje tudi <em>The zen of Python</em>, torej <em>zen Pythona</em>; to so vodila, ki se jih poskušamo držati pri programiranju. Tukaj navedimo samo nekatera vodila:</p>
<ul class="simple">
<li><p>Lepo je bolje kot grdo.</p></li>
<li><p>Preprosto je bolje kot zakomplicirano.</p></li>
<li><p>Premočrtno je bolje kot gnezdeno.</p></li>
<li><p>Berljivost je pomembna.</p></li>
<li><p>Posebni primeri niso dovolj posebni, da bi prekršili pravilo</p></li>
<li><p>Če je implementacijo težko pojasniti, je verjetno slaba ideja; če jo je lahko, je mogoče dobra.</p></li>
</ul>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="osnove-pythona">
<h2>Osnove Pythona<a class="headerlink" href="#osnove-pythona" title="Permalink to this heading">#</a></h2>
<section id="osnovni-podatkovni-tipi-in-operatorji">
<h3>Osnovni podatkovni tipi in operatorji<a class="headerlink" href="#osnovni-podatkovni-tipi-in-operatorji" title="Permalink to this heading">#</a></h3>
<section id="dinamicno-tipiziranje">
<h4>Dinamično tipiziranje<a class="headerlink" href="#dinamicno-tipiziranje" title="Permalink to this heading">#</a></h4>
<p>Python	je	dinamično	tipiziran jezik. Tipi	spremenljivk	se	ne	preverjajo. Posledično nekatere operacije niso mogoče na nekaterih tipih oz. so prilagojene tipu podatka (pozneje bomo na primer pogledali množenje niza črk). Tip se določi pri dodelitvi vrednosti, poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># to je komentar: a je celo število (integer)</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Tip prikažemo z ukazom <code class="docutils literal notranslate"><span class="pre">type</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>int
</pre></div>
</div>
</div>
</div>
<p>Vrednost <code class="docutils literal notranslate"><span class="pre">a</span></code> lahko prepišemo z novo vrednostjo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># to je sedaj število s plavajočo vejico (float)</span>
<span class="n">a</span>        <span class="c1"># če `a` tako zapišemo v zadnji vrstici, se bo izpisala vrednost </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>float
</pre></div>
</div>
</div>
</div>
<p>Za izpis vrednosti sicer lahko uporabimo tudi funkcijo <code class="docutils literal notranslate"><span class="pre">print()</span></code>, ki jo bomo podrobneje spoznali pozneje:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Dokumentacijo funkcije lahko kličemo s pritiskom [shift + tab]. Npr: napišemo <code class="docutils literal notranslate"><span class="pre">pri</span></code> in pritisnemo [shift + tab] ter se bo v pojavnem oknu prikazala pomoč; če pridržimo [shift], se z dodatnim pritiskom na [tab] prikaže razširjena pomoč, z nadaljnjim dvojnim pritiskom [tab] (skupaj torej 4-krat) se pomoč prikaže v novem oknu.</p>
<p>Do pomoči dostopamo tudi, tako, da pred funkcijo postavimo <code class="docutils literal notranslate"><span class="pre">?</span></code> (za pomoč) ali <code class="docutils literal notranslate"><span class="pre">??</span></code> (prikaže tudi izvorno kodo, če je ta na voljo).</p>
<p>Primer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>?print
??print
</pre></div>
</div>
</section>
<section id="logicni-operatorji">
<h4>Logični operatorji<a class="headerlink" href="#logicni-operatorji" title="Permalink to this heading">#</a></h4>
<p>Logični operatorji so (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#boolean-operations-and-or-not">vir</a>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">or</span></code>, primer: <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">or</span> <span class="pre">b</span></code>; opomba: drugi element se preverja samo, če prvi ni res,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">and</span></code>, primer: <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">and</span> <span class="pre">b</span></code>; opomba: drugi element se preverja samo, če prvi je res,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">not</span></code>, primer: <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">a</span></code>; opomba: ne-logični operatorji imajo prednost: <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code> se interpretira kot <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">(a</span> <span class="pre">==</span> <span class="pre">b)</span></code>.</p></li>
</ul>
</section>
<section id="primerjalni-operatorji">
<h4>Primerjalni operatorji<a class="headerlink" href="#primerjalni-operatorji" title="Permalink to this heading">#</a></h4>
<p>Primerjalni operatorji (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#comparisons">vir</a>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code> manj kot,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>	manj ali enako,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code> večje kot,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> večje ali enako,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">==</span></code> enako,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!=</span></code> neenako,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is</span></code> istost objekta primerjanih operandov,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">not</span></code> ali operanda nista isti objekt.</p></li>
</ul>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span> <span class="o">&lt;</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Lahko naredimo niz logičnih operatorjev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="mi">6</span> <span class="o">&lt;</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>preverimo istost (ali gre za isti objekt):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Uporabimo še logični operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="mi">6</span> <span class="o">&lt;</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="ow">not</span> <span class="mi">6</span> <span class="o">&lt;</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Tukaj velja izpostaviti, da je v logičnih izrazih poleg <code class="docutils literal notranslate"><span class="pre">False</span></code> neresnična tudi vrednost <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>, prazen seznam (ali niz, terka, …); <strong>vse ostalo je <code class="docutils literal notranslate"><span class="pre">True</span></code></strong>.</p>
<p>Poglejmo nekaj primerov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="ow">and</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="ow">and</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="ow">and</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="podatkovni-tipi-za-numericne-vrednosti">
<h4>Podatkovni tipi za numerične vrednosti<a class="headerlink" href="#podatkovni-tipi-za-numericne-vrednosti" title="Permalink to this heading">#</a></h4>
<p>Pogledali si bomo najbolj pogoste podatkovne tipe, ki jih bomo pozneje uporabili (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#numeric-types-int-float-complex">vir</a>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> za zapis poljubno velikega celega števila,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code> za zapis števil s plavajočo vejico,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">complex</span></code> za zapis števil v kompleksni obliki.</p></li>
</ul>
<p>Bolj podrobno bomo podatkovne tipe (natančnost zapisa in podobno) spoznali pri uvodu v numerične metode.</p>
<p>Primeri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">celo_število</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="mi">3000</span>         <span class="c1"># `**` predstavlja potenčni operator</span>
<span class="n">racionalno_število</span> <span class="o">=</span> <span class="mf">3.141592</span>
<span class="n">kompleksno_število</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="n">j</span>     <span class="c1"># `3j` predstavlja imaginarni del</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="operatorji-numericnih-vrednosti">
<h4>Operatorji numeričnih vrednosti<a class="headerlink" href="#operatorji-numericnih-vrednosti" title="Permalink to this heading">#</a></h4>
<p>Podatkovni tipi razvrščeni po naraščajoči prioriteti (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#numeric-types-int-float-complex">vir</a>):</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span></code> vsota,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">-</span> <span class="pre">y</span></code>razlika,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span></code> produkt,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">/</span> <span class="pre">y</span></code> deljenje,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">//</span> <span class="pre">y</span></code> celoštevilsko deljenje (rezultat je celo število zaokroženo navzdol),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">%</span> <span class="pre">y</span></code> ostanek pri celoštevilskem deljenju,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-x</span></code> negiranje,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+x</span></code> nespremenjen,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abs(x)</span></code> absolutna vrednost,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x)</span></code> celo število tipa <code class="docutils literal notranslate"><span class="pre">int</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float(x)</span></code> racionalno število tipa <code class="docutils literal notranslate"><span class="pre">float</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">complex(re,</span> <span class="pre">im)</span></code> compleksno število tipa <code class="docutils literal notranslate"><span class="pre">complex</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c.conjugate()</span></code> kompleksno konjugirano število,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">divmod(x,</span> <span class="pre">y)</span></code> vrne par <code class="docutils literal notranslate"><span class="pre">(x</span> <span class="pre">//</span> <span class="pre">y,</span> <span class="pre">x</span> <span class="pre">%</span> <span class="pre">y)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pow(x,</span> <span class="pre">y)</span></code> vrne <code class="docutils literal notranslate"><span class="pre">x</span></code> na potenco <code class="docutils literal notranslate"><span class="pre">y</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">**</span> <span class="pre">y</span></code>	vrne <code class="docutils literal notranslate"><span class="pre">x</span></code> na potenco <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
</ol>
<p>Pri aritmetičnih operatorjih velja izpostaviti različico, pri kateri se rezultat priredi operandu (<a class="reference external" href="https://docs.python.org/3/reference/simple_stmts.html#augmented-assignment-statements">vir</a>). To imenujemo <em>razširjena dodelitev</em> (angl. *augmented assignement).</p>
<p>Poglejmo si primer. Namesto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># prištejemo vrednost 1</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>lahko zapišemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span> 
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
</section>
<section id="operatorji-na-nivoju-bitov">
<h4>Operatorji na nivoju bitov<a class="headerlink" href="#operatorji-na-nivoju-bitov" title="Permalink to this heading">#</a></h4>
<p>Operatorje na nivoju bitov bomo v inženirski praksi redko uporabljali, vseeno jih navedimo po naraščajoči prioriteti (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bitwise-operations-on-integer-types">vir</a>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">|</span> <span class="pre">y</span></code> <em>ali</em> na nivoju bitov <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">^</span> <span class="pre">y</span></code> <em>ekskluzivni ali</em> (samo en, ne oba) na nivoju bitov <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&amp;</span> <span class="pre">y</span></code> bitni <em>in</em> na nivoju bitov <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;&lt;</span> <span class="pre">n</span></code> premik bitov <code class="docutils literal notranslate"><span class="pre">x</span></code> za <code class="docutils literal notranslate"><span class="pre">n</span></code> bitov levo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&gt;&gt;</span> <span class="pre">n</span></code> premik bitov <code class="docutils literal notranslate"><span class="pre">x</span></code> za <code class="docutils literal notranslate"><span class="pre">n</span></code> bitov desno,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">~x</span></code> negiranje bitov <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
<p>Poglejmo si primer (<a class="reference external" href="https://www.tutorialspoint.com/python/bitwise_operators_example.htm">vir</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">21</span>  <span class="c1"># 21 v bitni obliki: 0001 0101 </span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">9</span>   <span class="c1"># 9 v bitni obliki:  0000 1001 </span>

<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span><span class="p">;</span> <span class="c1"># 0000 0001 v bitni obliki predstavlja število 1 v decimalni</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Prikažimo število v bitni obliki:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">bin</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0b1&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="sestavljene-podatkovne-strukture">
<h3>Sestavljene podatkovne strukture<a class="headerlink" href="#sestavljene-podatkovne-strukture" title="Permalink to this heading">#</a></h3>
<section id="niz-string">
<h4>Niz (string)<a class="headerlink" href="#niz-string" title="Permalink to this heading">#</a></h4>
<p>Niz je sestavljen iz znakov po standardu <em>Unicode</em>. V podrobnosti se ne bomo spuščali; pomembno je navesti, da je Python od verzije 3 naprej naredil velik napredek (<a class="reference external" href="https://docs.python.org/3/howto/unicode.html">vir</a>) in da lahko poljubne znake po standardu <em>Unicode</em> uporabimo tako v tekstu, kakor tudi v programskih datotekah .py.</p>
<p>Niz se začne in zaključi z dvojnim “ ali enojnim ‚ narekovajem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;tekst&#39;</span> <span class="c1"># b je niz (string)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;tekst&#39;
</pre></div>
</div>
</div>
</div>
<p>Pri tem ni težav z imeni, ki smo jih bolj vajeni:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">π</span> <span class="o">=</span> <span class="mf">3.14</span>
</pre></div>
</div>
</div>
</div>
<p>Znak <span class="math notranslate nohighlight">\(\pi\)</span> se v notebooku zapiše, da napišemo <code class="docutils literal notranslate"><span class="pre">\pi</span></code> (imena so ponavadi ista kot se uporabljajo pri zapisu v LaTeXu) in nato pritisnemo [tab].</p>
<p>Nekatere operacije nad nizi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kratek &#39;</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="c1"># seštevanje</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="s1">&#39;To je množenje niza. &#39;</span><span class="p">)</span>      <span class="c1"># množenje niza</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Celo število:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">))</span>      <span class="c1"># pretvorba niza &#39;5&#39; v celo število</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Število s plavajočo vejico:&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">))</span>  <span class="c1"># pretvorba niza &#39;5&#39; v število s plavajo vejico</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>kratek tekst
To je množenje niza. To je množenje niza. To je množenje niza. 
Celo število: 10
Število s plavajočo vejico: 10.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="terka-tuple">
<h4>Terka (tuple)<a class="headerlink" href="#terka-tuple" title="Permalink to this heading">#</a></h4>
<p>Tuples (<a class="reference external" href="https://docs.python.org/tutorial/datastructures.html#tuples-and-sequences">vir</a>) ali po slovensko terke so seznami poljubnih <strong>objektov</strong>, ki jih ločimo z vejico in pišemo znotraj okroglih oklepajev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terka_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;programiranje&#39;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terka_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, &#39;programiranje&#39;, 5.0)
</pre></div>
</div>
</div>
</div>
<p>Večkrat smo že uporabili besedo <em>objekt</em>. Kaj je objekt? Objekte in razrede si bomo podrobneje pogledali pozneje; zaenkrat se zadovoljimo s tem, da je objekt več kot samo <em>ime</em> za določeno vrednost; objekt ima tudi metode.
Npr. drugi element je tipa <code class="docutils literal notranslate"><span class="pre">str</span></code>, ki ima tudi metodo <code class="docutils literal notranslate"><span class="pre">replace</span></code> za zamenjavo črk:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terka_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;p8og8ami8anje&#39;
</pre></div>
</div>
</div>
</div>
<p>Če ima terka samo en objekt, potem jo moramo zaključiti z vejico (sicer se ne loči od objekta v oklepaju):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terka_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">terka_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tuple
</pre></div>
</div>
</div>
</div>
<p>Terke lahko zapišemo tudi brez okroglih oklepajev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terka_3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;brez oklepajev&#39;</span><span class="p">,</span> <span class="mf">5.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terka_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, &#39;brez oklepajev&#39;, 5.0)
</pre></div>
</div>
</div>
</div>
<p>Do objektov v terki dostopamo prek indeksa (<strong>se začnejo z 0</strong>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terka_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Terke <strong>ni mogoče spreminjati</strong> (angl: <em>immutable</em>), elementov ne moremo odstranjevati ali dodajati. Klicanje spodnjega izraza bi vodilo v napako:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">terka_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;tuple&#39;</span> <span class="nb">object</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">support</span> <span class="n">item</span> <span class="n">assignment</span>
</pre></div>
</div>
</section>
<section id="seznam-list">
<h4>Seznam (list)<a class="headerlink" href="#seznam-list" title="Permalink to this heading">#</a></h4>
<p>Seznami (<a class="reference external" href="https://docs.python.org/tutorial/datastructures.html#more-on-lists">vir</a>) se zapišejo podobno kot terke, vendar se uporabijo oglati oklepaji:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.0, 2, &#39;d&#39;]
</pre></div>
</div>
</div>
</div>
<p>Za razliko od terk, se sezname lahko spreminja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[10, 2, &#39;d&#39;]
</pre></div>
</div>
</div>
</div>
<p>Seznami so spremenljivi (angl. <em>mutable</em>) in treba se je zavedati, da <strong>ime</strong> v bistvu <strong>kaže</strong> na mesto v pomnilniku računalnika:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">seznam</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[10, 2, &#39;d&#39;]
</pre></div>
</div>
</div>
</div>
<p>Sedaj tudi <code class="docutils literal notranslate"><span class="pre">b</span></code> kaže na isto mesto v pomnilniku.</p>
<p>Poglejmo, kaj se zgodi s <code class="docutils literal notranslate"><span class="pre">seznam</span></code>, če spremenimo element seznama <code class="docutils literal notranslate"><span class="pre">b</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[9, 2, &#39;d&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[9, 2, &#39;d&#39;]
</pre></div>
</div>
</div>
</div>
<p>Če želimo narediti kopijo podatkov, potem moramo narediti tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">seznam</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[99, 2, &#39;d&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[9, 2, &#39;d&#39;]
</pre></div>
</div>
</div>
</div>
<p>Primer seznama seznamov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrika</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrika</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1, 2, 3], [4, 5, 6], [7, 8, 9]]
</pre></div>
</div>
</div>
</div>
<p>Več o matrikah bomo izvedeli pozneje.</p>
<section id="izbrane-operacije-nad-seznami">
<h5>Izbrane operacije nad seznami<a class="headerlink" href="#izbrane-operacije-nad-seznami" title="Permalink to this heading">#</a></h5>
<p>Tukaj si bomo pogledali nekatere najbolj pogoste operacije, za več, glejte <a class="reference external" href="https://docs.python.org/tutorial/datastructures.html">dokumentacijo</a>.</p>
<p>Najprej si poglejmo dodajanje elementa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">]</span>
<span class="n">seznam</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;dodajanje elementa&#39;</span><span class="p">)</span>
<span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, &#39;test&#39;, &#39;dodajanje elementa&#39;]
</pre></div>
</div>
</div>
</div>
<p>Potem vstavljanje na določeno mesto (z indeksom 1, ostali elementi se zamaknejo):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;na drugo mesto&#39;</span><span class="p">)</span>
<span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, &#39;na drugo mesto&#39;, 1, &#39;test&#39;, &#39;dodajanje elementa&#39;]
</pre></div>
</div>
</div>
</div>
<p>Potem lahko določeni element odstranimo. To naredimo s <code class="docutils literal notranslate"><span class="pre">seznam.pop(i)</span></code> ali <code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">seznam[2]</span></code>. Prvi način vrne odstranjeni element, drugi samo odstrani element:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odstranjeni_element</span> <span class="o">=</span> <span class="n">seznam</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># odstani element z indeksom 2 in ga vrne </span>
<span class="c1"># podoben učinek bi imel ukaz: del seznam[2]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;seznam:&#39;</span><span class="p">,</span> <span class="n">seznam</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;odstranjeni element:&#39;</span><span class="p">,</span> <span class="n">odstranjeni_element</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>seznam: [0, &#39;na drugo mesto&#39;, &#39;test&#39;, &#39;dodajanje elementa&#39;]
odstranjeni element: 1
</pre></div>
</div>
</div>
</div>
<p>Z metodo <code class="docutils literal notranslate"><span class="pre">.index(v)</span></code> najdemo prvi element vrednosti <code class="docutils literal notranslate"><span class="pre">v</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, &#39;na drugo mesto&#39;, &#39;test&#39;, &#39;dodajanje elementa&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
</section>
<section id="zakaj-uporabiti-terko-in-ne-seznama">
<h5>Zakaj uporabiti terko in ne seznama?<a class="headerlink" href="#zakaj-uporabiti-terko-in-ne-seznama" title="Permalink to this heading">#</a></h5>
<p>Terk ne moremo spreminjati, zato je njihova numerična implementacija bistveno bolj lahka (v numeričnem smislu) in spomin se lahko bolje izrabi. Posledično so terke <strong>hitrejše</strong> od seznamov; poleg tega jih ne moretmo po nerodnosti <strong>spremeniti</strong>. Za širši odgovor glejte <a class="reference external" href="http://getpython3.com/diveintopython3/native-datatypes.html#tuples">vir</a>.</p>
</section>
</section>
<section id="mnozice-sets">
<h4>Množice (Sets)<a class="headerlink" href="#mnozice-sets" title="Permalink to this heading">#</a></h4>
<p>Množice so v principu podobne <em>množicam</em> kot jih poznamo iz matematike. Množice v Pythonu (<a class="reference external" href="https://docs.python.org/tutorial/datastructures.html#sets">dokumentacija</a>) za razliko od ostalih sestavljenih struktur:</p>
<ul class="simple">
<li><p><strong>ne dovoljujejo podvojenih elementov</strong> in</p></li>
<li><p><strong>nimajo urejenega vrstnega reda</strong> (pomembno, npr. za pravilno uporabo v zankah).</p></li>
</ul>
<p>Vredno je poudariti, da sta dodajanje in ugotavljanje pripadnosti elementa množici zelo hitri operaciji.</p>
<p>Kreiramo jih z zavitimi oklepaji  <code class="docutils literal notranslate"><span class="pre">{}</span></code> ali ukazom <code class="docutils literal notranslate"><span class="pre">set()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ž&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{2, 3, 4, &#39;a&#39;, &#39;ž&#39;}
</pre></div>
</div>
</div>
</div>
<p>Če se želimo v seznamu znebiti podvojenih elementov, je zelo enostaven način, da kreiramo množico iz seznama:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{4, 6}
</pre></div>
</div>
</div>
</div>
<p>Uporabimo lahko tipične matematične operacije nad množicami:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span>   <span class="c1"># elementi v B brez elementov, ki so tudi v A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{6}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">|</span> <span class="n">B</span>   <span class="c1"># elementi v A ali B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{2, 3, 4, 6, &#39;a&#39;, &#39;ž&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">&amp;</span> <span class="n">B</span>   <span class="c1"># elementi v A in B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{4}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">^</span> <span class="n">B</span>   <span class="c1"># elementi v A ali B, vendar ne v obeh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{2, 3, 6, &#39;a&#39;, &#39;ž&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="slovar-dictionary">
<h4>Slovar (dictionary)<a class="headerlink" href="#slovar-dictionary" title="Permalink to this heading">#</a></h4>
<p>Slovar (<a class="reference external" href="https://docs.python.org/tutorial/datastructures.html#dictionaries">dokumentacija</a>) lahko definiramo eksplicitno s pari <em>ključ : vrednost</em>, ločenimi z vejico znotraj zavitih oklepajev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametri</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;višina&#39;</span><span class="p">:</span> <span class="mf">5.2</span><span class="p">,</span> <span class="s1">&#39;širina&#39;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mf">9.81</span><span class="p">}</span>
<span class="n">parametri</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;višina&#39;: 5.2, &#39;širina&#39;: 43, &#39;g&#39;: 9.81}
</pre></div>
</div>
</div>
</div>
<p>Do vrednosti (angl. <em>value</em>) elementa dostopamo tako, da uporabimo ključ (angl. <em>key</em>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametri</span><span class="p">[</span><span class="s1">&#39;višina&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.2
</pre></div>
</div>
</div>
</div>
<p>Pogosteje uporabljamo metode:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">values()</span></code>, ki vrne vrednosti slovarja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keys()</span></code>, ki vrne ključe slovarja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">items()</span></code>, ki seznam terk (ključ, vrednost); to bomo pogosto rabili pri zankah.</p></li>
</ul>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametri</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_items([(&#39;višina&#39;, 5.2), (&#39;širina&#39;, 43), (&#39;g&#39;, 9.81)])
</pre></div>
</div>
</div>
</div>
<p>Slovarje lahko spreminjamo; npr. dodamo element:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametri</span><span class="p">[</span><span class="s1">&#39;lega_težišča&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99999</span>
<span class="n">parametri</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;višina&#39;: 5.2, &#39;širina&#39;: 43, &#39;g&#39;: 9.81, &#39;lega_težišča&#39;: 99999}
</pre></div>
</div>
</div>
</div>
<p>Elemente odstranimo (podobno kot zgoraj <code class="docutils literal notranslate"><span class="pre">pop</span></code> odstrani in vrne vrednost <code class="docutils literal notranslate"><span class="pre">del</span></code> samo odstrani):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametri</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lega_težišča&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametri</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;višina&#39;: 5.2, &#39;širina&#39;: 43, &#39;g&#39;: 9.81}
</pre></div>
</div>
</div>
</div>
</section>
<section id="operacije-nad-sestavljenimi-podatkovnimi-strukturami">
<h4>Operacije nad sestavljenimi podatkovnimi strukturami<a class="headerlink" href="#operacije-nad-sestavljenimi-podatkovnimi-strukturami" title="Permalink to this heading">#</a></h4>
<p>Večina sestavljenih podatkovnih struktur dovoljuje sledeče operacije (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#common-sequence-operations">dokumentacija</a>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">s</span></code> vrne <code class="docutils literal notranslate"><span class="pre">True</span></code>, če je kateri element iz <code class="docutils literal notranslate"><span class="pre">s</span></code> enak <code class="docutils literal notranslate"><span class="pre">x</span></code>, sicer vrne <code class="docutils literal notranslate"><span class="pre">False</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">s</span></code> vrne <code class="docutils literal notranslate"><span class="pre">False</span></code>, če je kateri element iz <code class="docutils literal notranslate"><span class="pre">s</span></code> enak <code class="docutils literal notranslate"><span class="pre">x</span></code>, sicer vrne <code class="docutils literal notranslate"><span class="pre">True</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">+</span> <span class="pre">t</span></code> sestavi <code class="docutils literal notranslate"><span class="pre">s</span></code> in <code class="docutils literal notranslate"><span class="pre">t</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">*</span> <span class="pre">n</span></code> ali <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">*</span> <span class="pre">s</span></code> rezultira v <code class="docutils literal notranslate"><span class="pre">n</span></code>-krat ponovljen <code class="docutils literal notranslate"><span class="pre">s</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s[i]</span></code> vrne <code class="docutils literal notranslate"><span class="pre">i</span></code>-ti element iz <code class="docutils literal notranslate"><span class="pre">s</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s[i:j]</span></code> vrne <code class="docutils literal notranslate"><span class="pre">s</span></code> od elementa <code class="docutils literal notranslate"><span class="pre">i</span></code> (vključno) do <code class="docutils literal notranslate"><span class="pre">j</span></code> (ni vključen),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s[i:j:k]</span></code> rezanje <code class="docutils literal notranslate"><span class="pre">s</span></code> od elementa <code class="docutils literal notranslate"><span class="pre">i</span></code> do <code class="docutils literal notranslate"><span class="pre">j</span></code>	po koraku <code class="docutils literal notranslate"><span class="pre">k</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len(s)</span></code> vrne dolžino <code class="docutils literal notranslate"><span class="pre">s</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min(s)</span></code> vrne najmanjši element iz <code class="docutils literal notranslate"><span class="pre">s</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max(s)</span></code> vrne največji element iz <code class="docutils literal notranslate"><span class="pre">s</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s.index(x[,</span> <span class="pre">i[,</span> <span class="pre">j]])</span></code> vrne indeks prve pojave <code class="docutils literal notranslate"><span class="pre">x</span></code> v <code class="docutils literal notranslate"><span class="pre">s</span></code> (od indeksa <code class="docutils literal notranslate"><span class="pre">i</span></code> do <code class="docutils literal notranslate"><span class="pre">j</span></code>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s.count(x)</span></code> vrne število elementov.</p></li>
</ul>
<p>Nekateri primeri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="s1">&#39;abc&#39;</span> <span class="c1"># in primerja ali je objekt v nizu, seznamu,...</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Zgoraj smo imeli seznam <code class="docutils literal notranslate"><span class="pre">parametri</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mf">9.81</span><span class="p">,</span> <span class="s1">&#39;višina&#39;</span><span class="p">:</span> <span class="mf">5.2</span><span class="p">,</span> <span class="s1">&#39;širina&#39;</span><span class="p">:</span> <span class="mi">43</span><span class="p">}</span>
</pre></div>
</div>
<p>Preverimo, ali vsebuje element s ključem <code class="docutils literal notranslate"><span class="pre">širina</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;širina&#39;</span> <span class="ow">in</span> <span class="n">parametri</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="stetje-in-rezanje-sestavljenih-podatkovnih-struktur">
<h4>Štetje in rezanje sestavljenih podatkovnih struktur<a class="headerlink" href="#stetje-in-rezanje-sestavljenih-podatkovnih-struktur" title="Permalink to this heading">#</a></h4>
<p>Predpostavimo spodnji niz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abeceda</span> <span class="o">=</span> <span class="s1">&#39;abcčdefghijklmnoprsštuvzž&#39;</span>
</pre></div>
</div>
</div>
</div>
<p><strong>V Pythonu začnemo šteti indekse z 0</strong>! Na spletu lahko najdete razprave o tem ali je prav, da se indeksi začnejo z 0 ali 1. Zakaj začeti z 0 zelo lepo pojasni prof. dr. Janez Demšar v knjigi Python za programerje (<a class="reference external" href="https://ucilnica.fri.uni-lj.si/file.php/166/Python%20za%20programerje.pdf">vir</a>, stran 28) ali pa tudi prof. dr. Edsger W. Dijkstra v zapisu na <a class="reference external" href="http://www.cs.utexas.edu/users/EWD/transcriptions/EWD08xx/EWD831.html">spletu</a>.</p>
<p>Rezanje imenujemo operacijo, ko iz seznama izrežemo določene člene.</p>
<p>Splošno pravilo je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">:</span><span class="n">k</span><span class="p">]</span>
</pre></div>
</div>
<p>kar pomeni, da se seznam <code class="docutils literal notranslate"><span class="pre">s</span></code> razreže od elementa <code class="docutils literal notranslate"><span class="pre">i</span></code> do <code class="docutils literal notranslate"><span class="pre">j</span></code>	po koraku <code class="docutils literal notranslate"><span class="pre">k</span></code>. Če katerega elementa ne podamo potem se uporabi (logična) vrednost:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> je privzeto 0, kar pomeni prvi element,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">j</span></code> je privzeto -1, kar pomeni zadnji element,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> je privzeto 1.</p></li>
</ul>
<p>Prvi znak je torej:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abeceda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;a&#39;
</pre></div>
</div>
</div>
</div>
<p>Prvi trije znaki so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abeceda</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;abc&#39;
</pre></div>
</div>
</div>
</div>
<p>Od prvih 15 znakov, vsak tretji je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abeceda</span><span class="p">[:</span><span class="mi">15</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;ačfil&#39;
</pre></div>
</div>
</div>
</div>
<p>Zadnjih petnajst znakov, vsak tretji:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abeceda</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;jmpšv&#39;
</pre></div>
</div>
</div>
</div>
<p>Ko želimo obrniti vrstni red, lahko to naredimo tako (beremo od začetka do konca po koraku -1, kar pomeni od konca proti začetku s korakom 1:)):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abeceda</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;žzvutšsrponmlkjihgfedčcba&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="kontrola-toka-programa">
<h3>Kontrola toka programa<a class="headerlink" href="#kontrola-toka-programa" title="Permalink to this heading">#</a></h3>
<p>Pogledali si bomo nekatera osnovna orodja za kontrolo toka izvajanja programa (<a class="reference external" href="https://docs.python.org/tutorial/controlflow.html">dokumentacija</a>).</p>
<section id="stavek-if">
<h4>Stavek <code class="docutils literal notranslate"><span class="pre">if</span></code><a class="headerlink" href="#stavek-if" title="Permalink to this heading">#</a></h4>
<p>Tipična oblika stavka <code class="docutils literal notranslate"><span class="pre">if</span></code> (<a class="reference external" href="https://docs.python.org/tutorial/controlflow.html#if-statements">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">pogoj0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Izpolnjen je bil pogoj0&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">pogoj1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Izpolnjen je bil pogoj1&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">pogoj2</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Izpolnjen je bil pogoj2&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Noben pogoj ni bil izpolnjen&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">6</span>
<span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a je več od 5&#39;</span><span class="p">)</span> <span class="c1"># se izvede, če je pogoj res. </span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a je več od 5
-------------
</pre></div>
</div>
</div>
</div>
<p>Zgoraj smo funkcijo <code class="docutils literal notranslate"><span class="pre">print</span></code> zamaknili, saj pripada bloku kode, ki se izvede v primeru <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>. Nekateri programski jeziki kodo znotraj bloka dajo v zavite ali kakšne druge oklepaje in dodatno še zamikajo. Pri Pythonu se samo zamikajo. Zamik je tipično <strong>4 presledke</strong>. Lahko je tudi <strong>tabulator</strong> (manj pogosto), vendar pa smemo v eni datoteki .py uporabljati le en način zamikanja.</p>
<p>Stavke lahko zapišemo tudi v eno vrstico, vendar je taka uporaba odsvetovana, saj zmanjšuje preglednost kode:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;taka oblika je odsvetovana&#39;</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="mi">40</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;uporaba podpičja namesto nove vrstice&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>taka oblika je odsvetovana
----------------------------------------
uporaba podpičja namesto nove vrstice
</pre></div>
</div>
</div>
</div>
</section>
<section id="izraz-if">
<h4>Izraz <code class="docutils literal notranslate"><span class="pre">if</span></code><a class="headerlink" href="#izraz-if" title="Permalink to this heading">#</a></h4>
<p>Poleg stavka <code class="docutils literal notranslate"><span class="pre">if</span></code> ima Python tudi izraz <code class="docutils literal notranslate"><span class="pre">if</span></code> (angl. <em>ternary operator</em>, glejte <a class="reference external" href="https://docs.python.org/faq/programming.html#is-there-an-equivalent-of-c-s-ternary-operator">dokumentacijo</a>).</p>
<p>Sintaksa je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">izvedi</span><span class="p">,</span> <span class="n">če</span> <span class="n">je</span> <span class="kc">True</span><span class="p">]</span> <span class="k">if</span> <span class="n">pogoj</span> <span class="k">else</span> <span class="p">[</span><span class="n">izvedi</span><span class="p">,</span> <span class="n">če</span> <span class="n">je</span> <span class="kc">False</span><span class="p">]</span>
</pre></div>
</div>
<p>Preprost primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Je res&#39;</span> <span class="k">if</span> <span class="mi">5</span><span class="o">==</span><span class="mi">3</span> <span class="k">else</span> <span class="s1">&#39;Ni res&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Ni res&#39;
</pre></div>
</div>
</div>
</div>
<p>If izrazi so zelo uporabni in jih bomo pogosto uporabljali pri izpeljevanju seznamov!</p>
</section>
<section id="zanka-while">
<h4>Zanka <code class="docutils literal notranslate"><span class="pre">while</span></code><a class="headerlink" href="#zanka-while" title="Permalink to this heading">#</a></h4>
<p>Sintaksa zanke while (<a class="reference external" href="https://docs.python.org/reference/compound_stmts.html#the-while-statement">dokumentacija</a>) je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="n">pogoj</span><span class="p">:</span>
    <span class="p">[</span><span class="n">koda</span> <span class="n">za</span> <span class="n">izvajanje</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="p">[</span><span class="n">koda</span> <span class="n">za</span> <span class="n">izvajanje</span><span class="p">]</span>
</pre></div>
</div>
<p>Pri tem je treba poudariti, da je del <code class="docutils literal notranslate"><span class="pre">else</span></code> opcijski in se izvede ob izhodu iz zanke <code class="docutils literal notranslate"><span class="pre">while</span></code>. Ukaz <code class="docutils literal notranslate"><span class="pre">break</span></code> prekine zanko in ne izvede <code class="docutils literal notranslate"><span class="pre">else</span></code> dela. Ukaz <code class="docutils literal notranslate"><span class="pre">continue</span></code> prekine izvajanje trenutne kode in gre takoj na testiranje pogoja.</p>
<p>Preprost primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
--
</pre></div>
</div>
</div>
</div>
</section>
<section id="zanka-for">
<h4>Zanka <code class="docutils literal notranslate"><span class="pre">for</span></code><a class="headerlink" href="#zanka-for" title="Permalink to this heading">#</a></h4>
<p>V Pythonu bomo <strong>zelo pogosto</strong> uporabljali zanko <code class="docutils literal notranslate"><span class="pre">for</span></code> (<a class="reference external" href="https://docs.python.org/3/tutorial/controlflow.html#for-statements">dokumentacija</a>). Sintaksa je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">seznam_z_elementi</span><span class="p">:</span>
    <span class="p">[</span><span class="n">koda</span> <span class="n">za</span> <span class="n">izvajanje</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="p">[</span><span class="n">koda</span> <span class="n">za</span> <span class="n">izvajanje</span><span class="p">]</span>
</pre></div>
</div>
<p>Podobno kakor pri <code class="docutils literal notranslate"><span class="pre">while</span></code> je tudi tukaj <code class="docutils literal notranslate"><span class="pre">else</span></code> del opcijski.</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imena</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Jaka&#39;</span><span class="p">,</span> <span class="s1">&#39;Miki&#39;</span><span class="p">,</span> <span class="s1">&#39;Luka&#39;</span><span class="p">,</span> <span class="s1">&#39;Anja&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ime</span> <span class="ow">in</span> <span class="n">imena</span><span class="p">:</span> <span class="c1"># tukaj se skriva prirejanje; ``ime`` vsakič pridobi novo vrednost</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jaka
Miki
Luka
Anja
</pre></div>
</div>
</div>
</div>
<p>Zelo uporabno je zanke delati čez slovarje:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Slovar je:&#39;</span><span class="p">,</span> <span class="n">parametri</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">parametri</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Slovar je: {&#39;višina&#39;: 5.2, &#39;širina&#39;: 43, &#39;g&#39;: 9.81}
višina = 5.2
širina = 43
g = 9.81
</pre></div>
</div>
</div>
</div>
</section>
<section id="izpeljevanje-seznamov">
<h4>Izpeljevanje seznamov<a class="headerlink" href="#izpeljevanje-seznamov" title="Permalink to this heading">#</a></h4>
<p>Pri programiranju se pogosto srečujemo s tem, da moramo izvajati operacije na posameznem elementu seznama. Predhodno smo že spoznali zanko <code class="docutils literal notranslate"><span class="pre">for</span></code>, ki jo lahko uporabimo v takem primeru.</p>
<p>Oglejmo si primer, kjer izračunamo kvadrat števil:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1"># izvorni seznam</span>
<span class="n">rezultat</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># pripravimo prazen seznam v katerega bomo dodajali rezultate</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">seznam</span><span class="p">:</span>
    <span class="n">rezultat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rezultat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 9]
</pre></div>
</div>
</div>
</div>
<p>Mnogo enostavneje lahko isti rezultat dosežemo s t. i. <strong>izpeljevanjem seznamov</strong> (angl. <em>list comprehensions</em>, glejte <a class="reference external" href="https://docs.python.org/tutorial/datastructures.html#list-comprehensions">dokumentacijo</a>).</p>
<p>Zgornji primer bi bil:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1"># izvorni seznam</span>
<span class="n">rezultat</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">seznam</span><span class="p">]</span> <span class="c1"># &lt;&lt;&lt; na desni strani = je izpeljevanje seznamov</span>
<span class="n">rezultat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 9]
</pre></div>
</div>
</div>
</div>
<p>Izpeljevanje seznamov predstavlja koda <code class="docutils literal notranslate"><span class="pre">[element**2</span> <span class="pre">for</span> <span class="pre">element</span> <span class="pre">in</span> <span class="pre">seznam]</span></code>, ki v bistvu pove to, kar je napisano: izračunaj kvadrat za vsak element v seznamu. Da je rezultat seznam, nakazujejo oglati oklepaji.</p>
<p>Izpeljevanje seznamov ima sledečo sintakso:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">koda</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">seznam</span><span class="p">]</span>
</pre></div>
</div>
<p>in ima predvsem dve prednosti:</p>
<ul class="simple">
<li><p><strong>preglednost / kompaktnost</strong> kode in</p></li>
<li><p>malo <strong>hitrejše</strong> izvajanje.</p></li>
</ul>
<p>Preglednost/kompaktnost smo lahko že presodili. Kako preverimo hitrost? Najlažje to naredimo s t. i. magičnim ukazom <code class="docutils literal notranslate"><span class="pre">%%timeit</span></code>, torej <strong>meri čas</strong> (glejte <a class="reference external" href="http://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">dokumentacijo</a>); spodaj bomo uporabili blokovni magični ukaz (označuje ga <code class="docutils literal notranslate"><span class="pre">%%</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">timeit</span> <span class="o">-</span><span class="n">n1000</span>
</pre></div>
</div>
<p>kjer parameter <code class="docutils literal notranslate"><span class="pre">-n1000</span></code> omejuje merjenje časa na 1000 ponovitev.</p>
<p>Najprej daljši način:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n1000
<span class="n">rezultat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">seznam</span><span class="p">:</span>
    <span class="n">rezultat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.4 µs ± 3.98 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Nato izpeljevanje seznamov (bolj pregledno in malenkost hitreje):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n1000
<span class="n">rezultat</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">seznam</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39.5 µs ± 1.11 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si še dva uporabna primera:</p>
<ul class="simple">
<li><p>uporabo izraza <code class="docutils literal notranslate"><span class="pre">if</span></code> za izračun nove vrednosti,</p></li>
<li><p>uporabo izraza <code class="docutils literal notranslate"><span class="pre">if</span></code>, če se nova vrednost sploh izračuna.</p></li>
</ul>
<p>Pri izračunu nove vrednosti izraz <code class="docutils literal notranslate"><span class="pre">if</span></code> vstavimo v del pred <code class="docutils literal notranslate"><span class="pre">for</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="n">el</span><span class="o">+</span><span class="mi">10</span> <span class="k">if</span> <span class="n">el</span><span class="o">&lt;</span><span class="mi">2</span> <span class="k">else</span> <span class="n">el</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">seznam</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11, 4, 9]
</pre></div>
</div>
</div>
</div>
<p>Pogosto pa za določene elemente izračuna sploh ne želimo izvesti, v tem primeru izraz <code class="docutils literal notranslate"><span class="pre">if</span></code> vstavimo za seznam:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">seznam</span> <span class="k">if</span> <span class="n">el</span> <span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 9]
</pre></div>
</div>
</div>
</div>
</section>
<section id="funkcija-zip">
<h4>Funkcija <code class="docutils literal notranslate"><span class="pre">zip</span></code><a class="headerlink" href="#funkcija-zip" title="Permalink to this heading">#</a></h4>
<p>Ko želimo kombinirati več seznamov v zanki, si pomagamo s funkcijo <code class="docutils literal notranslate"><span class="pre">zip</span></code> (<a class="reference external" href="https://docs.python.org/library/functions.html#zip">dokumentacija</a>); primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>

<span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pari so: &#39;</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pari so:  1 in 10
Pari so:  2 in 20
Pari so:  3 in 30
</pre></div>
</div>
</div>
</div>
</section>
<section id="funkcija-range">
<h4>Funkcija <code class="docutils literal notranslate"><span class="pre">range</span></code><a class="headerlink" href="#funkcija-range" title="Permalink to this heading">#</a></h4>
<p>Pogosto bomo uporabljali zanko <code class="docutils literal notranslate"><span class="pre">for</span></code> v povezavi s funkcijo <code class="docutils literal notranslate"><span class="pre">range</span></code> (<a class="reference external" href="https://docs.python.org/tutorial/controlflow.html#the-range-function">dokumentacija</a>). Sintaksa je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">range</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
<span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">[,</span> <span class="n">step</span><span class="p">])</span>
</pre></div>
</div>
<p>Če torej funkcijo kličemo z enim parametrom, je to <code class="docutils literal notranslate"><span class="pre">stop</span></code>: <strong>do</strong> katere številke naštevamo. V primeru klica z dvema parametroma <code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">stop</span></code>, naštevamo od, do! Tretji parameter je opcijski in definira korak <code class="docutils literal notranslate"><span class="pre">step</span></code>.</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
</pre></div>
</div>
</div>
</div>
</section>
<section id="funkcija-enumerate">
<h4>Funkcija <code class="docutils literal notranslate"><span class="pre">enumerate</span></code><a class="headerlink" href="#funkcija-enumerate" title="Permalink to this heading">#</a></h4>
<p>Zanko <code class="docutils literal notranslate"><span class="pre">for</span></code> pogosto uporabljamo tudi s funkcijo <code class="docutils literal notranslate"><span class="pre">enumerate</span></code>, ki elemente oštevilči (<a class="reference external" href="https://docs.python.org/library/functions.html#enumerate">dokumentacija</a>).</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ime</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">imena</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 Jaka
1 Miki
2 Luka
3 Anja
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="za-konec-plonk-list">
<h2>Za konec: plonk list :)<a class="headerlink" href="#za-konec-plonk-list" title="Permalink to this heading">#</a></h2>
<p>Veliko jih je; tukaj je <a class="reference external" href="http://perso.limsi.fr/pointal/_media/python:cours:mementopython3-english.pdf">povezava</a> do enega.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Namestite <em>Python</em>.</p></li>
<li><p>Namestite <em>Visual Studio Code</em>, GIT in iz GitHuba ter prenesite predavanja.</p></li>
<li><p>V poljubnem delovnem direktoriju zaženite Jupyter notebook.</p></li>
<li><p>Prikažite uporabo stilov, uporabo poudarjenega, poševnega teksta, uporabo seznamov, enačbe …</p></li>
<li><p>Definirajte razliko med statičnim in dinamičnim tipiziranjem.</p></li>
<li><p>Poiščite pomoč poljubnega ukaza (znotraj Pythona in na uradni domači strani).</p></li>
<li><p>Prikažite uporabo <em>niza</em>, <em>celega števila</em> in <em>števila z uporabo plavajoče vejice</em>.</p></li>
<li><p>Prikažite uporabo <em>terke</em> in njenih bistvenih lastnosti.</p></li>
<li><p>Prikažite uporabo <em>seznama</em> in njegovih bistvenih lastnosti.</p></li>
<li><p>Komentirajte tipične operacije nad seznami.</p></li>
<li><p>Komentirajte uporabo <em>množic</em> in tipične uporabe.</p></li>
<li><p>Prikažite uporabo slovarjev.</p></li>
<li><p>Katere aritmetične operatorje poznamo v Pythonu? Prikažite uporabo.</p></li>
<li><p>Katere primerjalne operatorje poznamo v Pythonu? Prikažite uporabo.</p></li>
<li><p>Katere logične operatorje poznamo v Pythonu? Prikažite uporabo.</p></li>
<li><p>Prikažite uporabo stavka ``if`.</p></li>
<li><p>Kakšna je razlika med stavikom <code class="docutils literal notranslate"><span class="pre">if</span></code> in izrazom <code class="docutils literal notranslate"><span class="pre">if</span></code>. Prikažite!</p></li>
<li><p>Prikažite uporabo zanke <code class="docutils literal notranslate"><span class="pre">while</span></code>.</p></li>
<li><p>Prikažite uporabo zanke <code class="docutils literal notranslate"><span class="pre">for</span></code>.</p></li>
<li><p>Prikažite uporabo zanke <code class="docutils literal notranslate"><span class="pre">for</span></code> v povezavi s funkcijami <code class="docutils literal notranslate"><span class="pre">range</span></code>, <code class="docutils literal notranslate"><span class="pre">enumerate</span></code>, <code class="docutils literal notranslate"><span class="pre">zip</span></code></p></li>
</ol>
<p>Še nekaj branja: <a class="reference external" href="https://automatetheboringstuff.com/">automatetheboringstuff.com</a>.</p>
<p>In en twit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">blockquote</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;twitter-tweet&quot;</span> <span class="na">data-lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span> <span class="na">dir</span><span class="o">=</span><span class="s">&quot;ltr&quot;</span><span class="p">&gt;</span>The most important slide from my <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://twitter.com/PyData&quot;</span><span class="p">&gt;</span>@PyData<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> talk. <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://t.co/Hc8j4ZpHV4&quot;</span><span class="p">&gt;</span>pic.twitter.com/Hc8j4ZpHV4<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span><span class="ni">&amp;mdash;</span> Almar Klein (@almarklein) <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://twitter.com/almarklein/status/708909917684568064&quot;</span><span class="p">&gt;</span>March 13, 2016<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">blockquote</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;//platform.twitter.com/widgets.js&quot;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">The most important slide from my <a href="https://twitter.com/PyData">@PyData</a> talk. <a href="https://t.co/Hc8j4ZpHV4">pic.twitter.com/Hc8j4ZpHV4</a></p>&mdash; Almar Klein (@almarklein) <a href="https://twitter.com/almarklein/status/708909917684568064">March 13, 2016</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</div></div>
</div>
<section id="vkljucevanje-lokalnega-video-posnetka-s-transformacijami">
<h3>Vključevanje lokalnega video posnetka s transformacijami<a class="headerlink" href="#vkljucevanje-lokalnega-video-posnetka-s-transformacijami" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;style&gt;video{</span><span class="se">\</span>
<span class="s1">  -moz-transform:scale(0.75) rotate(-90deg);</span><span class="se">\</span>
<span class="s1">  -webkit-transform:scale(0.75) rotate(-90deg);</span><span class="se">\</span>
<span class="s1">  -o-transform:scale(0.75) rotate(-90deg);</span><span class="se">\</span>
<span class="s1">  -ms-transform:scale(0.75) rotate(-90deg);</span><span class="se">\</span>
<span class="s1">  transform:scale(0.75) rotate(-90deg);</span><span class="se">\</span>
<span class="s1">}&lt;/style&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>video{  -moz-transform:scale(0.75) rotate(-90deg);  -webkit-transform:scale(0.75) rotate(-90deg);  -o-transform:scale(0.75) rotate(-90deg);  -ms-transform:scale(0.75) rotate(-90deg);  transform:scale(0.75) rotate(-90deg);}</style></div></div>
</div>
<p><video controls src="./fig/vodni-top.mkv"/></video></p>
<p>(Zgornje celice se na github-u ne prikaže pravilno)</p>
</section>
</section>
<span id="document-notebooks/Predavanje 02 - Print, delo z datotekami, funkcije, moduli"></span><section class="tex2jax_ignore mathjax_ignore" id="funkcije-izjeme-moduli">
<h2>Funkcije, izjeme, moduli<a class="headerlink" href="#funkcije-izjeme-moduli" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="funkcije">
<h2>Funkcije<a class="headerlink" href="#funkcije" title="Permalink to this heading">#</a></h2>
<section id="funkcija-print">
<h3>Funkcija print<a class="headerlink" href="#funkcija-print" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">print</span></code> predstavlja eno od najbolj pogosto uporabljenih funkcij. Vse podane argumente izpiše, mednje da presledek, na koncu pa gre v novo vrstico.</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;prvi argument&#39;</span><span class="p">,</span> <span class="s1">&#39;drugi&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mf">5.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>prvi argument drugi = 5.0
</pre></div>
</div>
</div>
</div>
<p>Za bolj splošno uporabo glejmo <a class="reference external" href="https://docs.python.org/library/functions.html#print">dokumentacijo</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">objects</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*objects</span></code> predstavlja argumente, ki jih želimo izpisati (celovitost zvezdice bo jasna pri obravnavi <em>funkcij</em>, spodaj,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sep</span></code> predstavlja delilni niz (angl. <em>sep</em>arator),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> predstavlja zaključni niz,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> predstavlja <em>datoteko</em> izpisa (<code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> predstavlja <em>standard output</em>, v konkretnem primeru to pomeni <em>zaslon</em> oz ukazna vrstica; pozneje bomo to spremenili),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flush</span></code> v primeru <code class="docutils literal notranslate"><span class="pre">True</span></code> izpis zaključi (sicer lahko zaradi optimizacije ostane v medpolnilniku, angl. <em>buffer</em>).</p></li>
</ul>
<p>Pri argumentu <code class="docutils literal notranslate"><span class="pre">end</span></code> smo zgoraj uporabili t. i. <strong>izhodni znak</strong> (angl. <em>escape character</em>): <strong>\</strong>.</p>
<p>Namen izhodnega znaka je, da sledečemu znaku da poseben pomen, nekatere pogoste uporabe so:</p>
<ul class="simple">
<li><p><strong>\n</strong> vstavi <em>prelomi vrstico</em>,</p></li>
<li><p><strong>\t</strong> vstavi <em>tabulator</em>,</p></li>
<li><p><strong>\b</strong> izbriše zadnji znak <em>backspace</em>,</p></li>
<li><p><strong>'</strong> izpiše enojni narekovaj ‚,</p></li>
<li><p><strong>&quot;</strong> izpiše dvojni narekovaj „,</p></li>
<li><p><strong>\</strong> prikaže <em>izhodni znak</em> (angl. <em>backslash</em>),</p></li>
<li><p><strong>\</strong> nova vrstica v večvrstičnem nizu.</p></li>
</ul>
<p>Primer (kako ponavadi ne programiramo):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pet&#39;</span><span class="p">,</span><span class="s1">&#39;et&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p:)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pet-et=p:)
</pre></div>
</div>
</div>
</div>
<p>In še primer z izhodnimi znaki:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nizi v Pythonu (po PEP8) naj ne bi bili daljši od 80 znakov. </span><span class="se">\</span>
<span class="s1">Razlog je v tem, da nam ni treba pomikati okna levo in desno. </span><span class="se">\</span>
<span class="s1">Da pa vseeno lahko napišemo nize, ki so daljši od 80 znakov </span><span class="se">\</span>
<span class="s1">Uporabimo enojni delilni znak </span><span class="se">\\</span><span class="s1"> (bodite pozorni na to, </span><span class="se">\</span>
<span class="s1">kako se izpiše: </span><span class="se">\\</span><span class="s1">)&#39;</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nizi v Pythonu (po PEP8) naj ne bi bili daljši od 80 znakov. Razlog je v tem, da nam ni treba pomikati okna levo in desno. Da pa vseeno lahko napišemo nize, ki so daljši od 80 znakov Uporabimo enojni delilni znak \ (bodite pozorni na to, kako se izpiše: \)
</pre></div>
</div>
</div>
</div>
<section id="oblikovanje-nizov">
<h4>Oblikovanje nizov<a class="headerlink" href="#oblikovanje-nizov" title="Permalink to this heading">#</a></h4>
<p>Pri oblikovanju/formatiranju nizov imamo na voljo več orodij:</p>
<ul class="simple">
<li><p><strong>f-niz</strong> (angl. <em>f-string</em>, <em>f</em> zaradi „formatirani“), <a class="reference external" href="https://docs.python.org/reference/lexical_analysis.html#f-strings">dokumentacija</a>,</p></li>
<li><p><strong>metoda <code class="docutils literal notranslate"><span class="pre">.format()</span></code></strong>, <a class="reference external" href="https://docs.python.org/library/stdtypes.html#str.format">dokumentacija</a>,</p></li>
<li><p><strong>%</strong> oblikovanje, <a class="reference external" href="https://docs.python.org/library/stdtypes.html#string-formatting-operations">dokumentacija</a>.</p></li>
</ul>
<p>Poglejmo si primere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">3.14</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;pi = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>                <span class="c1"># f-niz</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pi = </span><span class="si">{a}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">))</span>   <span class="c1"># .format</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pi = </span><span class="si">%(a)3.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span> <span class="c1"># % </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pi = 3.14
pi = 3.14
pi = 3.14
</pre></div>
</div>
</div>
</div>
<p><em>f-niz</em> je implementiran od Python verzije 3.6 naprej (<a class="reference external" href="https://www.python.org/dev/peps/pep-0498/">PEP 498</a>) in predstavlja najbolj enostaven način oblikovanja. Ostala načina navajamo zgolj zato, da se bralec seznani z njimi in da naredimo povezavo na dokumentacijo.</p>
<p><em>f-niz</em> se vedno začne s <strong>f</strong> pred prvim narekovajem in omogoča zelo splošno oblikovanje (glejte <a class="reference external" href="https://docs.python.org/reference/lexical_analysis.html#f-strings">dokumentacijo</a>).</p>
<p>Vrednost, ki jo želimo znotraj niza oblikovati, damo v zavite oklepaje:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;besedilo... </span><span class="si">{</span><span class="n">ime_arg1</span><span class="si">:</span><span class="s1">fmt1</span><span class="si">}</span><span class="s1"> ... besedilo...&#39;</span>
</pre></div>
</div>
<p>V zavitih oklepajih je:</p>
<ul class="simple">
<li><p>pred <code class="docutils literal notranslate"><span class="pre">:</span></code> podamo ime vrednosti, ki jo želimo oblikovati</p></li>
<li><p>za <code class="docutils literal notranslate"><span class="pre">:</span></code> oblikujemo izpis spremenljivke; najpogosteje bomo uporabili <em>fmt</em> oblike:</p>
<ul>
<li><p>w.d<strong>f</strong> - predstavitev s plavajočo vejico (<strong>f</strong>loat)</p></li>
<li><p>w.d<strong>e</strong> - predstavitev z eksponentom (<strong>e</strong>xponent)</p></li>
<li><p>w.d<strong>g</strong> - splošni format (<strong>g</strong>eneral)</p></li>
<li><p>w<strong>s</strong> - niz znakov (<strong>s</strong>tring).</p></li>
</ul>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">w</span></code> predstavlja (minimalno) skupno širino, <code class="docutils literal notranslate"><span class="pre">d</span></code> pa število mest za decimalno piko.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">višina</span> <span class="o">=</span> <span class="mf">1.84</span>
<span class="n">ime</span> <span class="o">=</span> <span class="s1">&#39;Marko&#39;</span>
<span class="n">tekst</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ime</span><span class="si">}</span><span class="s1"> je visok </span><span class="si">{</span><span class="n">višina</span><span class="si">}</span><span class="s1"> m ali tudi: </span><span class="si">{</span><span class="n">višina</span><span class="si">:</span><span class="s1">e</span><span class="si">}</span><span class="s1"> m, </span><span class="si">{</span><span class="n">višina</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1"> m.&#39;</span>
<span class="n">tekst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Marko je visok 1.84 m ali tudi: 1.840000e+00 m,   1.840 m.&#39;
</pre></div>
</div>
</div>
</div>
<p>Podobno bi lahko naredili z metodo <em>format</em> in se sklicali na indeks argumenta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tekst</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{1}</span><span class="s1"> je visok </span><span class="si">{0}</span><span class="s1"> m ali tudi: </span><span class="si">{0:e}</span><span class="s1"> m, </span><span class="si">{0:7.3f}</span><span class="s1"> m.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">višina</span><span class="p">,</span> <span class="n">ime</span><span class="p">)</span>
<span class="n">tekst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Marko je visok 1.84 m ali tudi: 1.840000e+00 m,   1.840 m.&#39;
</pre></div>
</div>
</div>
</div>
<p>Primer z uporabo slovarja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametri</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;visina&#39;</span><span class="p">:</span> <span class="mf">5.</span><span class="p">,</span> <span class="s1">&#39;gostota&#39;</span><span class="p">:</span><span class="mf">100.111</span><span class="p">,</span> <span class="s1">&#39;ime uporabnika&#39;</span><span class="p">:</span> <span class="s1">&#39;Janko&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;višina = </span><span class="si">{</span><span class="n">parametri</span><span class="p">[</span><span class="s2">&quot;visina&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">, gostota = </span><span class="si">{</span><span class="n">parametri</span><span class="p">[</span><span class="s2">&quot;gostota&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">7.3e</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;višina =   5.000, gostota = 1.001e+02&#39;
</pre></div>
</div>
</div>
</div>
<p>Oblikovanje s <em>fmt</em> (angl. <em>Format Specification Mini-Language</em>) je  izredno bogato. Del za dvopičjem je v  splošnem (glejte <a class="reference external" href="https://docs.python.org/library/string.html#formatspec">dokumentacijo</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">fill</span><span class="p">]</span><span class="n">align</span><span class="p">][</span><span class="n">sign</span><span class="p">][</span><span class="c1">#][0][width][grouping_option][.precision][type]</span>
</pre></div>
</div>
<p>kjer so v oglatih oklepajih opcijski parametri (vsi so opcijski):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> je lahko katerikoli znak,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">align</span></code> označuje poravnavo, možnosti: <code class="docutils literal notranslate"><span class="pre">&quot;&lt;&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;&gt;&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;=&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;^&quot;</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sign</span></code> označuje predznak, možnosti: <code class="docutils literal notranslate"><span class="pre">&quot;+&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code> definira minimalno skupno širino,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grouping_option</span></code> možnosti združevanja, možnosti:  <code class="docutils literal notranslate"><span class="pre">&quot;_&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> definira število števk po decimalnem ločilu,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> definira, kako naj bodo podatki prikazani, možnosti:  <code class="docutils literal notranslate"><span class="pre">&quot;b&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;c&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;d&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;e&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;E&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;f&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;F&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;g&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;G&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;n&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;&quot;o&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;X&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;%&quot;</span></code></p></li>
</ul>
<p>Besedili poravnavamo levo z <code class="docutils literal notranslate"><span class="pre">&quot;&lt;&quot;</span></code>, desno z <code class="docutils literal notranslate"><span class="pre">&quot;&gt;&quot;</span></code> in sredinsko <code class="docutils literal notranslate"><span class="pre">&quot;^&quot;</span></code>. Primer sredinske/desne poravnave (širina 20 znakov):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">višina</span><span class="si">:</span><span class="s1">*^20</span><span class="si">}</span><span class="s1">&#39;</span> <span class="c1"># pred ^ je znak s katerim zapolnimo levo in desno stran</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;********1.84********&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">parametri</span><span class="p">[</span><span class="s2">&quot;visina&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">_&gt;20</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;_________________5.0&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span>
<span class="sa">f</span><span class="s1">&#39;Kompleksno število </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1"> je sestavljeno iz realnega (</span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="si">}</span><span class="s1">)</span><span class="se">\</span>
<span class="s1">in imaginarnega (</span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="si">}</span><span class="s1">) dela.&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Kompleksno število (4-2j) je sestavljeno iz realnega (4.0)in imaginarnega (-2.0) dela.&#39;
</pre></div>
</div>
</div>
</div>
<p>Oblikovanje datuma, ure si lahko pogledate v dodatku spodaj.</p>
</section>
</section>
<section id="delo-z-datotekami">
<h3>Delo z datotekami<a class="headerlink" href="#delo-z-datotekami" title="Permalink to this heading">#</a></h3>
<p>Delo z datotekami je pomembno, saj podatke pogosto shranjujemo v datoteke ali jih beremo iz njih. Datoteko, iz katere želimo brati ali vanjo pisati, moramo najprej odpreti. To izvedemo z ukazom <code class="docutils literal notranslate"><span class="pre">open</span></code> (<a class="reference external" href="https://docs.python.org/library/functions.html#open">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">closefd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opener</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Od vseh argumentov je nujen samo <code class="docutils literal notranslate"><span class="pre">file</span></code>, ki definira pot do datoteke.</p>
<p>Argument <code class="docutils literal notranslate"><span class="pre">mode</span></code> je lahko:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'r'</span></code> za branje (<em>read</em>, privzeto),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'w'</span></code> za pisanje (<em>write</em>, datoteka se najprej pobriše),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'x'</span></code> za ekskluzivno pisanje; če datoteka že obstaja vrne napako,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'a'</span></code> za dodajanje na koncu obstoječe datoteke (<em>append</em>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'b'</span></code> binarna oblika zapisa,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'t'</span></code> tekstovna oblika zapisa (privzeto),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'+'</span></code> datoteka se odpre za branje in pisanje.</p></li>
</ul>
<p>Zadnji trije zanki (<code class="docutils literal notranslate"><span class="pre">'b'</span></code>, <code class="docutils literal notranslate"><span class="pre">'t'</span></code>, <code class="docutils literal notranslate"><span class="pre">'+'</span></code>) se uporabljajo v kombinaciji s prvimi tremi (<code class="docutils literal notranslate"><span class="pre">'r'</span></code>, <code class="docutils literal notranslate"><span class="pre">'w'</span></code>, <code class="docutils literal notranslate"><span class="pre">'x'</span></code>). Primer: <code class="docutils literal notranslate"><span class="pre">mode='r+b'</span></code> pomeni branje in pisanje binarne datoteke.</p>
<p>Podrobneje bomo spoznali samo branje in pisanje tekstovnih datotek.</p>
<p>Ostali (opcijski) argumenti funkcije <code class="docutils literal notranslate"><span class="pre">open</span></code> so podrobno opisani v <a class="reference external" href="https://docs.python.org/library/functions.html#open">dokumentaciji</a>.</p>
<p>Privzeto je <code class="docutils literal notranslate"><span class="pre">mode='r'</span></code> (oz. <code class="docutils literal notranslate"><span class="pre">'rt'</span></code>, ker je privzet tekstovni način), kar pomeni, da se datoteko odpre za branje v tekstovni obliki.</p>
<p>Poglejmo si najprej pisanje v (tekstovno) datoteko (<code class="docutils literal notranslate"><span class="pre">mode='w'</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datoteka</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/prikaz vpisa.txt&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">'data/prikaz</span> <span class="pre">vpisa.txt'</span></code> predstavlja relativno pot (glede na mesto, kjer se poganja <em>Jupyter notebook</em>) do datoteke.</p>
<p>Zapišimo prvo vrstico s pomočjo metode <code class="docutils literal notranslate"><span class="pre">write</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datoteka</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;test prve vrstice</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18
</pre></div>
</div>
</div>
</div>
<p>Metoda <code class="docutils literal notranslate"><span class="pre">write</span></code> vrne število zapisanih zankov. Če boste v tem trenutku pogledali vsebino datoteke, je velika možnost, da je še prazna. Razlog je v tem, da je vsebina še v medpolnilniku, ki se izprazni na disk samo občasno ali ob zaprtju datoteke (razlog za tako delovanje je v hitrosti zapisa na disk; za podrobnosti glejte dokumentacijo argumenta <code class="docutils literal notranslate"><span class="pre">buffering</span></code> funkcije <code class="docutils literal notranslate"><span class="pre">open</span></code>).</p>
<p>Zapišimo drugo vrstico:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datoteka</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;druga vrstica</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14
</pre></div>
</div>
</div>
</div>
<p>Vpišimo sedaj še nekaj številčnih vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">datoteka</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s1">7.2e</span><span class="si">}</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s1">9.4e</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Datoteko zapremo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datoteka</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj datoteko odpremo za branje in pisanje? <code class="docutils literal notranslate"><span class="pre">mode='r+'</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datoteka</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/prikaz vpisa.txt&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Preverimo vse vrstice s <code class="docutils literal notranslate"><span class="pre">for</span></code> zanko; v spodnji kodi nam <code class="docutils literal notranslate"><span class="pre">datoteka</span></code> v vsakem klicu vrne eno vrstico:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datoteka</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test prve vrstice
druga vrstica
0.00e+00	 0.0000e+00
1.00e+00	 1.0000e+00
2.00e+00	 2.0000e+00
3.00e+00	 3.0000e+00
4.00e+00	 4.0000e+00
</pre></div>
</div>
</div>
</div>
<p>Pri uvodu v funkcijo <code class="docutils literal notranslate"><span class="pre">print</span></code> smo omenili argument <code class="docutils literal notranslate"><span class="pre">file</span></code>, ki definira datoteko, v katero se piše (privzet je standardni izhod oz. <em>zaslon</em>). Če kot argument <code class="docutils literal notranslate"><span class="pre">file</span></code> posredujemo datoteko, ki je odprta za pisanje:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;konec&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">datoteka</span><span class="p">)</span>
<span class="n">datoteka</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>se vsebina zapiše v datoteko. Rezultat lahko preverite v datoteki!</p>
<p>Tukaj je lepa priložnost, da spoznamo stavek <code class="docutils literal notranslate"><span class="pre">with</span></code> (<a class="reference external" href="https://docs.python.org/reference/compound_stmts.html#with">dokumentacija</a>). Celovitost stavka <code class="docutils literal notranslate"><span class="pre">with</span></code> presega namen tega predmeta, je pa zelo preprosta uporaba pri delu z datotekami, zato si poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/prikaz vpisa.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datoteka</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datoteka</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test prve vrstice
druga vrstica
0.00e+00	 0.0000e+00
1.00e+00	 1.0000e+00
2.00e+00	 2.0000e+00
3.00e+00	 3.0000e+00
4.00e+00	 4.0000e+00
konec
</pre></div>
</div>
</div>
</div>
<p>Stavek <code class="docutils literal notranslate"><span class="pre">with</span></code> rezultat funkcije <code class="docutils literal notranslate"><span class="pre">open</span></code> shrani v (<em>as</em>) ime <code class="docutils literal notranslate"><span class="pre">datoteka</span></code>, potem pa za vsako vrstico izpišemo vrednosti. Pri izhodu iz stavka <code class="docutils literal notranslate"><span class="pre">with</span></code> se samodejno pokliče metoda <code class="docutils literal notranslate"><span class="pre">datoteka.close()</span></code>. Stavek <code class="docutils literal notranslate"><span class="pre">with</span></code> nam torej omogoča pisanje pregledne in kompaktne kode.</p>
</section>
<section id="funkcije-v-splosnem">
<h3>Funkcije v splošnem<a class="headerlink" href="#funkcije-v-splosnem" title="Permalink to this heading">#</a></h3>
<p>V Pythonu je veliko funkcij že vgrajenih (glejte <a class="reference external" href="https://docs.python.org/library/functions.html">dokumentacijo</a>); funkcije pa lahko tudi napišemo sami ali jih uvozimo iz t. i. modulov (zgoraj smo uvozili <code class="docutils literal notranslate"><span class="pre">datetime</span></code>, več si bomo pogledali pozneje).</p>
<p>Generični primer funkcije je (<a class="reference external" href="https://docs.python.org/tutorial/controlflow.html#defining-functions">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ime_funkcije</span><span class="p">(</span><span class="n">parametri</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;docstring&#39;&#39;&#39;</span>
    <span class="p">[</span><span class="n">koda</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">vsebina</span>
</pre></div>
</div>
<p>Pri tem izpostavimo:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">def</span></code> označuje definicijo funkcije,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ime_funkcije</span></code> <strong>imena funkcije po PEP8 pišemo z malo, večbesedna povežemo s podčrtajem</strong>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametri</span></code> parametri funkcije, več bomo povedali spodaj,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docstring</span></code> (opcijsko) dokumentacija funkcije,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[koda]</span></code> koda funkcije,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span></code> (opcijsko) ukaz za izhod iz funkcije, kar sledi se vrne kot rezultat (če ni <code class="docutils literal notranslate"><span class="pre">return</span></code> ali po return ni ničesar, se vrne <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>Primer preproste funkcije:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">površina</span><span class="p">(</span><span class="n">dolžina</span><span class="p">,</span> <span class="n">širina</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">dolžina</span> <span class="o">*</span> <span class="n">širina</span>
    <span class="k">return</span> <span class="n">S</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">površina</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
</section>
<section id="posredovanje-argumentov-v-funkcije">
<h3>Posredovanje argumentov v funkcije<a class="headerlink" href="#posredovanje-argumentov-v-funkcije" title="Permalink to this heading">#</a></h3>
<p>Python pozna dva načina posredovanja argumentov:</p>
<ul class="simple">
<li><p>glede na <strong>mesto</strong> (<em>positional</em>)</p></li>
<li><p>glede na <strong>ime</strong>.</p></li>
</ul>
<p>Poglejmo si oba načina na primeru:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">površina</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="c1"># pozicijsko</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">površina</span><span class="p">(</span><span class="n">širina</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dolžina</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span> <span class="c1"># glede na ime</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18
</pre></div>
</div>
</div>
</div>
<p>Priporočeno je, da argumente posredujemo z <em>imenom</em>; s tem zmanjšamo možnost napake!</p>
<p>Če ne podamo imena, potem se privzame ime glede na vrstni red argumentov; primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">površina</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">širina</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<p>V kolikor mešamo <em>pozicijsko</em> in <em>poimensko</em> posredovanje argumentov, morajo <strong>najprej biti navedeni pozicijski argumenti, šele nato poimenski</strong>. Pri tem poimenski ne sme ponovno definirati pozicijskega; ker je <code class="docutils literal notranslate"><span class="pre">dolžina</span></code> prvi argument, bi klicanje take kode:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">površina</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dolžina</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>povzročilo napako.</p>
<section id="primer-dobre-prakse-pri-definiranju-argumentov">
<h4>Primer dobre prakse pri definiranju argumentov<a class="headerlink" href="#primer-dobre-prakse-pri-definiranju-argumentov" title="Permalink to this heading">#</a></h4>
<p>Pogosto funkcije dopolnjujemo in dodajamo nove argumente ali pa število argumentov funkciji sploh ne moremo vnaprej definirati!</p>
<p>Python s tem nima težav. Argumente, ki niso eksplicitno definirani obvladamo z:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*[ime0]</span></code> terka <code class="docutils literal notranslate"><span class="pre">[ime0]</span></code> vsebuje vse <strong>pozicijske argumente</strong>, ki niso eksplicitno definirani,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**[ime1]</span></code> slovar <code class="docutils literal notranslate"><span class="pre">[ime1]</span></code> vsebuje vse <strong>poimenske argumente</strong>, ki niso eksplicitno definirani.</p></li>
</ul>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">neka_funkcija</span><span class="p">(</span><span class="n">student</span><span class="p">,</span> <span class="n">izpit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Prva verzija funkcije&#39;&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Študent </span><span class="si">{</span><span class="n">student</span><span class="si">}</span><span class="s1"> se je prijavil na izpit: </span><span class="si">{</span><span class="n">izpit</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neka_funkcija</span><span class="p">(</span><span class="s1">&#39;Janez&#39;</span><span class="p">,</span> <span class="n">izpit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Študent Janez se je prijavil na izpit: True.
</pre></div>
</div>
</div>
</div>
<p>Sedaj pa pripravimo drugo, nadgrajeno, verzijo (omogoča enako uporabo kot prva verzija):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">neka_funkcija</span><span class="p">(</span><span class="o">*</span><span class="n">terka</span><span class="p">,</span> <span class="o">**</span><span class="n">slovar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Druga verzija funkcije &#39;&#39;&#39;</span>
    <span class="n">student</span> <span class="o">=</span> <span class="n">terka</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">izpit</span> <span class="o">=</span> <span class="n">slovar</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;izpit&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># True je privzeta vrednost</span>
    <span class="n">izpisi_sliko</span> <span class="o">=</span> <span class="n">slovar</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;izpisi_sliko&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># False je privzeta vrednost</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Študent </span><span class="si">{</span><span class="n">student</span><span class="si">}</span><span class="s1"> se je prijavil na izpit: </span><span class="si">{</span><span class="n">izpit</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">izpisi_sliko</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;slika:)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neka_funkcija</span><span class="p">(</span><span class="s1">&#39;Janez&#39;</span><span class="p">,</span> <span class="n">izpit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Študent Janez se je prijavil na izpit: True.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neka_funkcija</span><span class="p">(</span><span class="s1">&#39;Janez&#39;</span><span class="p">,</span> <span class="n">izpit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">izpisi_sliko</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">neobstoječi_argument</span><span class="o">=</span><span class="s1">&#39;ni&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Študent Janez se je prijavil na izpit: True.
slika:)
</pre></div>
</div>
</div>
</div>
</section>
<section id="posredovanje-funkcij-kot-argument">
<h4>Posredovanje funkcij kot argument<a class="headerlink" href="#posredovanje-funkcij-kot-argument" title="Permalink to this heading">#</a></h4>
<p>Tukaj bi želeli izpostaviti, da so argumenti lahko tudi druge funkcije.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">oblika_a</span><span class="p">(</span><span class="n">vrednost</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Prikaz vrednosti: </span><span class="si">{</span><span class="n">vrednost</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="k">def</span> <span class="nf">oblika_b</span><span class="p">(</span><span class="n">vrednost</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Prikaz vrednosti: </span><span class="si">{</span><span class="n">vrednost</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="k">def</span> <span class="nf">izpis</span><span class="p">(</span><span class="n">oblika</span><span class="p">,</span> <span class="n">vrednost</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">oblika</span><span class="p">(</span><span class="n">vrednost</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Imamo torej dve funkciji <code class="docutils literal notranslate"><span class="pre">oblika_a</span></code> in <code class="docutils literal notranslate"><span class="pre">oblika_b</span></code>, ki malenkost drugače oblikujeta numerično vrednost.</p>
<p>Poglejmo uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">izpis</span><span class="p">(</span><span class="n">oblika_a</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prikaz vrednosti: 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">izpis</span><span class="p">(</span><span class="n">oblika_b</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prikaz vrednosti: 3.00
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="docstring-funkcije">
<h3>Docstring funkcije<a class="headerlink" href="#docstring-funkcije" title="Permalink to this heading">#</a></h3>
<p><em>docstring</em> je neobvezen del definicije funkcije, ki dokumentira funkcijo in njeno uporabo. Iz tega stališča je zelo priporočeno, da ga uporabimo.</p>
<p><a class="reference external" href="https://docs.python.org/tutorial/controlflow.html#documentation-strings">Dokumentacija</a> za docstring navaja bistvene elemente:</p>
<ul class="simple">
<li><p>prva vrstica naj bo kratek povzetek funkcije,</p></li>
<li><p>če je vrstic več, naj bo druga prazna (da se vizualno loči prvo vrstico od preostalega teksta),</p></li>
<li><p>uporabimo tri narekovaje (dvojne “ ali enojne ‚), ki označujejo večvrstični niz črk.</p></li>
</ul>
<p>Primer dokumentirane funkcije:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">površina</span><span class="p">(</span><span class="n">dolžina</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">širina</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Izračun površine pravokotnika</span>
<span class="sd">    </span>
<span class="sd">    Funkcija vrne vrednost površine.</span>
<span class="sd">    </span>
<span class="sd">    Argumenti:</span>
<span class="sd">    dolžina: dolžina pravokotnika</span>
<span class="sd">    širina: dolžina pravokotnika</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dolžina</span> <span class="o">*</span> <span class="n">širina</span>
</pre></div>
</div>
</div>
</div>
<p>Primer klica s privzetimi argumenti (med klicem funkcije lahko s pritiskom [shift]+[tab] dostopamo do pomoči):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">površina</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
</section>
<section id="lokalna-globalna-imena">
<h3>Lokalna/globalna imena<a class="headerlink" href="#lokalna-globalna-imena" title="Permalink to this heading">#</a></h3>
<p>Preprosto vodilo pri funkcijah je: <strong>funkcija vidi ven, drugi pa ne vidijo noter</strong>. Funkcija ima notranja imena, ki se ne prekrivajo z istimi imeni v drugih funkcijah.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zunanja</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">def</span> <span class="nf">prva</span><span class="p">():</span>
    <span class="n">notranja</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tole je zunanja vrednost: </span><span class="si">{</span><span class="n">zunanja</span><span class="si">}</span><span class="s1">, tole pa notranja: </span><span class="si">{</span><span class="n">notranja</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prva</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tole je zunanja vrednost: 3, tole pa notranja: 5
</pre></div>
</div>
</div>
</div>
<p>Ker ime <code class="docutils literal notranslate"><span class="pre">notranja</span></code> zunaj funkcije <code class="docutils literal notranslate"><span class="pre">prva</span></code> ni definirano, bi klicanje:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">notranja</span>
</pre></div>
</div>
<p>zunaj funkcije vrnilo napako (v funkcijo ne vidimo).</p>
<p>Tukaj velja omeniti, da je <strong>posredovanje zunanjih imen v funkcijo mimo argumentov funkcije odsvetovano</strong>.</p>
</section>
<section id="return">
<h3><code class="docutils literal notranslate"><span class="pre">return</span></code><a class="headerlink" href="#return" title="Permalink to this heading">#</a></h3>
<p>Ukaz <code class="docutils literal notranslate"><span class="pre">return</span></code> vrne vrednosti iz funkcije. Doslej smo spoznali rezultate v obliki ene spremenljivke; ta spremenljivka pa je lahko tudi terka.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">vrnem_terko</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="c1"># to je ekvivalenten zapis za terko: (1, 2, 3)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vrnem_terko</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 2, 3)
</pre></div>
</div>
</div>
</div>
<p>Rezultat funkcije lahko ujamemo tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rezultat</span> <span class="o">=</span> <span class="n">vrnem_terko</span><span class="p">()</span>
<span class="n">rezultat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 2, 3)
</pre></div>
</div>
</div>
</div>
<p>Ali tako, da vrednosti razpakiramo (to sicer velja v splošnem za terke):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span> <span class="o">=</span> <span class="n">vrnem_terko</span><span class="p">()</span>
<span class="n">i1</span> <span class="c1"># izpis samo ene vrednosti</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
</section>
<section id="anonimna-funkcija-izraz">
<h3>Anonimna funkcija/izraz<a class="headerlink" href="#anonimna-funkcija-izraz" title="Permalink to this heading">#</a></h3>
<p>Anonimna funkcija (glejte <a class="reference external" href="https://docs.python.org/tutorial/controlflow.html#lambda-expressions">dokumentacijo</a>) je funkcija, kateri ne damo imena (zato je <em>anonimna</em>), ampak jo definiramo z ukazom <code class="docutils literal notranslate"><span class="pre">lambda</span></code>. Tipična uporaba je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">lambda</span> <span class="p">[</span><span class="n">seznam</span> <span class="n">parametrov</span><span class="p">]:</span> <span class="n">izraz</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lambda</span></code> funkcijo si bomo pogledali na primeru razvrščanja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>od najmanjše do največje vrednosti. To lahko izvedemo z vgrajeno metodo <code class="docutils literal notranslate"><span class="pre">sort</span></code> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list.sort">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sort</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Metoda ima dva opcijska argumenta:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> ključ, po katerem razvrstimo elemente</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reverse</span></code>, če je <code class="docutils literal notranslate"><span class="pre">False</span></code>, se med vrednostmi ključa uporabi <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> sicer <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>.</p></li>
</ul>
<p>Opomba: <code class="docutils literal notranslate"><span class="pre">list.sort()</span></code> izvede razvrščanje na obstoječem seznamu in ne vrne seznama. Funkcija <code class="docutils literal notranslate"><span class="pre">sorted()</span></code> (glejte <a class="reference external" href="https://docs.python.org/3/library/functions.html#sorted">dokumentacijo</a>) pa vrne seznam urejenih vrednosti.</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">seznam</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-8, -4, 3, 6]
</pre></div>
</div>
</div>
</div>
<p>Sedaj uporabimo ključ, kjer se bo za primerjavo vrednosti razvrščanja uporabila kvadratna vrednost:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3, -4, 6, -8]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="obravnavanje-izjem">
<h2>Obravnavanje izjem<a class="headerlink" href="#obravnavanje-izjem" title="Permalink to this heading">#</a></h2>
<p>Pri programiranju se relativno pogosto pojavijo izjeme; na primer: deljenje z nič.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span>

<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">ZeroDivisionError</span>                         <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">50</span><span class="o">-</span><span class="mi">05</span><span class="n">c9758a9c21</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>

<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</pre></div>
</div>
<p>V primeru izjeme Python opozori na to in prekine izvajanje. Ni dobro, da se program prekine ali zruši; iz tega razloga bi zgornjo situacijo programer začetnik verjetno reševal s stavkom <code class="docutils literal notranslate"><span class="pre">if</span></code>. Takšen pristop pa ni preveč uporaben niti splošen in zato je v večini modernih programskih jezikih uveljavljeno obravnavanje izjem.</p>
<p>Pogledali si bomo nekatere osnove, ki bodo študentom predvsem olajšale branje in razumevanje kod drugih avtorjev.</p>
<p>Izjeme obvladujemo s stavkom <code class="docutils literal notranslate"><span class="pre">try</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="p">[</span><span class="n">koda0</span><span class="p">]</span>
<span class="k">except</span><span class="p">:</span>
    <span class="p">[</span><span class="n">koda1</span><span class="p">]</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="p">[</span><span class="n">koda2</span><span class="p">]</span>
</pre></div>
</div>
<p>V stavki <code class="docutils literal notranslate"><span class="pre">try</span></code> se <code class="docutils literal notranslate"><span class="pre">except</span></code> izvede, če se v kodi <code class="docutils literal notranslate"><span class="pre">[koda0]</span></code> pojavi izjema, <code class="docutils literal notranslate"><span class="pre">finally</span></code> je opcijski in  se izvede v vsakem primeru ob izhodu iz stavka <code class="docutils literal notranslate"><span class="pre">try</span></code>.</p>
<p>Poglejmo primer, ko enostavno nadaljujemo z izvajanjem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<p>Ukaz <code class="docutils literal notranslate"><span class="pre">pass</span></code> uporabimo, ko sintaksa zahteva stavek (kodo) za izvajanje, vendar ne želimo nobenega ukrepa (glejte <a class="reference external" href="https://docs.python.org/tutorial/controlflow.html#pass-statements">dokumentacijo</a>).</p>
<p>S pomočjo <code class="docutils literal notranslate"><span class="pre">except</span></code> lahko lovimo tudi različne izjeme, to naredimo tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="mi">1</span><span class="o">/</span><span class="mi">0</span> 
<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deljenje z ničlo!&#39;</span><span class="p">)</span> <span class="c1"># ali kakšna druga akcija</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nepričakovana napaka.&#39;</span><span class="p">)</span> <span class="c1"># odsvetovano; dobro je predvideti napako!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Deljenje z ničlo!
</pre></div>
</div>
</div>
</div>
<p>Sedaj uporabimo isto kodo za primer deljenja števila z nizom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="mi">1</span><span class="o">/</span><span class="s1">&#39;to pa ne gre&#39;</span>
<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deljenje z ničlo!&#39;</span><span class="p">)</span> <span class="c1"># ali kakšna druga akcija</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nepričakovana napaka.&#39;</span><span class="p">)</span> <span class="c1"># odsvetovano; dobro je predvideti napako!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nepričakovana napaka.
</pre></div>
</div>
</div>
</div>
<section id="prozenje-izjem">
<h3>Proženje izjem<a class="headerlink" href="#prozenje-izjem" title="Permalink to this heading">#</a></h3>
<p>Izjeme pa lahko tudi sami prožimo; to naredimo z ukazom <code class="docutils literal notranslate"><span class="pre">raise</span></code> (<a class="reference external" href="https://docs.python.org/tutorial/errors.html#raising-exceptions">dokumentacija</a>).</p>
<p>Primer proženja napake je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Opis izjeme&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>preprost, vendar celovit, primer, ko bi pričakovali, da je <code class="docutils literal notranslate"><span class="pre">ime_osebe</span></code> tipa <code class="docutils literal notranslate"><span class="pre">str</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ime_osebe</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ime_osebe</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ime ni pričakovanega tipa `str`.&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">izjema</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">izjema</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ime ni pričakovanega tipa `str`.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="osnove-modulov">
<h2>Osnove modulov<a class="headerlink" href="#osnove-modulov" title="Permalink to this heading">#</a></h2>
<p>Z moduli lahko na enostaven način uporabimo že napisano kodo. Preprosto povedano, moduli nam v Pythonu omogočajo relativno enostavno ohranjanje preglednosti in reda. Ponavadi v modul zapakiramo neko zaključeno funkcijo, skupino funkcij ali npr. objekt (pozneje bomo spoznali, kaj je objekt).</p>
<p>Za podroben opis uvažanja modulov glejte <a class="reference external" href="https://docs.python.org/reference/import.html#the-import-system">dokumentacijo</a>.</p>
<p>V mapi <code class="docutils literal notranslate"><span class="pre">moduli</span></code> se nahaja datoteka <code class="docutils literal notranslate"><span class="pre">prvi_modul.py</span></code>, ki ima sledečo vsebino:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kvadrat</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p><strong>Pomembno</strong>: pogosto module hierarhično razporejamo po direktorijih. <strong>Samo</strong> če je v določenem direktoriju datoteka (lahko tudi prazna) <strong>__init__.py</strong>, potem se tak direktorij obnaša kot modul. V zgornjem primeru taka datoteka obstaja in posledično se mapa <code class="docutils literal notranslate"><span class="pre">moduli</span></code> obnaša kot <em>modul</em>, v tem modulu je pa <em>podmodul</em> <code class="docutils literal notranslate"><span class="pre">prvi_modul</span></code> (datoteka pa je <code class="docutils literal notranslate"><span class="pre">prvi_modul.py</span></code>).</p>
<p>Module tipično uvažamo na dva načina:</p>
<p><strong>Prvi način</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moduli</span> <span class="kn">import</span> <span class="n">prvi_modul</span>
</pre></div>
</div>
<p><em>v tem primeru uvozimo imenski prostor <code class="docutils literal notranslate"><span class="pre">prvi_modul</span></code></em>; to pomeni, da funkcijo v <code class="docutils literal notranslate"><span class="pre">kvadrat()</span></code> kličemo tako: <code class="docutils literal notranslate"><span class="pre">prvi_modul.kvadrat()</span></code>.</p>
<p><strong>Drugi način uvažanja modula</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">moduli</span>
</pre></div>
</div>
<p>Uvozimo <em>imenski prostor <code class="docutils literal notranslate"><span class="pre">moduli</span></code></em>; to pomeni, da funkcijo <code class="docutils literal notranslate"><span class="pre">kvadrat()</span></code> kličemo tako: <code class="docutils literal notranslate"><span class="pre">moduli.prvi_modul.kvadrat()</span></code>.</p>
<p>V kolikor želimo uvoziti funkcije v modulu <code class="docutils literal notranslate"><span class="pre">prvi_modul</span></code>, to naredimo tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moduli</span> <span class="kn">import</span> <span class="n">prvi_modul</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj lahko funkcijo <code class="docutils literal notranslate"><span class="pre">kvadrat</span></code> kličemo tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prvi_modul</span><span class="o">.</span><span class="n">kvadrat</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25
</pre></div>
</div>
</div>
</div>
<p>Z ukazom <code class="docutils literal notranslate"><span class="pre">from</span></code> lahko uvozimo samo del modula. Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moduli.prvi_modul</span> <span class="kn">import</span> <span class="n">kvadrat</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj kličemo neposredno funkcijo <code class="docutils literal notranslate"><span class="pre">kvadrat</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kvadrat</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36
</pre></div>
</div>
</div>
</div>
<p>Funkcije ali module lahko tudi preimenujemo. Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moduli.prvi_modul</span> <span class="kn">import</span> <span class="n">kvadrat</span> <span class="k">as</span> <span class="n">sqr</span>
<span class="n">sqr</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49
</pre></div>
</div>
</div>
</div>
<p><strong>Kje Python išče module?</strong></p>
<ol class="arabic simple">
<li><p>V trenutni mapi (to je tista, v kateri ste prožili <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code>),</p></li>
</ol>
<ul class="simple">
<li><p>v mapah, definiranih v <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>,</p></li>
<li><p>v mapah, kjer je nameščen Python (poddirektorij <code class="docutils literal notranslate"><span class="pre">site-packages</span></code>).</p></li>
</ul>
<section id="uvoz-modulov-in-jupyter-notebook">
<h3>Uvoz modulov in Jupyter notebook<a class="headerlink" href="#uvoz-modulov-in-jupyter-notebook" title="Permalink to this heading">#</a></h3>
<p>V tej knjigi bomo, zaradi pedagoških razlogov, module vedno uvažali takrat, ko jih bomo prvič potrebovali. <strong>Pravila dobre prakse in pregledne kode priporočajo, da se uvoze vseh modulov izvede na vrhu Jupyter notebooka!</strong></p>
</section>
<section id="modul-pickle">
<h3>Modul <code class="docutils literal notranslate"><span class="pre">pickle</span></code><a class="headerlink" href="#modul-pickle" title="Permalink to this heading">#</a></h3>
<p>Modul <code class="docutils literal notranslate"><span class="pre">pickle</span></code> bomo velikokrat uporabljali za zelo hitro in kompaktno shranjevanje in branje podatkov.
<code class="docutils literal notranslate"><span class="pre">pickle</span></code> vrednosti spremenljivke shrani v taki obliki, kot so zapisane v spominu. V primeru racionalnih števil tako  <strong>ne izgublja na natančnosti</strong> (zapis v tekstovno obliko izgublja natančnost, saj definiramo število izpisanih števk, ki pa je lahko manjše od števila decimalnih mest v spominu). Poleg tega pa je zapis v <strong>spominu ponavadi manj zahteven</strong> kakor zapis v tekstovni obliki. Ker vrednosti ni treba pretvarjati v/iz tekstovno/e obliko/e, je pisanje/branje tudi <strong>zelo hitro</strong>! Tukaj si bomo pogledali osnovno uporabo, celovito je <code class="docutils literal notranslate"><span class="pre">pickle</span></code> opisan v  <a class="reference external" href="https://docs.python.org/library/pickle.html">dokumentaciji</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">pickle</span></code> ima dve pomembni metodi:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dump(obj,</span> <span class="pre">file,</span> <span class="pre">protocol=None,</span> <span class="pre">*,</span> <span class="pre">fix_imports=True)</span></code> za shranjevanje objekta <code class="docutils literal notranslate"><span class="pre">obj</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load(file,</span> <span class="pre">*,</span> <span class="pre">fix_imports=True,</span> <span class="pre">encoding=&quot;ASCII&quot;,</span> <span class="pre">errors=&quot;strict&quot;)</span></code> za brane datoteke <code class="docutils literal notranslate"><span class="pre">file</span></code>.</p></li>
</ul>
<p>Uporabo si bomo pogledali na primeru. Najprej uvozimo modul:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
<p>Zapišimo vrednosti slovarja <code class="docutils literal notranslate"><span class="pre">a</span></code> v datoteko <code class="docutils literal notranslate"><span class="pre">data/stanje1.pkl</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;število&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;velikost&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/stanje1.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datoteka</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datoteka</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># pazite: uporabite protocol=-1, da boste uporabili zadnjo verzijo</span>
</pre></div>
</div>
</div>
</div>
<p>Opazimo, da so datoteko odprli za pisanje v binarni obliki <code class="docutils literal notranslate"><span class="pre">wb</span></code>. Pomembno je tudi, da uporabimo zadnjo verzijo protokola (parameter <code class="docutils literal notranslate"><span class="pre">protocol</span></code>); privzeta ni optimirana za hitrost in ne zapiše v binarni obliki.</p>
<p>Sedaj vrednosti preberimo nazaj v <code class="docutils literal notranslate"><span class="pre">b</span></code> in ga prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/stanje1.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datoteka</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">datoteka</span><span class="p">)</span>

<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;število&#39;: 1, &#39;velikost&#39;: 10}
</pre></div>
</div>
</div>
</div>
<p>Zgoraj smo trdili, da je pristop zelo hiter; preverimo to.</p>
<p>Najprej pripravimo podatke (seznam 50000 vrednosti tipa <code class="docutils literal notranslate"><span class="pre">ind</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Pisanje v tekstovni obliki</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">datoteka</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/data.txt&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">datoteka</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s1">7.2e</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>
<span class="n">datoteka</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.6 ms ± 342 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
</div>
</div>
<p>Pisanje s pomočjo <code class="docutils literal notranslate"><span class="pre">pickle</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/data.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datoteka</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">datoteka</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>892 µs ± 37.7 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Gre skoraj za 20 kratno pohitritev!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uporaba-modulov-iz-spleta">
<h2>Uporaba modulov iz spleta<a class="headerlink" href="#uporaba-modulov-iz-spleta" title="Permalink to this heading">#</a></h2>
<p>Poleg vgrajenih modulov in tistih, ki jih pripravimo sami, obstaja še velika množica modulov, ki jih lahko najdemo na spletu in Pythonu dodajajo nove funkcionalnosti. Šele ti moduli naredijo ekosistem Pythona tako uporaben.</p>
<p>Modul je tehnično gledano ena datoteka, kadar nek večji modul vsebuje več modulov, pa lahko začnemo govoriti o <em>paketih</em>. Najbolj pomembne pakete na področju inženirskih ved bomo spoznali v okviru te knjige.</p>
<p>Module oz. pakete lahko <em>posodabljamo</em> ali nameščamo <em>nove</em>, pri tem nam pomagajo t. i. <em>upravljalniki paketov</em> (angl. <em>package manager</em>). Najbolj pogost upravljalnik paketov je <code class="docutils literal notranslate"><span class="pre">pip</span></code> (<a class="reference external" href="https://pip.pypa.io/en/stable/">dokumentacija</a>).</p>
<section id="upravljalnik-paketov-pip">
<h3>Upravljalnik paketov <code class="docutils literal notranslate"><span class="pre">pip</span></code><a class="headerlink" href="#upravljalnik-paketov-pip" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pip</span></code> je upravljalnik paketov z dolgo zgodovino in podpira veliko število paketov (<a class="reference external" href="https://pypi.org">pypi.org</a>).</p>
<p>Že nameščene pakete najdemo z ukazom v ukazni vrstici (<a class="reference external" href="https://pip.pypa.io/en/stable/reference/pip_list/">dokumentacija</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="nb">list</span>
</pre></div>
</div>
<p>Namesto izhoda v ukazno vrstico bomo večkrat uporabljali možnost <em>Jupyter notebooka</em>, ko s pomočjo klicaja (!) v celici s kodo izvedemo ukaz v ukazni vrstici  (gre za kratko obliko magičnega ukaza <code class="docutils literal notranslate"><span class="pre">%sx</span></code> - shell execute, glejte <a class="reference external" href="http://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-sx">dokumentacijo</a>). Opomba: dva klicaja bi vrnila celoten rezultat neposredno v notebook (ker je izpis zelo dolg, smo se temu izognili).</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rezultat</span> <span class="o">=</span> <span class="o">!</span>pip<span class="w"> </span>list
<span class="n">rezultat</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Package                           Version&#39;,
 &#39;--------------------------------- ------------&#39;,
 &#39;accessible-pygments               0.0.4&#39;,
 &#39;alabaster                         0.7.13&#39;,
 &#39;anyio                             4.0.0&#39;]
</pre></div>
</div>
</div>
</div>
<p>Pakete namestimo z ukazom (v ukazni vrstici):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="p">[</span><span class="n">ime_paketa</span><span class="p">]</span>
</pre></div>
</div>
<p>posodobimo z:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="p">[</span><span class="n">ime_paketa</span><span class="p">]</span> <span class="o">--</span><span class="n">upgrade</span>
</pre></div>
</div>
<p>in odstranimo z:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">uninstall</span> <span class="p">[</span><span class="n">ime_paketa</span><span class="p">]</span>
</pre></div>
</div>
<p>Za več glejte <a class="reference external" href="https://pip.pypa.io/en/stable/getting-started/">dokumentacijo</a>.</p>
<section id="primer-namestitve-paketa">
<h4>Primer namestitve paketa<a class="headerlink" href="#primer-namestitve-paketa" title="Permalink to this heading">#</a></h4>
<p>Sicer pa pakete najpogosteje najdemo na spletu (<a class="reference external" href="https://pypi.org">pypi.org</a>). Pojdite na omenjeni portal in poiščite pakete na temo snemanja posnetkov iz portala <a class="reference external" href="https://www.youtube.com">www.youtube.com</a>.  Z iskanjem „pytube“ najdemo obetaven paket, ki ga namestimo:</p>
<p>Sedaj modul uporabimo (za podrobnosti uporabe glejte <a class="reference external" href="https://github.com/pytube/pytube">dokumentacijo</a>). Najprej uvozimo celotni paket:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytube</span>
<span class="n">yt</span> <span class="o">=</span> <span class="n">pytube</span><span class="o">.</span><span class="n">YouTube</span><span class="p">(</span><span class="s1">&#39;https://www.youtube.com/watch?v=P4IrAXbpeyI&#39;</span><span class="p">)</span> <span class="c1"># kreiramo instanco objekta (kaj to točno pomeni, spoznamo pozneje)</span>
<span class="n">yt</span><span class="o">.</span><span class="n">streams</span><span class="o">.</span><span class="n">get_highest_resolution</span><span class="p">()</span><span class="o">.</span><span class="n">download</span><span class="p">()</span> <span class="c1">#Prenesemo video</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">61</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pytube</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">yt</span> <span class="o">=</span> <span class="n">pytube</span><span class="o">.</span><span class="n">YouTube</span><span class="p">(</span><span class="s1">&#39;https://www.youtube.com/watch?v=P4IrAXbpeyI&#39;</span><span class="p">)</span> <span class="c1"># kreiramo instanco objekta (kaj to točno pomeni, spoznamo pozneje)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">yt</span><span class="o">.</span><span class="n">streams</span><span class="o">.</span><span class="n">get_highest_resolution</span><span class="p">()</span><span class="o">.</span><span class="n">download</span><span class="p">()</span> <span class="c1">#Prenesemo video</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pytube&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Odprite datoteko za zapis in vanjo vpišite formatirani (skupaj 7 mest, 3 decimalna mesta) seznam v dveh stolpcih. Razločevalni znak med stolpci naj bo prazen znak ‚ ‚.</p></li>
<li><p>Odprite pripeto datoteko <code class="docutils literal notranslate"><span class="pre">zapis_labview.lvm</span></code> (gre za zapis iz programa LabView) in preberite glavo v obliki slovarja (‚ime polja‘: vrednost).</p></li>
<li><p>V datoteki iz prejšnje točke preberite podatke (uporabite funkcijo <code class="docutils literal notranslate"><span class="pre">replace()</span></code> za zamenjavo decimalne vejice v piko in nato pretvorite niz v število. Najdite ustrezno dokumentacijo/help).</p></li>
<li><p>Na poljubnem seznamu besed prikažite uporabo izpeljevanja seznamov tako, da zamenjate poljuben samoglasnik.</p></li>
<li><p>Napišite funkcijo. Če se v funkcijo vstavi seznam besed, potem naj vrne dolžino besed. Če se v funkcjo vstavi seznam numeričnih vrednosti, potem naj vrne njihovo vrednost povečano za ena.</p></li>
<li><p>Zgornjo funkcijo nadgradite: če se v funkcijo vstavi prazen seznam (dolžine 0), potem naj sproži izjemo <code class="docutils literal notranslate"><span class="pre">Exception</span></code> z ustreznim opisom.</p></li>
<li><p>Pripravite novo funkcijo, ki bo klicala funkcijo iz točke 6 in lovila izjeme.</p></li>
<li><p>Za obe funkciji pripravite <em>docstring</em>.</p></li>
<li><p>Prikažite uporabo argumentov s privzetimi vrednostmi.</p></li>
<li><p>Prikažite uporabo argumentov glede na mesto in glede na ime.</p></li>
<li><p>V funkcijo pošljite nepredvidene vrednosti (nize in numerične vrednosti).</p></li>
<li><p>V funkcijo pošljite nepredvidene poimenske vrednosti.</p></li>
<li><p>Definirajte <em>lambda</em> funkcijo in jo uporabite v povezavi s funkcijo <code class="docutils literal notranslate"><span class="pre">max</span></code> ali <code class="docutils literal notranslate"><span class="pre">min</span></code>.</p></li>
<li><p>Zgornji funkciji shranite v modul poljubnega imena (npr.: prve_funkcije.py).</p></li>
<li><p>Uvozite samo eno od funkcij kot funkcijo z novim imenom (drugačno ime od izvornega).</p></li>
<li><p>Poljuben slovar shranite in odprite s <code class="docutils literal notranslate"><span class="pre">pickle</span></code>.</p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<section id="oblikovanje-datuma-in-casa">
<h3>Oblikovanje datuma in časa<a class="headerlink" href="#oblikovanje-datuma-in-casa" title="Permalink to this heading">#</a></h3>
<p>Najprej uvozimo modul za delo z datumom in časom <code class="docutils literal notranslate"><span class="pre">datetime</span></code> in prikažemo trenutni čas z datumom (uporabimo funkcijo <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime.now"><code class="docutils literal notranslate"><span class="pre">now()</span></code></a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">sedaj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">sedaj</span>
</pre></div>
</div>
</div>
</div>
<p>Podatek o času oblikujemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sedaj</span><span class="si">:</span><span class="s1">%Y-%m-%d %H:%M:%S</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Oblikovanje datuma in ure sledi metodam:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">strftime</span></code> (<a class="reference external" href="https://docs.python.org/library/datetime.html#datetime.datetime.strftime">dokumentacija</a>) se uporablja za pretvorbo iz <code class="docutils literal notranslate"><span class="pre">datetime</span></code> v niz črk,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strptime</span></code> (<a class="reference external" href="https://docs.python.org/library/datetime.html#datetime.datetime.strptime">dokumentacija</a>) se uporablja za pretvorbo iz niza črk v tip <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p></li>
</ul>
<p>Kako izpisati ustrezno obliko (torej kako uporabiti znake <code class="docutils literal notranslate"><span class="pre">%Y</span></code>, <code class="docutils literal notranslate"><span class="pre">%m</span></code> itd.) je prav tako podrobno pojasnjeno v <a class="reference external" href="https://docs.python.org/library/datetime.html#strftime-strptime-behavior">dokumentaciji</a>.</p>
<p>Poglejmo si primer pretvorbe tipa <code class="docutils literal notranslate"><span class="pre">datetime</span></code> v niz (glede na zgoraj smo dodali še %a, da se izpiše ime dneva):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sedaj</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S </span><span class="si">%a</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj v obratno smer, torej iz niza v <code class="docutils literal notranslate"><span class="pre">datetime</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2017-09-28 05:31:45&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="uporabljajte-www-stackoverflow-com">
<h3>Uporabljajte <a class="reference external" href="http://www.stackoverflow.com">www.stackoverflow.com</a>!<a class="headerlink" href="#uporabljajte-www-stackoverflow-com" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="http://www.stackoverflow.com">http://www.stackoverflow.com</a></p>
</section>
<section id="nekateri-moduli">
<h3>Nekateri moduli<a class="headerlink" href="#nekateri-moduli" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">openpyxl</span></code> za pisanje in branje Excel xlsx/xlsm datotek: <a class="reference external" href="http://openpyxl.readthedocs.org/en/latest/index.html#">vir</a>,</p></li>
</ol>
<ul class="simple">
<li><p>Regularni izrazi (zelo močno orodje za iskanje po nizih): <a class="reference external" href="https://docs.python.org/library/re.html">vir</a>.</p></li>
</ul>
</section>
<section id="modul-sys">
<h3>Modul <code class="docutils literal notranslate"><span class="pre">sys</span></code><a class="headerlink" href="#modul-sys" title="Permalink to this heading">#</a></h3>
<p>Python ima veliko število vgrajenih modulov (in še veliko se jih lahko prenese s spleta, npr. <a class="reference external" href="https://pypi.org/">tukaj</a>), ki dodajo različne funkcionalnosti.</p>
<p>Modul <code class="docutils literal notranslate"><span class="pre">sys</span></code> omogoča dostop do objektov, ki jih uporablja interpreter.</p>
<p>Poglejmo si primer; najprej uvozimo modul:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>
</div>
<p>Mape, kjer se iščejo moduli, lahko preverimo z ukazom <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> (<a class="reference external" href="https://docs.python.org/2/library/sys.html#sys.path">dokumentacija</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modul-os">
<h3>Modul <code class="docutils literal notranslate"><span class="pre">os</span></code><a class="headerlink" href="#modul-os" title="Permalink to this heading">#</a></h3>
<p>Modul <code class="docutils literal notranslate"><span class="pre">os</span></code> je namenjen delu z operacijskim sistemom in skrbi za združljivost z različnimi operacijskimi sistemi (če npr. napišete program na sistemu <em>Windows</em>, bo delal tudi na sistemu <em>linux</em>).</p>
<p>Uvozimo modul:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<p>Pogljemo trenutno mapo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">curdir</span>
</pre></div>
</div>
</div>
</div>
<p>ali trenutno mapo v absolutni obliki:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">curdir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Kako najdemo vse datoteke in mape v direktoriju?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo prve štiri s končnico <code class="docutils literal notranslate"><span class="pre">ipynb</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">ime</span> <span class="ow">in</span> <span class="n">seznam</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ime</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ime</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;ipynb&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Našel sem datoteko: </span><span class="si">{</span><span class="n">ime</span><span class="si">:</span><span class="s1">s</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">:</span>
            <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<p>Za več glejte <a class="reference external" href="https://docs.python.org/3.7/library/os.path.html#module-os.path">dokumentacijo</a>.</p>
</section>
</section>
<span id="document-notebooks/Predavanje 03 - Moduli, numpy, matplotlib"></span><section class="tex2jax_ignore mathjax_ignore" id="numpy-matplotlib">
<h2>Numpy, matplotlib<a class="headerlink" href="#numpy-matplotlib" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modul-numpy">
<h2>Modul <code class="docutils literal notranslate"><span class="pre">numpy</span></code><a class="headerlink" href="#modul-numpy" title="Permalink to this heading">#</a></h2>
<p>Kakor je omenjeno zgoraj, lahko modul <code class="docutils literal notranslate"><span class="pre">numpy</span></code> namestimo z upravljalnikom paketov <code class="docutils literal notranslate"><span class="pre">pip</span></code> z naslednjim ukazom (v kolikok ga še nimamo nameščenega):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span>
</pre></div>
</div>
<p>oz. paket posodobimo na najnovešo različico:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span> <span class="o">--</span><span class="n">upgrade</span>
</pre></div>
</div>
<section id="osnove-modula-numpy">
<h3>Osnove modula <code class="docutils literal notranslate"><span class="pre">numpy</span></code><a class="headerlink" href="#osnove-modula-numpy" title="Permalink to this heading">#</a></h3>
<p>Najprej uvozimo modul (uveljavljeno je, da ga uvozimo v kratki obliki <code class="docutils literal notranslate"><span class="pre">np</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Gre za enega najbolj pomembnih modulov. Na kratko: gre za visoko optimiran modul za numerične izračune; zelo dobri tutoriali so zbrani na naslovu: <a class="reference external" href="https://github.com/numpy/numpy-tutorials">github.com/numpy/numpy-tutorials</a>. Za odličen uvod v Numpy si lahko ogledate <a class="reference external" href="https://www.youtube.com/watch?v=DcfYgePyedM">YouTube posnetek: NumPy Tutorial (2021): For Physicists, Engineers, and Mathematicians</a></p>
<p>Poglejmo si najprej sintakso za vektor ničel (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>argumenti so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code> definira obliko (lahko večdimenzijsko numerično polje),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code> definira tip podatka,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">order</span></code> definira vrstni red (lahko je C ali F kot Fortran).</p></li>
</ul>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0.],
       [0., 0., 0., 0.],
       [0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>ali pa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>Podobno kot <code class="docutils literal notranslate"><span class="pre">zeros</span></code> se obnaša <code class="docutils literal notranslate"><span class="pre">ones</span></code>, vendar je namesto ničel vrednost 1 (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ones.html#numpy.ones">dokumentacija</a>).</p>
<p>Poglejmo si primer, kjer definiramo tudi tip <code class="docutils literal notranslate"><span class="pre">int</span></code> (privzeti tip je <code class="docutils literal notranslate"><span class="pre">float</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 1, 1, 1])
</pre></div>
</div>
</div>
</div>
<p>Pogosto bomo tudi uporabljali razpon vrednosti <code class="docutils literal notranslate"><span class="pre">arange</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">([</span><span class="n">start</span><span class="p">,</span> <span class="p">]</span><span class="n">stop</span><span class="p">,</span> <span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="p">]</span><span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> začetna vrednost razpona (privzeto 0),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop</span></code> končna vrednost razpona,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> korak in</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code> tip vrednosti (če tip ni podan, se vzame tip ostalih argumetnov, npr. <code class="docutils literal notranslate"><span class="pre">step</span></code>).</p></li>
</ul>
<p>Poglejmo primer razpona od 0 do 9 (kakor vedno pri Pythonu <em>od</em> je vključen, <em>do</em> pa ni):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1, 2, 3, 4, 5, 6, 7, 8])
</pre></div>
</div>
</div>
</div>
<p>ali pa od 7 do 12 po koraku 2, vendar število s plavajočo vejico:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 7.,  9., 11.])
</pre></div>
</div>
</div>
</div>
<p>Še eno funkcijo bomo pogosto uporabili, to je <code class="docutils literal notranslate"><span class="pre">linspace</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>ki definiranemu razponu vrne numerično polje vrednosti na enaki razdalji (ekvidistanten razmik).</p>
<p>Argumenti so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> začetna vrednost razpona,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop</span></code> končna vrednost razpona,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span></code> število točk/vozlišč,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endpoint</span></code> ali je vrednost pri <code class="docutils literal notranslate"><span class="pre">stop</span></code> vključena ali ne,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">retstep</span></code> v primeru <code class="docutils literal notranslate"><span class="pre">True</span></code> vrne funkcija terko <code class="docutils literal notranslate"><span class="pre">(rezultat,</span> <span class="pre">korak)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code> tip vrednosti (če tip ni podan, se vzame tip ostalih argumetnov, npr. <code class="docutils literal notranslate"><span class="pre">step</span></code>).</p></li>
</ul>
<p>Primer generiranja 10 točk na razponu od <span class="math notranslate nohighlight">\(-\pi\)</span> do vključno <span class="math notranslate nohighlight">\(+\pi\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-3.14159265, -2.44346095, -1.74532925, -1.04719755, -0.34906585,
        0.34906585,  1.04719755,  1.74532925,  2.44346095,  3.14159265])
</pre></div>
</div>
</div>
</div>
<p>Mimogrede smo zgoraj spoznali, da ima <code class="docutils literal notranslate"><span class="pre">numpy</span></code> vgrajene konstante (npr. <span class="math notranslate nohighlight">\(\pi\)</span>):</p>
<p>Poglejmo še vgrajene funkcije za generiranje naključnih števil. Te najdemo v <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy-1.16.0/reference/routines.random.html">dokumentacija</a>).</p>
<p>Najprej si poglejmo funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.random.seed()</span></code>, ki se uporablja za ponastavitev generatorja naključnih števil (<a class="reference external" href="https://docs.scipy.org/doc/numpy-1.16.0/reference/generated/numpy.random.seed.html#numpy.random.seed">dokumentacija</a>). To pomeni, da lahko z istim semenom (angl. <em>seed</em>) različni uporabniki generiramo ista naključna števila!</p>
<p>Spodnja vrstica:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>bo povzročila, da bo klic generatorja naključnih števil z enakomerno porazdelitvijo <code class="docutils literal notranslate"><span class="pre">numpy.random.rand()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy-1.16.0/reference/generated/numpy.random.rand.html#numpy.random.rand">dokumentacija</a>) vedno rezultiral v iste vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.5488135 , 0.71518937, 0.60276338])
</pre></div>
</div>
</div>
</div>
<p>Preizkusimo ali je res, kar smo zapisali, in ponastavimo seme in kličimo generator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.5488135 , 0.71518937, 0.60276338])
</pre></div>
</div>
</div>
</div>
<section id="zapis-matrik-in-vektorjev">
<h4>Zapis matrik in vektorjev<a class="headerlink" href="#zapis-matrik-in-vektorjev" title="Permalink to this heading">#</a></h4>
<p>Matrika je dimenzije <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">n</span></code>, kjer je na prvem mestu <code class="docutils literal notranslate"><span class="pre">m</span></code> število vrstic in <code class="docutils literal notranslate"><span class="pre">n</span></code> število stolpcev. Primer definiranja matrike dimenzije <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">n</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">x</span> <span class="pre">2</span></code> je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>Vektor je lahko zapisan kot <strong>vrstični vektor</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># (1 x 3)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<p>ali kot <strong>stolpični vektor</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="c1"># 3 x 1</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.],
       [0.],
       [0.]])
</pre></div>
</div>
</div>
</div>
<p>V modulu <code class="docutils literal notranslate"><span class="pre">numpy</span></code> lahko vektorje in matrike zapisujemo kot:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> (priporočeno, <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html">dokumentacija</a>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.matrix</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matrix.html">dokumentacija</a>).</p></li>
</ul>
<p>Priporočena je prva oblika (<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>), ki pa ne sledi povsem matematičnemu zapisu (več o tem pozneje), nam pa omogoča <strong>enostavnejše</strong> programiranje in je tudi numerično <strong>bolj učinkovit</strong> pristop (<a class="reference external" href="http://wiki.scipy.org/NumPy_for_Matlab_Users#head-e9a492daa18afcd86e84e07cd2824a9b1b651935">vir</a>). Pristopa <code class="docutils literal notranslate"><span class="pre">numpy.matrix</span></code> tukaj ne bomo obravnavali.</p>
<p>V angleškem jeziku bomo <em>array</em> prevajali kot <strong>večdimenzijsko numerično polje</strong> ali včasih <strong>večdimenzijske sezname</strong> (ker imajo nekatere podobnosti z navadnimi seznami). Nekatere knjige <em>array</em> tukaj prevajajo kot <em>tabela</em>.</p>
</section>
<section id="rezanje">
<h4>Rezanje<a class="headerlink" href="#rezanje" title="Permalink to this heading">#</a></h4>
<p><strong>Rezanje</strong> (angl. <em>slicing</em>) seznamov smo si že pogledali v poglavju Uvod v Python. Podobno rezanje, vendar bolj splošno, velja tudi za numerična polja modula <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<p>Sintaksa rezanja (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">dokumentacija</a>) je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy_array</span><span class="p">[</span><span class="n">od</span><span class="p">:</span><span class="n">do</span><span class="p">:</span><span class="n">korak</span><span class="p">]</span>
</pre></div>
</div>
<p>pri tem velja:</p>
<ul class="simple">
<li><p>indeksiranje se začne z 0 (kot sicer pri Pythonu),</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">od</span></code></strong> pomeni <strong>&gt;=</strong>,</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">do</span></code></strong> pomeni <strong>&lt;</strong>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">od</span></code>, <code class="docutils literal notranslate"><span class="pre">do</span></code>, <code class="docutils literal notranslate"><span class="pre">korak</span></code> so opcijski parametri,</p></li>
<li><p>če parameter <code class="docutils literal notranslate"><span class="pre">od</span></code> ni podan, pomeni od <em>začetka</em>,</p></li>
<li><p>če parameter <code class="docutils literal notranslate"><span class="pre">do</span></code> ni podan, pomeni do vključno zadnjega,</p></li>
<li><p>če parameter <code class="docutils literal notranslate"><span class="pre">korak</span></code> ni podan, pomeni korak 1.</p></li>
</ul>
<p>Primer od elementa 3 do elementa 8 po koraku 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 5, 7])
</pre></div>
</div>
</div>
</div>
<p>Primer od elementa 3 naprej:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 4, 5, 6, 7, 8, 9])
</pre></div>
</div>
</div>
</div>
<p>Primer od elementa 3 naprej, vendar vsak tretji:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 6, 9])
</pre></div>
</div>
</div>
</div>
<p>Primer zadnjih 5 elementov, vendar vsak drugi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5, 7, 9])
</pre></div>
</div>
</div>
</div>
<p>Primer zadnjih 5 elementov brez zadnjih 2, vendar vsak drugi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5, 7])
</pre></div>
</div>
</div>
</div>
<section id="poglejmo-si-se-rezanje-vecdimenzijskega-numericnega-polja">
<h5>Poglejmo si še rezanje večdimenzijskega numeričnega polja.<a class="headerlink" href="#poglejmo-si-se-rezanje-vecdimenzijskega-numericnega-polja" title="Permalink to this heading">#</a></h5>
<p>Večdimenzijsko rezanje izvedemo tako, da dimenzije ločimo z vejico:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy_array</span><span class="p">[</span><span class="n">rezanje0</span><span class="p">,</span> <span class="n">rezanje1</span><span class="p">,</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>kjer <code class="docutils literal notranslate"><span class="pre">rezanje0</span></code> reže indeks 0 (prvo dimenzijo) v obliki <code class="docutils literal notranslate"><span class="pre">od:do:korak</span></code>, <code class="docutils literal notranslate"><span class="pre">rezanje1</span></code> reže indeks 1 (drugo dimenzijo) in tako naprej.</p>
<p>Poglejmo si primer; najprej pripravimo seznam 15 števil (<code class="docutils literal notranslate"><span class="pre">np.arange</span></code>), nato z metodo <code class="docutils literal notranslate"><span class="pre">reshape()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html">dokumentacija</a>) spremenimo obliko v matriko <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">x</span> <span class="pre">5</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14]])
</pre></div>
</div>
</div>
</div>
<p>Obliko numeričnega polja lahko preverimo z atributom <code class="docutils literal notranslate"><span class="pre">shape</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.shape.html">dokumentacija</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 5)
</pre></div>
</div>
</div>
</div>
<p>Atribute bomo sicer podrobno spoznali pri obravnavi razredov.</p>
<p>Prikažimo vrstice z indeksom 0:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1, 2, 3, 4])
</pre></div>
</div>
</div>
</div>
<p>Isti rezultat bi dobili s prikazom vrstice z indeksom 0 in vseh stolpcev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1, 2, 3, 4])
</pre></div>
</div>
</div>
</div>
<p>Pogosto želimo dostopati do stoplcev, npr. stolpca z indeksom 1 (torej režemo vse vrstice in stolpec z indeksom 1):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1,  6, 11])
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si še primer rezanja prvih dveh vrstic in zadnjih dveh stolpcev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[3, 4],
       [8, 9]])
</pre></div>
</div>
</div>
</div>
<p>Podobna logika se uporabi pri dimenzijah višjih od 2.</p>
</section>
</section>
<section id="operacije-nad-numericnimi-polji">
<h4>Operacije nad numeričnimi polji<a class="headerlink" href="#operacije-nad-numericnimi-polji" title="Permalink to this heading">#</a></h4>
<p>Poglejmo si sedaj bolj podrobno nekatere osnovne prednosti numeričnega polja <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> v primerjavi z navadnim seznamom Python.</p>
<p>Najprej pripravimo navaden Pythonov seznam:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5, 6, 7]
</pre></div>
</div>
</div>
</div>
<p>In nato še numerično polje <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> (kar iz seznama <code class="docutils literal notranslate"><span class="pre">a</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 2, 3, 4, 5, 6, 7])
</pre></div>
</div>
</div>
</div>
<p>Ko izpišemo <code class="docutils literal notranslate"><span class="pre">b</span></code>, smo opozorjeni, da gre za <code class="docutils literal notranslate"><span class="pre">array([...])</span></code>.</p>
<p>Poglejmo, kako se obnaša Pythonov seznam pri množenju:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">*</span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7]
</pre></div>
</div>
</div>
</div>
<p>Opazimo, da se podvoji seznam, ne pa vrednosti, kar bi morebiti pričakovali.</p>
<p>Poglejmo, kako se pri množenju obnaša numerično polje <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">*</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 2,  4,  6,  8, 10, 12, 14])
</pre></div>
</div>
</div>
</div>
<p>Opazimo, da se podvojijo vrednosti; tako kakor bi pričakovali, ko množimo na primer skalarno vrednost in vektor!</p>
</section>
<section id="aritmeticne-operacije">
<h4>Aritmetične operacije<a class="headerlink" href="#aritmeticne-operacije" title="Permalink to this heading">#</a></h4>
<p>Izbor aritmetičnih operacij, ki jih <code class="docutils literal notranslate"><span class="pre">numpy</span></code> izvaja na nivoju posameznega elementa, je (po naraščajoči prioriteti):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span></code> vsota,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">-</span> <span class="pre">y</span></code> razlika,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span></code> produkt,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">/</span> <span class="pre">y</span></code> deljenje,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">//</span> <span class="pre">y</span></code> celoštevilsko deljenje (rezultat je celo število zaokroženo navzdol),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">%</span> <span class="pre">y</span></code> ostanek pri celoštevilskem deljenju,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">**</span> <span class="pre">y</span></code>	vrne <code class="docutils literal notranslate"><span class="pre">x</span></code> na potenco <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
</ul>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  3,   4,   3,   0,  -5, -12, -21])
</pre></div>
</div>
</div>
</div>
<p>Vse aritmetične operacije so sicer navedene v <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#arithmetic-operations">dokumentaciji</a> in namesto kratkih oblik imamo tudi <em>dolge</em>, npr: <code class="docutils literal notranslate"><span class="pre">numpy.power(x,</span> <span class="pre">y)</span></code> namesto <code class="docutils literal notranslate"><span class="pre">x**y</span></code>; primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1,  4,  9, 16, 25, 36, 49], dtype=int32)
</pre></div>
</div>
</div>
</div>
<p>Mimogrede opazimo, da je rezultat tipa <code class="docutils literal notranslate"><span class="pre">int32</span></code> (integer). Ko smo ustvarili ime <code class="docutils literal notranslate"><span class="pre">b</span></code>, smo namreč ustvarili numerično polje z elementi tipa <code class="docutils literal notranslate"><span class="pre">int32</span></code>.</p>
</section>
<section id="matematicne-funkcije">
<h4>Matematične funkcije<a class="headerlink" href="#matematicne-funkcije" title="Permalink to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> ponuja praktično vse potrebne matematične (in druge) operacije, navedimo jih po skupinah, kot so strukturirane v <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#mathematical-functions">dokumentaciji</a>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#trigonometric-functions">trigonometrične funkcije</a>,</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#hyperbolic-functions">hiperbolične</a>,</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#rounding">funkcije za zaokroževanje</a>,</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#sums-products-differences">funkcije za vsoto, produkt in odvod</a>,</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#exponents-and-logarithms">eksponenti in logaritmi</a>,</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#other-special-functions">posebne</a> ter <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.math.html#miscellaneous">preostale</a> funkcije.</p></li>
</ul>
<p>Poglejmo primer funkcije <span class="math notranslate nohighlight">\(\sin()\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.0000000e+00,  1.0000000e+00,  1.2246468e-16, -1.0000000e+00,
       -2.4492936e-16])
</pre></div>
</div>
</div>
</div>
<p>Poglejmo še hitrost izvajanja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> -n100 np.sin(a)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>362 ns ± 34.3 ns per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
</section>
<section id="podatkovni-tipi">
<h4>Podatkovni tipi<a class="headerlink" href="#podatkovni-tipi" title="Permalink to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> ima vnaprej definirane podatkovne tipe (statično). Celoten seznam možnih tipov je naveden v <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html">dokumentaciji</a>.</p>
<p>Osredotočili se bomo predvsem na sledeče tipe:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> - celo število (poljubno veliko)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code> - število s plavajočo vejico (<a class="reference external" href="https://docs.python.org/dev/library/functions.html#float">dokumentacija</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">complex</span></code> - kompleksno število s plavajočo vejico</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code> - python objekt.</p></li>
</ul>
<p>Poglejmo si nekaj primerov (cela števila, število s plavajočo vejico in kompleksna števila):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1, 2, 3, 4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 1., 2., 3., 4.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.+0.j, 1.+0.j, 2.+0.j, 3.+0.j, 4.+0.j])
</pre></div>
</div>
</div>
</div>
</section>
<section id="spreminjanje-elementov-numericnega-polja-numpy-array">
<h4>Spreminjanje elementov numeričnega polja (<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>)<a class="headerlink" href="#spreminjanje-elementov-numericnega-polja-numpy-array" title="Permalink to this heading">#</a></h4>
<p>Podatke spreminjamo na podoben način kakor pri navadnih seznamih; v kolikor uporabljamo rezanje, moramo paziti, da so na levi in desni strani enačaja podatki iste oblike (<code class="docutils literal notranslate"><span class="pre">array.shape</span></code>).</p>
<p>Poglejmo si primer, ko matriki ničel dimenzije <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">x</span> <span class="pre">4</span></code> spremenimo element z indeksom <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">3]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  0.,   0.,   0.,   0.],
       [  0.,   0.,   0.,   0.],
       [  0.,   0.,   0., 100.]])
</pre></div>
</div>
</div>
</div>
<p>Sedaj spremenimo še elemente prvih dveh vrstic in prvih dveh stolpcev v vrednost 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1.,   1.,   0.,   0.],
       [  1.,   1.,   0.,   0.],
       [  0.,   0.,   0., 100.]])
</pre></div>
</div>
</div>
</div>
<p>Z 2 pomnožimo stolpec z indeksom 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1.,   2.,   0.,   0.],
       [  1.,   2.,   0.,   0.],
       [  0.,   0.,   0., 100.]])
</pre></div>
</div>
</div>
</div>
<p>Bodite pozorni na to, da na tak način naredimo <em>pogled</em> (view) na podatke (<strong>ne naredimo kopije podatkov</strong>).</p>
<p>Za primer najprej naredimo novo ime <code class="docutils literal notranslate"><span class="pre">pogled</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pogled</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">pogled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<p>Sedaj spremenimo izbrane vrednosti numeričnega polja <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1.,   2.,   5.,   0.],
       [  1.,   2.,   5.,   0.],
       [  0.,   0.,   5., 100.]])
</pre></div>
</div>
</div>
</div>
<p>Vrednosti <code class="docutils literal notranslate"><span class="pre">pogled</span></code> nismo spreminjali. Ker pa ime kaže na isto mesto kakor <code class="docutils literal notranslate"><span class="pre">a[:,</span> <span class="pre">2]</span></code>, so vrednosti spremenjene:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pogled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5., 5., 5.])
</pre></div>
</div>
</div>
</div>
<p>Če želimo kopijo, moramo narediti tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kopija</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">kopija</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5., 5., 5.])
</pre></div>
</div>
</div>
</div>
<p>in rezultat <code class="docutils literal notranslate"><span class="pre">kopija</span></code> ostane nespremenjen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">kopija</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5., 5., 5.])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="osnove-matricnega-racunanja">
<h3>Osnove matričnega računanja<a class="headerlink" href="#osnove-matricnega-racunanja" title="Permalink to this heading">#</a></h3>
<p>Če želite ponoviti matematične osnove matričnega računanja, potem sledite tej <a class="reference external" href="http://www.fmf.uni-lj.si/~kosir/poucevanje/skripta/matrike.pdf">povezavi</a> (gre za kratek in dober pregled prof. dr. T. Koširja). Pogledali bomo, kako matrične račune izvedemo s pomočjo paketa <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<p>Najprej definirajmo matriki <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{B}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>ter vektorja <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Skalarni produkt dveh vektorjev izvedemo s funkcijo <code class="docutils literal notranslate"><span class="pre">dot()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer argumenta <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">b</span></code> predstavljata numerični polji <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> (poljubne dimenzije), ki jih želimo množiti. Če sta <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">b</span></code> dimenzije 1 se izvede skalarni produkt. Pri dimenziji 2 (matrike) se izračuna produkt matrik. Za uporabo funkcije <code class="docutils literal notranslate"><span class="pre">dot()</span></code> pri dimenzijah več kot 2: glejte <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html">dokumentacijo</a>.</p>
<p>Poglejmo primer množenja dveh vektorjev, to lahko izvedemo tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11
</pre></div>
</div>
</div>
</div>
<p>ali tudi tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11
</pre></div>
</div>
</div>
</div>
<p>Zgoraj smo omenili, da <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> ne sledi dosledno matematičnemu zapisu. Če bi, bi namreč eden od vektorjev moral biti vrstični, drugi stolpični. <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to poenostavi in zato je koda lažje berljiva in krajša.</p>
<p>Poglejmo sedaj množenje matrike z vektorjem (opazimo, da transponiranje <code class="docutils literal notranslate"><span class="pre">x</span></code> ni potrebno):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5, 7])
</pre></div>
</div>
</div>
</div>
<p>Lahko pa seveda pripravimo matematično korektno transponirano obliko vektorja (ampak vidimo, da je zapis neroden):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">x</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5],
       [7]])
</pre></div>
</div>
</div>
</div>
<p>Transponiranje ima sicer tudi kratko obliko, prek atributa <code class="docutils literal notranslate"><span class="pre">T</span></code>, npr. za matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 3],
       [2, 2]])
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si primer množenja dveh matrik:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5, 5],
       [7, 7]])
</pre></div>
</div>
</div>
</div>
<p>Od Pythona 3.5 naprej se za množenje matrik (in vektorjev) uporablja tudi operator <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html#numpy.matmul">dokumentacija</a>), ki omogoča kratek in pregleden zapis.</p>
<p>Zgornji primeri zapisani z operatorjem <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5, 7])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5, 5],
       [7, 7]])
</pre></div>
</div>
</div>
</div>
<p><strong>Vektorski produkt</strong> izračunamo s funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.cross()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.cross.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axisa</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axisb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axisc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">b</span></code> definirata komponente vektorjev. Če sta podani samo dve komponenti (<span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(y\)</span>), se izračuna skalarna vrednost (komponenta <span class="math notranslate nohighlight">\(z\)</span>); če so podane tri komponente, je rezultat tudi vektor s tremi komponentami. Uporaba funkcije je možna tudi na večdimenzijskih numeričnih poljih in temu so namenjeni preostali argumenti (glejte dokumentacijo).</p>
<p>Primer vektorskega produkta ravninskih vektorjev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(1)
</pre></div>
</div>
</div>
</div>
<p>Primer vektorskega produkta prostorskih vektorjev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 0, 1])
</pre></div>
</div>
</div>
</div>
<section id="nekatere-funkcije-knjiznice-numpy">
<h4>Nekatere funkcije knjižnice <code class="docutils literal notranslate"><span class="pre">numpy</span></code><a class="headerlink" href="#nekatere-funkcije-knjiznice-numpy" title="Permalink to this heading">#</a></h4>
<p>Pogledali si bomo še nekatere funkcije, ki jih bolj ali manj pogosto potrebujemo.</p>
<p>Enotsko matriko definiramo s funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.identity()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.identity.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer argument <code class="docutils literal notranslate"><span class="pre">n</span></code> definira število vrstic in stolpcev pravokotne matrike. Tip <code class="docutils literal notranslate"><span class="pre">dtype</span></code> je privzeto <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
<p>Primer enotske matrike:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>Do diagonalnih elementov matrike dostopamo s pomočjo funkcije <code class="docutils literal notranslate"><span class="pre">numpy.diagonal()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.diagonal.html">dokumentacija</a>)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Če je matrika dvodimenzijska, potem funkcija s privzetimi argumenti vrne diagonalno os. Če je dimenzija višja od 2, se uporabi osi <code class="docutils literal notranslate"><span class="pre">axis1</span></code> in <code class="docutils literal notranslate"><span class="pre">axis2</span></code>, da se izloči dvodimenzijsko polje, nato pa določi diagonalo glede na elemente <code class="docutils literal notranslate"><span class="pre">[i,</span> <span class="pre">i+offset]</span></code>.</p>
<p>Poglejmo primer izločanja diagonale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 1., 1.])
</pre></div>
</div>
</div>
</div>
<p>in uporabe <code class="docutils literal notranslate"><span class="pre">offset=1</span></code> za sosednjo diagonalo (najprej pripravimo nesimetirčno matriko):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([10.,  0.])
</pre></div>
</div>
</div>
</div>
<p>Podobno sintakso kot <code class="docutils literal notranslate"><span class="pre">numpy.diagonal()</span></code> ima funkcija <code class="docutils literal notranslate"><span class="pre">numpy.trace()</span></code>, ki izračuna vsoto (sled) diagonalnih elementov (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.trace.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
            <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Primer sledi diagonale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<p>in potem sosednje diagonale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.0
</pre></div>
</div>
</div>
</div>
<p>Pogosto nas zanimata največji ali najmanjši element nekega numeričnega polja. <code class="docutils literal notranslate"><span class="pre">numpy</span></code> je tukaj zelo splošen. Poglejmo si na primeru funkcije <code class="docutils literal notranslate"><span class="pre">numpy.max()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.amax.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Izpostavimo argument <code class="docutils literal notranslate"><span class="pre">axis</span></code>, ki pove, čez kateri indeks iščemo maksimalno vrednost. Če je <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> se določi največja vrednost v celotnem polju.</p>
<p>Primer izračuna največje vrednosti celotnega polja (prej poglejmo <code class="docutils literal notranslate"><span class="pre">A</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1., 10.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([10.,  1.,  1.])
</pre></div>
</div>
</div>
</div>
<p>Primer izračuna največje vrednosti čez vrstice (torej po stolpcih):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1., 10.,  1.])
</pre></div>
</div>
</div>
</div>
<p>Primer izračuna največje vrednosti čez stolpce (torej po vrsticah):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([10.,  1.,  1.])
</pre></div>
</div>
</div>
</div>
<p>Par funkcije <code class="docutils literal notranslate"><span class="pre">max()</span></code> je <code class="docutils literal notranslate"><span class="pre">numpy.argmax()</span></code>, kateri določi indekse največje vrednosti.</p>
<p>Primer uporabe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1., 10.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 0, 2], dtype=int64)
</pre></div>
</div>
</div>
</div>
</section>
<section id="linearna-algebra-z-numpy">
<h4>Linearna algebra z <code class="docutils literal notranslate"><span class="pre">numpy</span></code><a class="headerlink" href="#linearna-algebra-z-numpy" title="Permalink to this heading">#</a></h4>
<p>Pozneje bomo linearno algebro bolj podrobno spoznali in bomo sami pisali algoritme. Tukaj si poglejmo nekatere osnove, ki so vgrajene v modul <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<p>Za primer najprej definirajmo matriko in vektor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Inverzno matriko izračunamo z uporabo funkcije <code class="docutils literal notranslate"><span class="pre">numpy.linalg.inv()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.inv.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.33333333, 0.16666667],
       [0.16666667, 0.33333333]])
</pre></div>
</div>
</div>
</div>
<p>Sistem linearnih enačb, ki ga definirata matrika koeficientov <code class="docutils literal notranslate"><span class="pre">a</span></code> in vektor konstant <code class="docutils literal notranslate"><span class="pre">b</span></code>, rešimo s pomočjo funkcije <code class="docutils literal notranslate"><span class="pre">numpy.linalg.solve()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.solve.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">rešitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.66666667, 0.83333333])
</pre></div>
</div>
</div>
</div>
<p>Enakost elementov numeričnega polja <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">b</span></code> (znotraj določene tolerance) preverimo s funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.isclose()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.isclose.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">equal_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">rešitev</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ True,  True])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="vektorizacija-algoritmov">
<h3>Vektorizacija algoritmov<a class="headerlink" href="#vektorizacija-algoritmov" title="Permalink to this heading">#</a></h3>
<p>V tem poglavju želimo izpostaviti vektorizacijo algoritmov. Glede na to kako Python in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> delujeta se je potrebno izogibati zankam. Bistveno hitreje lahko izvajamo izračune, če jih uspemo vektorizirati; to pomeni, da izračune izvajamo na nivoju vektorjev (oz. numeričnih polj) in ne elementov.</p>
<p>Za primer si najprej pripravimo podatke (dva vektorja dolžine 1000)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo skalarni produkt vektorjev z uporabo zanke <code class="docutils literal notranslate"><span class="pre">for</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>332833500
</pre></div>
</div>
</div>
</div>
<p>Izmerimo hitrost:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n100
<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>171 µs ± 5.39 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<p>Isti rezultat pridobimo še v vektorski obliki:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n100
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.32 µs ± 162 ns per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<p>Vidimo, da je vektorski način bistveno hitrejši (za še hitrejši način glejte <code class="docutils literal notranslate"><span class="pre">numba</span></code> v dodatku)!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modul-matplotlib">
<h2>Modul <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code><a class="headerlink" href="#modul-matplotlib" title="Permalink to this heading">#</a></h2>
<p>V Pythonu imamo več možnosti za prikaz rezultatov v grafični obliki. Najbolj uporabni paketi so:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://matplotlib.org/"><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a> za visoko kakovostne, visoko prilagodljive slike (relativno počasno),</p></li>
<li><p><a class="reference external" href="http://www.pyqtgraph.org/"><code class="docutils literal notranslate"><span class="pre">pyqtgraph</span></code></a> za kakovostne in prilagodljive uporabniške vmesnike (zelo hitro),</p></li>
<li><p><a class="reference external" href="https://bokeh.pydata.org/en/latest/"><code class="docutils literal notranslate"><span class="pre">bokeh</span></code></a> za interaktiven prikaz v brskalniku (relativno hitro).</p></li>
</ul>
<p>Obstaja še veliko drugih; dober pregled je naredil Jake VanderPlas na konferenci <a class="reference external" href="https://www.youtube.com/watch?v=FytuB8nFHPQ">PyCon 2017</a> (sicer avtor paketa za deklerativno vizualizacijo: <em>Altair</em>).</p>
<section id="osnovna-uporaba">
<h3>Osnovna uporaba<a class="headerlink" href="#osnovna-uporaba" title="Permalink to this heading">#</a></h3>
<p>Najbolj razširjen in najbolj splošno uporabljen je paket <a class="reference external" href="http://matplotlib.org/"><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a>:
<img width="400" src="http://matplotlib.org/_static/logo2.svg"></p>
<p>Sposobnosti paketa najbolje prikazuje <a class="reference external" href="https://matplotlib.org/stable/gallery/index.html">galerija</a>. Gre za zelo sofisticiran paket in tukaj si bomo na podlagi primerov pogledali nekatere osnove.</p>
<p>Pri uporabi vam lahko koristi <a class="reference external" href="https://github.com/rougier/matplotlib-cheatsheet">plonk listek</a>:
<img width=500 src="https://github.com/rougier/matplotlib-cheatsheet/blob/master/matplotlib-cheatsheet.png?raw=true"></p>
<p>Tipično uvozimo <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> kot <code class="docutils literal notranslate"><span class="pre">plt</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>Znotraj <em>Jupyter notebooka</em> obstajata dva načina prikaza slike (v oglatem oklepaju je magic ukaz za proženje):</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[%matplotlib</span> <span class="pre">inline]</span>&#160;&#160; </code>: slike so vključene v notebook (<strong>medvrstični</strong> način),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[%matplotlib</span> <span class="pre">widget]</span>&#160;&#160; </code>: slike so interaktivno vključene v notebook (<strong>medvrstični interaktivni</strong> način), zahteva namestitev paketa <strong>ipympl</strong>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[%matplotlib</span> <span class="pre">notebook]</span> </code>: slike so interaktivno vključene v notebook (<strong>medvrstični interaktivni</strong> način).</p></li>
</ol>
<p>Opomba: <em>interaktivni način se v pasivni, spletni/pdf verziji te knjige ne prikaže pravilno</em>.</p>
<p>Tukaj bomo najpogosteje uporabljali <em>medvrstični</em> način:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Kratek primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">44000</span><span class="p">)</span>
<span class="n">žvižg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">žvižg</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Žvižg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Žvižg: $t^2$ (podpora za LaTeX: $</span><span class="se">\\</span><span class="s1">sqrt{</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{a}{b}</span><span class="s1">}$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b49392ca30c5763b78fe90b59cfba74ab45d4aa0be73ac5c476e0112f59e73ce.png" src="_images/b49392ca30c5763b78fe90b59cfba74ab45d4aa0be73ac5c476e0112f59e73ce.png" />
</div>
</div>
<p>Mimogrede, zakaj to imenujemo žvižg (oz. kvadraten žvižg)? Da dobimo odgovor, podatke predvajamo na zvočnik:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Audio</span><span class="p">,</span> <span class="n">display</span>
<span class="n">display</span><span class="p">(</span><span class="n">Audio</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">žvižg</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">44000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,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" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div></div>
</div>
<p>Aktivirajmo sedaj interaktivni način (glejte tudi <code class="docutils literal notranslate"><span class="pre">%matplotlib</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> notebook
<span class="o">%</span><span class="k">matplotlib</span> notebook
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_device_pixel_ratio', {
                device_pixel_ratio: fig.ratio,
            });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute('tabindex', '0');
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;' +
            'z-index: 2;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute(
        'style',
        'box-sizing: content-box;' +
            'pointer-events: none;' +
            'position: relative;' +
            'z-index: 0;'
    );

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box;' +
            'left: 0;' +
            'pointer-events: none;' +
            'position: absolute;' +
            'top: 0;' +
            'z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            /* This rescales the canvas back to display pixels, so that it
             * appears correct on HiDPI screens. */
            canvas.style.width = width + 'px';
            canvas.style.height = height + 'px';

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        /* User Agent sniffing is bad, but WebKit is busted:
         * https://bugs.webkit.org/show_bug.cgi?id=144526
         * https://bugs.webkit.org/show_bug.cgi?id=181818
         * The worst that happens here is that they get an extra browser
         * selection when dragging, if this check fails to catch them.
         */
        var UA = navigator.userAgent;
        var isWebKit = /AppleWebKit/.test(UA) && !/Chrome/.test(UA);
        if(isWebKit) {
            return function (event) {
                /* This prevents the web browser from automatically changing to
                 * the text insertion cursor when the button is pressed. We
                 * want to control all of the cursor setting manually through
                 * the 'cursor' event from matplotlib */
                event.preventDefault()
                return fig.mouse_event(event, name);
            };
        } else {
            return function (event) {
                return fig.mouse_event(event, name);
            };
        }
    }

    canvas_div.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    canvas_div.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    canvas_div.addEventListener(
        'dblclick',
        on_mouse_event_closure('dblclick')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    canvas_div.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    canvas_div.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    canvas_div.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    canvas_div.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    fig.canvas_div.style.cursor = msg['cursor'];
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            var img = evt.data;
            if (img.type !== 'image/png') {
                /* FIXME: We get "Resource interpreted as Image but
                 * transferred with MIME type text/plain:" errors on
                 * Chrome.  But how to set the MIME type?  It doesn't seem
                 * to be part of the websocket stream */
                img.type = 'image/png';
            }

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                img
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};

function getModifiers(event) {
    var mods = [];
    if (event.ctrlKey) {
        mods.push('ctrl');
    }
    if (event.altKey) {
        mods.push('alt');
    }
    if (event.shiftKey) {
        mods.push('shift');
    }
    if (event.metaKey) {
        mods.push('meta');
    }
    return mods;
}

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * https://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    // from https://stackoverflow.com/q/1114465
    var boundingRect = this.canvas.getBoundingClientRect();
    var x = (event.clientX - boundingRect.left) * this.ratio;
    var y = (event.clientY - boundingRect.top) * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        modifiers: getModifiers(event),
        guiEvent: simpleKeys(event),
    });

    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.key === this._key) {
            return;
        } else {
            this._key = event.key;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.key !== 'Control') {
        value += 'ctrl+';
    }
    else if (event.altKey && event.key !== 'Alt') {
        value += 'alt+';
    }
    else if (event.shiftKey && event.key !== 'Shift') {
        value += 'shift+';
    }

    value += 'k' + event.key;

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "fa fa-square-o", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o", "download"]];

mpl.extensions = ["eps", "jpeg", "pgf", "pdf", "png", "ps", "raw", "svg", "tif", "webp"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.binaryType = comm.kernel.ws.binaryType;
    ws.readyState = comm.kernel.ws.readyState;
    function updateReadyState(_event) {
        if (comm.kernel.ws) {
            ws.readyState = comm.kernel.ws.readyState;
        } else {
            ws.readyState = 3; // Closed state.
        }
    }
    comm.kernel.ws.addEventListener('open', updateReadyState);
    comm.kernel.ws.addEventListener('close', updateReadyState);
    comm.kernel.ws.addEventListener('error', updateReadyState);

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        var data = msg['content']['data'];
        if (data['blob'] !== undefined) {
            data = {
                data: new Blob(msg['buffers'], { type: data['blob'] }),
            };
        }
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(data);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}
</script><div class="output text_html"><div id='d293a7f7-6fe3-4129-b166-0a43608758f0'></div></div></div>
</div>
<p>Zgornjo sliko lahko sedaj interaktivno klikamo in tudi dopolnjujemo s kodo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Pozneje dodani naslov!&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas [$t$]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interaktivna-uporaba">
<h3>Interaktivna uporaba<a class="headerlink" href="#interaktivna-uporaba" title="Permalink to this heading">#</a></h3>
<p>Pri tem predmetu bomo večkrat uporabljali interaktivnost pri delu z grafičnimi prikazi. V ta namen najprej uvozimo <code class="docutils literal notranslate"><span class="pre">interact</span></code> iz paketa <code class="docutils literal notranslate"><span class="pre">ipywidgets</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
</pre></div>
</div>
</div>
</div>
<p>Potem definiramo sliko kot funkcijo z argumenti <code class="docutils literal notranslate"><span class="pre">amplituda</span></code>, <code class="docutils literal notranslate"><span class="pre">fr</span></code>, <code class="docutils literal notranslate"><span class="pre">faza</span></code> in <code class="docutils literal notranslate"><span class="pre">dušenje</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slika</span><span class="p">(</span><span class="n">amplituda</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fr</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">faza</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dušenje</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">amplituda</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fr</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">faza</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dušenje</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fr</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Gremo nazaj na medvrstično uporabo in kličemo funkcijo za izris slike (privzeti argumenti):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">slika</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_device_pixel_ratio', {
                device_pixel_ratio: fig.ratio,
            });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute('tabindex', '0');
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;' +
            'z-index: 2;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute(
        'style',
        'box-sizing: content-box;' +
            'pointer-events: none;' +
            'position: relative;' +
            'z-index: 0;'
    );

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box;' +
            'left: 0;' +
            'pointer-events: none;' +
            'position: absolute;' +
            'top: 0;' +
            'z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            /* This rescales the canvas back to display pixels, so that it
             * appears correct on HiDPI screens. */
            canvas.style.width = width + 'px';
            canvas.style.height = height + 'px';

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        /* User Agent sniffing is bad, but WebKit is busted:
         * https://bugs.webkit.org/show_bug.cgi?id=144526
         * https://bugs.webkit.org/show_bug.cgi?id=181818
         * The worst that happens here is that they get an extra browser
         * selection when dragging, if this check fails to catch them.
         */
        var UA = navigator.userAgent;
        var isWebKit = /AppleWebKit/.test(UA) && !/Chrome/.test(UA);
        if(isWebKit) {
            return function (event) {
                /* This prevents the web browser from automatically changing to
                 * the text insertion cursor when the button is pressed. We
                 * want to control all of the cursor setting manually through
                 * the 'cursor' event from matplotlib */
                event.preventDefault()
                return fig.mouse_event(event, name);
            };
        } else {
            return function (event) {
                return fig.mouse_event(event, name);
            };
        }
    }

    canvas_div.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    canvas_div.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    canvas_div.addEventListener(
        'dblclick',
        on_mouse_event_closure('dblclick')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    canvas_div.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    canvas_div.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    canvas_div.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    canvas_div.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    fig.canvas_div.style.cursor = msg['cursor'];
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            var img = evt.data;
            if (img.type !== 'image/png') {
                /* FIXME: We get "Resource interpreted as Image but
                 * transferred with MIME type text/plain:" errors on
                 * Chrome.  But how to set the MIME type?  It doesn't seem
                 * to be part of the websocket stream */
                img.type = 'image/png';
            }

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                img
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};

function getModifiers(event) {
    var mods = [];
    if (event.ctrlKey) {
        mods.push('ctrl');
    }
    if (event.altKey) {
        mods.push('alt');
    }
    if (event.shiftKey) {
        mods.push('shift');
    }
    if (event.metaKey) {
        mods.push('meta');
    }
    return mods;
}

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * https://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    // from https://stackoverflow.com/q/1114465
    var boundingRect = this.canvas.getBoundingClientRect();
    var x = (event.clientX - boundingRect.left) * this.ratio;
    var y = (event.clientY - boundingRect.top) * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        modifiers: getModifiers(event),
        guiEvent: simpleKeys(event),
    });

    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.key === this._key) {
            return;
        } else {
            this._key = event.key;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.key !== 'Control') {
        value += 'ctrl+';
    }
    else if (event.altKey && event.key !== 'Alt') {
        value += 'alt+';
    }
    else if (event.shiftKey && event.key !== 'Shift') {
        value += 'shift+';
    }

    value += 'k' + event.key;

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "fa fa-square-o", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o", "download"]];

mpl.extensions = ["eps", "jpeg", "pgf", "pdf", "png", "ps", "raw", "svg", "tif", "webp"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.binaryType = comm.kernel.ws.binaryType;
    ws.readyState = comm.kernel.ws.readyState;
    function updateReadyState(_event) {
        if (comm.kernel.ws) {
            ws.readyState = comm.kernel.ws.readyState;
        } else {
            ws.readyState = 3; // Closed state.
        }
    }
    comm.kernel.ws.addEventListener('open', updateReadyState);
    comm.kernel.ws.addEventListener('close', updateReadyState);
    comm.kernel.ws.addEventListener('error', updateReadyState);

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        var data = msg['content']['data'];
        if (data['blob'] !== undefined) {
            data = {
                data: new Blob(msg['buffers'], { type: data['blob'] }),
            };
        }
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(data);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}
</script><div class="output text_html"><div id='bacc9ade-5ff0-4987-892c-98fad07352b5'></div></div></div>
</div>
<p>Če funkcijo za izris slike pošljemo v funkcijo <code class="docutils literal notranslate"><span class="pre">interact</span></code>, slednja poskrbi za interaktivne gumbe, s katerimi lahko spreminajmo parametre klicanja funkcije <code class="docutils literal notranslate"><span class="pre">slika</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">slika</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "fa8769f0303d4c7f87b95ddaa5c9abd8"}</script></div>
</div>
<p>Razpon parametov lahko tudi sami definiramo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">slika</span><span class="p">,</span> <span class="n">amplituda</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dušenje</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">fr</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">faza</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "72d1b003b84040a8ad9330a506352bc6"}</script></div>
</div>
</section>
<section id="napredna-uporaba">
<h3>Napredna uporaba<a class="headerlink" href="#napredna-uporaba" title="Permalink to this heading">#</a></h3>
<section id="prikaz-vec-funkcij">
<h4>Prikaz več funkcij<a class="headerlink" href="#prikaz-vec-funkcij" title="Permalink to this heading">#</a></h4>
<p>Poglejmo si preprost primer prikaza več funkcij (najprej, opcijsko, definirajmo fonte za izpis v pdf):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span><span class="s1">&#39;serif&#39;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;pdf.fonttype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">1.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sin(x)$ - to je LaTeX izpis&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin(x+1) - to ni&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sin(x^</span><span class="si">{1.2}</span><span class="s1">)$ - to spet je: čšž&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;data/prvi plot.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0c48f0bd00d1e3990484fd60c5636c410d5fbb6d6faddcc1a0082caf34a34aba.png" src="_images/0c48f0bd00d1e3990484fd60c5636c410d5fbb6d6faddcc1a0082caf34a34aba.png" />
</div>
</div>
</section>
<section id="prikaz-vec-slik">
<h4>Prikaz več slik<a class="headerlink" href="#prikaz-vec-slik" title="Permalink to this heading">#</a></h4>
<p>Več slik prikažemo s pomočjo metode <code class="docutils literal notranslate"><span class="pre">subplot</span></code>, ki definira mrežo in lego naslednjega izrisala.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>V primeru zgoraj <code class="docutils literal notranslate"><span class="pre">plt.subplot(2,</span> <span class="pre">2,</span> <span class="pre">1)</span></code> pomeni: mreža naj bo <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">2</span></code>, riši v sliko 1 (levo zgoraj). Naslednjič se kliče <code class="docutils literal notranslate"><span class="pre">plt.subplot(2,</span> <span class="pre">2,</span> <span class="pre">2)</span></code> kar pomeni mreža <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">2</span></code>, riši v sliko 2 (desno zgoraj) in tako naprej. Opazimo, da se indeks slik začne z 1; lahko bi rekli, da gre za nekonsistentnost v Pythonu, razlog pa je v tem, da je bil <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> rojen v ideji, da bi uporabnikom Pythona uporabil čimbolj podoben način izrisa, kakor so ga poznali v Matlabu (kjer se indeks začne z 1).</p>
<p>Delujoči primer je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="o">*</span><span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="o">+</span><span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/09003467efb45b40117e7fd9b260dd064a2f39a1bddd09ac241f092f88a3bb3f.png" src="_images/09003467efb45b40117e7fd9b260dd064a2f39a1bddd09ac241f092f88a3bb3f.png" />
</div>
</div>
</section>
<section id="histogram">
<h4>Histogram<a class="headerlink" href="#histogram" title="Permalink to this heading">#</a></h4>
<p>Generirajmo 10000 normalno porazdeljenih vzorcev in jih prikažimo v obliki histograma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d9b81b3a38cc96fbb5b0ccb682a2b620cc65c229fd4a1e89c7fb9acf51ec1cd2.png" src="_images/d9b81b3a38cc96fbb5b0ccb682a2b620cc65c229fd4a1e89c7fb9acf51ec1cd2.png" />
</div>
</div>
</section>
</section>
<section id="uporaba-primerov-iz-matplotlib-org">
<h3>Uporaba primerov iz <code class="docutils literal notranslate"><span class="pre">matplotlib.org</span></code><a class="headerlink" href="#uporaba-primerov-iz-matplotlib-org" title="Permalink to this heading">#</a></h3>
<p>Primere iz <a class="reference external" href="https://matplotlib.org/stable/gallery/index.html">galerije</a> lahko uvozimo s pomočjo magične funkcije <code class="docutils literal notranslate"><span class="pre">%load</span></code>.</p>
<p>Poskusite:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%load</span> <span class="pre">http://matplotlib.org/mpl_examples/lines_bars_and_markers/fill_demo.py</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%load</span> <span class="pre">http://matplotlib.org/examples/widgets/slider_demo.py</span></code></p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Naredite slovar lokalno nameščenih modulov (uporabite izpeljevanje slovarjev, ključ naj bo ime modula, vrednost naj bo verzija).</p></li>
<li><p>S pomočjo slovarja iz prejšnje točke čimbolj preprosto preverite, ali so nameščeni sledeči moduli: [‚numpy‘, ‚scipy‘, ‚matplotlib‘, ‚pandas‘, ‚pyjamas‘, ‚openpyxl‘].</p></li>
<li><p>Namestite poljubni modul iz <a class="reference external" href="https://pypi.org">https://pypi.org</a> in ga preizkusite.</p></li>
<li><p>Pretvorite navaden Pythonov seznam v <code class="docutils literal notranslate"><span class="pre">numpy</span></code> numerično polje. Preverite tip enega in drugega.</p></li>
<li><p>Raziščite funkcije <code class="docutils literal notranslate"><span class="pre">np.ones</span></code>, <code class="docutils literal notranslate"><span class="pre">np.zeros_like</span></code>, <code class="docutils literal notranslate"><span class="pre">np.arange</span></code>, <code class="docutils literal notranslate"><span class="pre">np.linspace</span></code> (ali zadnja funkcija lahko vrne korak?).</p></li>
<li><p>Prikažite uporabo rezanja.</p></li>
<li><p>Prikažite razliko med vrstičnim in stolpičnim vektorjem. Prikažite tipične matematične operacije med vektorji in matrikami.</p></li>
<li><p>Ustvarite matriko ničel dimenzije 3 x 2 in drugi stolpec zapolnite z vektorjem enic.</p></li>
<li><p>Ustvarite enotsko matriko dimenzije 5 podatkovnega tipa <code class="docutils literal notranslate"><span class="pre">complex</span></code>.</p></li>
<li><p>Ustvarite enotsko matriko dimenzije <code class="docutils literal notranslate"><span class="pre">N</span></code> in izračunajte vsoto poljubnga stolpca. Poskusite najti najhitrejši (vektoriziran) način in ga primerjajte s pristopom v zanki. Namig: np.sum().</p></li>
<li><p>V matriki iz prejšnje točke zamenjajte poljubna stolpca, nato še poljubni vrstici. Preverite hitrost vaše implementacije.</p></li>
<li><p>S pomočjo funkcije <code class="docutils literal notranslate"><span class="pre">np.random.rand</span></code> ustvarite dvorazsežno matriko poljubne dimenzije in najdite največjo in najmanjšo vrednost. Preverite možnost <code class="docutils literal notranslate"><span class="pre">axis</span></code> v funkciji <code class="docutils literal notranslate"><span class="pre">np.max</span></code> ali <code class="docutils literal notranslate"><span class="pre">np.min</span></code>.</p></li>
<li><p>V matriki iz prejšnje točke najdite indeks, kjer se nahaja največja vrednost.</p></li>
<li><p>Na primeru preprostega diagrama prikažite razliko med <em>inline</em> in <em>interaktivno</em> uporabo knjižnice <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
<li><p>Na primeru preprostega diagrama prikažite uporabo vsaj 5 različnih tipov črte in 5 različnih barv.</p></li>
<li><p>Raziščite primere <a class="reference external" href="http://matplotlib.org/gallery.html">http://matplotlib.org/gallery.html</a>. Za primer si podrobneje poglejte enega od zgledov na temo zaznamb <em>annotation</em>. Izbrani primer namestite na vaš računalnik.</p></li>
<li><p>Na primeru preprostega diagrama prikažite uporabo zaznamb.</p></li>
<li><p>Dodatno: Naredite preprosto animacijo.</p></li>
<li><p>Dodatno: Izrišite več krogov naključne lege in velikosti ter poljubne barve. Ob kliku se krogom naj spremeni barva.</p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<section id="numba">
<h3><code class="docutils literal notranslate"><span class="pre">numba</span></code><a class="headerlink" href="#numba" title="Permalink to this heading">#</a></h3>
<p>Paket <code class="docutils literal notranslate"><span class="pre">numba</span></code> se v zadnjem obdobju zelo razvija in lahko numerično izvajanje še dodatno pohitri (tudi v povezavi z grafičnimi karticami oz. GPU procesorji).</p>
<p>Za zgled tukaj uporabimo <code class="docutils literal notranslate"><span class="pre">jit</span></code> (<a class="reference external" href="http://numba.pydata.org/numba-doc/dev/reference/jit-compilation.html">just-in-time compilation</a>) iz paketa <code class="docutils literal notranslate"><span class="pre">numba</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">jit</span></code> uporabimo kot <a class="reference external" href="https://docs.python.org/3/glossary.html#term-decorator">dekorator</a> funkcije, ki jo želimo pohitriti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">skalarni_produkt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\janko\AppData\Local\Temp\ipykernel_16668\2600651875.py:1: NumbaDeprecationWarning: <span class=" -Color -Color-Bold">The &#39;nopython&#39; keyword argument was not supplied to the &#39;numba.jit&#39; decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.</span>
  @jit
</pre></div>
</div>
</div>
</div>
<p>Sedaj definirajmo vektorja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Preverimo hitrost <code class="docutils literal notranslate"><span class="pre">numpy</span></code> skalarnega produkta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n1000
<span class="n">a</span> <span class="o">@</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.32 µs ± 257 ns per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Preverimo še hitrost <code class="docutils literal notranslate"><span class="pre">numba</span></code> pohitrene verzije. Prvi klic izvedemo, da se izvede kompilacija, potem merimo čas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">skalarni_produkt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>332833500
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n1000
<span class="n">skalarni_produkt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>441 ns ± 31.8 ns per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Vidimo, da smo še izboljšali hitrost!</p>
</section>
<section id="matplotlib-animacije-povratni-klic-xkcd-stil">
<h3><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>: animacije, povratni klic, XKCD stil<a class="headerlink" href="#matplotlib-animacije-povratni-klic-xkcd-stil" title="Permalink to this heading">#</a></h3>
<p>Z <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> lahko pripravimo tudi <strong>animacije</strong>. Dva primera lahko najdete tukaj:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/0e3b4f3c6abbdf61143a47f1578a1055/matplotlib_animacija.py"><span class="xref download myst">Preprosta animacija</span></a>,</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/b0fdc87e21dba820fb6283651cd76137/animacija_dvojno_nihalo.py"><span class="xref download myst">Dvojno nihalo</span></a>.</p></li>
</ul>
<p>Več v <a class="reference external" href="https://matplotlib.org/api/animation_api.html#animation">dokumentaciji</a>.</p>
<p>Slika s <strong>povratnim klicem</strong> (angl. <em>call back</em>):</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/d63c795c0a355fcd6f652356cfff707b/matplotlib_klik.py"><span class="xref download myst">Risanje črte</span></a>.</p></li>
</ul>
<p>Pripravite lahko tudi <em>na roko</em> narisane slike (<strong>XKCD stil</strong>):</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/d4e75024121af911dca9216a2d47df78/xkcd_stil.py"><span class="xref download myst">XKCD stil</span></a>.</p></li>
</ul>
</section>
<section id="za-najbolj-zagrete">
<h3>Za najbolj zagrete<a class="headerlink" href="#za-najbolj-zagrete" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Naučite se še kaj novega na <a class="reference external" href="http://chrisalbon.com/">chrisalbon.com</a>.</p></li>
</ol>
</section>
</section>
<span id="document-notebooks/Predavanje 04 - Objektno programiranje, simbolno računanje"></span><section class="tex2jax_ignore mathjax_ignore" id="objektno-programiranje-simbolno-racunanje">
<h2>Objektno programiranje, simbolno računanje<a class="headerlink" href="#objektno-programiranje-simbolno-racunanje" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="objektno-programiranje">
<h2>Objektno programiranje<a class="headerlink" href="#objektno-programiranje" title="Permalink to this heading">#</a></h2>
<p>Pri programiranju poznamo različne pristope, dokumentacija Python-a (<a class="reference external" href="https://docs.python.org/howto/functional.html">docs.python.org</a>) omenja npr:</p>
<ol class="arabic simple">
<li><p><strong>proceduralni</strong>: seznam navodil, kaj je treba izvesti (npr.: <code class="docutils literal notranslate"><span class="pre">C,</span> <span class="pre">Pascal</span></code>)</p></li>
<li><p><strong>deklerativni</strong>: opišemo kaj želimo, programski jezik pa izvede (npr., <code class="docutils literal notranslate"><span class="pre">SQL</span></code>)</p></li>
<li><p><strong>funkcijski</strong>: programiranje temelji na funkcijah (npr.: <code class="docutils literal notranslate"><span class="pre">Haskell</span></code> )</p></li>
<li><p><strong>objektni</strong>: program temelji na objektih, ki imajo lastnosti, funkcije … (npr.: <code class="docutils literal notranslate"><span class="pre">Java,</span> <span class="pre">Smalltalk</span></code>)</p></li>
</ol>
<p>Python je objektno orientiran programski jezik, vendar pa nas ne sili v uporabo objektov v vseh primerih. Kot bomo videli pozneje, ima objektno programiranje veliko prednosti, vendar pa je lahko mnogokrat okorno in bi po nepotrebnem naredilo program kompleksen. Iz tega razloga se eksplicitnemu objektnemu programiranju izognemo, če se le da.</p>
<p>Objektno programiranje v Pythonu temelji na <strong>razredih</strong> (<em>class</em>), objekti so pa <strong>instance</strong> (<em>instance</em>) razreda.  Pogledali si bomo zgolj nekatere osnove objektnega programiranja (da boste lažje razumeli kodo drugih avtorjev in jo prirejali svojim potrebam).</p>
<p>Razred definiramo z ukazom <code class="docutils literal notranslate"><span class="pre">class</span></code> (<a class="reference external" href="https://docs.python.org/tutorial/classes.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImeRazreda</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;docstring&#39;&#39;&#39;</span>
    <span class="p">[</span><span class="n">izraz</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">[</span><span class="n">izraz</span> <span class="mi">2</span><span class="p">]</span>
    <span class="o">.</span>
    <span class="o">.</span>
</pre></div>
</div>
<p>kjer ime razreda (torej <code class="docutils literal notranslate"><span class="pre">ImeRazreda</span></code>) po PEP8 pišemo z veliko začetnico. Če je ime sestavljeno iz več besed, vsako pišemo z veliko (t. i. principi <em>CamelCase</em>).</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Pravokotnik</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Razred za objekt pravokotnik&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">širina</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">višina</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># to je konstruktor objekta. Se izvede, ko kličemo Pravokotnik(sirina=1, visina=4)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">širina</span> <span class="o">=</span> <span class="n">širina</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">višina</span> <span class="o">=</span> <span class="n">višina</span> <span class="c1"># višina je atribut objekta</span>
        
    <span class="k">def</span> <span class="nf">površina</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">širina</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">višina</span>
    
    <span class="k">def</span> <span class="nf">set_širina</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">širina</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">širina</span> <span class="o">=</span> <span class="n">širina</span>
</pre></div>
</div>
</div>
</div>
<p>Preden gremo v podrobnosti razumevanja kode, naredimo instanco razreda (torej objekt):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_pravokotnik</span> <span class="o">=</span> <span class="n">Pravokotnik</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Funkcije definirane znotraj razreda poimenujemo <strong>metode</strong>, ko jih kličemo na objektih.</p>
<p>V zgornjem primeru metodo <code class="docutils literal notranslate"><span class="pre">površina</span></code> uporabimo tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_pravokotnik</span><span class="o">.</span><span class="n">površina</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Ime <code class="docutils literal notranslate"><span class="pre">self</span></code> je referenca na instanco razreda (objekt, ki bo ustvarjen). Imena znotraj razreda postanejo <strong>atributi</strong> objekta.</p>
<p>Primer atributa `višina˙:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_pravokotnik</span><span class="o">.</span><span class="n">višina</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Od kje pride rezultat <code class="docutils literal notranslate"><span class="pre">1</span></code>? Ko ustvarimo objekt, se najprej izvede inicializacijska funkcija <code class="docutils literal notranslate"><span class="pre">__init__()</span></code>, pri tem se kot argumenti funkcije <code class="docutils literal notranslate"><span class="pre">__init__</span></code> uporabijo argumenti, ki jih posredujemo v razred.</p>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tvoj_pravokotnik</span> <span class="o">=</span> <span class="n">Pravokotnik</span><span class="p">(</span><span class="n">višina</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">širina</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">tvoj_pravokotnik</span><span class="o">.</span><span class="n">površina</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15
</pre></div>
</div>
</div>
</div>
<p>Pripravili smo tudi metodo, ki spremeni atribut <code class="docutils literal notranslate"><span class="pre">širina</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_pravokotnik</span><span class="o">.</span><span class="n">set_širina</span><span class="p">(</span><span class="n">širina</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">moj_pravokotnik</span><span class="o">.</span><span class="n">površina</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
</div>
</div>
<p>Atribute lahko spreminjamo tudi neposredno, vendar se temu (zaradi možnosti napake in napačne uporabe) ponavadi izogibamo.</p>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_pravokotnik</span><span class="o">.</span><span class="n">višina</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">moj_pravokotnik</span><span class="o">.</span><span class="n">površina</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>300
</pre></div>
</div>
</div>
</div>
<section id="dedovanje">
<h3>Dedovanje<a class="headerlink" href="#dedovanje" title="Permalink to this heading">#</a></h3>
<p>Pomembna lastnost razredov je dedovanje; samo ime pove bistvo: tako kot ljudje dedujemo od svojih staršev, podobno velja tudi za razrede.  Vsak razred (<code class="docutils literal notranslate"><span class="pre">class</span></code>) tako lahko deduje lastnosti kakega drugega razreda (<a class="reference external" href="https://docs.python.org/tutorial/classes.html#inheritance">dokumentacija</a>). Lahko ima celo več staršev (v te podrobnosti tukaj ne bomo šli).</p>
<p>Sintaksa razreda, ki deduje, je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Otrok</span><span class="p">(</span><span class="n">Starš</span><span class="p">):</span>
    <span class="p">[</span><span class="n">izraz</span><span class="p">]</span>
    <span class="o">.</span>
    <span class="o">.</span>
</pre></div>
</div>
<p>Opomba: tudi, če razredu ne definiramo <em>starša</em>, deduje razred <code class="docutils literal notranslate"><span class="pre">class</span></code>.</p>
<p>Primer, ko novi razred <code class="docutils literal notranslate"><span class="pre">Kvadrat</span></code> podeduje obstoječega (<code class="docutils literal notranslate"><span class="pre">Pravokotnik</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Kvadrat</span><span class="p">(</span><span class="n">Pravokotnik</span><span class="p">):</span>
    <span class="s2">&quot;Razred kvadrat&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">širina</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># kličimo iniciacijo razreda Pravokotnik</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">širina</span><span class="o">=</span><span class="n">širina</span><span class="p">,</span> <span class="n">višina</span><span class="o">=</span><span class="n">širina</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">set_širina</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">širina</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">širina</span> <span class="o">=</span> <span class="n">širina</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">višina</span> <span class="o">=</span> <span class="n">širina</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo sedaj uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_kvadrat</span> <span class="o">=</span> <span class="n">Kvadrat</span><span class="p">(</span><span class="n">širina</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Razred <code class="docutils literal notranslate"><span class="pre">Kvadrat</span></code> nima definicije metode za izračun površine, vendar pa jo je podedoval od razreda <code class="docutils literal notranslate"><span class="pre">Pravokotnik</span></code> in zato <em>ima metodo</em> za izračun površine:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_kvadrat</span><span class="o">.</span><span class="n">površina</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
</div>
<p>V kolikor spremenimo širino, se ustrezno spremeni površina:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_kvadrat</span><span class="o">.</span><span class="n">set_širina</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">moj_kvadrat</span><span class="o">.</span><span class="n">površina</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25
</pre></div>
</div>
</div>
</div>
<section id="primer-dedovanja-razreda-list-seznam">
<h4>Primer dedovanja razreda <code class="docutils literal notranslate"><span class="pre">list</span></code> (seznam)<a class="headerlink" href="#primer-dedovanja-razreda-list-seznam" title="Permalink to this heading">#</a></h4>
<p>Najprej pripravimo seznam:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3]
</pre></div>
</div>
</div>
</div>
<p>Če želimo seznamu dodati vrednost, uporabimo metodo <code class="docutils literal notranslate"><span class="pre">append</span></code> (to je metoda, ki jo imajo objekti tipa <code class="docutils literal notranslate"><span class="pre">list</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seznam</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nato seznam prikažemo (najprej uvozimo <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seznam</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bb4d905b04821494daa65e4c5dbadea3fa6f030d9233bb0d1b7605d36c4938c3.png" src="_images/bb4d905b04821494daa65e4c5dbadea3fa6f030d9233bb0d1b7605d36c4938c3.png" />
</div>
</div>
<p>Če nekaj takega izvajamo pogosto, potem je bolje, da si pripravimo svoj razred <code class="docutils literal notranslate"><span class="pre">Seznam</span></code>, ki deduje od <code class="docutils literal notranslate"><span class="pre">list</span></code> in dodamo metodo za prikaz <code class="docutils literal notranslate"><span class="pre">nariši</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Seznam</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
        
    <span class="k">def</span> <span class="nf">nariši</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dolgo besedilo&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Instanca objekta je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_seznam</span> <span class="o">=</span> <span class="n">Seznam</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">type</span><span class="p">(</span><span class="n">moj_seznam</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>__main__.Seznam
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3]
</pre></div>
</div>
</div>
</div>
<p>Čeprav nismo definirali metode <code class="docutils literal notranslate"><span class="pre">append</span></code>, jo je nov razred podedoval po razredu <code class="docutils literal notranslate"><span class="pre">list</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_seznam</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">moj_seznam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 1]
</pre></div>
</div>
</div>
</div>
<p>Ima tudi metodo za izris:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moj_seznam</span><span class="o">.</span><span class="n">nariši</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/33cdf05d61737edc7db6a75e43e92318ad631ef6274e8ba39816c0a12041d616.png" src="_images/33cdf05d61737edc7db6a75e43e92318ad631ef6274e8ba39816c0a12041d616.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="simbolno-racunanje-s-sympy">
<h2>Simbolno računanje s <code class="docutils literal notranslate"><span class="pre">SymPy</span></code><a class="headerlink" href="#simbolno-racunanje-s-sympy" title="Permalink to this heading">#</a></h2>
<p>Termin <strong>simbolno računanje</strong> pomeni, da matematične izraze rešujemo strojno v obliki abstraktnih simbolov (in <strong>ne numerično</strong>). Strojno simbolno računanje nam pomaga kadar nas zanima <strong>rezultat v simbolni obliki</strong> in so izrazi preobsežni za klasično reševanje na list in papir. K strojnemu reševanju se zatečemo tudi zaradi zmanjšanja možnosti napake (pri obsežnih izračunih se ljudje lahko zmotimo).</p>
<p><strong>Simbolno računanje nikakor ni nadomestek numeričnih metod!</strong></p>
<p>Pogledali si bomo nekatere osnove, nekateri priporočeni dodatni viri pa so:</p>
<ul class="simple">
<li><p>J.R. Johansson <a class="reference external" href="http://github.com/jrjohansson/scientific-python-lectures">Scientific python lectures</a>,</p></li>
<li><p><a class="reference external" href="http://sympy.org/en/index.html">SymPy</a> - uradna dokumentacija modula,</p></li>
<li><p>Odličen članek nekaterih avtorjev SymPy: <a class="reference external" href="https://peerj.com/articles/cs-103/">Meurer et. al, 2017</a>.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">SymPy</span></code> je eden od sistemov za strojno algebro (CAS - <em>Computer Algebra Systems</em>), ki pa ima poleg zmogljivosti tudi to prednost, da je v celoti napisan v Pythonu (alternativni paket v Pythonu <a class="reference external" href="http://www.sagemath.org/">Sage</a> na primer ni v celoti napisan v Pythonu).</p>
<p>Nekatera namenska komercialna orodja:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.wolfram.com/mathematica">Mathematica</a></p></li>
<li><p><a class="reference external" href="http://www.maplesoft.com/products/maple">Maple</a></p></li>
</ul>
<p>Najprej uvozimo modul <code class="docutils literal notranslate"><span class="pre">SymPy</span></code>; tipično paket uvozimo kot <code class="docutils literal notranslate"><span class="pre">sym</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
</pre></div>
</div>
</div>
</div>
<p>Opazimo lahko, da se <code class="docutils literal notranslate"><span class="pre">SymPy</span></code> uvaža tudi <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">sympy</span> <span class="pre">import</span> <span class="pre">*</span></code>. Temu se praviloma izogibamo, saj tako s <code class="docutils literal notranslate"><span class="pre">SymPy</span></code> imeni po nepotrebnem zapolnimo osnovni imenski prostor programa. V slednjem primeru do funkcij paketa (npr. <code class="docutils literal notranslate"><span class="pre">sympy.Sum</span></code>) dostopamo neposredno (npr. <code class="docutils literal notranslate"><span class="pre">Sum</span></code>), kar je lahko privlačno, vendar nas začne motiti, ko dodamo še druge pakete (npr. <code class="docutils literal notranslate"><span class="pre">numpy</span></code>), kar lahko poleg zmede privede do tega, da se funkcije z enakimi imeni „povozijo“.</p>
<p>Zato da dobimo lepo oblikovan LaTeX izpis, uporabimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="definiranje-spremenljivk-in-numericni-izracun">
<h3>Definiranje spremenljivk in numerični izračun<a class="headerlink" href="#definiranje-spremenljivk-in-numericni-izracun" title="Permalink to this heading">#</a></h3>
<p>Spremenljivke definiramo takole:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y, k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Preverimo lahko tip:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sympy.core.symbol.Symbol
</pre></div>
</div>
</div>
</div>
<p>Opazimo, da je spremenljivka <code class="docutils literal notranslate"><span class="pre">x</span></code> sedaj <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> iz paketa <code class="docutils literal notranslate"><span class="pre">sympy</span></code>.</p>
<p>Sedaj lahko naredimo preprost izračun:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">**</span><span class="n">y</span> <span class="o">+</span> <span class="n">k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0a58b752f319b2638f2e0923cdaee2e59539ac0ed3fd94aa16a3177f6de716f0.png" src="_images/0a58b752f319b2638f2e0923cdaee2e59539ac0ed3fd94aa16a3177f6de716f0.png" />
</div>
</div>
<p>Funkcijo lahko tudi poimenujemo; tukaj je primer, kjer uporabimo funkcijo sinus in konstanto <span class="math notranslate nohighlight">\(\pi\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">1.2</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cfcc51e0412854e8546efdf4bb8cd925db42e52b8047decee6e23824ae68aa62.png" src="_images/cfcc51e0412854e8546efdf4bb8cd925db42e52b8047decee6e23824ae68aa62.png" />
</div>
</div>
<p>Bralec se morebiti sprašuje, zakaj potrebujemo <em>novo</em> funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.sin()</span></code>, saj imamo vendar že tisto iz paketa <code class="docutils literal notranslate"><span class="pre">numpy</span></code>! Razlog je v tem, da simbolni izračun potrebuje popolnoma drugačno obravnavo kakor numerični in zato je koda zadaj povsem drugačna.</p>
<p>Če želimo zapisati enačbo, torej da enačimo en izraz z drugim, to naredimo takole:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">enačba</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">),</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">enačba</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/777022286609fdca993fe6da9d1b72dda54856d502a4362bad39de429a43bbed.png" src="_images/777022286609fdca993fe6da9d1b72dda54856d502a4362bad39de429a43bbed.png" />
</div>
</div>
<p>Nedefinirane matematične funkcije zapišemo kot (<a class="reference external" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.function.Function">dokumentacija</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj lahko, na primer, definiramo differencialno enačbo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/46ab96b323b3800edfe8945835e11774775d2aecb673078d1da11f27c953b53a.png" src="_images/46ab96b323b3800edfe8945835e11774775d2aecb673078d1da11f27c953b53a.png" />
</div>
</div>
<p>Pri definiranju spremenljivk lahko dodajamo predpostavke:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">is_positive</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Predpostavke se potem upoštevajo pri izračunu. V splošnem vemo, da <span class="math notranslate nohighlight">\(\sqrt{(x^2)}\ne x\)</span>, če pa je <span class="math notranslate nohighlight">\(x\)</span> pozitiven, pa velja <span class="math notranslate nohighlight">\(\sqrt{(x^2)}= x\)</span> in <code class="docutils literal notranslate"><span class="pre">sympy</span></code> glede na predpostavke izračuna pravilen rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a62f1bf0f037de5a14e602497a42670c302da5db132010539cd91d2d25add5c6.png" src="_images/a62f1bf0f037de5a14e602497a42670c302da5db132010539cd91d2d25add5c6.png" />
</div>
</div>
<p>Z metodo <code class="docutils literal notranslate"><span class="pre">assumptions0</span></code> pogledamo predpostavke objekta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">assumptions0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;positive&#39;: True,
 &#39;extended_nonpositive&#39;: False,
 &#39;extended_real&#39;: True,
 &#39;hermitian&#39;: True,
 &#39;nonnegative&#39;: True,
 &#39;nonzero&#39;: True,
 &#39;extended_positive&#39;: True,
 &#39;extended_nonnegative&#39;: True,
 &#39;imaginary&#39;: False,
 &#39;negative&#39;: False,
 &#39;infinite&#39;: False,
 &#39;complex&#39;: True,
 &#39;extended_negative&#39;: False,
 &#39;real&#39;: True,
 &#39;finite&#39;: True,
 &#39;commutative&#39;: True,
 &#39;nonpositive&#39;: False,
 &#39;extended_nonzero&#39;: True,
 &#39;zero&#39;: False}
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SymPy</span></code> pozna tipe števil (<a class="reference external" href="http://docs.sympy.org/latest/modules/core.html#module-sympy.core.numbers">dokumentacija</a>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Real</span></code> realna števila,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Rational</span></code> racionalna števila,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Complex</span></code> kompleksna števila,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Integer</span></code> cela števila.</p></li>
</ul>
<p>Ti tipi so pomembni, saj lahko vplivajo na način reševanja in na rešitev.</p>
<section id="racionalna-stevila">
<h4>Racionalna števila<a class="headerlink" href="#racionalna-stevila" title="Permalink to this heading">#</a></h4>
<p>Zgoraj smo že definirali <em>realna števila</em>. Poglejmo na primeru sedaj <em>racionalna števila</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2ca5a7b1da0abcb8a66ef64f5a9e3514537ecc465bab19847940ee9d78c1e2e3.png" src="_images/2ca5a7b1da0abcb8a66ef64f5a9e3514537ecc465bab19847940ee9d78c1e2e3.png" />
</div>
</div>
<p>Nekateri izračuni:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span><span class="o">+</span><span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3e760233670809c9a0cf4c0a69ab2c3370ef48b0881970894778a077d95dcb6f.png" src="_images/3e760233670809c9a0cf4c0a69ab2c3370ef48b0881970894778a077d95dcb6f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span><span class="o">/</span><span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fd756d14a146a98aa8b0ae85e116f62254d37bd387ff9cbe78351c3370315ad8.png" src="_images/fd756d14a146a98aa8b0ae85e116f62254d37bd387ff9cbe78351c3370315ad8.png" />
</div>
</div>
</section>
<section id="kompleksna-stevila">
<h4>Kompleksna števila<a class="headerlink" href="#kompleksna-stevila" title="Permalink to this heading">#</a></h4>
<p>Imaginarno število se zapiše z <code class="docutils literal notranslate"><span class="pre">I</span></code> (to je drugače kot pri <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, kjer je imaginarni del definiran z <code class="docutils literal notranslate"><span class="pre">j</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">I</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7f73cfcbe4fc082bfddd0a93d02f113cfa9740ac742f3b14fc31c9deade4ad18.png" src="_images/7f73cfcbe4fc082bfddd0a93d02f113cfa9740ac742f3b14fc31c9deade4ad18.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">I</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d42ce757c38d93f08ca9ba5ba51bc1dbb529ac27fbdf9ae82e39d2572c183f67.png" src="_images/d42ce757c38d93f08ca9ba5ba51bc1dbb529ac27fbdf9ae82e39d2572c183f67.png" />
</div>
</div>
</section>
<section id="numericni-izracun">
<h4>Numerični izračun<a class="headerlink" href="#numericni-izracun" title="Permalink to this heading">#</a></h4>
<p>Pri simbolnem izračunu najprej analitične izraze rešimo, poenostavimo itd., nato pa pogosto želimo tudi izračunati konkreten rezultat.</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">x</span><span class="o">**</span><span class="n">x</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a2626477b6f1da44add829001c3a0c9b0cf48b39fef1f16124a2089287d944ae.png" src="_images/a2626477b6f1da44add829001c3a0c9b0cf48b39fef1f16124a2089287d944ae.png" />
</div>
</div>
<p>Če želimo sedaj namesto <span class="math notranslate nohighlight">\(x\)</span> uporabiti vrednost, npr <code class="docutils literal notranslate"><span class="pre">0.5</span></code>, to naredimo z metodo <code class="docutils literal notranslate"><span class="pre">subs()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/tutorial/basic_operations.html#substitution">dokumentacija</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1452e1e4d1e82556721f6d08e442268ffb64fb788cc0c270671aa8ee09383c96.png" src="_images/1452e1e4d1e82556721f6d08e442268ffb64fb788cc0c270671aa8ee09383c96.png" />
</div>
</div>
<p>Zgoraj smo uporabili konstanto <span class="math notranslate nohighlight">\(\pi\)</span> (<a class="reference external" href="http://docs.sympy.org/latest/modules/core.html?highlight=pi#sympy.core.numbers.Pi">dokumentacija</a>); nekatere tipično uporabljene konstante so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sympy.pi</span></code> za število <span class="math notranslate nohighlight">\(\pi\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sympy.E</span></code> za naravno število <span class="math notranslate nohighlight">\(e\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sympy.oo</span></code> za neskončnost.</p></li>
</ul>
<p>Kot smo videli zgoraj, <code class="docutils literal notranslate"><span class="pre">subs()</span></code> naredi zamenjavo in potem poenostavitve, ki so očitne; števila <span class="math notranslate nohighlight">\(\pi\)</span> ni izračunal v racionalni obliki. To moramo eksplicitno zahtevati z metodo:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">evalf</span></code> (angl. *evaluate function, <a class="reference external" href="http://docs.sympy.org/latest/modules/evalf.html">dokumentacija</a>) ali</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code>,</p></li>
</ul>
<p>kateri imata obe argument <code class="docutils literal notranslate"><span class="pre">n</span></code> (število števk).</p>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/859af3bf52cefb83321b9b1092e7e8bf8151cc3bc8bc532e26d9fbe1815908ce.png" src="_images/859af3bf52cefb83321b9b1092e7e8bf8151cc3bc8bc532e26d9fbe1815908ce.png" />
</div>
</div>
<p>Podobno je z <code class="docutils literal notranslate"><span class="pre">N</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/859af3bf52cefb83321b9b1092e7e8bf8151cc3bc8bc532e26d9fbe1815908ce.png" src="_images/859af3bf52cefb83321b9b1092e7e8bf8151cc3bc8bc532e26d9fbe1815908ce.png" />
</div>
</div>
<p>Mimogrede smo pokazali, da pod pogojem, da v izrazu nimamo števil s plavajočo vejico, lahko rezultat prikažemo poljubno natančno (<a class="reference external" href="http://docs.sympy.org/latest/modules/evalf.html">dokumentacija</a>).</p>
<p>V <code class="docutils literal notranslate"><span class="pre">subs</span></code> funkciji lahko uporabimo tudi slovar. Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">parametri</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">parametri</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9166a76e4c7188a60c99c6c89cc0834bef1c30309bc070a9db6f09d3cf3f7823.png" src="_images/9166a76e4c7188a60c99c6c89cc0834bef1c30309bc070a9db6f09d3cf3f7823.png" />
</div>
</div>
<p>ali seznam terk:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9166a76e4c7188a60c99c6c89cc0834bef1c30309bc070a9db6f09d3cf3f7823.png" src="_images/9166a76e4c7188a60c99c6c89cc0834bef1c30309bc070a9db6f09d3cf3f7823.png" />
</div>
</div>
<p>Podobno ima metoda <code class="docutils literal notranslate"><span class="pre">sympy.evalf()</span></code> argument <code class="docutils literal notranslate"><span class="pre">subs</span></code>, ki sprejme slovar zamenjav, primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="n">parametri</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b51127934d3ba17a39febdbc570fbb6a30142bcf157b4c479e692177012146ee.png" src="_images/b51127934d3ba17a39febdbc570fbb6a30142bcf157b4c479e692177012146ee.png" />
</div>
</div>
<p>Metoda <code class="docutils literal notranslate"><span class="pre">sympy.subs</span></code> pa lahko zamenja simbol (ali izraz) tudi z drugim izrazom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">oo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a4e4235f4eeb3ac8d36895aed005f6e891473586120516a4b052364d8e22920.png" src="_images/8a4e4235f4eeb3ac8d36895aed005f6e891473586120516a4b052364d8e22920.png" />
</div>
</div>
</section>
</section>
<section id="sympy-in-numpy">
<h3><code class="docutils literal notranslate"><span class="pre">SymPy</span></code> in <code class="docutils literal notranslate"><span class="pre">NumPy</span></code><a class="headerlink" href="#sympy-in-numpy" title="Permalink to this heading">#</a></h3>
<p>Pogosto <code class="docutils literal notranslate"><span class="pre">sympy</span></code> povežemo z <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. Za primer si poglejmo, kako bi izraz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d9a678613784e35364d07be8a03846a09e7f062d51612e636b2d8dfaf26a1fb8.png" src="_images/d9a678613784e35364d07be8a03846a09e7f062d51612e636b2d8dfaf26a1fb8.png" />
</div>
</div>
<p>numerično učinkovito izračunali pri tisoč vrednostih <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Najprej uvozimo paket <code class="docutils literal notranslate"><span class="pre">numpy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo numerično polje vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">x_vec</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.  , 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09])
</pre></div>
</div>
</div>
</div>
<p>Glede na zapisano zgoraj in predhodno znanje uporabimo izpeljevanje seznamov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">vrednost</span><span class="p">})</span> <span class="k">for</span> <span class="n">vrednost</span> <span class="ow">in</span> <span class="n">x_vec</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Opazimo, da je to dolgotrajno, zato izmerimo potreben čas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n1
<span class="n">y_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">vrednost</span><span class="p">})</span> <span class="k">for</span> <span class="n">vrednost</span> <span class="ow">in</span> <span class="n">x_vec</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>97.3 ms ± 3.12 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
</div>
</div>
<section id="uporaba-funkcije-lambdify">
<h4>Uporaba funkcije <code class="docutils literal notranslate"><span class="pre">lambdify</span></code><a class="headerlink" href="#uporaba-funkcije-lambdify" title="Permalink to this heading">#</a></h4>
<p>Bistveno hitrejši način je uporaba pristopa <code class="docutils literal notranslate"><span class="pre">lambdify</span></code>, kjer se pripravi prevedena funkcija, optimirana za numerično izvajanje. Sintaksa funkcije <code class="docutils literal notranslate"><span class="pre">sympy.lambdify()</span></code> je (<a class="reference external" href="http://docs.sympy.org/latest/modules/utilities/lambdify.html#sympy.utilities.lambdify.lambdify">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">simboli</span><span class="p">,</span> <span class="n">funkcija</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">simboli</span></code> simboli uporabljeni v <code class="docutils literal notranslate"><span class="pre">funkcija</span></code>, ki se zamenjajo z numeričnimi vrednostmi,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">funkcija</span></code> predstavlja <code class="docutils literal notranslate"><span class="pre">sympy</span></code> funkcijo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules</span></code> predstavlja, za kateri paket je prevedena oblika pripravljena. Če je <code class="docutils literal notranslate"><span class="pre">numpy</span></code> nameščen, je privzeto za ta modul.</p></li>
</ul>
<p>Primer uporabe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_hitra</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="n">y_vec_hitra</span> <span class="o">=</span> <span class="n">f_hitra</span><span class="p">(</span><span class="n">x_vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Preverimo hitrost:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it -n100
<span class="n">f_hitra</span><span class="p">(</span><span class="n">x_vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22.1 µs ± 5.45 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<p>Opazimo približno 10.000-kratno pohitritev!</p>
<p>Poglejmo še primer uporabe funkcije več spremenljivk:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_hitra2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">f_hitra2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  9.8696044 ,  28.77051002,  57.54795885,  96.20195089,
       144.73248614, 203.1395646 , 271.42318627, 349.58335115,
       437.62005924, 535.53331054])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="graficni-prikaz">
<h3>Grafični prikaz<a class="headerlink" href="#graficni-prikaz" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">SymPy</span></code> ima na <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> temelječ prikaz podatkov. Prikaz je sicer glede na <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> bolj omejen in ga uporabljamo za preproste prikaze. (<a class="reference external" href="http://docs.sympy.org/latest/modules/plotting.html">dokumentacija</a>).</p>
<p>Pogledali si bomo preproste primere, ki se navezujejo na funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.plotting.plot</span></code>; najprej uvozimo funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.plotting</span> <span class="kn">import</span> <span class="n">plot</span>
</pre></div>
</div>
</div>
</div>
<p>Sintaksa uporabe funkcije <code class="docutils literal notranslate"><span class="pre">sympy.plotting.plot()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/plotting.html#plotting-function-reference">dokumentacija</a>) je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">izraz</span><span class="p">,</span> <span class="n">razpon</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">izraz</span></code> je matematični izraz ali več izrazov,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">razpon</span></code> je razpon prikaza (privzeti razpon je (-10, 10)),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> so <em>keyword arguments</em>, torej slovar različnih možnosti.</p></li>
</ul>
<p>Funkcija vrne instanco objekta <code class="docutils literal notranslate"><span class="pre">sympy.Plot()</span></code>.</p>
<p>Minimalni primer ene funkcije:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/68c485ceaf9db344818002a7a6c41367d37ff2b08fc525a85ea969f082143eeb.png" src="_images/68c485ceaf9db344818002a7a6c41367d37ff2b08fc525a85ea969f082143eeb.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sympy.plotting.plot.Plot at 0x15e14a0b310&gt;
</pre></div>
</div>
</div>
</div>
<p>Opomba: zadnja vrstica opozori na rezultat v obliki instance <code class="docutils literal notranslate"><span class="pre">Plot</span></code>; izpis objekta <code class="docutils literal notranslate"><span class="pre">&lt;sympy.plotting.plot.Plot</span> <span class="pre">at</span> <span class="pre">0x...&gt;</span></code> skrijemo z uporabo podpičja:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>slika pa se vseeno prikaže.</p>
<p>Nekateri pogosti argumenti so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">show</span></code> prikaže sliko (privzeto <code class="docutils literal notranslate"><span class="pre">True</span></code>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">line_color</span></code> barva izrisa,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xscale</span></code> in <code class="docutils literal notranslate"><span class="pre">yscale</span></code> način prikaza (možnosti: <code class="docutils literal notranslate"><span class="pre">linear</span></code> ali <code class="docutils literal notranslate"><span class="pre">log</span></code>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xlim</span></code> in <code class="docutils literal notranslate"><span class="pre">ylim</span></code> omejitev prikaza za osi (terka dveh <code class="docutils literal notranslate"><span class="pre">(min,</span> <span class="pre">max)</span></code> vrednosti).</p></li>
</ul>
<p>Pripravimo dve sliki, kjer bo <span class="math notranslate nohighlight">\(y\)</span> os logaritemska in bo razpon izrisa od 1 do 5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">izris1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">izris2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj prvo sliko razširimo z drugo in prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">izris1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">izris2</span><span class="p">)</span>
<span class="n">izris1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/94d89c117e63b7e149ab810abffc3c878dee340e093f0e5e3056417999812b76.png" src="_images/94d89c117e63b7e149ab810abffc3c878dee340e093f0e5e3056417999812b76.png" />
</div>
</div>
<section id="parametricni-izris">
<h4>Parametrični izris<a class="headerlink" href="#parametricni-izris" title="Permalink to this heading">#</a></h4>
<p>Podobno uporabljamo funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.plotting.plot_parametric</span></code> za parametrični izris (<a class="reference external" href="http://docs.sympy.org/latest/modules/plotting.html#sympy.plotting.plot.plot_parametric">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_parametric</span><span class="p">(</span><span class="n">izraz_x</span><span class="p">,</span> <span class="n">izraz_y</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer sta nova argumenta:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">izraz_x</span></code> in <code class="docutils literal notranslate"><span class="pre">izraz_y</span></code> definicije lege koordinate <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(y\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> je slovar možnosti.</p></li>
</ul>
<p>Uvozimo funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.plotting</span> <span class="kn">import</span> <span class="n">plot_parametric</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo uporabo na primeru:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_parametric</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/835dd20ca03ad3a4c8650539ce7d69d09cdf2aa6c1faff3a4ae4d6058e2b5f72.png" src="_images/835dd20ca03ad3a4c8650539ce7d69d09cdf2aa6c1faff3a4ae4d6058e2b5f72.png" />
</div>
</div>
</section>
<section id="izris-v-prostoru">
<h4>Izris v prostoru<a class="headerlink" href="#izris-v-prostoru" title="Permalink to this heading">#</a></h4>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">sympy.plotting.plot3D</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/plotting.html#sympy.plotting.plot.plot3d">dokumentacija</a>) za izris v prostoru ima sintakso:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot3d</span><span class="p">(</span><span class="n">izraz</span><span class="p">,</span> <span class="n">razpon_x</span><span class="p">,</span> <span class="n">razpon_y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">izraz</span></code> definicija površine,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">razpon_x</span></code> in <code class="docutils literal notranslate"><span class="pre">razpon_y</span></code> razpon koordinate <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> slovar možnosti.</p></li>
</ul>
<p>Uvozimo funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.plotting</span> <span class="kn">import</span> <span class="n">plot3d</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo uporabo na primeru:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="n">plot3d</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/40138da8f4aef5608793451c6908be7229edbc3d918fce2faf72e84e3f713567.png" src="_images/40138da8f4aef5608793451c6908be7229edbc3d918fce2faf72e84e3f713567.png" />
</div>
</div>
<p>Za ostale prikaze glejte <a class="reference external" href="http://docs.sympy.org/latest/modules/plotting.html#module-sympy.plotting.plot">dokumentacijo</a>.</p>
</section>
</section>
<section id="algebra">
<h3>Algebra<a class="headerlink" href="#algebra" title="Permalink to this heading">#</a></h3>
<p>V tem poglavju si bomo pogledali nekatere osnove uporabe <code class="docutils literal notranslate"><span class="pre">SymPy</span></code> za algebrajske operacije.</p>
<section id="uporaba-expand-in-factor">
<h4>Uporaba <code class="docutils literal notranslate"><span class="pre">expand</span></code> in <code class="docutils literal notranslate"><span class="pre">factor</span></code><a class="headerlink" href="#uporaba-expand-in-factor" title="Permalink to this heading">#</a></h4>
<p>Definirajmo matematični izraz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3cc11bc42bdefbfd1fbe06ea901bc6cecd22b035958ec803d54e477ed2065229.png" src="_images/3cc11bc42bdefbfd1fbe06ea901bc6cecd22b035958ec803d54e477ed2065229.png" />
</div>
</div>
<p>in ga sedaj <strong>razčlenimo</strong> (angl. <em>expand</em>, glejte <a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#expand">dokumentacijo</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aa</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">aa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/589ca0fc7877657d05318af33172a1af97a738abd2e8abaaca2f241bce3d9011.png" src="_images/589ca0fc7877657d05318af33172a1af97a738abd2e8abaaca2f241bce3d9011.png" />
</div>
</div>
<p>Če želimo pogledati koeficiente pred <code class="docutils literal notranslate"><span class="pre">x</span></code>, to naredimo z metodo <code class="docutils literal notranslate"><span class="pre">coeff()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aa</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a28165f21132b3ecda9391d48dd23cbf7651e859ca1d98f2e94c43afe484c0db.png" src="_images/a28165f21132b3ecda9391d48dd23cbf7651e859ca1d98f2e94c43afe484c0db.png" />
</div>
</div>
<p>Argumenti funkcije definirajo, kakšno razširitev želimo (<a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#expand">dokumentacija</a>). Če želimo npr. trigonometrično razširitev, potem uporabimo <code class="docutils literal notranslate"><span class="pre">trig=True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, b&#39;</span><span class="p">)</span>
<span class="n">sym</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8b34ba99a4f7048425077d6ac4c1c293ee1ebc08b7ea1575a02d5fafe89c99c4.png" src="_images/8b34ba99a4f7048425077d6ac4c1c293ee1ebc08b7ea1575a02d5fafe89c99c4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">),</span> <span class="n">trig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fb42666eb43c1bb178478c20f131d31217baccdc140b5d178e396db42a33ebcb.png" src="_images/fb42666eb43c1bb178478c20f131d31217baccdc140b5d178e396db42a33ebcb.png" />
</div>
</div>
<p>Obratna operacija od razčlenitve je <strong>razcepitev</strong> ali <strong>razstavljanje</strong> ali <strong>faktorizacija</strong> (angl. <em>factor</em>, <a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#factor">dokumentacija</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3cc11bc42bdefbfd1fbe06ea901bc6cecd22b035958ec803d54e477ed2065229.png" src="_images/3cc11bc42bdefbfd1fbe06ea901bc6cecd22b035958ec803d54e477ed2065229.png" />
</div>
</div>
<p>Če nas zanimajo posamezni členi, potem to naredimo s funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.factor_list</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">factor_list</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ea8ae5130c19f84527a047c18aea43263991bebe71dbff0d037e41efaff76e07.png" src="_images/ea8ae5130c19f84527a047c18aea43263991bebe71dbff0d037e41efaff76e07.png" />
</div>
</div>
</section>
<section id="poenostavljanje-izrazov-s-simplify">
<h4>Poenostavljanje izrazov s <code class="docutils literal notranslate"><span class="pre">simplify</span></code><a class="headerlink" href="#poenostavljanje-izrazov-s-simplify" title="Permalink to this heading">#</a></h4>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">sympy.simplify()</span></code>  (<a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#simplify">dokumentacija</a>) poskuša poenostaviti izraze v bolj preproste (npr. s krajšanjem spremenljivk).</p>
<p>Za posebne namene lahko poenostavimo tudi z:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#trigsimp"><code class="docutils literal notranslate"><span class="pre">sympy.trigsimp</span></code></a>,</p></li>
<li><p><a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#powsimp"><code class="docutils literal notranslate"><span class="pre">sympy.powsimp</span></code></a>,</p></li>
<li><p><a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#logcombine"><code class="docutils literal notranslate"><span class="pre">sympy.logcombine</span></code></a>.</p></li>
</ul>
<p>Za več glejte <a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html">dokumentacijo</a>.</p>
<p>Primeri poenostavljanja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/783d038914bb2cb41e6724f4af16e608e3e346428912d00891dd1a93bab41f01.png" src="_images/783d038914bb2cb41e6724f4af16e608e3e346428912d00891dd1a93bab41f01.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d81096050bd44ce57b5d5fe4208dfd494a47c011aecee7a2c422785cd87b6ef4.png" src="_images/d81096050bd44ce57b5d5fe4208dfd494a47c011aecee7a2c422785cd87b6ef4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/563d6094e9255fa98dbf43b31d020ace326b4c3d38a2225d6c37125c8a7d4901.png" src="_images/563d6094e9255fa98dbf43b31d020ace326b4c3d38a2225d6c37125c8a7d4901.png" />
</div>
</div>
</section>
</section>
<section id="uporaba-apart-in-together">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">apart</span></code> in <code class="docutils literal notranslate"><span class="pre">together</span></code><a class="headerlink" href="#uporaba-apart-in-together" title="Permalink to this heading">#</a></h3>
<p>Funkciji uporabljamo za delo z ulomki:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="p">))</span>
<span class="n">f1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/407e11504bce7437320ce4d1c6155e1c8708d783b74d2606cc2b350e4d347bdc.png" src="_images/407e11504bce7437320ce4d1c6155e1c8708d783b74d2606cc2b350e4d347bdc.png" />
</div>
</div>
<p>Razcep na parcialne ulomke (angl. <em>partial fraction decomposition</em>) izvedemo s funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.apart()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/tutorial/simplification.html#apart">dokumentacija</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">apart</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">f2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0032336f88627f88a1ef3e16d428b97d5584c3b2dc314c41def286a1b6154535.png" src="_images/0032336f88627f88a1ef3e16d428b97d5584c3b2dc314c41def286a1b6154535.png" />
</div>
</div>
<p>in potem ponovno v obratni smeri s funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.together()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">together</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/407e11504bce7437320ce4d1c6155e1c8708d783b74d2606cc2b350e4d347bdc.png" src="_images/407e11504bce7437320ce4d1c6155e1c8708d783b74d2606cc2b350e4d347bdc.png" />
</div>
</div>
<p>V slednjem primeru pridemo do podobnega rezultata s <code class="docutils literal notranslate"><span class="pre">sympy.simplify()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/407e11504bce7437320ce4d1c6155e1c8708d783b74d2606cc2b350e4d347bdc.png" src="_images/407e11504bce7437320ce4d1c6155e1c8708d783b74d2606cc2b350e4d347bdc.png" />
</div>
</div>
</section>
<section id="odvajanje">
<h3>Odvajanje<a class="headerlink" href="#odvajanje" title="Permalink to this heading">#</a></h3>
<p>Odvajanje je načeloma relativno preprosta matematična operacija, ki jo izvedemo s funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.diff()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/tutorial/calculus.html#derivatives">dokumentacija</a>):</p>
<p>Pripravimo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y, z&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5ff7249ddff2b921d4836494423a55b5390f3604939c5488ed676c7cb003b511.png" src="_images/5ff7249ddff2b921d4836494423a55b5390f3604939c5488ed676c7cb003b511.png" />
</div>
</div>
<p>Odvajajmo ga po <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" src="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" />
</div>
</div>
<p>ali tudi</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" src="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" />
</div>
</div>
<p>Odvode višjega reda definiramo tako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3e75788866ec8f130111685bdadeb806093bff676ebdadcb9d66fe19083ad52c.png" src="_images/3e75788866ec8f130111685bdadeb806093bff676ebdadcb9d66fe19083ad52c.png" />
</div>
</div>
<p>ali (isti rezultat malo drugače):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3e75788866ec8f130111685bdadeb806093bff676ebdadcb9d66fe19083ad52c.png" src="_images/3e75788866ec8f130111685bdadeb806093bff676ebdadcb9d66fe19083ad52c.png" />
</div>
</div>
<p>Odvod po več spremenljivkah <span class="math notranslate nohighlight">\(\frac{d^3f}{dx\,dy^2}\)</span> izvedemo takole:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a1fb2f486edb296169ae8d717c1232a5be8055c2d18238bfdbbf0d4b91981a8.png" src="_images/4a1fb2f486edb296169ae8d717c1232a5be8055c2d18238bfdbbf0d4b91981a8.png" />
</div>
</div>
</section>
<section id="integriranje">
<h3>Integriranje<a class="headerlink" href="#integriranje" title="Permalink to this heading">#</a></h3>
<p>Funkcijo <code class="docutils literal notranslate"><span class="pre">integrate</span></code> lahko uporabimo za nedoločeno integriranje (<a class="reference external" href="http://docs.sympy.org/latest/modules/integrals/integrals.html#module-sympy.integrals">dokumentacija</a>):</p>
<div class="highlight-pythoon notranslate"><div class="highlight"><pre><span></span>integrate(f, x)
</pre></div>
</div>
<p>ali za določeno integriranje:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> funkcija, ki jo integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> spremenljivka, po kateri integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">b</span></code> meje integriranja.</p></li>
</ul>
<p>Primer nedoločenega integriranja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5659145c23aeb9a34f4a2f81a12f1fce627f01c74acef6ebc8ea5e1f6e2ef166.png" src="_images/5659145c23aeb9a34f4a2f81a12f1fce627f01c74acef6ebc8ea5e1f6e2ef166.png" />
</div>
</div>
<p>Opazimo, da <code class="docutils literal notranslate"><span class="pre">sympy</span></code> pravilno upošteva možnost, da je <span class="math notranslate nohighlight">\(y=0\)</span>.</p>
<p>Še primer določenega integriranja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b7111734a58ceccf79603e820280d7fc1612dc1b22c061d32eb5a553a649f9c9.png" src="_images/b7111734a58ceccf79603e820280d7fc1612dc1b22c061d32eb5a553a649f9c9.png" />
</div>
</div>
<p>Primer, ko so meje v neskončnosti (uporabimo konstanto za neskončnost <code class="docutils literal notranslate"><span class="pre">sympy.oo</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">sym</span><span class="o">.</span><span class="n">oo</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">oo</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ccef02a8d83a3c43a6ef7751e0c9d76bac908e2bb2411907f1c600908ecb5eff.png" src="_images/ccef02a8d83a3c43a6ef7751e0c9d76bac908e2bb2411907f1c600908ecb5eff.png" />
</div>
</div>
</section>
<section id="vsota-in-produkt-vrste">
<h3>Vsota in produkt vrste<a class="headerlink" href="#vsota-in-produkt-vrste" title="Permalink to this heading">#</a></h3>
<p>Vsoto vrste definiramo s pomočju funkcije <code class="docutils literal notranslate"><span class="pre">sympy.Sum()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/concrete.html#sympy.concrete.summations.Sum">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">izraz</span><span class="p">,</span> <span class="p">(</span><span class="n">spr</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">izraz</span></code> izraz, katerega seštevamo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spr</span></code>, <code class="docutils literal notranslate"><span class="pre">start</span></code> in <code class="docutils literal notranslate"><span class="pre">end</span></code> spremenljivka, ki naračša od <code class="docutils literal notranslate"><span class="pre">start</span></code> do <code class="docutils literal notranslate"><span class="pre">end</span></code> (<code class="docutils literal notranslate"><span class="pre">end</span></code> je vključen).</p></li>
</ul>
<p>Primer vsote vrste:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">oo</span><span class="p">))</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/294dce18e8c07e6fdb70e7f5c58d0b5add61b77dea190a4b5f065f8cc748c4cb.png" src="_images/294dce18e8c07e6fdb70e7f5c58d0b5add61b77dea190a4b5f065f8cc748c4cb.png" />
</div>
</div>
<p>Šele ko uporabimo metodo <code class="docutils literal notranslate"><span class="pre">doit_()</span></code>, se izračun izvede:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ebe6feee72f542ebd434c62a7d53ae25e602a21454cd9539ca783630cfd423a5.png" src="_images/ebe6feee72f542ebd434c62a7d53ae25e602a21454cd9539ca783630cfd423a5.png" />
</div>
</div>
<p>Poglejmo še številčni rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c93686befe153074e678fb4b337ce6c7b80083932202eeb9002b915a963d425a.png" src="_images/c93686befe153074e678fb4b337ce6c7b80083932202eeb9002b915a963d425a.png" />
</div>
</div>
<p>Produkt vrste definiramo podobno s funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.Product</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/concrete.html#sympy.concrete.products.Product">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Product</span><span class="p">(</span><span class="n">izraz</span><span class="p">,</span> <span class="p">(</span><span class="n">spr</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">izraz</span></code> izraz, katerega množimo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spr</span></code>, <code class="docutils literal notranslate"><span class="pre">start</span></code> in <code class="docutils literal notranslate"><span class="pre">end</span></code> spremenljivka, ki naračša od <code class="docutils literal notranslate"><span class="pre">start</span></code> do <code class="docutils literal notranslate"><span class="pre">end</span></code> (<code class="docutils literal notranslate"><span class="pre">end</span></code> je vključen).</p></li>
</ul>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Product</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8207d5e77928e425180f9d0a5d27e000de3732fb3b10a844e1110064a8dba45e.png" src="_images/8207d5e77928e425180f9d0a5d27e000de3732fb3b10a844e1110064a8dba45e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3fed1b161ded0a4bfb92a7120f15189ad891707a9875d6f46569cd738d7dc0e6.png" src="_images/3fed1b161ded0a4bfb92a7120f15189ad891707a9875d6f46569cd738d7dc0e6.png" />
</div>
</div>
</section>
<section id="limitni-racun">
<h3>Limitni račun<a class="headerlink" href="#limitni-racun" title="Permalink to this heading">#</a></h3>
<p>Limite računamo s pomočjo funkcije <code class="docutils literal notranslate"><span class="pre">sympy.limit()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/tutorial/calculus.html#limits">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> izraz, katerega limito iščemo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> spremenljivka, ki limitira proti <code class="docutils literal notranslate"><span class="pre">x0</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code> limita.</p></li>
</ul>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/765b1df3002a67d91142c2d544525bcf3ffdd0e71b84c22aeddf3d2249911bee.png" src="_images/765b1df3002a67d91142c2d544525bcf3ffdd0e71b84c22aeddf3d2249911bee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d81096050bd44ce57b5d5fe4208dfd494a47c011aecee7a2c422785cd87b6ef4.png" src="_images/d81096050bd44ce57b5d5fe4208dfd494a47c011aecee7a2c422785cd87b6ef4.png" />
</div>
</div>
<p>Za primer si poglejmo uporabo limite na definiciji odvoda:
$<span class="math notranslate nohighlight">\(\frac{\mathrm{d}f}{\mathrm{d}x} = \lim_{h\rightarrow 0}\frac{f(x+h,y)-f(x,y)}{h}.\)</span>$</p>
<p>Pripravimo funkcijo <code class="docutils literal notranslate"><span class="pre">f</span></code> in njen odvod:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y, z, h&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Odvod funkcije je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" src="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" />
</div>
</div>
<p>Enak rezultat izračunamo tudi z uporabo limite:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">limit</span><span class="p">((</span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" src="_images/396c7f6d437daf0a8f06b229731fa6e27509d443ce5e651f334b6c56b1d7d1c3.png" />
</div>
</div>
</section>
<section id="taylorjeve-vrste">
<h3>Taylorjeve vrste<a class="headerlink" href="#taylorjeve-vrste" title="Permalink to this heading">#</a></h3>
<p>Taylorjeve vrste izračunamo s pomočjo funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.series()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/series/series.html#id1">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">izraz</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">izraz</span></code> izraz, katerega vrsto določamo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> neodvisna spremenljivka,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code> vrednost, okoli katere določamo vrsto (privzeto 0),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> red vrste (privzeto 6),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span></code> smer razvoja vrste (<code class="docutils literal notranslate"><span class="pre">+</span></code> ali <code class="docutils literal notranslate"><span class="pre">-</span></code>).</p></li>
</ul>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">sym</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># privzete vrednosti x0=0, in n=6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6086771a78e1d58325f476fdb7530df32cd6bec3980477b49838a1d42e8a2734.png" src="_images/6086771a78e1d58325f476fdb7530df32cd6bec3980477b49838a1d42e8a2734.png" />
</div>
</div>
<p>Če želimo definirati drugo izhodišče (<code class="docutils literal notranslate"><span class="pre">x0=2</span></code>) in z več členi (<code class="docutils literal notranslate"><span class="pre">n=8</span></code>), to izvedemo takole:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">s1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ccb74c260fb2439ed8791276eb4cc1345a27e03fc3e563289b53d65f1426c0d9.png" src="_images/ccb74c260fb2439ed8791276eb4cc1345a27e03fc3e563289b53d65f1426c0d9.png" />
</div>
</div>
<p>Rezultat vključuje tudi red veljavnosti; na ta način lahko kontroliramo veljavnosti izvajanja (<span class="math notranslate nohighlight">\(\mathcal{O}\)</span>).</p>
<p>Primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">s1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a0fdaf198fbda3d65519dbf747af74d4b3503616fab85006f4f3de8d170e5461.png" src="_images/a0fdaf198fbda3d65519dbf747af74d4b3503616fab85006f4f3de8d170e5461.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/33ee20909f81aa49fad6303bc8185685896d8c21895128cdd0a5cd99ff7dc3af.png" src="_images/33ee20909f81aa49fad6303bc8185685896d8c21895128cdd0a5cd99ff7dc3af.png" />
</div>
</div>
<p>Izračuna <code class="docutils literal notranslate"><span class="pre">s1</span></code> in <code class="docutils literal notranslate"><span class="pre">s2</span></code> imata različna reda veljavnosti, posledično je produkt:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">*</span> <span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1fb8f5094a70485cf6bf923c26dffc6ea062a78624f8d2d0db5cd261857fb8e.png" src="_images/d1fb8f5094a70485cf6bf923c26dffc6ea062a78624f8d2d0db5cd261857fb8e.png" />
</div>
</div>
<p>natančen samo do reda <span class="math notranslate nohighlight">\(\mathcal{O}(x^2)\)</span>, kar <code class="docutils literal notranslate"><span class="pre">sympy</span></code> ustrezno obravnava:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">s1</span> <span class="o">*</span> <span class="n">s2</span><span class="p">)</span>
<span class="n">s3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/33ee20909f81aa49fad6303bc8185685896d8c21895128cdd0a5cd99ff7dc3af.png" src="_images/33ee20909f81aa49fad6303bc8185685896d8c21895128cdd0a5cd99ff7dc3af.png" />
</div>
</div>
<p>Podatek o stopnji veljavnosti lahko odstranimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a62f1bf0f037de5a14e602497a42670c302da5db132010539cd91d2d25add5c6.png" src="_images/a62f1bf0f037de5a14e602497a42670c302da5db132010539cd91d2d25add5c6.png" />
</div>
</div>
</section>
<section id="linearna-algebra">
<h3>Linearna algebra<a class="headerlink" href="#linearna-algebra" title="Permalink to this heading">#</a></h3>
<section id="matrike-in-vektorji">
<h4>Matrike in vektorji<a class="headerlink" href="#matrike-in-vektorji" title="Permalink to this heading">#</a></h4>
<p>Matrike in vektorje definiramo s funkcjo <code class="docutils literal notranslate"><span class="pre">Matrix</span></code>. Če se pri <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> ni treba dosledno držati matematičnega zapisa vektorjev in matrik, je pri <code class="docutils literal notranslate"><span class="pre">sympy</span></code> to nujno.</p>
<p>Poglejmo si primer; najprej pripravimo spremenljivke:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m11</span><span class="p">,</span> <span class="n">m12</span><span class="p">,</span> <span class="n">m21</span><span class="p">,</span> <span class="n">m22</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;m11, m12, m21, m22&#39;</span><span class="p">)</span>
<span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;b1, b2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nato matriko in stolpični vektor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">m11</span><span class="p">,</span> <span class="n">m12</span><span class="p">],[</span><span class="n">m21</span><span class="p">,</span> <span class="n">m22</span><span class="p">]])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fabbff8489dae2de9d637c573cb2e58a71e2a56533eae66813e92544d1998f10.png" src="_images/fabbff8489dae2de9d637c573cb2e58a71e2a56533eae66813e92544d1998f10.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">b1</span><span class="p">],</span> <span class="p">[</span><span class="n">b2</span><span class="p">]])</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/628aca1b0bd366381d226be6630f54c7add0c34f8bdadadbc166ba2f532a49e4.png" src="_images/628aca1b0bd366381d226be6630f54c7add0c34f8bdadadbc166ba2f532a49e4.png" />
</div>
</div>
<p>Sedaj si poglejmo nekatere tipične operacije; najprej množenje matrike in vektorja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">*</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a33616a9cd466c20d65bb4cc8c401604f1bf0360bdeb5d3a23f5601a2cd6ce7.png" src="_images/4a33616a9cd466c20d65bb4cc8c401604f1bf0360bdeb5d3a23f5601a2cd6ce7.png" />
</div>
</div>
<p>Nato skalarni produkt dveh vektorjev (paziti moramo na transponiranje enega od vektorjev):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a4a13a20e65c0166d76e6ec0c8c4be9437a04a239ad6f3fd007d5840ff469eee.png" src="_images/a4a13a20e65c0166d76e6ec0c8c4be9437a04a239ad6f3fd007d5840ff469eee.png" />
</div>
</div>
<p>Determinanta in inverzna matrika:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf8bfc95bdea0f0958b5b25357197d51b6855b256fad827706f1d63d5310209e.png" src="_images/cf8bfc95bdea0f0958b5b25357197d51b6855b256fad827706f1d63d5310209e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dc4b4e738f3014f76c8991edccbe7cc1d7988734a224eff3f4e36a21248ed856.png" src="_images/dc4b4e738f3014f76c8991edccbe7cc1d7988734a224eff3f4e36a21248ed856.png" />
</div>
</div>
<p>Množenje in potenca matrike:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">*</span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2d69eb351594020673abcebf0e7778d508a6ac4f154ef62ce2c471bd59d5f875.png" src="_images/2d69eb351594020673abcebf0e7778d508a6ac4f154ef62ce2c471bd59d5f875.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2d69eb351594020673abcebf0e7778d508a6ac4f154ef62ce2c471bd59d5f875.png" src="_images/2d69eb351594020673abcebf0e7778d508a6ac4f154ef62ce2c471bd59d5f875.png" />
</div>
</div>
</section>
</section>
<section id="resevanje-enacb">
<h3>Reševanje enačb<a class="headerlink" href="#resevanje-enacb" title="Permalink to this heading">#</a></h3>
<p>Enačbe in sistem enačb rešujemo s funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.solve()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/solvers/solvers.html#algebraic-equations">dokumentacija</a>). Podprto je reševanje sledečih enačb:</p>
<ul class="simple">
<li><p>polinomske enačbe,</p></li>
<li><p>transcendentne enačbe,</p></li>
<li><p>odsekovno definirane enačbe kot kombinacija zgornjih dveh tipov,</p></li>
<li><p>sistem linearnih in polinomskih enačb,</p></li>
<li><p>sistem enačb z neenakostmi.</p></li>
</ul>
<p>Sintaksa je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="o">**</span><span class="n">flags</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> izraz ali seznam izrazov,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*symbols</span></code> simbol ali seznam simbolov, katere želimo določiti,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**flags</span></code> slovar možnosti.</p></li>
</ul>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">en</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">en</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aefb226d64133b4090ef5e4e32d7ce419454cb2b3af84b01502006d9700ca680.png" src="_images/aefb226d64133b4090ef5e4e32d7ce419454cb2b3af84b01502006d9700ca680.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">en</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/996f6c8b63435e031989a119dcafc65e0a4be15d89e8caa4ced84f09ae430573.png" src="_images/996f6c8b63435e031989a119dcafc65e0a4be15d89e8caa4ced84f09ae430573.png" />
</div>
</div>
<p>Prikažimo rešitev (opazimo, da smo našli samo dve od neskončno rešitev):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9d4b77cb37bd15b5c6d174f8bf398121ef342d4ffb4413da1fabd67c2e7f131.png" src="_images/b9d4b77cb37bd15b5c6d174f8bf398121ef342d4ffb4413da1fabd67c2e7f131.png" />
</div>
</div>
<p>Kvadratna enačba:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, b, c, x&#39;</span><span class="p">)</span>
<span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de690edcf14d63955807697e02e7df87fa230038145155159e732a4027064bff.png" src="_images/de690edcf14d63955807697e02e7df87fa230038145155159e732a4027064bff.png" />
</div>
</div>
<p>Sistem enačb:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c40a008cc79d11ec047f7e2976b517d14620f442831024cde2ce9330e1f0cdb2.png" src="_images/c40a008cc79d11ec047f7e2976b517d14620f442831024cde2ce9330e1f0cdb2.png" />
</div>
</div>
<p>Za nelinearne sisteme pa lahko uporabimo tudi numerično reševanje s funkcijo  <code class="docutils literal notranslate"><span class="pre">sympy.nsolve()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/solvers/solvers.html#sympy.solvers.solvers.nsolve">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">nsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">args</span><span class="p">,]</span> <span class="n">x0</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mpmath&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> enačba ali sistem enačb, ki ga rešujemo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code> spremenljivke (opcijsko),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code> začetni približek (skalar ali vektor),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules</span></code> paket, ki se uporabi za izračun numerične vrednosti (enaka logika kot pri funkciji <code class="docutils literal notranslate"><span class="pre">lambdify</span></code>, privzet je paket <code class="docutils literal notranslate"><span class="pre">mpmath</span></code>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> slovar opcij.</p></li>
</ul>
<p>Poglejmo primer od zgoraj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">nsolve</span><span class="p">(</span><span class="n">en</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/947d82f9c72d06572fc73015eea31fa7697d8c85513435f3524df1e693961c6a.png" src="_images/947d82f9c72d06572fc73015eea31fa7697d8c85513435f3524df1e693961c6a.png" />
</div>
</div>
</section>
<section id="resevanje-diferencialnih-enacb">
<h3>Reševanje diferencialnih enačb<a class="headerlink" href="#resevanje-diferencialnih-enacb" title="Permalink to this heading">#</a></h3>
<section id="nedefinirane-funkcije">
<h4>Nedefinirane funkcije<a class="headerlink" href="#nedefinirane-funkcije" title="Permalink to this heading">#</a></h4>
<p>Preden si ogledamo diferencialne enačbe, moramo spoznati nedefinirane funkcije. Take funkcije definiramo <code class="docutils literal notranslate"><span class="pre">sympy.Function</span></code> <a class="reference external" href="https://docs.sympy.org/latest/modules/functions/index.html">dokumentacija</a>.</p>
<p>Kot primer si poglejmo kako definiramo enačbo <span class="math notranslate nohighlight">\(\ddot x(t)=g\)</span>. Najprej definirajmo nedoločeno funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nato simbole:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t, g&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In še enačbo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/50bdc56afd8d4bb6b9647984fea28a3f81a8d360908606061f35028370f5ba1e.png" src="_images/50bdc56afd8d4bb6b9647984fea28a3f81a8d360908606061f35028370f5ba1e.png" />
</div>
</div>
</section>
<section id="diferencialne-enacbe">
<h4>Diferencialne enačbe<a class="headerlink" href="#diferencialne-enacbe" title="Permalink to this heading">#</a></h4>
<p>Diferencialne enačbe in sisteme diferencialnih enačb rešujemo s funkcijo <code class="docutils literal notranslate"><span class="pre">sympy.dsolve()</span></code> (<a class="reference external" href="http://docs.sympy.org/latest/modules/solvers/ode.html#dsolve">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
             <span class="n">ics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so izbrani argumenti:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eq</span></code> differencialna enačba ali sistem diferencialnih enačb,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> rešitev, ki jo iščemo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> začetni in robni pogoji diferencialne enačbe.</p></li>
</ul>
<p>Poglejmo si primer mase <span class="math notranslate nohighlight">\(m\)</span>, ki drsi po površini s koeficientom trenja <span class="math notranslate nohighlight">\(\mu\)</span>; začetna hitrost je <span class="math notranslate nohighlight">\(v_0\)</span>, pomik <span class="math notranslate nohighlight">\(x_0=0\)</span>.</p>
<p>Definirajmo simbole:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t m mu g v0 x0&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo diferencialno enačbo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0027f162394cf7b608f00e65d67715045d1a55737aa57fe987c8bd9d0b1d53bd.png" src="_images/0027f162394cf7b608f00e65d67715045d1a55737aa57fe987c8bd9d0b1d53bd.png" />
</div>
</div>
<p>Poglejmo lastnosti diferencialne enačbe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">ode_order</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d09c16c60c1bec6d87b5a6ea36a28d98601be002bd4b459592b55e0896ad9754.png" src="_images/d09c16c60c1bec6d87b5a6ea36a28d98601be002bd4b459592b55e0896ad9754.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;factorable&#39;,
 &#39;nth_algebraic&#39;,
 &#39;nth_linear_constant_coeff_undetermined_coefficients&#39;,
 &#39;nth_linear_euler_eq_nonhomogeneous_undetermined_coefficients&#39;,
 &#39;nth_linear_constant_coeff_variation_of_parameters&#39;,
 &#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters&#39;,
 &#39;nth_algebraic_Integral&#39;,
 &#39;nth_linear_constant_coeff_variation_of_parameters_Integral&#39;,
 &#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters_Integral&#39;,
 &#39;2nd_nonlinear_autonomous_conserved&#39;,
 &#39;2nd_nonlinear_autonomous_conserved_Integral&#39;)
</pre></div>
</div>
</div>
</div>
<p>Rešimo jo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> 
                     <span class="n">ics</span><span class="o">=</span><span class="p">{</span>
                         <span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span>                     <span class="c1">#pri času 0s je pomik nič</span>
                         <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="n">v0</span> <span class="c1">#pri času 0s je hitrost enaka v0</span>
                     <span class="p">})</span>
<span class="n">rešitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8e869e77442b73494e310bc3572115707e2b3ef9523fd8ab8638f48b49ff29bb.png" src="_images/8e869e77442b73494e310bc3572115707e2b3ef9523fd8ab8638f48b49ff29bb.png" />
</div>
</div>
<p>Desno stran enačbe prikličemo takole (<code class="docutils literal notranslate"><span class="pre">rhs</span></code> - right-hand side):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span><span class="o">.</span><span class="n">rhs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/41356b2e05b013a527154169a141e22f72de9a830c85863c698c2908b1a0cbd1.png" src="_images/41356b2e05b013a527154169a141e22f72de9a830c85863c698c2908b1a0cbd1.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Pojasnite na primeru <em>proceduralno</em> in <em>funkcijsko</em> programiranje.</p></li>
</ol>
<ul class="simple">
<li><p>Definirajte preprost objekt, naredite nekaj funkcij temu objektu.</p></li>
<li><p>Definirajte objekt, ki pri kreiranju instance zahteva zgolj celoštevilsko vrednost( npr.: dolžino seznama, ki jo bomo uporabili pri naslednji točki).</p></li>
<li><p>Objektu iz prejšnje točke naj pri inicializaciji argumentu <code class="docutils literal notranslate"><span class="pre">data</span></code> priredi naključni seznam ustrezne dolžine (glejte funkcijo <code class="docutils literal notranslate"><span class="pre">np.random.rand</span></code>).</p></li>
<li><p>Objektu iz prejšnje točke dodajte metodo za zapis vrednosti v datoteko s pomočjo funkcije <code class="docutils literal notranslate"><span class="pre">np.savetxt</span></code>.</p></li>
<li><p>Enako kot pri prejšnji točki, vendar naj se podatki shranijo v binarni obliki s pomočjo modula <code class="docutils literal notranslate"><span class="pre">pickle</span></code>.</p></li>
<li><p>Dodajte metodo za branje iz datoteke (s pomočjo <code class="docutils literal notranslate"><span class="pre">np.genfromtxt</span></code>).</p></li>
<li><p>Uvozite ves naslovni prostor iz <code class="docutils literal notranslate"><span class="pre">SymPy</span></code>. Nastavite lep izpis rezultatov.</p></li>
<li><p>Za trikotnik na sliki definirajte funkcijo za izračun površine in volumna.</p></li>
</ul>
<img src="./fig/trikotnik.png" width=300>
<ul class="simple">
<li><p>Izračunajte številčne vrednosti (podatki naj bodo definirani v slovarju in si jih izmislite).</p></li>
<li><p>Izračunajte statični moment ploskve <span class="math notranslate nohighlight">\(S_{xx}=\int_A y\,dA=\int_{0}^{b} y\,x(y)\,dy\)</span>, kjer je <span class="math notranslate nohighlight">\(x(y)=a-a\,y/b\)</span>.</p></li>
<li><p>Izračunajte vztrajnostni moment ploskve <span class="math notranslate nohighlight">\(I_{xx}=\int_A y^2\,dA\)</span>, <span class="math notranslate nohighlight">\(dA = x(y) \cdot dy\)</span>.</p></li>
<li><p>Prikažite <span class="math notranslate nohighlight">\(I_{xx}\)</span> v odvisnosti od parametra <span class="math notranslate nohighlight">\(b\)</span> (<span class="math notranslate nohighlight">\(a\)</span> definirajte poljubno).</p></li>
<li><p>Nedoločeno in določeno (v mejah od 0 do <span class="math notranslate nohighlight">\(\tau\)</span>) integrirajte izraz: <span class="math notranslate nohighlight">\(\sin(5+t)+e^t\)</span>.</p></li>
<li><p>Z odvajanjem pokažite pravilnost nedoločenega integrala iz predhodnega koraka.</p></li>
<li><p>Za kotaleči valj (polmer <span class="math notranslate nohighlight">\(r\)</span>, masa <span class="math notranslate nohighlight">\(m\)</span>) povežite translatorno <span class="math notranslate nohighlight">\(x\)</span> prostost z rotacijsko <span class="math notranslate nohighlight">\(\varphi\)</span>. Pozneje boste vse izrazili s slednjo. Namig: Dolžina loka kroga ustreza zmnožku polmera <span class="math notranslate nohighlight">\(r\)</span> in kota <span class="math notranslate nohighlight">\(\varphi\)</span> [rad].</p></li>
<li><p>Določite translatorno kinetično energijo težišča (definirajte s hitrostjo <span class="math notranslate nohighlight">\(\dot x\)</span>, zaradi predhodne povezave pa bi naj bil rezultat s <span class="math notranslate nohighlight">\(\dot{\varphi}\)</span>). <span class="math notranslate nohighlight">\(E_k = \frac{1}{2} \, m \, v^2\)</span>.</p></li>
<li><p>Določite še masni vztrajnostni moment valja in rotacijsko kinetično energijo. Obe kinetični energiji seštejte in izraz poenostavite (če je potrebno). <span class="math notranslate nohighlight">\(J_v = \frac{1}{2} \, m \, r^2\)</span> <span class="math notranslate nohighlight">\(E_{k, r} = \frac{1}{2} \, J_v \, \left[\frac{d}{dt} \varphi(t)\right]^2\)</span></p></li>
<li><p>Če na valj deluje moment <span class="math notranslate nohighlight">\(-M\)</span>, definirajte mehansko energijo: <span class="math notranslate nohighlight">\(E_m=-M\,\varphi\)</span> in določite gibalno enačbo iz spremembe mehanske energije: <span class="math notranslate nohighlight">\(\frac{d E_m}{d t}=\frac{d E_k}{d t}\)</span>.</p></li>
<li><p>Nadaljujete na predhodni enačbi: poiščite <code class="docutils literal notranslate"><span class="pre">sympy</span></code> funkcijo <code class="docutils literal notranslate"><span class="pre">replace</span></code> in ugotovite razliko s <code class="docutils literal notranslate"><span class="pre">subs</span></code>. Poskusite s pomočjo <code class="docutils literal notranslate"><span class="pre">replace</span></code> <span class="math notranslate nohighlight">\(\dot{\varphi}\)</span> na obeh straneh enačbe spremeniti v 1.</p></li>
<li><p>Najdite rešitev za predhodno pridobljeno diferencialno enačbo.</p></li>
<li><p>Izmislite si začetne pogoje in jih uporabite na predhodno rešeni diferencialni enačbi. Izmislite si še preostale podatke ter prikažite rezultat.</p></li>
<li><p>Določite čas, ko je zasuk <span class="math notranslate nohighlight">\(\varphi\)</span> spet enak začetnemu (če ste predpostavili začetni zasuk nič, potem torej iščete <span class="math notranslate nohighlight">\(\varphi=0\)</span>. Določite tudi čas, ko je kotna hitrost <span class="math notranslate nohighlight">\(\dot{\varphi}\)</span> enaka nič.</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<section id="sympy-mechanics">
<h3>sympy.mechanics<a class="headerlink" href="#sympy-mechanics" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sympy</span></code> ima vgrajeno podporo za klasično mehaniko (<a class="reference external" href="http://docs.sympy.org/latest/modules/physics/mechanics/index.html#classical-mechanics">dokumentacija</a>). Celovit tutorial je bil prikazan na znanstveni konferenci <a class="reference external" href="https://www.youtube.com/watch?v=r4piIKV4sDw">SciPy 2016</a>.</p>
</section>
</section>
<span id="document-notebooks/Predavanje 05 - Uvod v numerične metode in sistemi linearnih enačb 1"></span><section class="tex2jax_ignore mathjax_ignore" id="uvod-v-numericne-metode-in-sistemi-linearnih-enacb">
<h2>Uvod v numerične metode in sistemi linearnih enačb<a class="headerlink" href="#uvod-v-numericne-metode-in-sistemi-linearnih-enacb" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod-v-numericne-metode">
<h2>Uvod v numerične metode<a class="headerlink" href="#uvod-v-numericne-metode" title="Permalink to this heading">#</a></h2>
<p>Kadar želimo simulirati izbrani fizikalni proces, ponavadi postopamo takole:</p>
<ol class="arabic simple">
<li><p>postavimo matematični model*,</p></li>
<li><p>izberemo numerično metodo in njene parametre,</p></li>
<li><p>pripravimo program (pomagamo si z vgrajenimi funkcijami),</p></li>
<li><p>izvedemo izračun, rezultate analiziramo in vrednotimo.</p></li>
</ol>
<p>* Če lahko matematični model rešimo analitično, numerično reševanje ni potrebno.</p>
<p>Matematični model poskušamo rešiti analitično, saj taka rešitev ni obremenjena z napakami. Iz tega razloga se v okviru matematike učimo reševanja sistema enačb, integriranja, odvajanja in podobno. Bistvo <strong>numeričnih metod</strong> je, da matematične modele rešujemo <strong>numerično</strong>, torej na podlagi <strong>diskretnih vrednosti</strong>. Kakor bomo spoznali pozneje, nam numerični pristop v primerjavi z analitičnim omogoča reševanje bistveno obsežnejših in kompleksnejših problemov.</p>
<section id="zaokrozitvena-napaka">
<h3>Zaokrožitvena napaka<a class="headerlink" href="#zaokrozitvena-napaka" title="Permalink to this heading">#</a></h3>
<p>V nadaljevanju si bomo pogledali nekatere omejitve in izzive numeričnega pristopa. Prva omejitev je, da so v računalniku realne vrednosti vedno zapisane s končno natančnostjo. V Pythonu se števila pogosto zapišejo v dvojni natančnosti s približno 15 signifikantnimi števkami.</p>
<p>Število z dvojno natančnostjo se v Pythonu imenuje <strong>float64</strong> in je zapisano v spomin v binarni obliki v 64 bitih (11 bitov eksponent in 53 bitov mantisa (1 bit za predznak)). Ker je mantisa definirana na podlagi 52 binarnih števk, se lahko pojavi pri njegovem zapisu <em>relativna napaka</em> največ <span class="math notranslate nohighlight">\(\epsilon\approx2.2\cdot 10^{-16}\)</span>. Ta napaka se imenuje <strong>osnovna zaokrožitvena napaka</strong> in se lahko pojavi pri vsakem vmesnem
izračunu!</p>
<p>Če je korakov veliko, lahko napaka zelo naraste in zato je pomembno, da je njen vpliv na rezultat čim manjši!</p>
<p>Spodaj je primer podrobnejših informacij za tip podatkov z dvojno natančnostjo (<code class="docutils literal notranslate"><span class="pre">float</span></code>); pri tem si pomagamo z vgrajenim modulom <code class="docutils literal notranslate"><span class="pre">sys</span></code> za klic parametrov in funkcij python sistema (<a class="reference external" href="https://docs.python.org/3/library/sys.html">dokumentacija</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
<span class="mf">1e16</span><span class="o">+</span><span class="mi">2</span>
<span class="c1">#sys.float_info #preverite tudi širši izpis!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0000000000000002e+16
</pre></div>
</div>
</div>
</div>
<p>Poleg števila z dvojno natančnostjo se uporabljajo drugi tipi podatkov; dober pregled različnih tipov je prikazan v okviru <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.10.1/user/basics.types.html">numpy</a> in <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html">python</a> dokumentacije.</p>
<p>Tukaj si poglejmo primer tipa <code class="docutils literal notranslate"><span class="pre">int8</span></code>, kar pomeni celo število zapisano z 8 biti (8 bit = 1 byte). Z njim lahko v dvojiškem sistemu zapišemo cela števila od -128 do +127:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">število</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># poskušite še števila: -128 in nato 127, 128, 129. Kaj se dogaja?</span>
<span class="sa">f</span><span class="s1">&#39;Število </span><span class="si">{</span><span class="n">število</span><span class="si">}</span><span class="s1"> tipa </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">število</span><span class="p">)</span><span class="si">}</span><span class="s1"> zapisano v binari obliki:</span><span class="si">{</span><span class="n">število</span><span class="si">:</span><span class="s1">8b</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;Število 1 tipa &lt;class &#39;numpy.int8&#39;&gt; zapisano v binari obliki:       1&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="napaka-metode">
<h3>Napaka metode<a class="headerlink" href="#napaka-metode" title="Permalink to this heading">#</a></h3>
<p>Poleg zaokrožitvene napake pa se pogosto srečamo tudi z <strong>napako metode</strong> ali <strong>metodično napako</strong>, ki jo naredimo takrat, ko natančen analitični postopek reševanja matematičnega modela zamenjamo s približnim numeričnim.</p>
<p>Pomembna lastnost numeričnih algoritmov je <strong>stabilnost</strong>. To pomeni, da majhna sprememba vhodnih podatkov povzroči majhno spremembo rezultatov. Če se ob majhni spremembi na vhodu rezultati zelo spremenijo, pravimo, da je <strong>algoritem nestabilen</strong>. V praksi torej uporabljamo stabilne algoritme; bomo pa pozneje spoznali, da je stabilnost lahko pogojena tudi z vhodnimi podatki!</p>
<p>Poznamo pa tudi nestabilnost matematičnega modela/naloge/enačbe; v tem primeru govorimo o <strong>slabi pogojenosti</strong>.</p>
<p>Med izvajanjem numeričnega izračuna se napake lahko širijo. Posledično je rezultat operacije manj natančen (ima manj zanesljivih števk), kakor pa je zanesljivost podatkov izračuna.</p>
<p>Poglejmo si sedaj splošen pristop k oceni napake. Točno vrednost označimo z <span class="math notranslate nohighlight">\(r\)</span>, približek z <span class="math notranslate nohighlight">\(a_1\)</span>; velja <span class="math notranslate nohighlight">\(r=a_1+e_1\)</span>, kjer je <span class="math notranslate nohighlight">\(e_1\)</span> napaka. Če z numeričnim algoritmom  izračunamo bistveno boljši približek <span class="math notranslate nohighlight">\(a_2\)</span>, velja <span class="math notranslate nohighlight">\(r=a_2+e_2\)</span>.</p>
<p>Ker velja <span class="math notranslate nohighlight">\(a_1+e_1=a_2+e_2\)</span>, lahko ob predpostavki <span class="math notranslate nohighlight">\(\left|e_1\right|&gt;&gt;\left|e_2\right|\)</span> in <span class="math notranslate nohighlight">\(\left|e_2\right|\approx 0\)</span> izpeljemo <span class="math notranslate nohighlight">\(a_2-a_1=e_1-e_2\approx e_1\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\left|a_1-a_2\right|\)</span> je torej pesimistična ocena absolutne napake,</p>
<p><span class="math notranslate nohighlight">\(\left|\frac{a_1-a_2}{a_2}\right|\)</span> pa ocena relativne napake.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod-v-sisteme-linearnih-enacb">
<h2>Uvod v sisteme linearnih enačb<a class="headerlink" href="#uvod-v-sisteme-linearnih-enacb" title="Permalink to this heading">#</a></h2>
<p>Pod zgornjim naslovom razumemo sistem <span class="math notranslate nohighlight">\(m\)</span> linearnih enačb (<span class="math notranslate nohighlight">\(E_i, i=0, 1,\dots,m-1\)</span>) z <span class="math notranslate nohighlight">\(n\)</span> neznankami (<span class="math notranslate nohighlight">\(x_j, j=0,1,\dots,n-1\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rllllllll}
E_0: &amp; A_{0,0}\,x_0 &amp;+&amp;A_{0,1}\,x_1&amp;+&amp; \ldots &amp;+&amp;A_{0,n-1}\,x_{n-1}&amp;=&amp;b_0\\
E_1: &amp; A_{1,0}\,x_0 &amp;+&amp;A_{1,1}\,x_1&amp;+&amp; \ldots &amp;+&amp;A_{1,n-1}\,x_{n-1}&amp;=&amp;b_1\\
\vdots &amp;&amp; &amp;&amp;&amp; \vdots\\
E_{m-1}: &amp; A_{m-1,0}\,x_0&amp;+&amp;A_{m-1,1}\,x_1&amp;+&amp; \ldots &amp;+&amp;A_{m-1,n-1}\,x_{n-1}&amp;=&amp;b_{m-1}.\\
\end{array}
\end{split}\]</div>
<p>Koeficienti <span class="math notranslate nohighlight">\(A_{i,j}\)</span> in <span class="math notranslate nohighlight">\(b_i\)</span> so znana števila.</p>
<p>V kolikor je desna stran enaka nič, torej <span class="math notranslate nohighlight">\(b_i=0\)</span>, imenujemo sistem <strong>homogenem</strong>, sicer je sistem <strong>nehomogen</strong>.</p>
<p>Sistem enačb lahko zapišemo tudi v matrični obliki:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,\mathbf{x}=\mathbf{b}\]</div>
<p>kjer sta <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> znana matrika in vektor, vektor <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> pa ni znan. Matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> imenujemo <strong>matrika koeficientov</strong>, vektor <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> <strong>vektor konstant</strong> (tudi: vektor prostih členov ali vektor stolpec desnih strani) in <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> <strong>vektor neznank</strong>. Če matriki <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> dodamo kot stolpec vektor <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, dobimo t. i. <strong>razširjeno matriko</strong> in jo označimo <span class="math notranslate nohighlight">\([\mathbf{A}|\mathbf{b}]\)</span>.</p>
<p>Opomba glede zapisa:</p>
<ul class="simple">
<li><p>skalarne spremenljivke pišemo poševno, npr.: <span class="math notranslate nohighlight">\(a, A\)</span>,</p></li>
<li><p>vektorske spremenljivke pišemo z majhno črko poudarjeno, npr.: <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>,</p></li>
<li><p>matrične  spremenljivke pišemo z veliko črko poudarjeno, npr.: <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
</ul>
<section id="o-resitvi-sistema-linearnih-enacb">
<h3>O rešitvi sistema linearnih enačb<a class="headerlink" href="#o-resitvi-sistema-linearnih-enacb" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;7YbyijGUbYw&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/7YbyijGUbYw"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>Če nad sistemom linearnih enačb izvajamo <strong>elementarne operacije</strong>:</p>
<ul class="simple">
<li><p>množenje poljubne enačbe s konstanto (ki je različna od nič),</p></li>
<li><p>spreminjanje vrstnega reda enačb,</p></li>
<li><p>prištevanje ene enačbe (pomnožene s konstanto) drugi enačbi,</p></li>
</ul>
<p>rešitve sistema ne spremenimo in dobimo ekvivalentni sistem enačb.</p>
<p>S pomočjo elementarnih operacij nad vrsticami matrike <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> jo lahko preoblikujemo v t. i. <strong>vrstično kanonično obliko</strong>:</p>
<ol class="arabic simple">
<li><p>če obstajajo ničelne vrstice, so te na dnu matrike,</p></li>
<li><p>prvi neničelni element se nahaja desno od prvih neničelnih elementov predhodnih vrstic,</p></li>
<li><p>prvi neničelni element v <em>vrstici</em> imenujemo <strong>pivot</strong> in je enak 1,</p></li>
<li><p>pivot je edini neničelni element v <em>stolpcu</em>.</p></li>
</ol>
<p><strong>Rang matrike</strong> predstavlja število neničelnih vrstic v vrstični kanonični obliki matrike; število neničelnih vrstic predstavlja <strong>število linearno neodvisnih enačb in je enako številu pivotnih elementov</strong>. <strong>Rang matrike je torej enak številu linearno neodvisnih vrstic matrike</strong>. Transponiranje matrike njenega ranga ne spremeni, zato je rang matrike enak tudi številu linearno neodvisnih <em>stolpcev</em> matrike.</p>
<p>Primer preoblikovanja matrike <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#uvozimo numpy</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])
</pre></div>
</div>
</div>
</div>
<p>Očitno ima neničelni element <code class="docutils literal notranslate"><span class="pre">A[0,0]</span></code> vrednost 1 in je pivotni element. Prvo vrstico <code class="docutils literal notranslate"><span class="pre">A[0,:]</span></code> pomnožimo z <span class="math notranslate nohighlight">\(-4\)</span> in produkt prištejemo drugi vrstici <code class="docutils literal notranslate"><span class="pre">A[1,:]-4A[0,:]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2,  3],
       [ 0, -3, -6],
       [ 7,  8,  9]])
</pre></div>
</div>
</div>
</div>
<p>Podobno naredimo za tretjo vrstico:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1,   2,   3],
       [  0,  -3,  -6],
       [  0,  -6, -12]])
</pre></div>
</div>
</div>
</div>
<p>Drugo vrstico sedaj delimo z <code class="docutils literal notranslate"><span class="pre">A[1,1]</span></code>, da dobimo pivot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1,   2,   3],
       [  0,   1,   2],
       [  0,  -6, -12]])
</pre></div>
</div>
</div>
</div>
<p>Odštejemo drugo vrstico od ostalih, da dobimo v drugem stolpcu ničle povsod, razen v drugi vrstici vrednost 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="c1"># odštevanje od prve vrstice</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1,   0,  -1],
       [  0,   1,   2],
       [  0,  -6, -12]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="c1"># odštevanje od zadnje vrstice</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  0, -1],
       [ 0,  1,  2],
       [ 0,  0,  0]])
</pre></div>
</div>
</div>
</div>
<p>Imamo dve neničelni vrstici; Matrika <code class="docutils literal notranslate"><span class="pre">A</span></code> ima dva pivota in predstavlja dve linearno neodvisni enačbi. Rang matrike je 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  0, -1],
       [ 0,  1,  2],
       [ 0,  0,  0]])
</pre></div>
</div>
</div>
</div>
<p>Rang matrike pa lahko določimo tudi s pomočjo <code class="docutils literal notranslate"><span class="pre">numpy</span></code> funkcije <code class="docutils literal notranslate"><span class="pre">numpy.linalg.matrix_rank</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.matrix_rank.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer je <code class="docutils literal notranslate"><span class="pre">M</span></code> matrika, katere rang iščemo, <code class="docutils literal notranslate"><span class="pre">tol</span></code> opcijski parameter, ki določa mejo, pod katero se vrednosti v algoritmu smatrajo enake nič.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>Če velja <span class="math notranslate nohighlight">\(r=\textbf{rang}(\mathbf{A})=\textbf{rang}([\mathbf{A}|\mathbf{b}])\)</span>, potem rešitev <strong>obstaja</strong> (rečemo tudi, da je sistem <strong>konsistenten</strong>).</p>
<p>Konsistenten sistem ima:</p>
<ul class="simple">
<li><p>natanko eno rešitev, ko je število neznank <span class="math notranslate nohighlight">\(n\)</span> enako rangu <span class="math notranslate nohighlight">\(r\)</span> (rešitev je neodvisna) in</p></li>
<li><p>neskončno mnogo rešitev, ko je rang <span class="math notranslate nohighlight">\(r\)</span> manjši od števila neznank <span class="math notranslate nohighlight">\(n\)</span> (rešitev je odvisna od <span class="math notranslate nohighlight">\(n-r\)</span> parametrov).</p></li>
</ul>
<p>Najprej se bomo omejili na sistem <span class="math notranslate nohighlight">\(m=n\)</span> linearnih enačb z <span class="math notranslate nohighlight">\(n\)</span> neznankami ter velja <span class="math notranslate nohighlight">\(n=r\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,\mathbf{x}=\mathbf{b}.\]</div>
<p>Pod zgornjimi pogoji je matrika koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> nesingularna (<span class="math notranslate nohighlight">\(|\mathbf{A}|\neq 0\)</span>) in sistem ima rešitev:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}=\mathbf{A^{-1}}\,\mathbf{b}.\]</div>
<p>Poglejmo si primer sistema, ko so <strong>enačbe linearno odvisne</strong> (<span class="math notranslate nohighlight">\(r&lt;n\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 2, 1],
       [2, 4, 2]])
</pre></div>
</div>
</div>
</div>
<p>S pomočjo <code class="docutils literal notranslate"><span class="pre">numpy</span></code> knjižnice poglejmo sedaj rang matrike koeficientov in razširjene matrike ter determinanto z uporabo <code class="docutils literal notranslate"><span class="pre">numpy.linalg.det</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.det.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">det</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer je <code class="docutils literal notranslate"><span class="pre">a</span></code> matrika (ali seznam matrik), katere determinanto iščemo; funkcija <code class="docutils literal notranslate"><span class="pre">det</span></code> vrne determinanto (ali seznam determinant).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;rang(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">, rang(Ab)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="se">\</span>
<span class="s1">število neznank: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s1">, det(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;rang(A)=1, rang(Ab)=1, število neznank: 2, det(A)=0.0&#39;
</pre></div>
</div>
</div>
</div>
<p>Poglejmo še primer, ko <strong>rešitve sploh ni</strong> (nekonsistenten sistem):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 2, 1],
       [2, 4, 1]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;rang(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">, rang(Ab)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="se">\</span>
<span class="s1">število neznank: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s1">, det(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;rang(A)=1, rang(Ab)=2, število neznank: 2, det(A)=0.0&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="norma-in-pogojenost-sistemov-enacb">
<h3>Norma in pogojenost sistemov enačb<a class="headerlink" href="#norma-in-pogojenost-sistemov-enacb" title="Permalink to this heading">#</a></h3>
<p>Numerična naloga je slabo pogojena, če majhna sprememba podatkov povzroči veliko spremembo rezultata. V primeru <em>majhne spremembe podatkov</em>, ki povzročijo <em>majhno spremembo rezultatov</em>, pa je naloga <strong>dobro pogojena</strong>.</p>
<p>Sistem enačb je ponavadi dobro pogojen, če so absolutne vrednosti diagonalnih elementov matrike koeficientov velike v primerjavi z absolutnimi vrednostmi izven diagonalnih elementov.</p>
<p>Za sistem linearnih enačb <span class="math notranslate nohighlight">\(\mathbf{A}\,\mathbf{x}=\mathbf{b}\)</span> lahko računamo <strong>število pogojenosti</strong> (<em>angl.</em> condition number):</p>
<div class="math notranslate nohighlight">
\[\textrm{cond}(\textbf{A})=||\textbf{A}||\,||\textbf{A}^{-1}||.\]</div>
<p>Z <span class="math notranslate nohighlight">\(||\textbf{A}||\)</span> je označena <strong>norma</strong> matrike.</p>
<p>Obstaja več načinov računanja norme; navedimo dve:</p>
<ul class="simple">
<li><p>Evklidska norma (tudi Frobeniusova):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[||\textbf{A}||_e=\sqrt{\sum_{i=1}^n\sum_{j=1}^nA_{ij}^2}\]</div>
<ul class="simple">
<li><p>Norma vsote vrstic ali tudi neskončna norma:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[||\textbf{A}||_{\infty}=\max_{1\le i\le n}\sum_{j=1}^n |A_{ij}|\]</div>
<p>Pogojenost računamo z vgrajeno funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.linalg.cond</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.cond.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>ki sprejme dva parametra: matriko <code class="docutils literal notranslate"><span class="pre">x</span></code> in opcijski tip norme <code class="docutils literal notranslate"><span class="pre">p</span></code> (privzeti tip je <code class="docutils literal notranslate"><span class="pre">None</span></code>; v tem primeru se uporabi Evklidska/Frobeniusova norma).</p>
<p>Če je število pogojenosti majhno, potem je matrika dobro pogojena in obratno - pri slabi pogojenosti se število pogojenosti zelo poveča.</p>
<p>Žal je izračun pogojenosti matrike numerično relativno zahteven.</p>
<section id="primer-slabo-pogojene-matrike">
<h4>Primer slabo pogojene matrike<a class="headerlink" href="#primer-slabo-pogojene-matrike" title="Permalink to this heading">#</a></h4>
<p>Pogledali si bomo slabo pogojen sistem, kjer bomo z malenkostno spremembo na matriki koeficientov povzročili veliko spremembo rešitve.</p>
<p>Matrika koeficientov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.00001</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>400002.00000320596
</pre></div>
</div>
</div>
</div>
<p>Vektor konstant:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.     ,  1.     ,  3.     ],
       [ 1.     ,  1.00001, -3.     ]])
</pre></div>
</div>
</div>
</div>
<p>Preverimo rang in determinanto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;rang(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">, rang(Ab)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="se">\</span>
<span class="s1">število neznank: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s1">, det(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;rang(A)=2, rang(Ab)=2, število neznank: 2, det(A)=1.000000000006551e-05&#39;
</pre></div>
</div>
</div>
</div>
<p>Od druge enačbe odštejemo prvo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.e+00,  1.e+00,  3.e+00],
       [ 0.e+00,  1.e-05, -6.e+00]])
</pre></div>
</div>
</div>
</div>
<p>Določimo <code class="docutils literal notranslate"><span class="pre">x1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-599999.9999960692
</pre></div>
</div>
</div>
</div>
<p>Preostane še določitev <code class="docutils literal notranslate"><span class="pre">x0</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>600002.9999960692
</pre></div>
</div>
</div>
</div>
<p>Malenkostno spremenimo matriko koeficientov in ponovimo reševanje:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0001</span><span class="p">]])</span> <span class="c1"># &lt;= tukaj smo spremenili 1.00001 na 1.0001</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40002.000074915224
</pre></div>
</div>
</div>
</div>
<p>Ponovimo izračun:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="sa">f</span><span class="s1">&#39;rang(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">, rang(Ab)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="se">\</span>
<span class="s1">število neznank: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s1">, det(A)=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">x1_</span> <span class="o">=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x0_</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Primerjamo obe rešitvi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">]</span> <span class="c1"># prva rešitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[600002.9999960692, -599999.9999960692]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x0_</span><span class="p">,</span> <span class="n">x1_</span><span class="p">]</span> <span class="c1"># druga rešitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[600002.9999960692, -60000.00000000661]
</pre></div>
</div>
</div>
</div>
<p>Ugotovimo, da je malenkostna sprememba enega koeficienta v matriki koeficientov povzročila veliko spremembo v rezultatu. Majhni spremembi podatkov se ne moremo izogniti, zaradi zapisa podatkov v računalniku.</p>
</section>
</section>
<section id="numericno-resevanje-sistemov-linearnih-enacb">
<h3>Numerično reševanje sistemov linearnih enačb<a class="headerlink" href="#numericno-resevanje-sistemov-linearnih-enacb" title="Permalink to this heading">#</a></h3>
<p>Pogledali si bomo dva, v principu različna pristopa k reševanju sistemov linearnih enačb:</p>
<p>A) <strong>Direktni pristop</strong>: nad sistemom enačb izvajamo elementarne operacije, s katerimi predelamo sistem enačb v lažje rešljivega,</p>
<p>B) <strong>Iterativni pristop</strong>: izberemo začetni približek, nato pa približek iterativno izboljšujemo.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="gaussova-eliminacija">
<h2>Gaussova eliminacija<a class="headerlink" href="#gaussova-eliminacija" title="Permalink to this heading">#</a></h2>
<p>Predpostavimo, da rešujemo sistem <span class="math notranslate nohighlight">\(n\)</span> enačb za <span class="math notranslate nohighlight">\(n\)</span> neznank, ki ima rang <span class="math notranslate nohighlight">\(n\)</span>. Tak sistem je enolično rešljiv.</p>
<p>Gaussova eliminacija spada med direktne metode, saj s pomočjo elementarnih vrstičnih operacij sistem enačb prevedemo v zgornje poravnani trikotni sistem (pod glavno diagonalo v razširjeni matriki so vrednosti nič).</p>
<p>Najprej pripravimo razširjeno matriko koeficientov:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
\mathbf{A}|\mathbf{b}
\end{bmatrix}=
\left[\begin{array}{cccc|c}
A_{0,0}&amp;A_{0,1}&amp;\cdots &amp; A_{0,n-1} &amp; b_0\\
A_{1,0}&amp;A_{1,1}&amp;\cdots &amp; A_{1,n-1} &amp; b_1\\
\vdots&amp;\vdots&amp;\ddots &amp; \vdots &amp; \vdots\\
A_{n-1,0}&amp;A_{n-1,1}&amp;\cdots &amp; A_{n-1,n-1} &amp; b_{n-1}\\
\end{array}\right]
\end{split}\]</div>
<p>Gaussovo eliminacijo si bomo pogledali na zgledu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">8.</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.,  -6.,   3., -14.],
       [ -6.,   6.,  -6.,  36.],
       [  3.,  -6.,   6.,   6.]])
</pre></div>
</div>
</div>
</div>
<p>Korak 0: prvo vrstico pomnožimo z <code class="docutils literal notranslate"><span class="pre">Ab[1,0]/Ab[0,0]=-6/8</span></code> in odštejemo od druge:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.  ,  -6.  ,   3.  , -14.  ],
       [  0.  ,   1.5 ,  -3.75,  25.5 ],
       [  3.  ,  -6.  ,   6.  ,   6.  ]])
</pre></div>
</div>
</div>
</div>
<p>Nato prvo vrstico pomnožimo z <code class="docutils literal notranslate"><span class="pre">Ab[2,0]/Ab[0,0]=3/8</span></code> in odštejemo od tretje:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.   ,  -6.   ,   3.   , -14.   ],
       [  0.   ,   1.5  ,  -3.75 ,  25.5  ],
       [  0.   ,  -3.75 ,   4.875,  11.25 ]])
</pre></div>
</div>
</div>
</div>
<p>Korak 1: drugo vrstico pomnožimo z <code class="docutils literal notranslate"><span class="pre">Ab[2,1]/Ab[1,1]=-3.75/1.5</span></code> in odštejemo od tretje:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.  ,  -6.  ,   3.  , -14.  ],
       [  0.  ,   1.5 ,  -3.75,  25.5 ],
       [  0.  ,   0.  ,  -4.5 ,  75.  ]])
</pre></div>
</div>
</div>
</div>
<p>S pomočjo pripravljenega modula <code class="docutils literal notranslate"><span class="pre">moduli/gauss_prikaz.py</span></code> lahko postopek tudi animiramo:
<img src="./fig/gauss_eliminacija.gif" width=350></p>
<p>Dobili smo zgornje trikotno matriko in Gaussova eliminacija je končana. Lahko izračunamo rešitev, torej določimo vektor neznank <span class="math notranslate nohighlight">\(x\)</span> z <strong>obratnim vstavljanjem</strong>.</p>
<p>Iz zadnje vrstice zgornje trikotne matrike izračunamo <span class="math notranslate nohighlight">\(x_2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.  ,  -6.  ,   3.  , -14.  ],
       [  0.  ,   1.5 ,  -3.75,  25.5 ],
       [  0.  ,   0.  ,  -4.5 ,  75.  ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#pripravimo prazen seznam</span>
<span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">Ab</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0.        ,   0.        , -16.66666667])
</pre></div>
</div>
</div>
</div>
<p>S pomočjo predzadnje vrstice izračunamo <span class="math notranslate nohighlight">\(x_1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.  ,  -6.  ,   3.  , -14.  ],
       [  0.  ,   1.5 ,  -3.75,  25.5 ],
       [  0.  ,   0.  ,  -4.5 ,  75.  ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0.        , -24.66666667, -16.66666667])
</pre></div>
</div>
</div>
</div>
<p>S pomočjo prve vrstice nato izračunamo <span class="math notranslate nohighlight">\(x_0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.  ,  -6.  ,   3.  , -14.  ],
       [  0.  ,   1.5 ,  -3.75,  25.5 ],
       [  0.  ,   0.  ,  -4.5 ,  75.  ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="nd">@x</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14.        , -24.66666667, -16.66666667])
</pre></div>
</div>
</div>
</div>
<p>Preverimo rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-3.55271368e-15,  7.10542736e-15,  7.10542736e-15])
</pre></div>
</div>
</div>
</div>
<section id="povzetek-gaussove-eliminacije">
<h3>Povzetek Gaussove eliminacije<a class="headerlink" href="#povzetek-gaussove-eliminacije" title="Permalink to this heading">#</a></h3>
<p>V modul <code class="docutils literal notranslate"><span class="pre">orodja.py</span></code> shranimo funkciji:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gaussova_eliminacija</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">prikazi_korake</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">pivot_vrsta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Ab</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">vrsta</span> <span class="ow">in</span> <span class="n">Ab</span><span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>
                <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span><span class="o">*</span><span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">/</span><span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Deljenje z 0.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prikazi_korake</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Korak: </span><span class="si">{:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Ab</span>

<span class="k">def</span> <span class="nf">gaussova_el_resitev</span><span class="p">(</span><span class="n">Ub</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ub</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">pivot_vrsta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Ub</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pivot_vrsta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="n">p</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">x</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="n">p</span><span class="p">:]</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p>Algoritem, s katerim iz zgornje trikotnega sistema enačb <span class="math notranslate nohighlight">\(\mathbf{U}\,\mathbf{x}=\mathbf{b}\)</span> izračunamo rešitev, imenujemo <strong>obratno vstavljanje</strong> (angl. <em>back substitution</em>); <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> je zgornje trikotna matrika.</p>
<p>V kolikor bi reševali sistem <span class="math notranslate nohighlight">\(\mathbf{L}\,\mathbf{x}=\mathbf{b}\)</span> in je <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> spodnje trikotna matrika, bi to metodo imenovali <strong>direktno vstavljanje</strong> (angl. <em>forward substitution</em>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ub</span> <span class="o">=</span> <span class="n">gaussova_eliminacija</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">prikazi_korake</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Ub</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.  ,  -6.  ,   3.  , -14.  ],
       [  0.  ,   1.5 ,  -3.75,  25.5 ],
       [  0.  ,   0.  ,  -4.5 ,  75.  ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaussova_el_resitev</span><span class="p">(</span><span class="n">Ub</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14.        , -24.66666667, -16.66666667])
</pre></div>
</div>
</div>
</div>
</section>
<section id="numericna-zahtevnost">
<h3>Numerična zahtevnost<a class="headerlink" href="#numericna-zahtevnost" title="Permalink to this heading">#</a></h3>
<p>Numerično zahtevnost ocenjujemo po številu matematičnih operacij, ki so potrebne za izračun.
Za rešitev <span class="math notranslate nohighlight">\(n\)</span> linearnih enačb tako z Gaussovo eliminacijo potrebujemo približno <span class="math notranslate nohighlight">\(n^3/3\)</span> matematičnih operacij. Za določitev neznank <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> potrebujemo še dodatnih približno <span class="math notranslate nohighlight">\(n^2\)</span> operacij.</p>
<p>Pri Gaussovi eliminaciji smo eliminacijo izvedli samo za člene pod diagonalo; če bi z eliminacijo nadaljevali in jo izvedli tudi za člene nad diagonalo, bi izvedli t. i. <em>Gauss-Jordanovo</em> eliminacijo, za katero pa potrebujemo dodatnih približno <span class="math notranslate nohighlight">\(n^3/3\)</span> operacij* (kar se šteje kot glavna slabost te metode).</p>
<p>* Nekaj komentarjev na temo števila numeričnih operacij najdete tukaj: <a class="reference external" href="http://pinm.ladisk.si/303/kako-dolo%C4%8Damo-numeri%C4%8Dno-zahtevnost-algoritmov">pinm.ladisk.si</a>.</p>
</section>
<section id="uporaba-knjiznjice-numpy">
<h3>Uporaba knjižnjice <code class="docutils literal notranslate"><span class="pre">numpy</span></code><a class="headerlink" href="#uporaba-knjiznjice-numpy" title="Permalink to this heading">#</a></h3>
<p>Reševanje sistema linearnih enačb z <code class="docutils literal notranslate"><span class="pre">numpy.linalg.solve</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.solve.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer je <code class="docutils literal notranslate"><span class="pre">a</span></code> matrika koeficientov (ali seznam matrik) in je <code class="docutils literal notranslate"><span class="pre">b</span></code> vektor konstant (ali seznam vektorjev). Funkcija vrne vektor (ali seznam vektorjev) rešitev.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14.        , -24.66666667, -16.66666667])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic">
<li><p>Za sistem enačb:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \mathbf{A}=
    \begin{bmatrix}
    1 &amp; -4 &amp; 1\\
    1 &amp; 6 &amp; -1\\
    2 &amp; -1 &amp; 2
    \end{bmatrix}
    \qquad
    \mathbf{b}=
    \begin{bmatrix}
    7\\
    13\\
    5
    \end{bmatrix}
    \end{split}\]</div>
<p>najdite rešitev s pomočjo <code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code>.</p>
</li>
<li><p>Za zgoraj definirano matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> določite Evklidsko normo (lastni program).</p></li>
<li><p>Za zgoraj definirano matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> določite neskončno normo (lastni program).</p></li>
<li><p>Za zgoraj definirano matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> določite pogojenost (<code class="docutils literal notranslate"><span class="pre">numpy</span></code> funkcija).</p></li>
<li><p>Definirajte funkcijo <code class="docutils literal notranslate"><span class="pre">gauss_elim</span></code>, ki za poljubno matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> in vektor <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> izvede Gaussovo eliminacijo (posebej za matriko in posebej za vektor tako, da ne sestavite razširjene matrike <span class="math notranslate nohighlight">\([\mathbf{A}|\mathbf{b}]\)</span>).</p></li>
<li><p>Definirajte funkcijo <code class="docutils literal notranslate"><span class="pre">gauss_elim_x</span></code>, ki za razultat funkcije <code class="docutils literal notranslate"><span class="pre">gauss_elim</span></code> najde ustrezne vrednosti vektorja <span class="math notranslate nohighlight">\(\textbf{x}\)</span>.</p></li>
<li><p>Zgornji funkciji dopolnite s štetjem matematičnih operacij.</p></li>
<li><p>Na sliki je prikazan sistem mas:</p>
 <img width=600 src="./fig/mase_na_klancu.png">
<p>Predpostavite, da se sistem zaradi teže giblje po klancu navzdol z neznanim pospeškom <span class="math notranslate nohighlight">\(a\)</span> in da so vrvi napete z neznanimi silami <span class="math notranslate nohighlight">\(F_i\)</span>. Znane veličine so (sami jih določite): posamično telo ima maso <span class="math notranslate nohighlight">\(m_i\)</span>, koeficient trenja s podlago <span class="math notranslate nohighlight">\(\mu_i=1\)</span>, <span class="math notranslate nohighlight">\(g=9,81\)</span>m/s<span class="math notranslate nohighlight">\(^2\)</span>, <span class="math notranslate nohighlight">\(\varphi=55^{\circ}\)</span>.
Določite sistem enačb v primeru dveh teles. Določite matriko koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> in vektorja <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> ter <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
</li>
<li><p>Za zgoraj definiran sistem mas predpostavite, da je mas 4 (ali več) ter določite matriko koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, in vektorja <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> ter <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>. Rešite sistem s pomočjo Gaussove elimnacije/LU razcepa ali <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code>. Preverite pogojenost!</p></li>
<li><p>V sistemu mas dobimo fizikalno nekonsistentno rešitev, če imamo v kateri od vrvi tlačno silo (vrv ne prenese tlačne sile). Preverite, ali je to v vašem primeru res. Ustrezno spremenite koeficient(e) trenja, da se bo to zgodilo.</p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<p>Poglejte si strani:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.micropython.org">micropython.org</a></p></li>
<li><p><a class="reference external" href="http://www.kivy.org">kivy.org</a></p></li>
<li><p><a class="reference external" href="http://www.openmodal.com">openmodal.com</a></p></li>
</ul>
<section id="primer-simbolnega-resevanja-sistema-linearnih-enacb-v-okviru-sympy">
<h3>Primer simbolnega reševanja sistema linearnih enačb v okviru <code class="docutils literal notranslate"><span class="pre">sympy</span></code><a class="headerlink" href="#primer-simbolnega-resevanja-sistema-linearnih-enacb-v-okviru-sympy" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A11</span><span class="p">,</span> <span class="n">A12</span><span class="p">,</span> <span class="n">A21</span><span class="p">,</span> <span class="n">A22</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;A11, A12, A21, A22&#39;</span><span class="p">)</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x1, x2&#39;</span><span class="p">)</span>
<span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;b1, b2&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">A11</span><span class="p">,</span> <span class="n">A12</span><span class="p">],</span>
                <span class="p">[</span><span class="n">A21</span><span class="p">,</span> <span class="n">A22</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x1</span><span class="p">],</span>
                <span class="p">[</span><span class="n">x2</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">b1</span><span class="p">],</span>
                <span class="p">[</span><span class="n">b2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c880fc58128aa12d44de92f93f0ee0e87bc55f3b4c4c7ce2621111efa3892d90.png" src="_images/c880fc58128aa12d44de92f93f0ee0e87bc55f3b4c4c7ce2621111efa3892d90.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">resitev</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eq</span><span class="p">,[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
<span class="n">resitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8691cd8a1c5dbb708b970862f7b907137506c053e5284fdb09b7f772288afac8.png" src="_images/8691cd8a1c5dbb708b970862f7b907137506c053e5284fdb09b7f772288afac8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/55ed0b3a79041ba38e7ac73d405528030a86ff252e25184fd90128b60a5eade0.png" src="_images/55ed0b3a79041ba38e7ac73d405528030a86ff252e25184fd90128b60a5eade0.png" />
</div>
</div>
</section>
</section>
<span id="document-notebooks/Predavanje 06 - Sistemi linearnih enačb 2"></span><section class="tex2jax_ignore mathjax_ignore" id="sistemi-linearnih-enacb-nadaljevanje">
<h2>Sistemi linearnih enačb - nadaljevanje<a class="headerlink" href="#sistemi-linearnih-enacb-nadaljevanje" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="razcep-lu">
<h2>Razcep LU<a class="headerlink" href="#razcep-lu" title="Permalink to this heading">#</a></h2>
<p>Za rešitev sistema linearnih enačb zahteva Gaussov eliminacijski postopek najmanjše število računskih operacij.</p>
<p>V primeru, ko se matrika koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> ne spreminja in se spreminja zgolj vektor konstant <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, se je mogoče izogniti ponovni Gaussovi eliminaciji matrike koeficientov. Z razcepom matrike <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> lahko pridemo do rešitve z manj računskimi operacijami. V ta namen si bomo pogledali razcep LU!</p>
<p>Poljubno matriko lahko zapišemo kot produkt dveh matrik:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}=\mathbf{B}\,\mathbf{C}.
\]</div>
<p>Pri tem je možnosti za zapis matrik <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> neskončno veliko.</p>
<p>Pri razcepu LU zahtevamo, da je matrika <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> spodnje trikotna in matrika <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> zgornje trikotna:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}=\mathbf{L}\,\mathbf{U}.
\]</div>
<p>Vsaka od matrik <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> ima <span class="math notranslate nohighlight">\((n+1)\,n/2\)</span> neničelnih elementov; skupaj torej <span class="math notranslate nohighlight">\(n^2+n\)</span> neznank. Znana matrika <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> definira <span class="math notranslate nohighlight">\(n^2\)</span> vrednosti. Za enolično določitev matrik <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> torej manjka
<span class="math notranslate nohighlight">\(n\)</span> enačb. Tukaj bomo uporabili razcep LU, ki dodatne enačbe pridobi s pogojem <span class="math notranslate nohighlight">\(L_{ii}=1\)</span>, <span class="math notranslate nohighlight">\(i=0, 1,\dots,n-1\)</span>.</p>
<p>Sistem linearnih enačb:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}\mathbf{x}=\mathbf{b}
\]</div>
<p>torej zapišemo z razcepom matrike <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{L}\,\underbrace{\mathbf{U}\,\mathbf{x}}_{\mathbf{y}}=\mathbf{b}.
\]</div>
<p>Do rešitve sistema <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span> sedaj pridemo tako, da rešimo dva trikotna sistema enačb.</p>
<p>Najprej izračunamo vektor <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{L}\,\mathbf{y}=\mathbf{b}.\qquad \textrm{(direktno vstavljanje)}
\]</div>
<p>Ko je <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> izračunan, lahko iz:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{U}\,\mathbf{x}=\mathbf{y}\qquad \textrm{(obratno vstavljanje)}
\]</div>
<p>določimo <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<section id="razcep-lu-matrike-koeficientov-mathbf-a">
<h3>Razcep LU matrike koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span><a class="headerlink" href="#razcep-lu-matrike-koeficientov-mathbf-a" title="Permalink to this heading">#</a></h3>
<p>V nadaljevanju bomo pokazali, da Gaussova eliminacija dejanjsko predstavlja razcep LU matrike koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. Pri tem si bomo pomagali s simbolnim izračunom, zato uvozimo paket <code class="docutils literal notranslate"><span class="pre">sympy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span> <span class="c1"># uvozimo sympy</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span> <span class="c1"># za lep prikaz izrazov</span>
</pre></div>
</div>
</div>
</div>
<p>Prikaz začnimo na primeru simbolno zapisanih matrik <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> dimenzije <span class="math notranslate nohighlight">\(3\times 3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L21</span><span class="p">,</span> <span class="n">L31</span><span class="p">,</span> <span class="n">L32</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;L21, L31, L32&#39;</span><span class="p">)</span>
<span class="n">U11</span><span class="p">,</span> <span class="n">U12</span><span class="p">,</span> <span class="n">U13</span><span class="p">,</span> <span class="n">U22</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span> <span class="n">U33</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;U11, U12, U13, U22, U23, U33&#39;</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="n">L21</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="n">L31</span><span class="p">,</span> <span class="n">L32</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]])</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">U11</span><span class="p">,</span> <span class="n">U12</span><span class="p">,</span> <span class="n">U13</span><span class="p">],</span>
                <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">U22</span><span class="p">,</span> <span class="n">U23</span><span class="p">],</span>
                <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="n">U33</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>Matrika koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> zapisana z elementi matrik <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> in  <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> torej je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="n">U</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bc971e7cf5c879023ce39f03407472ce496a599e4a4b1ebb117a197fc8f0f436.png" src="_images/bc971e7cf5c879023ce39f03407472ce496a599e4a4b1ebb117a197fc8f0f436.png" />
</div>
</div>
<p>Izvedimo sedaj Gaussovo eliminacijo nad matriko koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p>
<p>S pomočjo prve vrstice izvedemo Gaussovo eliminacijo v prvem stolpcu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">L21</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">L31</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bb8638f4e4b255559b796677a987a1c09087c46214170ca6dfdecd8ec0ab26ea.png" src="_images/bb8638f4e4b255559b796677a987a1c09087c46214170ca6dfdecd8ec0ab26ea.png" />
</div>
</div>
<p>Nadaljujemo v drugem stolpcu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">-=</span> <span class="n">L32</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/df7c805565cd549ccef55b3315fd8a9ac73eb7a438da134d1aa0042af3850e20.png" src="_images/df7c805565cd549ccef55b3315fd8a9ac73eb7a438da134d1aa0042af3850e20.png" />
</div>
</div>
<p>Iz zgornje eliminacije ugotovimo:</p>
<ol class="arabic simple">
<li><p>matrika <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> je enaka matriki, ki jo dobimo, če izvedemo Gaussovo eliminacijo nad matriko koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
</ol>
<ul class="simple">
<li><p>izven diagonalni členi <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> so faktorji, ki smo jih uporabili pri Gaussovi eliminaciji.</p></li>
</ul>
</section>
<section id="numericna-implementacija-razcepa-lu">
<h3>Numerična implementacija razcepa LU<a class="headerlink" href="#numericna-implementacija-razcepa-lu" title="Permalink to this heading">#</a></h3>
<p>Numerično implementacijo si bomo pogledali na sistemu, ki je definiran kot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> 
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izvedimo Gaussovo eliminacijo in koeficiente, s katerim množimo pivotno vrsto <code class="docutils literal notranslate"><span class="pre">m</span></code>, shranimo v matriko <code class="docutils literal notranslate"><span class="pre">L</span></code> na mesto z indeksi, kot jih ima v matriki <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> eliminirani element.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># v=število vrstic, s=število stolpcev</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>     <span class="c1"># pripravimo matriko U kot kopijo A</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="c1"># pripravimo matriko L dimenzije enake A (vrednosti 0)</span>
<span class="c1"># eliminacija</span>
<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">pivot_vrsta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">U</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vrsta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">if</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">/</span><span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
            <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span> <span class="o">=</span> <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span><span class="o">-</span><span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span><span class="o">*</span><span class="n">m</span>
            <span class="n">L</span><span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Korak: </span><span class="si">{:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Korak: 0
[[ 8.    -6.     3.   ]
 [ 0.     1.5   -3.75 ]
 [ 0.    -3.75   4.875]]
Korak: 1
[[ 8.   -6.    3.  ]
 [ 0.    1.5  -3.75]
 [ 0.    0.   -4.5 ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.   ,  0.   ,  0.   ],
       [-0.75 ,  0.   ,  0.   ],
       [ 0.375, -2.5  ,  0.   ]])
</pre></div>
</div>
</div>
</div>
<p>Dopolnimo diagonalo <span class="math notranslate nohighlight">\(\mathbf{L}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.   ,  0.   ,  0.   ],
       [-0.75 ,  1.   ,  0.   ],
       [ 0.375, -2.5  ,  1.   ]])
</pre></div>
</div>
</div>
</div>
<p>Sedaj rešimo spodnje trikotni sistem enačb <span class="math notranslate nohighlight">\(\mathbf{L}\,\mathbf{y}=\mathbf{b}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># direktno vstavljanje</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="n">i</span><span class="p">]))</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14. ,  25.5,  75. ])
</pre></div>
</div>
</div>
</div>
<p>Nadaljujemo z reševanjem zgornje trikotnega sistema <span class="math notranslate nohighlight">\(\mathbf{U}\,\mathbf{x}=\mathbf{y}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8.  , -6.  ,  3.  ],
       [ 0.  ,  1.5 , -3.75],
       [ 0.  ,  0.  , -4.5 ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14. ,  25.5,  75. ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># obratno vstavljanje</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]))</span> <span class="o">/</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14.        , -24.66666667, -16.66666667])
</pre></div>
</div>
</div>
</div>
<p>Kakor smo navedli zgoraj, ob spremembi vektorja konstant <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> ponovna Gaussova eliminacija ni potrebna. Izvesti je treba samo direktno in nato obratno vstavljanje. Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b</span><span class="p">):</span><span class="c1">#direktno vstavljanje</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="n">i</span><span class="p">]))</span>    
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span><span class="c1"># obratno vstavljanje</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]))</span> <span class="o">/</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-4.33333333, -7.88888889, -4.55555556])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-1.,  6.,  7.])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pivotiranje">
<h2>Pivotiranje<a class="headerlink" href="#pivotiranje" title="Permalink to this heading">#</a></h2>
<p>Poglejmo si spodnji sistem enačb:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># poskusite tukaj izpustiti dtype=float in preveriet rezultat</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Če bi izvedli Gaussovo eliminacijo v prvem stolpcu matrike <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\janko\AppData\Local\Temp\ipykernel_18732\3999418912.py:1: RuntimeWarning: divide by zero encountered in scalar divide
  A[1,:] - A[1,0]/A[0,0] * A[0,:]
C:\Users\janko\AppData\Local\Temp\ipykernel_18732\3999418912.py:1: RuntimeWarning: invalid value encountered in multiply
  A[1,:] - A[1,0]/A[0,0] * A[0,:]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ nan, -inf,  inf])
</pre></div>
</div>
</div>
</div>
<p>Opazimo, da imamo težavo z deljenjem z 0 v prvi vrstici. Elementarne operacije, ki jih nad sistemom lahko izvajamo, dovoljujejo zamenjavo poljubnih vrstic. Sistem lahko preuredimo tako, da pivotni element ni enak 0. Vseeno se lahko zgodi, da ima pivotni element, s katerim delimo, zelo majhno vrednost <span class="math notranslate nohighlight">\(\varepsilon\)</span>. Ker bi to povečevalo zaokrožitveno napako, izmed vseh vrstic za pivotno vrstico izberemo tisto, katere pivot ima največjo absolutno vrednost.</p>
<p>Če med Gaussovo eliminacijo zamenjamo vrstice tako, da je pivotni element največji, to imenujemo <strong>pivotiranje vrstic</strong> ali tudi <strong>delno pivotiranje</strong>. Tako dosežemo, da je Gaussova eliminacija numerično stabilna.</p>
<p>Pokazati je mogoče, da pri reševanju sistema enačb <span class="math notranslate nohighlight">\(\mathbf{A}\,\mathbf{x}=\mathbf{b}\)</span>, pri katerem je matrika <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> diagonalno dominantna, pivotiranje po vrsticah ni potrebno. Reševanje je brez pivotiranja numerično stabilno.</p>
<p>Pravokotna matrika <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> dimenzije <span class="math notranslate nohighlight">\(n\)</span> je <strong>diagonalno dominantna</strong>, če je absolutna vrednost diagonalnega elementa vsake vrstice večja od vsote absolutnih vrednosti ostalih elementov v vrstici:</p>
<div class="math notranslate nohighlight">
\[
\left|A_{ii}\right|&gt; \sum_{j=1, j\ne i}^n \left|A_{ij}\right|
\]</div>
<section id="gaussova-eliminacija-z-delnim-pivotiranjem">
<h3>Gaussova eliminacija z delnim pivotiranjem<a class="headerlink" href="#gaussova-eliminacija-z-delnim-pivotiranjem" title="Permalink to this heading">#</a></h3>
<p>Pogledali si bomo Gaussovo eliminacijo z <strong>delnim pivotiranjem</strong>. Brez delnega pivotiranja v <span class="math notranslate nohighlight">\(i\)</span>-tem koraku eliminacije izberemo vrstico <span class="math notranslate nohighlight">\(i\)</span> za pivotiranje. Pri delnem pivotiranju pa najprej preverimo, ali je <span class="math notranslate nohighlight">\(i\)</span>-ti diagonalni element po absolutni vrednosti največji element v stolpcu <span class="math notranslate nohighlight">\(i\)</span> na ali pod diagonalo; če ni, zamenjamo vrstico <span class="math notranslate nohighlight">\(i\)</span> s
tisto vrstico pod njo, v kateri je v stolpcu <span class="math notranslate nohighlight">\(i\)</span> po absolutni vrednosti največji element. Z delnim pivotiranjem zmanjšamo vpliv zaokrožitvene napake na rezultat.</p>
<p>V koliko bi izvedli <strong>polno pivotiranje</strong>, bi poleg zamenjave vrstic uporabili tudi zamenjavo vrstnega reda spremenljivk (zamenjava stolpcev). Polno pivotiranje izboljša stabilnost, se pa redko uporablja in ga tukaj ne bomo obravnavali.</p>
<p>Algoritem za Gaussovo eliminacijo z delnim pivotiranjem torej je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gaussova_eliminacija_pivotiranje</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">prikazi_korake</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne Gaussovo eliminacijo razširjene matrike koeficientov, </span>
<span class="sd">    uporabi delno pivotiranje.</span>

<span class="sd">    :param A: matrika koeficientov</span>
<span class="sd">    :param b: vektor konstant</span>
<span class="sd">    :param prikazi_korake: ali izpišem posamezne korake</span>
<span class="sd">    :return Ab: trapezna razširjena matrika koeficientov</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">p_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ab</span><span class="p">[</span><span class="n">p</span><span class="p">:,</span><span class="n">p</span><span class="p">]))</span><span class="o">+</span><span class="n">p</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">p_max</span><span class="p">:</span>
            <span class="n">Ab</span><span class="p">[[</span><span class="n">p</span><span class="p">],</span> <span class="p">:],</span> <span class="n">Ab</span><span class="p">[[</span><span class="n">p_max</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Ab</span><span class="p">[[</span><span class="n">p_max</span><span class="p">],</span> <span class="p">:],</span> <span class="n">Ab</span><span class="p">[[</span><span class="n">p</span><span class="p">],</span> <span class="p">:]</span>
        <span class="n">pivot_vrsta</span> <span class="o">=</span> <span class="n">Ab</span><span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="p">:]</span>                
        <span class="k">for</span> <span class="n">vrsta</span> <span class="ow">in</span> <span class="n">Ab</span><span class="p">[</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>
                <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span> <span class="o">*</span> <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">/</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">prikazi_korake</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Korak: </span><span class="si">{:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pivot vrsta:&#39;</span><span class="p">,</span> <span class="n">pivot_vrsta</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Ab</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0., -6.,  6.],
       [-6.,  6., -6.],
       [ 8., -6.,  3.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span> <span class="o">=</span> <span class="n">gaussova_eliminacija_pivotiranje</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">prikazi_korake</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Korak: 0
Pivot vrsta: [  8.  -6.   3. -14.]
[[  8.    -6.     3.   -14.  ]
 [  0.     1.5   -3.75  25.5 ]
 [  0.    -6.     6.     6.  ]]
Korak: 1
Pivot vrsta: [ 0. -6.  6.  6.]
[[  8.    -6.     3.   -14.  ]
 [  0.    -6.     6.     6.  ]
 [  0.     0.    -2.25  27.  ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="razcep-lu-z-delnim-pivotiranjem">
<h3>Razcep LU z delnim pivotiranjem<a class="headerlink" href="#razcep-lu-z-delnim-pivotiranjem" title="Permalink to this heading">#</a></h3>
<p>Podobno kakor pri Gaussovi eliminaciji lahko tudi razcep LU razširimo z delnim pivotiranjem. Reševanje tako postane numerično <strong>stabilno</strong>. Pri tem moramo shraniti informacijo o zamenjavi vrstic, ki jo potem posredujemo v funkcijo za rešitev ustreznih trikotnih sistemov.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LU_razcep_pivotiranje</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">prikazi_korake</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne razcep LU matriko in vektor zamenjanih vrstic pivotiranje, </span>
<span class="sd">    uporabi delno pivotiranje.</span>

<span class="sd">    :param A: matrika koeficientov</span>
<span class="sd">    :param prikazi_korake: izpišem posamezne korake</span>
<span class="sd">    :return LU: LU matrika</span>
<span class="sd">    :return pivotiranje: vektor zamenjave vrstic (pomembno pri iskanju rešitve)    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">LU</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">pivotiranje</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">LU</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">p_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">LU</span><span class="p">[</span><span class="n">p</span><span class="p">:,</span><span class="n">p</span><span class="p">]))</span><span class="o">+</span><span class="n">p</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">p_max</span><span class="p">:</span>
            <span class="n">LU</span><span class="p">[[</span><span class="n">p</span><span class="p">],</span> <span class="p">:],</span> <span class="n">LU</span><span class="p">[[</span><span class="n">p_max</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">LU</span><span class="p">[[</span><span class="n">p_max</span><span class="p">],</span> <span class="p">:],</span> <span class="n">LU</span><span class="p">[[</span><span class="n">p</span><span class="p">],</span> <span class="p">:]</span>
            <span class="n">pivotiranje</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">pivotiranje</span><span class="p">[</span><span class="n">p_max</span><span class="p">]</span> <span class="o">=</span> <span class="n">pivotiranje</span><span class="p">[</span><span class="n">p_max</span><span class="p">],</span> <span class="n">pivotiranje</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
        <span class="n">pivot_vrsta</span> <span class="o">=</span> <span class="n">LU</span><span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="p">:]</span>                
        <span class="k">for</span> <span class="n">vrsta</span> <span class="ow">in</span> <span class="n">LU</span><span class="p">[</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">/</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">pivot_vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span> <span class="o">*</span> <span class="n">m</span>
                <span class="n">vrsta</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Deljenje z 0.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prikazi_korake</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Korak: </span><span class="si">{:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pivot vrsta:&#39;</span><span class="p">,</span> <span class="n">pivot_vrsta</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">LU</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">LU</span><span class="p">,</span> <span class="n">pivotiranje</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lu</span><span class="p">,</span> <span class="n">piv</span> <span class="o">=</span> <span class="n">LU_razcep_pivotiranje</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">prikazi_korake</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Korak: 0
Pivot vrsta: [ 8. -6.  3.]
[[ 8.   -6.    3.  ]
 [-0.75  1.5  -3.75]
 [ 0.   -6.    6.  ]]
Korak: 1
Pivot vrsta: [ 0. -6.  6.]
[[ 8.   -6.    3.  ]
 [ 0.   -6.    6.  ]
 [-0.75 -0.25 -2.25]]
</pre></div>
</div>
</div>
</div>
<p>V zgornjem primeru smo uporabili kompaketen način zapisa trikotnih matrik <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> in <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>; vsaka je namreč definirana s 6 elementi, pri matriki <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> pa vemo, da so diagonalni elementi enaki 1. Matrika <code class="docutils literal notranslate"><span class="pre">lu</span></code> tako vsebuje <span class="math notranslate nohighlight">\(3\times3=9\)</span> elementov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8.  , -6.  ,  3.  ],
       [ 0.  , -6.  ,  6.  ],
       [-0.75, -0.25, -2.25]])
</pre></div>
</div>
</div>
</div>
<p>Na diagonali in nad diagonalo so vrednosti zgornje trikotne matrike <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>, pod diagonalo pa so poddiagonalni elementi matrike <span class="math notranslate nohighlight">\(\mathbf{L}\)</span>. Pri izračunu rešitve bomo upoštevali, da so diagonalne vrednosti <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> enake 1.</p>
<p>Numerični seznam <code class="docutils literal notranslate"><span class="pre">piv</span></code> nam pove, kako so bile zamenjane vrstice, kar je treba upoštevati pri izračunu rešitve:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">piv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 0, 1])
</pre></div>
</div>
</div>
</div>
<p>Določimo sedaj še rešitev (koda za računanje rešitve je v modulu <code class="docutils literal notranslate"><span class="pre">orodja.py</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">moduli</span> <span class="kn">import</span> <span class="n">orodja</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">orodja</span><span class="o">.</span><span class="n">LU_resitev_pivotiranje</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">piv</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ -3.66666667, -14.11111111, -16.44444444])
</pre></div>
</div>
</div>
</div>
<p>Preverjanje rešitve:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="nd">@r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14.,  36.,   6.])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modul-scipy">
<h2>Modul <code class="docutils literal notranslate"><span class="pre">SciPy</span></code><a class="headerlink" href="#modul-scipy" title="Permalink to this heading">#</a></h2>
<p>Modul <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> temelji na <code class="docutils literal notranslate"><span class="pre">numpy</span></code> modulu in vsebuje veliko različnih visokonivojskih programov/modulov/funkcij. Teoretično ozadje modulov so seveda različni numerični algoritmi; nekatere spoznamo tudi v okviru tega učbenika. Dober vir teh numeričnih algoritmov v povezavi s <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> predstavlja <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/tutorial/">dokumentacija</a>. Za odličen uvod v SciPy si lahko ogledate <span class="xref myst">YouTube posnetek: SciPy Tutorial (2021): For Physicists, Engineers, and Mathematicians: For Physicists, Engineers, and Mathematicians</span></p>
<p>Kratek pregled hierarhije modula:</p>
<ul class="simple">
<li><p>Linearna algebra (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html">scipy.linalg</a>)</p></li>
<li><p>Integracija (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/integrate.html">scipy.integrate</a>)</p></li>
<li><p>Optimizacija (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html">scipy.optimize</a>)</p></li>
<li><p>Interpolacija (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/interpolate.html">scipy.interpolate</a>)</p></li>
<li><p>Fourierjeva transformacija (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/fftpack.html">scipy.fftpack</a>)</p></li>
</ul>
<ul class="simple">
<li><p>Problem lastnih vrednosti (redke matrike) (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/sparse.html">scipy.sparse</a>)</p></li>
<li><p>Statistika (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/stats.html">scipy.stats</a>)</p></li>
<li><p>Procesiranje signalov (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html">scipy.signal</a>)</p></li>
<li><p>Posebne funkcije (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/special.html">scipy.special</a>)</p></li>
<li><p>Večdimenzijsko procesiranje slik (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/ndimage.html">scipy.ndimage</a>)</p></li>
<li><p>Delo z datotekami (<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/io.html">scipy.io</a>)</p></li>
</ul>
<p>V sledečih predavanjih si bomo nekatere podmodule podrobneje pogledali.</p>
<p>Poglejmo si, kako je znotraj <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> implementiran <em>razcep LU</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">lu_factor</span><span class="p">,</span> <span class="n">lu_solve</span>
</pre></div>
</div>
</div>
</div>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">scipy.linalg.lu_factor</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lu_factor.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lu_factor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>zahteva vnos matrike koeficientov (ali seznama matrik koeficientov) <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">overwrite_a</span></code> v primeru <code class="docutils literal notranslate"><span class="pre">True</span></code> z rezultatom razcepa prepiše vrednost <code class="docutils literal notranslate"><span class="pre">a</span></code> (to je lahko pomembno, da se prihrani spomin in poveča hitrost). Funkcija <code class="docutils literal notranslate"><span class="pre">lu_factor</span></code> vrne terko <code class="docutils literal notranslate"><span class="pre">(lu,</span> <span class="pre">piv)</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lu</span></code> - <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> \ <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> matrika (matrika, ki je enake dimenzije kot <code class="docutils literal notranslate"><span class="pre">a</span></code>, vendar pod diagonalo vsebuje elemente <span class="math notranslate nohighlight">\(\mathbf{L}\)</span>, preostali elementi pa definirajo <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>; diagonalni elementi <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> imajo vrednosti 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">piv</span></code> - pivotni indeksi, predstavljajo permutacijsko matriko <code class="docutils literal notranslate"><span class="pre">P</span></code>: vrsta  <code class="docutils literal notranslate"><span class="pre">i</span></code> matrike <code class="docutils literal notranslate"><span class="pre">a</span></code> je bila zamenjana z vrsto <code class="docutils literal notranslate"><span class="pre">piv[i]</span></code> (v vsakem koraku se upošteva predhodno stanje, malo drugačna logika kot v naši funkciji <code class="docutils literal notranslate"><span class="pre">LU_razcep_pivotiranje</span></code>).</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">lu_factor</span></code> uporabljamo v paru s funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.linalg.lu_solve</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lu_solve.html">dokumentacija</a>), ki nam poda rešitev sistema:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lu_solve</span><span class="p">(</span><span class="n">lu_and_piv</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">overwrite_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lu_and_piv</span></code> je terka rezultata <code class="docutils literal notranslate"><span class="pre">(lu,</span> <span class="pre">piv)</span></code> iz <code class="docutils literal notranslate"><span class="pre">lu_factor</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> je vektor (ali seznam vektorjev) konstant. Ostali parametri so opcijski.</p>
<p>Poglejmo si uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>            
              <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lu</span><span class="p">,</span> <span class="n">piv</span> <span class="o">=</span> <span class="n">lu_factor</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8.  , -6.  ,  3.  ],
       [ 0.  , -6.  ,  6.  ],
       [-0.75, -0.25, -2.25]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">piv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 2, 2], dtype=int32)
</pre></div>
</div>
</div>
</div>
<p>Pridobimo rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">lu_solve</span><span class="p">((</span><span class="n">lu</span><span class="p">,</span> <span class="n">piv</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ -3.66666667, -14.11111111, -16.44444444])
</pre></div>
</div>
</div>
</div>
<p>Preverimo ustreznost rešitve:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="nd">@r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14.,  36.,   6.])
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="racunanje-inverzne-matrike">
<h2>Računanje inverzne matrike<a class="headerlink" href="#racunanje-inverzne-matrike" title="Permalink to this heading">#</a></h2>
<p>Inverzno matriko h kvadratni matriki <span class="math notranslate nohighlight">\(\textbf{A}\)</span> reda <span class="math notranslate nohighlight">\(n\times n\)</span> označimo z <span class="math notranslate nohighlight">\(\textbf{A}^{-1}\)</span>. Je matrika reda <span class="math notranslate nohighlight">\(n\times n\)</span>,  takšna, da velja</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,\mathbf{A}^{-1} = \mathbf{A}^{-1}\,\mathbf{A} = \mathbf{I},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> enotska matrika.</p>
<p>Najbolj učinkovit način za izračun inverzne matrike od matrike <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> je rešitev matrične enačbe:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,\mathbf{X}=\mathbf{I}.\]</div>
<p>Matrika <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> je inverzna matriki <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>: <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}=\mathbf{X}\)</span>.</p>
<p>Izračun inverzne matrike je torej enak reševanju <span class="math notranslate nohighlight">\(n\)</span> sistemov <span class="math notranslate nohighlight">\(n\)</span> linarnih enačb:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,\mathbf{x}_i=\mathbf{b}_i,\qquad i=0,1,2,\dots,n-1,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\mathbf{b}_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ti stolpec matrike <span class="math notranslate nohighlight">\(\mathbf{B}=\mathbf{I}\)</span>.</p>
<p><em>Numerična zahtevnost:</em> izvedemo razcep LU nad matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> (računski obseg reda <span class="math notranslate nohighlight">\(n^3\)</span>) in nato
poiščemo rešitev za vsak <span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span> (<span class="math notranslate nohighlight">\(2\,n^2\)</span> računskih operacij za vsak <span class="math notranslate nohighlight">\(i\)</span>). Skupni računski obseg je torej še vedno reda <span class="math notranslate nohighlight">\(n^3\)</span>. (Če bi <span class="math notranslate nohighlight">\(n\)</span> krat izvajali Gaussovo eliminacijo, bi bil obseg reda <span class="math notranslate nohighlight">\(n^4\)</span>.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lu_piv</span> <span class="o">=</span> <span class="n">lu_factor</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">lu_piv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[ 8.  , -6.  ,  3.  ],
        [ 0.  , -6.  ,  6.  ],
        [-0.75, -0.25, -2.25]]),
 array([2, 2, 2], dtype=int32))
</pre></div>
</div>
</div>
</div>
<p>Tukaj se sedaj pokaže smisel razcepa LU; razcep namreč izračunamo samo enkrat in potem za vsak vektor konstant poiščemo rešitev tako, da rešimo dva trikotna sistema. Če bi sisteme reševali po Gaussovi metodi, bi rabili <span class="math notranslate nohighlight">\((n^3+n^2)\,n\)</span> računskih operacij.</p>
<p>Izračunajmo inverzno matriko od matrike <span class="math notranslate nohighlight">\(\textbf{A}\)</span>. Najprej z uporabo <code class="docutils literal notranslate"><span class="pre">np.identity()</span></code> pripravimo enotsko matriko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>Nato rešimo sistem enačb za vsak stolpec enotske matrike:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="c1">#zeros_like vrne matriko oblike in tipa matrike A z vrednostmi 0</span>
<span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">a_inv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)),</span> <span class="n">A_inv</span><span class="p">):</span>
    <span class="n">a_inv</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lu_solve</span><span class="p">(</span><span class="n">lu_piv</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">A_inv</span> <span class="o">=</span> <span class="n">A_inv</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<p>Rešitev torej je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_inv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.66666667e-01, -1.66666667e-01,  1.38777878e-17],
       [-2.77777778e-01, -4.44444444e-01, -3.33333333e-01],
       [-1.11111111e-01, -4.44444444e-01, -3.33333333e-01]])
</pre></div>
</div>
</div>
</div>
<p>Preverimo rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="nd">@A_inv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.00000000e+00,  0.00000000e+00,  1.11022302e-16],
       [ 0.00000000e+00,  1.00000000e+00, -1.11022302e-16],
       [ 5.55111512e-17,  0.00000000e+00,  1.00000000e+00]])
</pre></div>
</div>
</div>
</div>
<p>Rešitev z uporabo Numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.66666667e-01, -1.66666667e-01,  1.38777878e-17],
       [-2.77777778e-01, -4.44444444e-01, -3.33333333e-01],
       [-1.11111111e-01, -4.44444444e-01, -3.33333333e-01]])
</pre></div>
</div>
</div>
</div>
<p>Z ustrezno uporabo funkcij iz modula <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> lahko do rešitve pridemo še hitreje. V funkcijo <code class="docutils literal notranslate"><span class="pre">lu_solve</span></code> lahko vstavimo vektor <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> ali matriko <span class="math notranslate nohighlight">\(\mathbf{B}\)</span>, katere posamezni stolpec <span class="math notranslate nohighlight">\(i\)</span> predstavlja nov vektor konstant <span class="math notranslate nohighlight">\(\mathbf{b}_i\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">lu_solve</span><span class="p">(</span><span class="n">lu_piv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.66666667e-01, -1.66666667e-01,  1.38777878e-17],
       [-2.77777778e-01, -4.44444444e-01, -3.33333333e-01],
       [-1.11111111e-01, -4.44444444e-01, -3.33333333e-01]])
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resevanje-predolocenih-sistemov">
<h2>Reševanje predoločenih sistemov<a class="headerlink" href="#resevanje-predolocenih-sistemov" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;N6upu99LbfQ&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/N6upu99LbfQ"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>Kadar rešujemo sistem <span class="math notranslate nohighlight">\(m\)</span> linearnih enačbami z <span class="math notranslate nohighlight">\(n\)</span> neznankami ter velja <span class="math notranslate nohighlight">\(m&gt;n\)</span> in je rang <span class="math notranslate nohighlight">\(n+1\)</span>, imamo predoločeni sistem.</p>
<p>Predoločeni (tudi <strong>nekonsistenten sistem</strong>):</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,\mathbf{x}=\mathbf{b},\]</div>
<p>nima rešitve. Lahko pa poiščemo najboljši približek rešitve z metodo <strong>najmanjših kvadratov</strong>.</p>
<p>Vsota kvadratov preostankov je definirana s skalarnim produktom:</p>
<div class="math notranslate nohighlight">
\[\left\lVert r\right\rVert ^2=(\mathbf{A}\,\mathbf{x}-\mathbf{b})^T\,(\mathbf{A}\,\mathbf{x}-\mathbf{b})\]</div>
<p>kar preoblikujemo v:</p>
<div class="math notranslate nohighlight">
\[\left\lVert r\right\rVert^2=\mathbf{x}^T\mathbf{A}^T\mathbf{A}\mathbf{x}-2\mathbf{b}^T\mathbf{A}\mathbf{x}+\mathbf{b}^T\mathbf{b},
\]</div>
<p>kjer smo upoštevali, da zaradi skalarne vrednosti velja: <span class="math notranslate nohighlight">\(\mathbf{b}^T\mathbf{A}\mathbf{x}=(\mathbf{b}^T(\mathbf{A}\mathbf{x}))^T=(\mathbf{A}\mathbf{x})^T\mathbf{b}\)</span>.</p>
<p>Rešitev enačbe, gradient vsote kvadratov, določa njen minimum:</p>
<div class="math notranslate nohighlight">
\[
\nabla_x\,\left\lVert r\right\rVert^2=2\mathbf{A}^T\mathbf{A}\,\mathbf{x}-2\mathbf{A}^T\,\mathbf{b}=0
\]</div>
<p>Tako iz normalne enačbe:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}^T\mathbf{A}\,\mathbf{x}=\mathbf{A}^T\,\mathbf{b}
\]</div>
<p>določimo najboljši približek rešitve:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{x}=\left(\mathbf{A}^T\mathbf{A}\right)^{-1}\mathbf{A}^T\,\mathbf{b}.
\]</div>
<p>Z vpeljavo <strong>psevdo inverzne matrike</strong>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}^+=\left(\mathbf{A}^T\mathbf{A}\right)^{-1}\mathbf{A}^T
\]</div>
<p>k matriki <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> je rešitev predoločenega sistema zapisana:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{x}=\mathbf{A}^+\,\mathbf{b}.
\]</div>
<p>Zgoraj predstavljen postopek je relativo enostaven, je pa numerično zahteven in lahko v nekaterih primerih slabo pogojen; priporočeno je da v praksi psevdo inverzno matriko izračunamo z uporabo funkcij:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.linalg.pinv</span></code> iz modula <code class="docutils literal notranslate"><span class="pre">numpy</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.pinv.html">dokumentacija</a>),</p></li>
<li><p>Funkcij <code class="docutils literal notranslate"><span class="pre">pinv</span></code>, <code class="docutils literal notranslate"><span class="pre">pinv2</span></code> ali <code class="docutils literal notranslate"><span class="pre">pinvh</span></code> iz modula <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code> (izbira je odvisna od obravnavanega problema; glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html">dokumentacijo</a>),</p></li>
</ul>
<p>ki temeljijo na boljših numerični metodah.</p>
<p>Primer sistema z enolično rešitvijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># število enačb enako številu neznank</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 2.])
</pre></div>
</div>
</div>
</div>
<p>Naredimo sedaj predoločeni sistem (funkcija <code class="docutils literal notranslate"><span class="pre">numpy.vstack</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.vstack.html">dokumentacija</a>) sestavi sezname po stolpcih, <code class="docutils literal notranslate"><span class="pre">numpy.random.seed</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.seed.html">dokumentacija</a>) ponastavi generator naključnih števil na vrednost semena <code class="docutils literal notranslate"><span class="pre">seed</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy.random.normal</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.normal.html">dokumentacija</a>) pa generira normalno porazdeljeni seznam dolžine <code class="docutils literal notranslate"><span class="pre">size</span></code> in standardne deviacije <code class="docutils literal notranslate"><span class="pre">scale</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">])</span> 
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">vA</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">vA</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># pokvarimo rešitev -&gt; sistem je predoločen</span>
<span class="n">vA</span> <span class="c1"># matrika koeficientov</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.01764052, 2.00400157],
       [2.00978738, 3.02240893],
       [1.01867558, 1.99022722],
       [2.00950088, 2.99848643],
       [0.99896781, 2.00410599],
       [2.00144044, 3.01454274]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">])</span>
<span class="n">vb</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">vb</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vb</span> <span class="c1"># vektor konstant</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5.00761038, 8.00121675, 5.00443863, 8.00333674, 5.01494079,
       7.99794842])
</pre></div>
</div>
</div>
</div>
<p>Rešimo sedaj predoločen sistem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">vA</span><span class="p">)</span>
<span class="n">Ap</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.94512271, 2.02675939])
</pre></div>
</div>
</div>
</div>
<p>Vidimo, da predoločeni sistem z naključnimi vrednostmi (simulacija šuma pri meritvi) poda podoben rezultat kakor rešitev brez šuma. V kolikor bi nivo šuma povečevali, bi se odstopanje od enolične rešitve povečevalo.</p>
<p>Psevdo inverzno matriko lahko določimo tudi sami in preverimo razliko z vgrajeno funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit # preverite hitrost!</span>
<span class="n">Ap2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">vA</span><span class="o">.</span><span class="n">T</span><span class="nd">@vA</span><span class="p">)</span> <span class="o">@</span> <span class="n">vA</span><span class="o">.</span><span class="n">T</span>

<span class="n">Ap2</span> <span class="o">-</span> <span class="n">Ap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-8.88178420e-16,  2.77555756e-15,  3.33066907e-16,
         3.33066907e-15, -1.11022302e-15,  2.99760217e-15],
       [ 1.22124533e-15, -6.10622664e-16,  4.44089210e-16,
        -6.66133815e-16,  1.11022302e-15, -1.27675648e-15]])
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="iterativne-metode">
<h2>Iterativne metode<a class="headerlink" href="#iterativne-metode" title="Permalink to this heading">#</a></h2>
<p>Pogosto se srečamo z velikimi sistemi linearnih enačb, katerih matrika koeficientov ima malo od nič različnih elementov (take matrike imenujemo <strong>redke</strong> ali tudi <strong>razpršene</strong>, angl. <em>sparse</em>).</p>
<p>Pri reševanju takih sistemov linearnih enačb se zelo dobro izkažejo iterativne metode; prednosti v primerjavi z direktnimi metodami so:</p>
<ul class="simple">
<li><p>računske operacije se izvajajo samo nad neničelnimi elementi (kljub iterativnemu reševanju jih je lahko manj)</p></li>
<li><p>zahtevani spominski prostor je lahko neprimerno manjši.</p></li>
</ul>
<section id="gauss-seidlova-metoda">
<h3>Gauss-Seidlova metoda<a class="headerlink" href="#gauss-seidlova-metoda" title="Permalink to this heading">#</a></h3>
<p>V nadaljevanju si bomo pogledali idejo <em>Gauss-Seidelove</em> iterativne metode. Najprej sistem enačb <span class="math notranslate nohighlight">\(\mathbf{A}\,\mathbf{x}=\mathbf{b}\)</span> zapišemo kot:</p>
<div class="math notranslate nohighlight">
\[
\sum_{j=0}^{n-1} A_{ij}x_j=b_i\qquad{}i=0,1,\dots,n-1.
\]</div>
<p>Predpostavim, da smo v <span class="math notranslate nohighlight">\(k-1\)</span> koraku iterativne metode in so znani približki <span class="math notranslate nohighlight">\(x_{j}^{(k-1)}\)</span> (<span class="math notranslate nohighlight">\(j=0,1,\dots, n-1\)</span>). Iz zgornje vsote izpostavimo člen <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight">
\[
A_{ii}\,x_{i}^{(k-1)} +\sum_{j=0, j\ne i}^{n-1} A_{ij}x_{j}^{(k-1)}=b_i\qquad{}i=0,1,\dots,n-1.
\]</div>
<p>Ker približki <span class="math notranslate nohighlight">\(x_{j}^{(k-1)}\)</span> ne izpolnjujejo natančno linearnega problema, lahko iz zgornje enačbe določimo nov približek <span class="math notranslate nohighlight">\(x_{i}^{(k)}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
x_{i}^{(k)} =\frac{1}{A_{ii}}\left(b_i-\sum_{j=0}^{i-1} A_{ij}x_{j}^{(k)}-\sum_{j=i+1}^{n-1} A_{ij}x_{j}^{(k-1)}\right)
\]</div>
<p>Vsoto smo razdelili na dva dela in za izračun <span class="math notranslate nohighlight">\(i\)</span>-tega člena upoštevali v <span class="math notranslate nohighlight">\(k\)</span>-ti iteraciji že določene člene z indeksom manjšim od <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Iterativni pristop prekinemo, ko dosežemo želeno natančnost rešitve <span class="math notranslate nohighlight">\(\epsilon\)</span>:</p>
<div class="math notranslate nohighlight">
\[
||x_{i}^{(k)}-x_{i}^{(k-1)}||&lt;\epsilon
\]</div>
</section>
<section id="zgled">
<h3>Zgled<a class="headerlink" href="#zgled" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> 
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Začetni približek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<p>Pripravimo matriko <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> brez diagonalnih elementov (Zakaj? Poskusite odgovoriti spodaj, ko bomo izvedli iteracije.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">#naredimo kopijo, da ne povozimo podatkov</span>
<span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#spremenimo samo diagonalne elemente</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0., -1.,  1.],
       [-1.,  0., -1.],
       [ 0., -1.,  0.]])
</pre></div>
</div>
</div>
</div>
<p>Izvedemo iteracije:</p>
<div class="math notranslate nohighlight">
\[
x_{i}^{(k)} =\frac{1}{A_{ii}}\left(b_i-\sum_{j=0}^{i-1} A_{ij}x_{j}^{(k)}-\sum_{j=i+1}^{n-1} A_{ij}x_{j}^{(k-1)}\right)
\]</div>
<p>(Ker bomo vrednosti takoj zapisali v <code class="docutils literal notranslate"><span class="pre">x</span></code>, ni treba razbiti vsote na dva dela)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">xk_1</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;iteracja </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span> <span class="c1">#opazujte kaj se dogaja, ko to celico poženete večkrat!</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Približek za element </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xk_1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Norma </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-----iteracja 0-----
Približek za element 0 [-1.75  0.    0.  ]
Približek za element 1 [-1.75        5.70833333  0.        ]
Približek za element 2 [-1.75        5.70833333  1.95138889]
Norma 6.281360365408393
-----iteracja 1-----
Približek za element 0 [-1.28038194  5.70833333  1.95138889]
Približek za element 1 [-1.28038194  6.11183449  1.95138889]
Približek za element 2 [-1.28038194  6.11183449  2.01863908]
Norma 0.6227976321231091
-----iteracja 2-----
Približek za element 0 [-1.23835057  6.11183449  2.01863908]
Približek za element 1 [-1.23835057  6.13004808  2.01863908]
Približek za element 2 [-1.23835057  6.13004808  2.02167468]
Norma 0.04590845211691733
</pre></div>
</div>
</div>
</div>
<p>Preverimo rešitev</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="nd">@x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-14.01517799,  35.9969644 ,   6.        ])
</pre></div>
</div>
</div>
</div>
<p>Metoda deluje dobro, če je matrika diagonalno dominantna (obstajajo pa metode, ki delujejo tudi, ko matrika ni diagonalno dominantna, glejte npr.: J. Petrišič, Reševanje enačb, 1996, str 149: Metoda konjugiranih gradientov).</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<p>Na sliki je prikazano paličje. Ob delovanju sil <span class="math notranslate nohighlight">\(F_1\)</span> in <span class="math notranslate nohighlight">\(F_2\)</span> se v palicah razvijejo notranje sile <span class="math notranslate nohighlight">\(P_i\)</span>. Dimenzije paličja zagotavljata kota <span class="math notranslate nohighlight">\(\alpha\)</span> in <span class="math notranslate nohighlight">\(\beta\)</span>.
<img src="./fig/palicje_2.2_15.png" width=300>
Sile v palicah izračunamo s pomočjo sistema linearnih enačb.</p>
<ol class="arabic simple">
<li><p>V simbolni obliki zapišite ravnotežje sil za točko 1 v <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(y\)</span> smeri (namig: naloga je posplošitev naloge 15 na strani 81 v knjigi Numerical methods in Eng with Py 3 z nastavkom za rešitev):
<img src="./fig/palicje_2.2_15_resitev.png" width=300>
Zgornji nastavek ima napako v predzadnji vrstici. Rešitev sistema v knjigi je: <span class="math notranslate nohighlight">\(P_{1} = -42000, P_{2}=-12000, P_{3}= 42426, P_{4} = -12000, P_{5} = 16971, P_{6} = 12000\)</span>
).</p></li>
<li><p>V simbolni obliki zapišite ravnotežje sil za točko 2 v <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(y\)</span> smeri.</p></li>
<li><p>Najdite simbolno rešitev za sile <span class="math notranslate nohighlight">\(P_i\)</span>.</p></li>
<li><p>Uporabite podatke: <span class="math notranslate nohighlight">\(\alpha=\beta=\pi/4\)</span>, <span class="math notranslate nohighlight">\(F_1=18\)</span> kN in <span class="math notranslate nohighlight">\(F_2=12\)</span> kN ter najdite številčno rešitev.</p></li>
<li><p>Pripravite si funkcijo, ki bo za poljubne podatke (npr: <code class="docutils literal notranslate"><span class="pre">podatki</span> <span class="pre">=</span> <span class="pre">{a:</span> <span class="pre">pi/4,</span> <span class="pre">b:</span> <span class="pre">pi/4,</span> <span class="pre">F1:</span> <span class="pre">18000,</span> <span class="pre">F2:</span> <span class="pre">12000}</span></code>) vrnila numerično matriko koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> in vektor konstant <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>. Če ne uspete tega narediti avtomatizirano, delajte „na roke“ (splača se vam potruditi, saj bomo to večkrat rabili).</p></li>
<li><p>Razširite zgornjo funkcijo, da vam vrne rešitev linearnega sistema (uporabite kar <code class="docutils literal notranslate"><span class="pre">numpy</span></code> knjižnico)</p></li>
<li><p>Predpostavite <span class="math notranslate nohighlight">\(F_1=F_2=10\)</span> kN. V vsaj petih vrednostih kota <span class="math notranslate nohighlight">\(\alpha=\beta\)</span> od 10<span class="math notranslate nohighlight">\(^{\circ}\)</span> do 80<span class="math notranslate nohighlight">\(^{\circ}\)</span> izračunajte sile v palicah.</p></li>
<li><p>Za primer iz predhodne naloge narišite sile v palicah.</p></li>
<li><p>S pomočjo funkcije <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code> izračunajte inverz poljubne matrike <code class="docutils literal notranslate"><span class="pre">A</span></code> (nato izračunajte še inverz s pomočjo funkcije <code class="docutils literal notranslate"><span class="pre">np.linalg.inv</span></code>).</p></li>
<li><p>Na primeru poljubnih podatkov (npr: <code class="docutils literal notranslate"><span class="pre">podatki</span> <span class="pre">=</span> <span class="pre">{a:</span> <span class="pre">pi/4,</span> <span class="pre">b:</span> <span class="pre">pi/4,</span> <span class="pre">F1:</span> <span class="pre">18000,</span> <span class="pre">F2:</span> <span class="pre">12000}</span></code>) pokažite Gaussovo eliminacijo z delnim pivotiranjem.</p></li>
<li><p>Na primeru poljubnih podatkov (npr: <code class="docutils literal notranslate"><span class="pre">podatki</span> <span class="pre">=</span> <span class="pre">{a:</span> <span class="pre">pi/4,</span> <span class="pre">b:</span> <span class="pre">pi/4,</span> <span class="pre">F1:</span> <span class="pre">18000,</span> <span class="pre">F2:</span> <span class="pre">12000}</span></code>) pokažite Gauss-Seidlov iterativni pristop k iskanju rešitve.</p></li>
</ol>
<section id="dodatno">
<h3>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h3>
<p>Analizirajte, koliko e-mailov dobite na dan:
<img src="./fig/povprecje_emailov.jpg" width=300>
<a class="reference external" href="https://plot.ly/ipython-notebooks/graph-gmail-inbox-data/">https://plot.ly/ipython-notebooks/graph-gmail-inbox-data/</a>
(Nasvet: sledite kodi in uporabite <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> za prikaz).</p>
</section>
</section>
<span id="document-notebooks/Predavanje 07 - Interpolacija"></span><section class="tex2jax_ignore mathjax_ignore" id="interpolacija">
<h2>Interpolacija<a class="headerlink" href="#interpolacija" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h2>Uvod<a class="headerlink" href="#uvod" title="Permalink to this heading">#</a></h2>
<p>Pri <strong>interpolaciji</strong> izhajamo iz tabele (različnih) vrednosti <span class="math notranslate nohighlight">\(x_i, y_i\)</span>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathbf{y}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(x_0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_1\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\dots\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\dots\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(x_{n-1}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_{n-1}\)</span></p></td>
</tr>
</tbody>
</table>
<p>določiti pa želimo vmesne vrednosti. Če želimo določiti vrednosti zunaj območja <span class="math notranslate nohighlight">\(x\)</span> v tabeli, govorimo o <strong>ekstrapolaciji</strong>.</p>
<p>V okviru <strong>interpolacije</strong> (angl. <em>interpolation</em>) točke povežemo tako, da predpostavimo neko funkcijo in dodamo pogoj, da funkcija <em>mora</em> potekati skozi podane točke.</p>
<p>Pri <strong>aproksimaciji</strong> (angl. <em>approximation</em> ali tudi <em>curve fitting</em>) pa predpostavimo funkcijo, ki se čimbolj (glede na izbrani kriterij) prilega podatkom.</p>
<p>Poglejmo si primer:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathbf{y}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>1.0</p></td>
<td class="text-center"><p>0.54030231</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2.5</p></td>
<td class="text-center"><p>-0.80114362</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4.0</p></td>
<td class="text-center"><p>-0.65364362</p></td>
</tr>
</tbody>
</table>
<p>Pri interpolaciji izhajamo iz tabele vrednosti. Da bomo pozneje lahko enostavno prikazali napako, smo zgornjo tabelo generirali s pomočjo izraza <span class="math notranslate nohighlight">\(y = \cos(x)\)</span>!</p>
<p>Pripravimo numerični zgled; najprej uvozimo pakete:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Nato pripravimo tabelo ter prikaz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span> <span class="c1"># posplošimo interpolirano funkcijo (lahko spremenite v drugo funkcijo)</span>
<span class="n">f_ime</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># avtomatsko vzamemo ime funkcije</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="c1"># + np.random.rand(len(x))*0.3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9e9f888b31acaa7a98fc6a8c0a8906b0523be70e868c56e333bcbf24e4a98f83.png" src="_images/9e9f888b31acaa7a98fc6a8c0a8906b0523be70e868c56e333bcbf24e4a98f83.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="interpolacija-s-polinomom">
<h2>Interpolacija s polinomom<a class="headerlink" href="#interpolacija-s-polinomom" title="Permalink to this heading">#</a></h2>
<p>Interpolacija s polinomom se zdi najbolj primerna, saj je enostavna!</p>
<p>Polinom stopnje <span class="math notranslate nohighlight">\(n-1\)</span>:</p>
<div class="math notranslate nohighlight">
\[
y = a_0\,x^{n-1} +a_1\,x^{n-2} +\cdots + a_{n-2}\,x + a_{n-1}.
\]</div>
<p>je definiran z <span class="math notranslate nohighlight">\(n\)</span> konstantami <span class="math notranslate nohighlight">\(a_i\)</span>. Da določimo <span class="math notranslate nohighlight">\(n\)</span> konstant, potrebujemo <span class="math notranslate nohighlight">\(n\)</span> (različnih) enačb. Za vsak par <span class="math notranslate nohighlight">\(x_i, y_i\)</span> lahko torej zapišemo:</p>
<div class="math notranslate nohighlight">
\[
y_i = a_{0}\,x_i^{n-1} +a_{1}\,x_i^{n-2} +\cdots + a_{n-2}\,x_i + a_{n-1}.
\]</div>
<p>Ker imamo podanih <span class="math notranslate nohighlight">\(n\)</span> parov, lahko določimo <span class="math notranslate nohighlight">\(n\)</span> neznanih konstant <span class="math notranslate nohighlight">\(a_i\)</span>, ki definirajo polinom stopnje <span class="math notranslate nohighlight">\(n-1\)</span>. Sistem <span class="math notranslate nohighlight">\(n\)</span> linearnih enačb lahko zapišemo:
$<span class="math notranslate nohighlight">\(
\begin{bmatrix}
x_{0}^{n-1}&amp;x_{0}^{n-2}&amp;\dots&amp;x_{0}^0\\
x_{1}^{n-1}&amp;x_{1}^{n-2}&amp;\dots&amp;x_{1}^0\\
&amp;&amp;\vdots&amp;&amp;\\
x_{n-1}^{n-1}&amp;x_{n-1}^{n-2}&amp;\dots&amp;x_{n-1}^0\\
\end{bmatrix}
\begin{pmatrix}
a_{0}\\
a_{1}\\
\vdots\\
a_{n-1}
\end{pmatrix}=
\begin{pmatrix}
y_{0}\\
y_{1}\\
\vdots\\
y_{n-1}
\end{pmatrix}
\)</span>$</p>
<p>Sistem linearnim enačb zapišemo v obliki:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{M}\,\mathbf{a}=\mathbf{b}.
\]</div>
<p>Definirajmo matriko koeficientov <span class="math notranslate nohighlight">\(\mathbf{M}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="n">_</span><span class="o">**</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
<span class="n">M</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.  ,  1.  ,  1.  ],
       [ 6.25,  2.5 ,  1.  ],
       [16.  ,  4.  ,  1.  ]])
</pre></div>
</div>
</div>
</div>
<p>Izračunamo koeficiente <span class="math notranslate nohighlight">\(a_{0}, a_{1},\dots\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resitev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">resitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.33087687, -2.05236633,  2.26179176])
</pre></div>
</div>
</div>
</div>
<p>Pripravimo interpolacijski polinom kot Pythonovo funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">y_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">resitev</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="n">_</span><span class="o">**</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resitev</span><span class="p">)))]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">resitev</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izris interpolacijskega polinoma pri bolj gosti mreži točk:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">yint</span> <span class="o">=</span> <span class="n">y_function</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">resitev</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">yint</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacija&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e1729e2499c035357c7da79a11d189f0e954b99ebd28ce3e9754f7541dc0b193.png" src="_images/e1729e2499c035357c7da79a11d189f0e954b99ebd28ce3e9754f7541dc0b193.png" />
</div>
</div>
<p>Slabosti zgornjega postopka so:</p>
<ul class="simple">
<li><p>število numeričnih operacij raste sorazmerno z <span class="math notranslate nohighlight">\(n^3\)</span>,</p></li>
<li><p>problem je lahko slabo pogojen (z večanjem stopnje polinoma slaba pogojenost naglo narašča):</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71.30227870311077
</pre></div>
</div>
</div>
</div>
<p><em>Navodilo</em>: vrnite se par vrstic nazaj in spremenite število interpolacijskih točk <span class="math notranslate nohighlight">\(n\)</span> na višjo vrednost (npr. 10).</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lagrangeva-metoda">
<h2>Lagrangeva metoda<a class="headerlink" href="#lagrangeva-metoda" title="Permalink to this heading">#</a></h2>
<p><em>Lagrangeva</em> metoda ne zahteva reševanja sistema enačb in je s stališča števila računskih operacij (narašča sorazmerno z <span class="math notranslate nohighlight">\(n^2\)</span> (<a class="reference external" href="http://www.ams.org/journals/mcom/1970-24-109/S0025-5718-1970-0258240-X/S0025-5718-1970-0258240-X.pdf">vir</a>)) boljša od predhodno predstavljene polinomske interpolacije (število operacij narašča sorazmerno z <span class="math notranslate nohighlight">\(n^3\)</span>), kjer smo reševali sistem linearnih enačb. Rešitev pa je seveda popolnoma enaka!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;c_TbU8XBHsw&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/c_TbU8XBHsw"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>Lagrangev interpolacijski polinom stopnje <span class="math notranslate nohighlight">\(n-1\)</span> je definiran kot:</p>
<div class="math notranslate nohighlight">
\[
P_{n-1}(x)=\sum_{i=0}^{n-1}y_i\,l_i(x),
\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(l_i\)</span> Lagrangev polinom:</p>
<div class="math notranslate nohighlight">
\[
l_i(x)=\prod_{j=0, j\ne i}^{n-1} \frac{x-x_j}{x_i-x_j}.
\]</div>
<p>Poglejmo si interpolacijo za zgoraj prikazane <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(y\)</span> podatke.</p>
<p>Definirajmo najprej Lagrangeve polinome <span class="math notranslate nohighlight">\(l_i(x)=\prod_{j=0, j\ne i}^{n-1} \frac{x-x_j}{x_i-x_j}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lagrange</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_int</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne vrednosti i-tega Lagrangevega polinoma</span>
<span class="sd">    </span>
<span class="sd">    x: neodvisna spremenljivka (skalar ali numerično polje)</span>
<span class="sd">    x_int: seznam interpolacijskih točk</span>
<span class="sd">    i: indeks polinoma</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Lx</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_int</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">Lx</span> <span class="o">*=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x_int</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">x_int</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x_int</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Lx</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slika</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">xint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">lagrange</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">x_int</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Lagrangev polinom i=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slika</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f51f82dd02399a65807eefa41a4b0a3e33e16547c78d80e98be8146af53676b1.png" src="_images/f51f82dd02399a65807eefa41a4b0a3e33e16547c78d80e98be8146af53676b1.png" />
</div>
</div>
<p>Opazimo, da ima <span class="math notranslate nohighlight">\(i\)</span>-ti Lagrangev polinom v <span class="math notranslate nohighlight">\(x_i\)</span> vrednost 1, v ostalih podanih točkah pa nič!</p>
<p>Če torej Lagrangev polinom za <span class="math notranslate nohighlight">\(i=0\)</span> pomnožimo z <span class="math notranslate nohighlight">\(y_0\)</span>, bomo pri <span class="math notranslate nohighlight">\(x=x_0\)</span> dobili pravo vrednost, v ostalih interpolacijskih točkah pa nič; implementirajmo torej Lagrangev interpolacijski polinom:</p>
<div class="math notranslate nohighlight">
\[
P_{n-1}(x)=\sum_{i=0}^{n-1}y_i\,l_i(x),
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lagrange_interpolacija</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_int</span><span class="p">,</span> <span class="n">y_int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne vrednosti Lagrangeve interpolacije</span>
<span class="sd">    </span>
<span class="sd">    x: neodvisna spremenljivka (skalar ali numerično polje)</span>
<span class="sd">    x_int: abscisa interpolacijskih točk</span>
<span class="sd">    y_int: ordinata interpolacijskih točk</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_int</span><span class="p">)):</span>
        <span class="n">Lx</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_int</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">Lx</span> <span class="o">*=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x_int</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">x_int</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x_int</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="n">y_int</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">Lx</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slika</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">xint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">lagrange</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">x_int</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Lagrangev polinom i=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">lagrange_interpolacija</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">x_int</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y_int</span><span class="o">=</span><span class="n">y</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Lagrangev int polinom&#39;</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Iz <code class="docutils literal notranslate"><span class="pre">ipywidgets</span></code> uvozimo <code class="docutils literal notranslate"><span class="pre">interact</span></code>, ki je močno orodje za avtomatsko generiranje (preprostega) uporabniškega vmesnika znotraj <code class="docutils literal notranslate"><span class="pre">jupyter</span></code> okolja. Tukaj bomo uporabili relativno preprosto interakcijo s sliko; za pregled vseh zmožnosti pa radovednega bralca naslavljamo na <a class="reference external" href="http://ipywidgets.readthedocs.io/en/latest/examples/Using%20Interact.html">dokumentacijo</a>.</p>
<p>Uvoz funkcije <code class="docutils literal notranslate"><span class="pre">interact</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">slika</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "dbe385c8f58948329a42d935f91ad1a4"}</script></div>
</div>
<p>Iz slike vidimo, da ima Lagrangev polinom <span class="math notranslate nohighlight">\(i\)</span> samo pri <span class="math notranslate nohighlight">\(x_i\)</span> vrednost 1 v ostalih točkah <span class="math notranslate nohighlight">\(\ne i\)</span> pa ima vrednosti nič; ko Lagrangev polinom <span class="math notranslate nohighlight">\(l_i(x)\)</span> pomnožimo z <span class="math notranslate nohighlight">\(y_i\)</span> zadostimo <span class="math notranslate nohighlight">\(i\)</span>-ti točki iz tabele. Posledično Lagrangeva interpolacija z vsoto Lagrangevih polinomov interpolira tabelo.</p>
<p>Polinomska interpolacija pri velikem številu točk je lahko slabo pogojena naloga in zato jo odsvetujemo.</p>
<section id="ocena-napake">
<h3>Ocena napake<a class="headerlink" href="#ocena-napake" title="Permalink to this heading">#</a></h3>
<p>Če je <span class="math notranslate nohighlight">\(f(x)\)</span> funkcija, ki jo interpoliramo in je <span class="math notranslate nohighlight">\(P_{n-1}(x)\)</span> interpolacijski polinom stopnje <span class="math notranslate nohighlight">\(n-1\)</span>, potem se lahko pokaže (glejte npr.: Burden, Faires, Burden: Numerical Analysis), da je napaka interpolacije s polinomom:</p>
<div class="math notranslate nohighlight">
\[
e=f(x)-P_{n-1}(x)=\frac{f^{(n)}(\xi)}{n!}\,(x-x_0)\,(x-x_1)\,\cdots\,(x-x_{n-1}),
\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(f^{(n)}\)</span> odvod funkcije, <span class="math notranslate nohighlight">\(n-1\)</span> stopnja interpolacijskega polinoma in <span class="math notranslate nohighlight">\(\xi\)</span> vrednost na interpoliranem intervalu <span class="math notranslate nohighlight">\([x_0, x_{n-1}]\)</span>.</p>
</section>
<section id="zgled">
<h3>Zgled<a class="headerlink" href="#zgled" title="Permalink to this heading">#</a></h3>
<p>Tukaj si bomo ogledali interpolacijo točk:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.52359878</span><span class="p">,</span>  <span class="mf">1.04719755</span><span class="p">,</span>  <span class="mf">1.57079633</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>       <span class="p">,</span>  <span class="mf">0.5</span>      <span class="p">,</span>  <span class="mf">0.8660254</span><span class="p">,</span>  <span class="mf">1.</span>       <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Točke prikažimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a9231f2c46b4b8bd44d6d77427b37dc2c8128ab3e24643df90a7982d38595242.png" src="_images/a9231f2c46b4b8bd44d6d77427b37dc2c8128ab3e24643df90a7982d38595242.png" />
</div>
</div>
<p>Linearna interpolacija za vrednost pri <code class="docutils literal notranslate"><span class="pre">x=1.57079633/2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_linearna</span> <span class="o">=</span> <span class="n">lagrange_interpolacija</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_int</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">y_int</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">y_linearna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6830127
</pre></div>
</div>
</div>
</div>
<p>Kvadratna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_kvadratna</span> <span class="o">=</span> <span class="n">lagrange_interpolacija</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_int</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">y_int</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">y_kvadratna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6997595236464176
</pre></div>
</div>
</div>
</div>
<p>Kubična</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_kubična</span> <span class="o">=</span> <span class="n">lagrange_interpolacija</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_int</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y_int</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">y_kubična</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.705889286844634
</pre></div>
</div>
</div>
</div>
</section>
<section id="zgled-ocene-napake">
<h3>Zgled ocene napake<a class="headerlink" href="#zgled-ocene-napake" title="Permalink to this heading">#</a></h3>
<p>Pri interpolaciji ponavadi funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> ne poznamo in napako ocenimo s pomočjo formule:</p>
<div class="math notranslate nohighlight">
\[
e=\frac{f^{(n)}(\xi)}{n!}\,(x-x_0)\,(x-x_1)\,\cdots\,(x-x_n).
\]</div>
<p>Pri tem vrednost <span class="math notranslate nohighlight">\(\xi\)</span>  ni znana; ker je v primeru linearne interpolacije (<span class="math notranslate nohighlight">\(n=2\)</span>) drugi odvod sinusne funkcije (<span class="math notranslate nohighlight">\(f^{(n)}\)</span>) med -1 in +1, velja:</p>
<div class="math notranslate nohighlight">
\[
|e|\le\left|\frac{-1}{2!}\,(\pi/4-\pi/6)\,(\pi/4-\pi/3)\right|=\frac{1}{2}\,\frac{\pi}{12}\,\frac{\pi}{12}=\frac{\pi^2}{288}=0,034
\]</div>
<p>Poleg <strong>Lagrangeve metode</strong> bi si tukaj lahko pogledali še <strong>Newtonovo metodo</strong> interpolacije.</p>
</section>
<section id="interpolacija-z-uporabo-scipy">
<h3>Interpolacija z uporabo <code class="docutils literal notranslate"><span class="pre">scipy</span></code><a class="headerlink" href="#interpolacija-z-uporabo-scipy" title="Permalink to this heading">#</a></h3>
<p>Poglejmo si interpolacijo v okviru modula <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">dokumentacija</a>).</p>
<p>Uporabili bomo funkcijo za interpoliranje tabele z zlepki, <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html#scipy.interpolate.interp1d">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">nan</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Podati moramo vsaj dva parametra: seznama interpolacijskih točk <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code>. Privzeti parameter <code class="docutils literal notranslate"><span class="pre">kind='linear'</span></code> pomeni, da inteproliramo z odsekoma linearno funkcijo. <code class="docutils literal notranslate"><span class="pre">interp1d</span></code> vrne funkcijo <code class="docutils literal notranslate"><span class="pre">f</span></code>, ki jo kličemo (npr. <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>) za izračun interpolirane vrednosti.</p>
<p>Parameter <code class="docutils literal notranslate"><span class="pre">kind</span></code> je lahko npr. tudi: <code class="docutils literal notranslate"><span class="pre">'zero'</span></code>, <code class="docutils literal notranslate"><span class="pre">'slinear'</span></code>, <code class="docutils literal notranslate"><span class="pre">'quadratic'</span></code> in <code class="docutils literal notranslate"><span class="pre">'cubic'</span></code>; takrat se uporabi interpolacijski zlepek (ang. <em>spline</em>) reda 0, 1, 2 oz. 3. Zlepke si bomo pogledali v naslednjem poglavju.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo tabelo podatkov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.14285714</span><span class="p">,</span>  <span class="mf">3.28571429</span><span class="p">,</span>  <span class="mf">4.42857143</span><span class="p">,</span>  <span class="mf">5.57142857</span><span class="p">,</span>
        <span class="mf">6.71428571</span><span class="p">,</span>  <span class="mf">7.85714286</span><span class="p">,</span>  <span class="mf">9.</span>        <span class="p">])</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.84147098</span><span class="p">,</span>  <span class="mf">0.84078711</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14362322</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95999344</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.65316501</span><span class="p">,</span>
        <span class="mf">0.41787078</span><span class="p">,</span>  <span class="mf">0.999995</span>  <span class="p">,</span>  <span class="mf">0.41211849</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">x_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">20</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_g</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacija&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/69b572eef8e658a550d2ac735dd1c26fb833c04636157cc7a1bb5e4b5df9d5b4.png" src="_images/69b572eef8e658a550d2ac735dd1c26fb833c04636157cc7a1bb5e4b5df9d5b4.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="kubicni-zlepki">
<h2>Kubični zlepki<a class="headerlink" href="#kubicni-zlepki" title="Permalink to this heading">#</a></h2>
<p>Preden gremo v teorijo zlepkov, si poglejmo rezultat, ki ga dobimo s klicanjem funkcije <code class="docutils literal notranslate"><span class="pre">interp1d</span></code> s parametrom <code class="docutils literal notranslate"><span class="pre">kind='cubic'</span></code> (rezultat je kubični zlepek).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_g</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kubični zlepek&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_g</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d19ab8ddb11a81c24bb941960d1f9c498cf1385d8e987e8c085e55daf1ce5fe0.png" src="_images/d19ab8ddb11a81c24bb941960d1f9c498cf1385d8e987e8c085e55daf1ce5fe0.png" />
</div>
</div>
<p>Kubični zlepki so pogost način interpolacije.</p>
<p>Zahtevamo, da je: <span class="math notranslate nohighlight">\(x_0&lt;x_1&lt; \cdots &lt;x_n\)</span>.</p>
<p>Od točke <span class="math notranslate nohighlight">\(x_i\)</span> do <span class="math notranslate nohighlight">\(x_{i+1}\)</span> naj bo zlepek
polinom:</p>
<div class="math notranslate nohighlight">
\[
f_{i,i+1}(x)= a_{i,3}\,x^3+a_{i,2}\,x^2+a_{i,1}\,x+a_{i,0},
\]</div>
<p>pri čemer so neznane vrednosti konstant <span class="math notranslate nohighlight">\(a_{i,j}\)</span>.</p>
<p>Če imamo na primer <span class="math notranslate nohighlight">\(n+1\)</span> točk, potem je treba določiti <span class="math notranslate nohighlight">\(n\)</span> polinomov.</p>
<p>Celotni zlepek čez <span class="math notranslate nohighlight">\(n+1\)</span> točk je definiran z:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x) = \left\{
\begin{array}{rcl}
f_{0,1}(x); &amp;&amp; x\in[x_0, x_1)\\
f_{1,2}(x); &amp;&amp; x\in[x_1, x_2)\\
&amp;\vdots&amp;\\
f_{n-1,n}(x); &amp;&amp; x\in[x_{n-1}, x_n]
\end{array}
\right.
\end{split}\]</div>
<p>Vsak polinom <span class="math notranslate nohighlight">\(f_{i,i+1}\)</span> je definiran s 4 konstantami <span class="math notranslate nohighlight">\(a_{i,j}\)</span>; skupaj torej moramo izračunati <span class="math notranslate nohighlight">\(4n\)</span> konstant <span class="math notranslate nohighlight">\(a_{i,j}\)</span>.</p>
<p><strong>Kako določimo konstante <span class="math notranslate nohighlight">\(a_{i,j}\)</span>?</strong></p>
<p>Za določitev <span class="math notranslate nohighlight">\(4n\)</span> neznak potrebujemo <span class="math notranslate nohighlight">\(4n\)</span> enačb. Poglejmo si, kako jih dobimo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> enačb dobimo iz interpolacijskega pogoja: $<span class="math notranslate nohighlight">\(y_i=f_{i,i+1}(x_i),\quad i=0,1,2,\dots,n-1\)</span>$</p></li>
<li><p>1 enačbo iz zadnje točke: $<span class="math notranslate nohighlight">\(y_n=f_{n-1,n}(x_n)\)</span>$</p></li>
<li><p><span class="math notranslate nohighlight">\(3(n-1)\)</span> enačb dobimo iz pogoja <span class="math notranslate nohighlight">\(C^2\)</span>zveznosti:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\lim_{x\rightarrow x_i^-}f(x)=\lim_{x\rightarrow x_i^+}f(x),
\]</div>
<div class="math notranslate nohighlight">
\[
\lim_{x\rightarrow x_i^-}f'(x)=\lim_{x\rightarrow x_i^+}f'(x)
\]</div>
<p>in</p>
<div class="math notranslate nohighlight">
\[
\lim_{x\rightarrow x_i^-}f''(x)=\lim_{x\rightarrow x_i^+}f''(x).
\]</div>
<p>Skupaj imamo definiranih <span class="math notranslate nohighlight">\(4n-2\)</span> enačbi, manjkata torej še dve!</p>
<p>Različni tipi zlepkov se ločijo po tem, kako ti dve enačbi določimo. V nadaljevanju si bomo pogledali <em>naravne kubične zlepke</em>.</p>
<section id="naravni-kubicni-zlepki">
<h3>Naravni kubični zlepki<a class="headerlink" href="#naravni-kubicni-zlepki" title="Permalink to this heading">#</a></h3>
<p><em>Naravni kubični zlepki</em> temeljijo na ideji Eulerjevega nosilca:</p>
<div class="math notranslate nohighlight">
\[
E\,I\,\frac{\textrm{d}^4y}{\textrm{d}x^4}=q(x),
\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(E\)</span> elastični modul, <span class="math notranslate nohighlight">\(I\)</span> drugi moment preseka in <span class="math notranslate nohighlight">\(q(x)\)</span> zunanja porazdeljena sila. Ker zunanje porazdeljene sile ni (<span class="math notranslate nohighlight">\(q(x)=0\)</span>), velja:</p>
<div class="math notranslate nohighlight">
\[
E\,I\,\frac{\textrm{d}^4y}{\textrm{d}x^4}=0.
\]</div>
<p>Sledi, da lahko v vsaki točki tanek nosilec popišemo s polinomom tretje stopnje.</p>
<p><span class="math notranslate nohighlight">\(C^2\)</span> zveznost je zagotovljena v kolikor so vmesne podpore nosilca členki (moment zato nima nezvezne spremembe).</p>
<p>Manjkajoči 2 neznanki pri naravnih kubičnih zlepkih določimo iz pogoja, da je moment na koncih enak nič (členkasto vpetje):</p>
<div class="math notranslate nohighlight">
\[
f''(x_{0})=0\qquad\textrm{in}\qquad f''(x_{n})=0
\]</div>
<p>Izpeljava je natančneje prikazana v knjigi Kiusalaas J: Numerical Methods in Engineering with Python 3, 2013, stran 120 (glejte tudi J. Petrišič: Interpolacija, Fakulteta za strojništvo, 1999); podrobna izpeljava presega namen te knjige.</p>
<p>Tukaj si bomo pogledali samo končni rezultat, ki ga lahko izpeljemo ob zgornjih pogojih. V primeru ekvidistantne delitve <span class="math notranslate nohighlight">\(h=x_{i+1}-x_i\)</span> tako izpeljemo sistem enačb (<span class="math notranslate nohighlight">\(i=1,\dots,n-1\)</span>):</p>
<div class="math notranslate nohighlight">
\[
k_{i-1} + 4 k_{i} + k_{i+1}  =  \frac{6}{h^2} \left(y_{i-1} -2 y_{i} +y_{i+1} \right).
\]</div>
<p>kjer je neznanka <span class="math notranslate nohighlight">\(k_i\)</span> drugi odvod odsekovne funkcije <span class="math notranslate nohighlight">\(k_i = f''_{i,i+1}(x_i)\)</span>.</p>
<p>Rešljiv sistem enačb dobimo, če dodamo še robna pogoja za naravne kubične zlepke:</p>
<div class="math notranslate nohighlight">
\[
k_0=k_n=0.
\]</div>
<p>Ko določimo neznake <span class="math notranslate nohighlight">\(k_i\)</span>, jih uporabimo v odsekoma definirani funkciji:</p>
<div class="math notranslate nohighlight">
\[
f_{i,i+1}(x)=\frac{k_i}{6}\left(\frac{(x-x_{i+1})^3}{h}-(x-x_{i+1})\,h\right)
-\frac{k_{i+1}}{6}\left(\frac{(x-x_{i})^3}{h}-(x-x_{i})\,h\right)
+\frac{y_i\,(x-x_{i+1})-y_{i+1}\,(x-x_{i})}{h}.
\]</div>
</section>
<section id="numericna-implementacija">
<h3>Numerična implementacija<a class="headerlink" href="#numericna-implementacija" title="Permalink to this heading">#</a></h3>
<p>Najprej pripravimo funkcijo, katera za podane interpolacijske točke reši sistem linearnih enačb in vrne koeficiente <span class="math notranslate nohighlight">\(k_i\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kubicni_zlepki_koeficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne koeficiente kubičnih zlepkov `k`, matriko koeficientov `A` in konstant.</span>
<span class="sd">    </span>
<span class="sd">    x in y predstavljata seznam znanih vrednosti; x mora biti ekvidistanten.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="c1"># pripravimo matriko koeficientov</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># korak h</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c1"># k_0 in k_n sta nič zato tukaj damo 1</span>
                       <span class="c1"># pri vektorju konstant pa bomo dali 0, k_0 in k_n bosta torej 0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span> <span class="c1"># desna stran zgornje enačbe</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<p>Opomba: pri zgornjem linearnem problemu, lahko izračun zelo pohitrimo, če upoštevamo tridiagonalnost matrike koeficientov! (Glejte <a class="reference external" href="https://stackoverflow.com/questions/23120164/optimize-ax-b-solution-for-a-tridiagonal-coefficient-matrix">odgovor na stackoverflow.com</a>).</p>
<p>Poglejmo si primer izračuna koeficientov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">kubicni_zlepki_koeficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Matrika koeficientov A lin. sistema:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vektor konstant b lin. sistema:     &#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Koeficienti k so:&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matrika koeficientov A lin. sistema:
 [[1. 0. 0. 0. 0.]
 [1. 4. 1. 0. 0.]
 [0. 1. 4. 1. 0.]
 [0. 0. 1. 4. 1.]
 [0. 0. 0. 0. 1.]]
Vektor konstant b lin. sistema:      [  0. -12.  12. -12.   0.]
Koeficienti k so: [ 0.         -4.28571429  5.14285714 -4.28571429  0.        ]
</pre></div>
</div>
</div>
</div>
<p>Nato potrebujemo še kubični polinom v določenem intervalu; implementirajmo izraz:</p>
<div class="math notranslate nohighlight">
\[
f_{i,i+1}(x)=\frac{k_i}{6}\left(\frac{(x-x_{i+1})^3}{h}-(x-x_{i+1})\,h\right)
-\frac{k_{i+1}}{6}\left(\frac{(x-x_{i})^3}{h}-(x-x_{i})\,h\right)
+\frac{y_i\,(x-x_{i+1})-y_{i+1}\,(x-x_{i})}{h}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kubicni_zlepki</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_najdi</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne kubicni zlepek pri delitvi `xint`.</span>
<span class="sd">    </span>
<span class="sd">    :param k: koeficienti kubičnih zlepkov</span>
<span class="sd">    :param x in y: znane vrednosti, x mora biti ekvidistanten</span>
<span class="sd">    :param x_najdi: vrednosti kjer želimo izračunati kubični zlepek</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">x_najdi</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">//</span><span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">((</span><span class="n">x_najdi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">x_najdi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">6.0</span> \
        <span class="o">-</span> <span class="p">((</span><span class="n">x_najdi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">x_najdi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">6.0</span> \
        <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_najdi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> \
        <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_najdi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">/</span><span class="n">h</span>
    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunamo interpolirane vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">yint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">kubicni_zlepki</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xint</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">yint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Naravni kubični zlepek&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a1a460181d2011a5ff2033a3fddf129f4c19218a6af9224e0045711b8ccc3c74.png" src="_images/a1a460181d2011a5ff2033a3fddf129f4c19218a6af9224e0045711b8ccc3c74.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic">
<li><p>Preštudirajte Lagrangevo polinomsko interpolacijo in pripravite funkcijo za Lagrangeve polinome. Pojasnite (z grafičnim prikazom) Lagrangeve polinome.</p></li>
<li><p>Definirajte funkcijo za Lagrangevo polinomsko interpolacijo. Na primeru pojasnite, kako deluje.</p></li>
<li><p>Pojasnite teoretično ozadje naravnih kubičnih zlepkov.</p></li>
<li><p>Naravne kubične zlepke smo izpeljali pod pogojem, da momenta na koncu ni; včasih želimo drugačne pogoje na koncih (npr. znani naklon ali znani moment). Modificirajte na predavanjih predstavljeno kodo za primer, da je na koncih moment <span class="math notranslate nohighlight">\(\ne 0\)</span> (predpostavite neko numerično vrednost).</p></li>
<li><p>Podatke:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span>
</pre></div>
</div>
</li>
</ol>
<p>interpolirajte z uporabo <code class="docutils literal notranslate"><span class="pre">scipy.InterpolatedUnivariateSpline</span></code>. Podatke prikažite.
6. Za zgoraj definirane podatke preučite pomoč in najdite vse ničle. Prikažite jih na predhodni sliki.
7. Za zgoraj definirani zlepek izračunajte prvi odvod in ga prikažite.
8. Za zgoraj definirani zlepek izračunajte določeni integral od začetka do konca.
9. Za zgoraj definirane podatke z uporabo vgrajenih funkcij prikažite izračun linearnega in kvadratnega zlepka. Prikažite na sliki.
10. Preučite pomoč za funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.lagrange</span></code> in k predhodni sliki dodajte Lagrangev interpolacijski polinom. Komentirajte rezultate.
11. Preučite pomoč za funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d</span></code> in k predhodni sliki dodajte kvadratni zlepek.
12. Preučite pomoč za funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.BarycentricInterpolator</span></code> in pojasnite ter prikažite njeno prednost.
13. Preučite pomoč za funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.KroghInterpolator</span></code> in pojasnite njeno prednost.</p>
<section id="dodatno">
<h3>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>2D interpolacija: <a class="reference external" href="https://www.youtube.com/watch?v=_cJLVhdj0j4">https://www.youtube.com/watch?v=_cJLVhdj0j4</a></p></li>
<li><p>Strojno prevajanje: <a class="reference external" href="https://pypi.org/project/goslate">https://pypi.org/project/goslate</a>)</p></li>
</ul>
</section>
<section id="nekaj-komentarjev-modula-scipy-interpolate">
<h3>Nekaj komentarjev modula <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code><a class="headerlink" href="#nekaj-komentarjev-modula-scipy-interpolate" title="Permalink to this heading">#</a></h3>
<p>SciPy ima implementiranih večje število različnih interpolacij (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">glejte dokumentacijo</a>). S stališča uporabe se bomo tukaj dotaknili  objektne implementacije <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.InterpolatedUnivariateSpline</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.InterpolatedUnivariateSpline.html">dokumentacija</a>) (starejši pristop temelji na funkcijskem programiranju, glejte  <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.splrep.html">dokumentacijo</a> <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.splrep</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Pri inicializaciji objekta <code class="docutils literal notranslate"><span class="pre">InterpolatedUnivariateSpline</span></code> moramo posredovati interpolacijske točke <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code>. Argument <code class="docutils literal notranslate"><span class="pre">k</span></code> s privzeto vrednostjo <code class="docutils literal notranslate"><span class="pre">k=3</span></code> definira red intepolacijskega zlepka (<code class="docutils literal notranslate"><span class="pre">1&lt;=k&lt;=5</span></code>). Pomemben opcijski parameter je tudi <code class="docutils literal notranslate"><span class="pre">w</span></code>, ki definira uteži posameznim interpolacijskim točkam (uporabimo ga, če želimo določenim področjem dati večji poudarek).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">InterpolatedUnivariateSpline</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spl</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># poglejte opcije!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacijske točke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">spl</span><span class="p">(</span><span class="n">xint</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kubični zlepek&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spl</span><span class="o">.</span><span class="n">get_knots</span><span class="p">(),</span> <span class="n">spl</span><span class="p">(</span><span class="n">spl</span><span class="o">.</span><span class="n">get_knots</span><span class="p">()),</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Vozli B-zlepkov&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">yint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Naravni kubični zlepki - lastna koda&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9702452749f152f8a3abcf5c4a1335be173d254b3719bc9fe02cc3a0a50dde1.png" src="_images/b9702452749f152f8a3abcf5c4a1335be173d254b3719bc9fe02cc3a0a50dde1.png" />
</div>
</div>
<p>Ker gre za B-zlepke, je rezultat drugačen kot tisti, ki smo ga izpeljali z naravnimi kubičnimi zlepki. V nasprotju z naravnimi kubičnimi zlepki, ki imajo vozle (angl. <em>knots</em>) v interpolacijskih točkah, se vozli B-zlepkov prilagodijo podatkom. V konkretnem primeru so vozli v točkah:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spl</span><span class="o">.</span><span class="n">get_knots</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 3., 5.])
</pre></div>
</div>
</div>
</div>
</section>
<section id="odvajanje-integriranje-zlepkov">
<h3>Odvajanje, integriranje … zlepkov<a class="headerlink" href="#odvajanje-integriranje-zlepkov" title="Permalink to this heading">#</a></h3>
<p>Zlepke lahko odvajamo in integriramo, saj so polinomi. Objekt <code class="docutils literal notranslate"><span class="pre">InterpolatedUnivariateSpline</span></code> je tako že pripravljen za odvajanje, integriranje, iskanje korenov (ničel), vozlov … (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.InterpolatedUnivariateSpline.html">dokumentacijo</a>).</p>
<p>Za prvi odvod zlepka v objektu <code class="docutils literal notranslate"><span class="pre">spl</span></code> na primer uporabimo metodo <code class="docutils literal notranslate"><span class="pre">spl.derivative(1)</span></code>, ki vrne nov objekt zlepka (njen red je sedaj za 1 nižji):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spl1</span> <span class="o">=</span> <span class="n">spl</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#spl2 = spl.derivative(2)</span>
<span class="c1">#spl3 = spl.derivative(3)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">spl</span><span class="p">(</span><span class="n">xint</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zlepek&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xint</span><span class="p">,</span> <span class="n">spl1</span><span class="p">(</span><span class="n">xint</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prvi odvod&#39;</span><span class="p">)</span>
<span class="c1">#plt.plot(xint, spl2(xint), label=&#39;Drugi odvod&#39;)</span>
<span class="c1">#plt.plot(xint, spl3(xint), label=&#39;Tretji odvod&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Znane vrednosti&#39;</span><span class="p">)</span>
<span class="c1">#plt.plot(spl.get_knots(), spl(spl.get_knots()), &#39;k.&#39;, label=&#39;Vozli B-zlepka&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9d0f959b56e57693d3cedef41fff5214f1915959d67e595ed1839143d9d3eef9.png" src="_images/9d0f959b56e57693d3cedef41fff5214f1915959d67e595ed1839143d9d3eef9.png" />
</div>
</div>
</section>
</section>
<span id="document-notebooks/Predavanje 08 - Aproksimacija"></span><section class="tex2jax_ignore mathjax_ignore" id="aproksimacija">
<h2>Aproksimacija<a class="headerlink" href="#aproksimacija" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h2>Uvod<a class="headerlink" href="#uvod" title="Permalink to this heading">#</a></h2>
<p>V strojniški praksi se pogosto srečamo s tabelo podatkov, ki so lahko obremenjeni z merilnimi ali numeričnimi napakami.</p>
<p>Oglejmo si primer meritve (linearne) vzmeti (<span class="math notranslate nohighlight">\(x\)</span> je raztezek, <span class="math notranslate nohighlight">\(y\)</span> je pomerjena sila):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span>  <span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.9</span>  <span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.22</span><span class="p">,</span> <span class="mf">18.15</span><span class="p">,</span> <span class="mf">44.33</span><span class="p">,</span> <span class="mf">75.59</span><span class="p">,</span> <span class="mf">105.63</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si podatke na sliki, najprej uvozimo potrebne pakete:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pomik $x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sila $y$&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f908d0c402f71734d0c251f6d4ad11e0aa2022144b0401b5d7926e17d37d0fee.png" src="_images/f908d0c402f71734d0c251f6d4ad11e0aa2022144b0401b5d7926e17d37d0fee.png" />
</div>
</div>
<p>Za konkreten primer bi bilo, glede na poznavanje fizikalnega ozadja linearne vzmeti, primerno, da bi meritve poskušali popisati z linearno funkcijo:
$<span class="math notranslate nohighlight">\(f(x) = a_0\,x+ a_1\)</span>$</p>
<p>Poznamo tabelo <span class="math notranslate nohighlight">\(n\)</span> podatkov <span class="math notranslate nohighlight">\(x_i, y_i\)</span> za <span class="math notranslate nohighlight">\(i=0,1,\dots,n-1\)</span>; teh je več, kot jih potrebujemo za določitev dveh konstant <span class="math notranslate nohighlight">\(a_0\)</span> in <span class="math notranslate nohighlight">\(a_1\)</span>, zato imamo torej predoločen sistem linearnih enačb:</p>
<div class="math notranslate nohighlight">
\[y_i=a_0\,x_i+a_1\quad\textrm{za}\quad i=0,1,\dots,n-1.\]</div>
<p>Iščemo taki vrednosti konstanti <span class="math notranslate nohighlight">\(a_0\)</span> in <span class="math notranslate nohighlight">\(a_1\)</span>, da se bo funkcija <span class="math notranslate nohighlight">\(f(x)\)</span> v znanih točkah <span class="math notranslate nohighlight">\(x_i\)</span> <em>najbolje</em> ujemala z <span class="math notranslate nohighlight">\(y_i\)</span>.</p>
<p>Najprej torej potrebujemo kriterij za <em>najboljše</em> ujemanje.</p>
<p>Za vrednosti iz tabele <span class="math notranslate nohighlight">\(x_i, y_i\)</span> bi lahko iskali vrednosti <span class="math notranslate nohighlight">\(a_0\)</span> in <span class="math notranslate nohighlight">\(a_1\)</span>, pri katerih bi bila vsota absolutne vrednosti odstopkov <span class="math notranslate nohighlight">\(S\)</span> najmanjša:</p>
<div class="math notranslate nohighlight">
\[P(a_0, a_1) = \sum_{i=0}^{n-1} |y_i - (a_0\,x_i+a_1)|.\]</div>
<p>Ker pa taka funkcija <span class="math notranslate nohighlight">\(P(a_0, a_1)\)</span> ni zvezno odvedljiva,raje uporabimo <strong>metodo najmanjših kvadratov</strong>:</p>
<div class="math notranslate nohighlight">
\[S(a_0, a_1) = \sum_{i=0}^{n-1} \left(y_i - (a_0\,x_i+a_1)\right)^2.\]</div>
<p>Takšna funkcija <span class="math notranslate nohighlight">\(S(a_0, a_1)\)</span> je zvezna in zvezno odvedljiva. S parcialnim odvajanjem po parametrih <span class="math notranslate nohighlight">\(a_0\)</span> in <span class="math notranslate nohighlight">\(a_1\)</span> lahko najdemo stacionarno točko (parcialna odvoda sta enaka 0). Postopek si bomo za linearno funkcijo pogledali v naslednjem poglavju.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="metoda-najmanjsih-kvadratov-za-linearno-funkcijo">
<h2>Metoda najmanjših kvadratov za linearno funkcijo<a class="headerlink" href="#metoda-najmanjsih-kvadratov-za-linearno-funkcijo" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;8-oixY6GG9E&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/8-oixY6GG9E"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>Poiskati moramo konstanti <span class="math notranslate nohighlight">\(a_0\)</span>, <span class="math notranslate nohighlight">\(a_1\)</span>, da bo vsota kvadratov razlik med funkcijo in tabelirano vrednostjo (<span class="math notranslate nohighlight">\(x_i, y_i\)</span>, kjer <span class="math notranslate nohighlight">\(i=0,1,\dots, n-1\)</span> in je <span class="math notranslate nohighlight">\(n\)</span> število tabeliranih podatkov):</p>
<div class="math notranslate nohighlight">
\[S(a_0, a_1) = \sum_{i=0}^{n-1} \left(y_i - (a_0\,x_i+a_1)\right)^2\]</div>
<p>najmanjša. Vrednost bo najmanjša v stacionarni točki, ki jo določimo s parcialnim odvodom po parametrih <span class="math notranslate nohighlight">\(a_0\)</span> in <span class="math notranslate nohighlight">\(a_1\)</span>.</p>
<p>Najprej izvedemo parcialni odvod po parametru <span class="math notranslate nohighlight">\(a_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial S(a_0, a_1)}{\partial a_0} = 2\,\sum_{i=0}^{n-1} \left(y_i - a_0\,x_i-a_1\right)\,(-x_i)\]</div>
<p>Izraz uredimo:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial S(a_0, a_1)}{\partial a_0} =-2\left(\sum_{i=0}^{n-1} y_i\,x_i -a_0\,\sum_{i=0}^{n-1} x_i^2- a_1\,\sum_{i=0}^{n-1} x_i\right)\]</div>
<p>Podobno postopamo še za <span class="math notranslate nohighlight">\(a_1\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial S(a_0, a_1)}{\partial a_1} = 2\,\sum_{i=0}^{n-1} \left(y_i  - a_0\,x_i- a_1\right)\,(-1)\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial S(a_0, a_1)}{\partial a_1} = -2\left(\sum_{i=0}^{n-1} y_i -a_0\,\sum_{i=0}^{n-1} x_i- a_1\,\sum_{i=0}^{n-1}1\right)\]</div>
<p>Ker v stacionarni točki velja <span class="math notranslate nohighlight">\(\partial S(a_0, a_1)/\partial a_0=0\)</span> in <span class="math notranslate nohighlight">\(\partial S(a_0, a_1)/\partial a_1=0\)</span>, iz zgornjih izrazov izpeljemo:</p>
<div class="math notranslate nohighlight">
\[a_0\,\sum_{i=0}^{n-1} x_i^2 + a_1\,\sum_{i=0}^{n-1} x_i=\sum_{i=0}^{n-1} y_i\,x_i\]</div>
<p>in</p>
<div class="math notranslate nohighlight">
\[a_0\,\sum_{i=0}^{n-1} x_i+ a_1\,n=\sum_{i=0}^{n-1} y_i.\]</div>
<p>Dobili smo sistem dveh linearnih enačb za neznanki <span class="math notranslate nohighlight">\(a_0\)</span> in <span class="math notranslate nohighlight">\(a_1\)</span>, ki ga znamo rešiti. Imenujemo ga <em>normalni sistem</em> (število enačb je enako številu neznank).</p>
<p>Zapišimo normalni sistem v matrični obliki:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)],</span> <span class="c1"># matrika koeficientov</span>
     <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>    <span class="c1"># vektor konstant</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A:&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A: [[30.8725 10.35  ]
 [10.35    5.    ]]
b: [764.7085 243.92  ]
</pre></div>
</div>
</div>
</div>
<p>Sedaj moramo rešiti linearni sistem:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,\mathbf{a}=\mathbf{b},\]</div>
<p>Opomba, tukaj smo vektor neznank zapisali kot <span class="math notranslate nohighlight">\(\mathbf{a}=(a_0, a_1)\)</span>.</p>
<p>Sistem rešimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a0</span><span class="p">,</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">a0</span><span class="p">,</span> <span class="n">a1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(27.49725867908551, -8.135325465707005)
</pre></div>
</div>
</div>
</div>
<p>Preverimo še število pogojenosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.20071350870242
</pre></div>
</div>
</div>
</div>
<p>Sedaj si bomo pogledali še rezultat. Najprej pripravimo sliko, ki bo vsebovala tudi informacijo o vsoti kvadratov odstopanja <span class="math notranslate nohighlight">\(f(x_i)\)</span> od tabeliranih vrednosti <span class="math notranslate nohighlight">\(y_i\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slika</span><span class="p">(</span><span class="n">naklon</span><span class="o">=</span><span class="n">a0</span><span class="p">,</span> <span class="n">premik</span><span class="o">=</span><span class="n">a1</span><span class="p">):</span>
    <span class="n">d</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">def</span> <span class="nf">linearna_f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a0</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">a1</span>
    <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">f</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tabela podatkov&#39;</span><span class="p">)</span>
    <span class="n">linearna_f1</span> <span class="o">=</span> <span class="n">linearna_f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">naklon</span><span class="p">,</span> <span class="n">premik</span><span class="p">)</span>
    <span class="n">linearna_f1_MNK</span> <span class="o">=</span> <span class="n">linearna_f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linearna_f1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Izbrani parametri&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linearna_f1_MNK</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Metoda najmanjših kvadratov&#39;</span><span class="p">)</span>
    <span class="n">napaka</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linearna_f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">naklon</span><span class="p">,</span> <span class="n">premik</span><span class="p">))</span>
    <span class="n">sprememba_napake_v_smeri_a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linearna_f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">naklon</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">premik</span><span class="p">))</span><span class="o">-</span><span class="n">napaka</span><span class="p">)</span><span class="o">/</span><span class="n">d</span>
    <span class="n">sprememba_napake_v_smeri_a1</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linearna_f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">naklon</span><span class="p">,</span> <span class="n">premik</span><span class="o">+</span><span class="n">d</span><span class="p">))</span><span class="o">-</span><span class="n">napaka</span><span class="p">)</span><span class="o">/</span><span class="n">d</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;S: </span><span class="si">{</span><span class="n">napaka</span><span class="si">:</span><span class="s1">g</span><span class="si">}</span><span class="s1">, </span><span class="se">\</span>
<span class="s1">            $\Delta S/\Delta a_0$: </span><span class="si">{</span><span class="n">sprememba_napake_v_smeri_a0</span><span class="si">:</span><span class="s1">g</span><span class="si">}</span><span class="s1">, </span><span class="se">\</span>
<span class="s1">            $\Delta S/\Delta a_1$: </span><span class="si">{</span><span class="n">sprememba_napake_v_smeri_a1</span><span class="si">:</span><span class="s1">g</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">110</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
<span class="n">interact</span><span class="p">(</span><span class="n">slika</span><span class="p">,</span> <span class="n">naklon</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">premik</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5a70f717bf564a8abef455b42a49fb37"}</script></div>
</div>
<section id="uporaba-psevdo-inverzne-matrike">
<h3>Uporaba psevdo inverzne matrike<a class="headerlink" href="#uporaba-psevdo-inverzne-matrike" title="Permalink to this heading">#</a></h3>
<p>Do podobnega rezultata lahko pridemo z uporabo psevdo inverzne matrike. Iščemo <span class="math notranslate nohighlight">\(y(x)=a_0\,x+a_1\)</span> in nastavimo predoločen sistem <span class="math notranslate nohighlight">\(\mathbf{A}\,\mathbf{a}=\mathbf{y}\)</span>, kjer je matrika koeficientov <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> definirana glede na vrednosti <span class="math notranslate nohighlight">\(x_i\)</span> (<span class="math notranslate nohighlight">\(i=0,1,\dots,n-1\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.1 , 1.  ],
       [1.1 , 1.  ],
       [2.05, 1.  ],
       [3.2 , 1.  ],
       [3.9 , 1.  ]])
</pre></div>
</div>
</div>
</div>
<p>Vektor konstant smo označili z <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, v našem primeru pa je to kar vektor vrednosti <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> z elementi <span class="math notranslate nohighlight">\(y_i\)</span> (<span class="math notranslate nohighlight">\(i=0,1,2,\dots,n-1\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0.22,  18.15,  44.33,  75.59, 105.63])
</pre></div>
</div>
</div>
</div>
<p>Preverimo rang matrike koeficientov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>In še rang razširjene matrike:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="n">Ab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.0000e-01, 1.0000e+00, 2.2000e-01],
       [1.1000e+00, 1.0000e+00, 1.8150e+01],
       [2.0500e+00, 1.0000e+00, 4.4330e+01],
       [3.2000e+00, 1.0000e+00, 7.5590e+01],
       [3.9000e+00, 1.0000e+00, 1.0563e+02]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">Ab</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>Ker rešujemo sistem <span class="math notranslate nohighlight">\(m\)</span> linearnih enačbami z <span class="math notranslate nohighlight">\(n\)</span> neznankami ter velja <span class="math notranslate nohighlight">\(m&gt;n\)</span> in je rang razširjene matrike <span class="math notranslate nohighlight">\(n+1\)</span>, imamo predoločeni sistem.</p>
<p>Vektor konstant <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> določimo z uporabo psevdo inverzne matrike:</p>
<div class="math notranslate nohighlight">
\[\mathbf{a}=\mathbf{A}^{+}\,\mathbf{y}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([27.49725868, -8.13532547])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="metoda-najmanjsih-kvadratov-za-poljubni-polinom">
<h2>Metoda najmanjših kvadratov za poljubni polinom<a class="headerlink" href="#metoda-najmanjsih-kvadratov-za-poljubni-polinom" title="Permalink to this heading">#</a></h2>
<p>Linearno aproksimacijo, predstavljeno zgoraj, bomo posplošili za poljubni polinom stopnje <span class="math notranslate nohighlight">\(m\)</span>:</p>
<div class="math notranslate nohighlight">
\[f(a_0,a_1,\dots,a_{m}, x) = \sum_{s=0}^{m}a_s\,\underbrace{x^{m-s}}_{f_s(x)},\]</div>
<p>kjer <span class="math notranslate nohighlight">\(f_s(x)=x^{m-s}\)</span> imenujemo bazna funkcija (<span class="math notranslate nohighlight">\(s=0,1,2,\dots,m\)</span>).</p>
<p>Tabela podatkov naj bo definirana z <span class="math notranslate nohighlight">\(x_i, y_i\)</span>, kjer je <span class="math notranslate nohighlight">\(i=0,1,2,\dots,n-1\)</span>.</p>
<p>Opomba: zaradi kompaktnosti zapisa bomo konstante <span class="math notranslate nohighlight">\(a\)</span> zapisali v vektorski obliki <span class="math notranslate nohighlight">\(\mathbf{a}=[a_0, a_1,\dots,a_m]\)</span>.</p>
<p>Uporabimo metodo najmanjših kvadratov:</p>
<div class="math notranslate nohighlight">
\[S(\mathbf{a}) = \sum_{i=0}^{n-1} \left(y_i - f(\mathbf{a}, x_i)\right)^2= \sum_{i=0}^{n-1} \left(y_i - \sum_{s=0}^{m}a_s\,x_i^{m-s}\right)^2.\]</div>
<p>Potreben pogoj za nastop ekstrema funkcije <span class="math notranslate nohighlight">\(m+1\)</span> neodvisnih spremenljivk je, da najdemo stacionarno točko za vsak <span class="math notranslate nohighlight">\(a_v\)</span>, iščemo torej <span class="math notranslate nohighlight">\(\partial S(\mathbf{a})/\partial a_v=0\)</span> (namesto <span class="math notranslate nohighlight">\(s\)</span> smo uporabili indeks <span class="math notranslate nohighlight">\(v\)</span>).</p>
<p>Najprej določimo parcialni odvod za izbrani <span class="math notranslate nohighlight">\(a_v\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial S(\mathbf{a})}{\partial a_v} = \sum_{i=0}^{n-1} - 2\,\left(y_i - \sum_{s=0}^{m}a_s\,x_i^{m-s}\right)\,x_i^{m-v}\]</div>
<p>Opomba: <span class="math notranslate nohighlight">\(\frac{\partial}{\partial a_v}\left(\sum_{s=0}^{m}a_s\,x_i^{m-s}\right)=x_i^{m-v}\)</span>.</p>
<p>Ker je parcialni odvod v stacionarni točki enak 0, zgornji izraz preoblikujemo:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{n-1} \left(\sum_{s=0}^{m}a_s\,x_i^{m-s}\right)\,x_i^{m-v}=\sum_{i=0}^{n-1} y_i\,x_i^{m-v}\]</div>
<p>Izraz uredimo:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{n-1} \sum_{s=0}^m a_s\,x_i^{2m-s-v}=\sum_{i=0}^{n-1} y_i\,x_i^{m-v}\]</div>
<p>Zamenjamo vrstni red seštevanja ter izpeljemo:</p>
<div class="math notranslate nohighlight">
\[\sum_{s=0}^m \left(a_s \sum_{i=0}^{n-1} \,x_i^{2m-s-v}\right)=\sum_{i=0}^{n-1} y_i\,x_i^{m-v}\quad\textrm{za:}\quad v=0,1,\dots,m\]</div>
<p>Izpeljali smo enačbo <span class="math notranslate nohighlight">\(v\)</span> sistema <span class="math notranslate nohighlight">\(m+1\)</span> linearnih enačb:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\,{\mathbf{a}}=\mathbf{b}\]</div>
<p>Element <span class="math notranslate nohighlight">\(A_{v,s}\)</span> matrike koeficientov je:</p>
<div class="math notranslate nohighlight">
\[A_{v,s}= \sum_{i=0}^{n-1} x_i^{2m-v-s},\]</div>
<p>Element vektorja konstant je:</p>
<div class="math notranslate nohighlight">
\[b_{v}= \sum_{i=0}^{n-1} y_i\,x_i^{m-v}\]</div>
<section id="numericni-zgled">
<h3>Numerični zgled<a class="headerlink" href="#numericni-zgled" title="Permalink to this heading">#</a></h3>
<p>Uporabimo podatke iz prve naloge in poskusimo aproksimirati s polinomom 2. stopnje (<span class="math notranslate nohighlight">\(m=2\)</span>).</p>
<p>Tabela podatkov je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.1 , 1.1 , 2.05, 3.2 , 3.9 ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0.22,  18.15,  44.33,  75.59, 105.63])
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo matriko koeficientov:</p>
<div class="math notranslate nohighlight">
\[A_{v,s}= \sum_{i=0}^{n-1} x_i^{2m-v-s}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#stopnja</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">-</span><span class="n">v</span><span class="o">-</span><span class="n">s</span><span class="p">))</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[355.32690625, 102.034125  ,  30.8725    ],
       [102.034125  ,  30.8725    ,  10.35      ],
       [ 30.8725    ,  10.35      ,   5.        ]])
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo še vektor konstant:</p>
<div class="math notranslate nohighlight">
\[b_{v}= \sum_{i=0}^{n-1} y_i\,x_i^{m-v}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">b</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">v</span><span class="p">))</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2588.934425,  764.7085  ,  243.92    ])
</pre></div>
</div>
</div>
</div>
<p>Preverimo število pogojenosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>963.2125856290659
</pre></div>
</div>
</div>
</div>
<p>Rešimo sistem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.17760897, 14.67380042, -1.21091344])
</pre></div>
</div>
</div>
</div>
<p>Glede na definicijo aproksimacijskega polinoma:</p>
<div class="math notranslate nohighlight">
\[f(a_0,a_1,\dots,a_{m}, x) = \sum_{v=0}^{m}a_v\,x^{m-v}\]</div>
<p>Kar v konkretnem primeru je aproksimacijski polinom:</p>
<div class="math notranslate nohighlight">
\[f(x)=3.18393375\,x^2 + 14.64106847\,x -1.22621065\]</div>
<p>Definirajmo numerično implementacijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apr_polinom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vrne vrednosti aproksimacijskega polinoma</span>

<span class="sd">    :param x: vrednosti kjer računamo aproksimirani rezultat</span>
<span class="sd">    :param a: koeficienti aproksimacijskega polinoma</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">_</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">)]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># več točk za prikaz</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tabela podatkov&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">apr_polinom</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aproksimacija s kvadratno funkcijo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a73a7117dc1e5559cfb60bdc362797dcf3ff5dc38596bfae3865705f9a908f84.png" src="_images/a73a7117dc1e5559cfb60bdc362797dcf3ff5dc38596bfae3865705f9a908f84.png" />
</div>
</div>
<p>Poglejmo še napako aproksimacije:
$<span class="math notranslate nohighlight">\(e_i=y_i - f(x_i)\)</span>$</p>
<p>za <span class="math notranslate nohighlight">\(i=0,1,2,\dots,n-1\)</span>.</p>
<p>Pri pravilno izvedni aproksimaciji je nekaj <span class="math notranslate nohighlight">\(e_i\)</span> pozitivnih in nekaj negativnih. Poglejmo, če je to res v našem primeru:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">apr_polinom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">e</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.06824269, -0.62517387,  2.1057209 , -2.69396374,  1.28165939])
</pre></div>
</div>
</div>
</div>
<p>Opomba: višje stopnje polinoma kot uporabimo, večja je verjetnost slabe pogojenosti. Iz tega razloga s stopnjo polinoma ne pretiravamo (v praksi uporabljamo predvsem nizke stopnje)!</p>
</section>
<section id="uporaba-numpy-za-aproksimacjo-s-polinomom">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">numpy</span></code> za aproksimacjo s polinomom<a class="headerlink" href="#uporaba-numpy-za-aproksimacjo-s-polinomom" title="Permalink to this heading">#</a></h3>
<p>Poglejmo si, kako uporabimo knjižnico <code class="docutils literal notranslate"><span class="pre">numpy</span></code> za polinomsko aproksimacijo.</p>
<p>Najprej uporabimo funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.polyfit</span></code> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>ki zahteva tri parametre: <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code> predstavljata tabelo podatkov (lahko tudi v obliki seznamov vektorjev), <code class="docutils literal notranslate"><span class="pre">deg</span></code> pa stopnjo polinoma. Ostali parametri so opcijski (npr. <code class="docutils literal notranslate"><span class="pre">w</span></code> za uporabo uteži pri aproksimaciji).</p>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">polyfit</span></code> vrne seznam koeficientov polinoma (najprej za najvišji red); rezultat je lahko tudi seznam seznamov (če so vhodni podatki seznam vektorjev).</p>
<p>Poglejmo si uporabo za predhodno obravnavani primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">koef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">koef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.17760897, 14.67380042, -1.21091344])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="c1"># rezultat lastne implementacije</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.17760897, 14.67380042, -1.21091344])
</pre></div>
</div>
</div>
</div>
<p>Ko imamo koeficiente, lahko ustvarimo objekt polinoma s klicem <code class="docutils literal notranslate"><span class="pre">numpy.poly1d</span></code> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.poly1d.html#numpy.poly1d">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">poly1d</span><span class="p">(</span><span class="n">c_or_r</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer <code class="docutils literal notranslate"><span class="pre">c_or_r</span></code> predstavlja seznam koeficientov polinoma oz. ničle polinoma v primeru, da je <code class="docutils literal notranslate"><span class="pre">r=True</span></code>. Funkcija vrne instanco objekta, s klicem katere lahko izračunamo vrednosti aproksimacijskega polinoma pri <code class="docutils literal notranslate"><span class="pre">x</span></code>, lahko pa izračunamo tudi druge stvari, kot na primer ničle polinoma.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">koef</span><span class="p">)</span> <span class="c1"># p je instanca objekta poly1d. Aproksimacijo sedaj dobimo z y = p(x).</span>
</pre></div>
</div>
</div>
</div>
<p>Izrišimo vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tabela podatkov&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">p</span><span class="p">(</span><span class="n">x_g</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aproksimacija s kvadratno funkcijo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a73a7117dc1e5559cfb60bdc362797dcf3ff5dc38596bfae3865705f9a908f84.png" src="_images/a73a7117dc1e5559cfb60bdc362797dcf3ff5dc38596bfae3865705f9a908f84.png" />
</div>
</div>
<p>Izračunajmo ničle polinoma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">roots</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-4.69897273,  0.08109792])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="aproksimacija-s-poljubno-funkcijo">
<h2>Aproksimacija s poljubno funkcijo<a class="headerlink" href="#aproksimacija-s-poljubno-funkcijo" title="Permalink to this heading">#</a></h2>
<p>Pri aproksimaciji nismo omejeni zgolj na polinome. Tabele podatkov lahko aproksimiramo:</p>
<ul class="simple">
<li><p>z linearno kombinacijo linearno neodvisnih baznih funkcij ali</p></li>
<li><p>s funkcijo, v kateri nastopajo parametri v nelinearni zvezi (npr. <span class="math notranslate nohighlight">\(a_0\,\sin(a_1\,x+a_2)\)</span>).</p></li>
</ul>
<p>Za podrobnosti glejte vir J. Petrišič: Uvod v Matlab za inženirje, Fakulteta za strojništvo 2013, str 145.</p>
<p>Osredotočili se bomo na uporabo <code class="docutils literal notranslate"><span class="pre">scipy</span></code> paketa za aproksimacijo z nelinearno fukcijo, ki temelji na metodi najmanjših kvadratov.</p>
<section id="aproksimacija-s-harmonsko-funkcijo">
<h3>Aproksimacija s harmonsko funkcijo<a class="headerlink" href="#aproksimacija-s-harmonsko-funkcijo" title="Permalink to this heading">#</a></h3>
<p>Tabela podatkov je definirana kot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span>  <span class="mf">5.1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.13</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo tabelo podatkov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tabela podatkov&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/28399a8e2aeb519c8506d1aedcf5e10e5f9dc79c381b3f420647b1b9b48a3522.png" src="_images/28399a8e2aeb519c8506d1aedcf5e10e5f9dc79c381b3f420647b1b9b48a3522.png" />
</div>
</div>
<p>Aproksimacijo z nelinearno funkcijo bomo izvedli s pomočjo <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span> <span class="n">inf</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>katera zahteva tri parametre: <code class="docutils literal notranslate"><span class="pre">f</span></code> predstavlja definicijo Python funkcije, s katero želimo aproksimirati, in katere parametre spreminjamo z uporabo metode najmanjših kvadratov. <code class="docutils literal notranslate"><span class="pre">xdata</span></code> in <code class="docutils literal notranslate"><span class="pre">ydata</span></code> predstavljata tabelo podatkov. Priporočeno je tudi, da definiramo približek iskanih parametrov <code class="docutils literal notranslate"><span class="pre">p0</span></code>. Ostali parametri so opcijski.</p>
<p>Funkcija vrne dve numerični polji: <code class="docutils literal notranslate"><span class="pre">popt</span></code>, ki predstavlja najdene parametre ter <code class="docutils literal notranslate"><span class="pre">pcov</span></code>, ki predstavljajo ocenjeno kovarianco <code class="docutils literal notranslate"><span class="pre">popt</span></code>.</p>
<p>Definirajmo najprej Python funkcijo, katere prvi parameter je neodvisna spremenljivka <code class="docutils literal notranslate"><span class="pre">x</span></code>, nato pa sledijo parametri, ki jih želimo določiti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">ω</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ω</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">ϕ</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>kjer je <code class="docutils literal notranslate"><span class="pre">A</span></code> amplitua, <code class="docutils literal notranslate"><span class="pre">ω</span></code> krožna frekvenca in <code class="docutils literal notranslate"><span class="pre">ϕ</span></code> faza harmonske funkcije. S pomočjo slike lahko ugibamo prve približke: <code class="docutils literal notranslate"><span class="pre">A=1</span></code>, <code class="docutils literal notranslate"><span class="pre">ω=1</span></code>, <code class="docutils literal notranslate"><span class="pre">ϕ=0</span></code></p>
<p>Sedaj uvozimo <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> in izvedemo optimizacijski postopek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">popt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.01461945,  1.89652046, -3.27943097])
</pre></div>
</div>
</div>
</div>
<p>Izračunali smo pričakovane vrednosti (glejte zgoraj).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.0525477 , -0.99608783, -0.05612665,  1.00860622, -0.02753942,
       -1.01426499,  0.1110182 ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y_g</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span> <span class="c1"># bodi pozorni kako smo v funkcijo posredovali parametre</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tabela podatkov&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">y_g</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aproksimacija&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/344c90f3a915283c9839d7a12c425c49b83ad8a5e98ab0ec56daf1c198e0b2e6.png" src="_images/344c90f3a915283c9839d7a12c425c49b83ad8a5e98ab0ec56daf1c198e0b2e6.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic">
<li><p>Podatki:
$<span class="math notranslate nohighlight">\(x = [-1.00, -0.50, 0.00, 0.50, 1.00]\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y = [−1.00, −0.55, 0.00, 0.45, 1.00]\)</span>$
uporabite linearne zlepke in določite prvi odvod.</p></li>
<li><p>Na zgornjih podatkih izračunajte linearno aproksimacijo ter določite parametra aproksimacije.</p></li>
<li><p>Na nateznem testu ste testirali aluminijeve vzorce; rezultati testa so podani spodaj.</p>
<p>Napetost [MPa]:
$<span class="math notranslate nohighlight">\(\sigma = [34.5, 69.0, 103.5, 138.0]\)</span>$</p>
<p>Specifična deformacija [mm/m]
$<span class="math notranslate nohighlight">\(vzorec_1 = [0.46, 0.95, 1.48, 1.93]\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(vzorec_2 = [0.34, 1.02, 1.51, 2.09]\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(vzorec_3 = [0.37, 1.00, 1.51, 2.05]\)</span>$
S pomočjo linearne aproksimacije določite elastični modul (napetost/specifična deformacija) vsakega posameznega vzorca.</p>
</li>
<li><p>Za vzorce zgoraj linearno aproksimirajte elastični modul čez vse vzorce. Določite tudi standardno napako (glejte <code class="docutils literal notranslate"><span class="pre">np.std</span></code>).</p></li>
<li><p>Raziščite pomoč za funkcijo <code class="docutils literal notranslate"><span class="pre">np.polyfit</span></code> in utežite različne vzorce z različno utežjo (npr. da prvi meritvi zaupate manj). Izračunajte nato linearno aproksimiran elastični modul.</p></li>
<li><p>Pojasnite bistvo metode najmanjših kvadratov na primeru linearne aproksimacije.</p></li>
<li><p>Podatki:
$<span class="math notranslate nohighlight">\(x = [1.0, 2.5, 3.5, 4.0, 1.1, 1.8, 2.2, 3.7]\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y = [6.008, 15.722, 27.130, 33.772, 5.257, 9.549, 11.098, 28.828\)</span>$
Pripravite in pojasnite funkcijo za linearno aproksimacijo.</p></li>
<li><p>Nadaljujte zgornjo nalogo in z vgrajeno funkcijo <code class="docutils literal notranslate"><span class="pre">np.polyfit</span></code> izvedite linearno, kvadratno in kubično polinomsko aproksimacijo.</p></li>
<li><p>Nadaljujte zgornjo nalogo in aproksimacije narišite ter določite standarno napako. Katera aproksimacija najbolje popiše podatke?</p></li>
<li><p>Definirajte polinom 2. ali 3. stopnje. Dodajte šum (enakomeren <code class="docutils literal notranslate"><span class="pre">np.random.rand</span></code> ali normalen <code class="docutils literal notranslate"><span class="pre">np.random.randn</span></code>) ter nato aproksimirajte s polinomom 1., 2. in 3. stopnje. Vse rezultate narišite in jih vrednotite.</p></li>
<li><p>Podatke iz prejšnje točke aproksimirajte s pomočjo kubičnih zlepkov. Uporabite vgrajeno funkcijo in preučite vpliv parametra <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<p>Naredite <em>.exe</em> svojega programa:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pypi.org/project/py2exe/">https://pypi.org/project/py2exe/</a></p></li>
<li><p><a class="reference external" href="http://www.pyinstaller.org/">http://www.pyinstaller.org/</a></p></li>
<li><p><a class="reference external" href="http://pinm.ladisk.si/323/kako-iz-python-kodo-prevedem-v-exe-datoteko">http://pinm.ladisk.si/323/kako-iz-python-kodo-prevedem-v-exe-datoteko</a></p></li>
</ul>
<p>Poglejte <a class="reference external" href="http://pandas.pydata.org/">pandas paket</a>.
<img width=200 src="https://pandas.pydata.org/static/img/pandas.svg"></p>
<section id="aproksimacija-z-zlepki-in-uporabo-scipy">
<h3>Aproksimacija z zlepki in uporabo <code class="docutils literal notranslate"><span class="pre">SciPy</span></code><a class="headerlink" href="#aproksimacija-z-zlepki-in-uporabo-scipy" title="Permalink to this heading">#</a></h3>
<p>Tabela podatkov naj bo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-3.        , -2.68421053, -2.36842105, -2.05263158, -1.73684211,
       -1.42105263, -1.10526316, -0.78947368, -0.47368421, -0.15789474,
        0.15789474,  0.47368421,  0.78947368,  1.10526316,  1.42105263,
        1.73684211,  2.05263158,  2.36842105,  2.68421053,  3.        ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># seme generatorja naključnih števil</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.08832603,  0.02075073,  0.0526001 ,  0.12684217,  0.14234432,
        0.08387244,  0.34226064,  0.52862107,  0.79385312,  0.99590738,
        0.98257964,  0.87172774,  0.57424082,  0.30083997,  0.15492949,
        0.06565014,  0.08950146, -0.00659471,  0.01639626, -0.04258138])
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si objekt <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.UnivariateSpline</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.UnivariateSpline.html">dokumentacija</a>), ki omogoča tako interpolacijo kot aproksimacijo z zlepki:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Parametra <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code> predstavljata tabelo podatkov.</p>
<p>Opcijski parameter <code class="docutils literal notranslate"><span class="pre">s</span></code> določa vrednost, katere vsota kvadratov razlik aproksimacijskega zlepka in aproksimacijskih točk ne sme preseči:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">spl</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">s</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">w</span></code> so uteži posameznih točk.</p>
<p>Če definiramo <code class="docutils literal notranslate"><span class="pre">s=0</span></code>, zahtevamo interpolacijo.</p>
<p>Parameter <code class="docutils literal notranslate"><span class="pre">k</span></code> definira stopnjo polinomskega zlepka (privzeto je <code class="docutils literal notranslate"><span class="pre">k=3</span></code>).</p>
<p>Aproksimacijo z zlepki izvedemo tako, da ob tabeli podatkov <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span></code> definiramo še parameter <code class="docutils literal notranslate"><span class="pre">s</span></code>.  Izvedimo interpolacijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">UnivariateSpline</span>
<span class="n">spl</span> <span class="o">=</span> <span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aproksimacijske točke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">spl</span><span class="p">(</span><span class="n">x_g</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zlepek&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/42c83099b1f7f57a85eb9514c70ec81048ab82347eabbb03b16b25cf91f11beb.png" src="_images/42c83099b1f7f57a85eb9514c70ec81048ab82347eabbb03b16b25cf91f11beb.png" />
</div>
</div>
<p>Izvedimo še aproksimacijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spl_a</span> <span class="o">=</span> <span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aproksimacijske točke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">spl</span><span class="p">(</span><span class="n">x_g</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolacija (s=0)&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_g</span><span class="p">,</span> <span class="n">spl_a</span><span class="p">(</span><span class="n">x_g</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aproksimacija (s=2)&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spl_a</span><span class="o">.</span><span class="n">get_knots</span><span class="p">(),</span> <span class="n">spl_a</span><span class="p">(</span><span class="n">spl_a</span><span class="o">.</span><span class="n">get_knots</span><span class="p">()),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Vozli pri aproksimaciji&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1cca79679e29fb3ab7ce039e7ea518f8ec6163a1bc2d686e274c3f7d446aaea.png" src="_images/d1cca79679e29fb3ab7ce039e7ea518f8ec6163a1bc2d686e274c3f7d446aaea.png" />
</div>
</div>
<p>Dejanski preostanek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spl_a</span><span class="o">.</span><span class="n">get_residual</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0999987185545532
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-notebooks/Predavanje 09 - Reševanje enačb"></span><section class="tex2jax_ignore mathjax_ignore" id="resevanje-enacb">
<h2>Reševanje enačb<a class="headerlink" href="#resevanje-enacb" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h2>Uvod<a class="headerlink" href="#uvod" title="Permalink to this heading">#</a></h2>
<p>Za uvod si oglejmo spodnji video:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;17d55KE8SIU&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/17d55KE8SIU"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>V okviru reševanja enačb obravnavamo poljubno enačbo, ki je odvisna od spremenljivke <span class="math notranslate nohighlight">\(x\)</span> in iščemo rešitev:</p>
<div class="math notranslate nohighlight">
\[f(x)=0.\]</div>
<p>Rešitvam enačbe rečemo tudi <em>koreni</em> (angl. <em>roots</em>). Koren enačbe <span class="math notranslate nohighlight">\(f(x)=0\)</span> je hkrati tudi ničla funkcije <span class="math notranslate nohighlight">\(y=f(x)\)</span>.</p>
<p>Funkcija <span class="math notranslate nohighlight">\(y=f(x)\)</span> ima lahko ničle stopnje:</p>
<ul class="simple">
<li><p>ničla prve stopnje: funkcija seka abscisno os pod neničelnim kotom,</p></li>
<li><p>ničle sode stopnje: funkcija se dotika abscisne osi, vendar je ne seka,</p></li>
<li><p>ničle lihe stopnje: funkcija seka abscisno os, pri ničli stopnje 3 in več imamo prevoj (tangenta je vzporedna z abscisno osjo).</p></li>
</ul>
<p>Tukaj je pomembno izpostaviti, da iščemo rešitev poljubne enačbe <span class="math notranslate nohighlight">\(f(x)=0\)</span>. Če za linearne, kvadratne ali kubične enačbe, lahko določimo analitične rešitve; za večino nelinearnih enačb analitične rešitve ne moremo določiti. Iz tega razloga so numerični pristopi toliko bolj pomembni.</p>
<section id="omejitve-funkcije-f-x">
<h3>Omejitve funkcije <span class="math notranslate nohighlight">\(f(x)\)</span><a class="headerlink" href="#omejitve-funkcije-f-x" title="Permalink to this heading">#</a></h3>
<p>Za funkcijo <span class="math notranslate nohighlight">\(y=f(x)\)</span> zahtevamo, da je na zaprtem intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> zvezna. Pri računanju ničel, se bomo omejili samo na ničle prve stopnje.</p>
</section>
<section id="zgled">
<h3>Zgled<a class="headerlink" href="#zgled" title="Permalink to this heading">#</a></h3>
<p>Poljubno funkcijo <span class="math notranslate nohighlight">\(y=f(x)\)</span> lahko definiramo s <em>Pythonovo funkcijo</em>; za zgled tukaj definirajmo polinom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<p>Ker pa gre za polinom <span class="math notranslate nohighlight">\(x^3-10x^2+5\)</span> s koeficienti <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">-10,</span> <span class="pre">0,</span> <span class="pre">5]</span></code> pa je bolje, da ga definiramo s pomočjo <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.poly1d.html"><code class="docutils literal notranslate"><span class="pre">np.poly1d</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">c_or_r</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c_or_r</span></code> koeficienti polinoma s padajočo potenco ali če je <code class="docutils literal notranslate"><span class="pre">r=True</span></code> ničle polinoma,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> je privzeto <code class="docutils literal notranslate"><span class="pre">False</span></code>, kar pomeni, da se podajo koeficienti polinoma,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> spremenljivka, ki se izpiše pri uporabi funkcije <code class="docutils literal notranslate"><span class="pre">print()</span></code>.</p></li>
</ul>
<p>Uvozimo <code class="docutils literal notranslate"><span class="pre">numpy</span></code> in definirajmo polinom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># uvozimo numpy</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="c1"># definiramo koeficiente polinoma</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># prikažemo polinom</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3      2
1 x - 10 x + 5
</pre></div>
</div>
</div>
</div>
<p>Prikažimo funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>       <span class="c1"># uvozimo matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">x_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># horizontalna črta,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_r</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span> <span class="c1"># da je ničla nekje blizu $x = 0.7$.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/792ac075a3175219579fa7fec625f3861574683f046555a4b892123a692a58d5.png" src="_images/792ac075a3175219579fa7fec625f3861574683f046555a4b892123a692a58d5.png" />
</div>
</div>
<p>Opazimo, da so ničle funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> blizu -0,7 in +0,7. Objekt <code class="docutils literal notranslate"><span class="pre">poly1d</span></code> ima atribut <code class="docutils literal notranslate"><span class="pre">roots</span></code> ali tudi <code class="docutils literal notranslate"><span class="pre">r</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.poly1d.html">glejte dokumentacijo</a>), ki vrne te ničle:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 9.94949106,  0.73460351, -0.68409457])
</pre></div>
</div>
</div>
</div>
<p>V nadaljevanju bo naš cilj numerično določiti ničlo za poljubno funkcijo <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="inkrementalna-metoda">
<h2>Inkrementalna metoda<a class="headerlink" href="#inkrementalna-metoda" title="Permalink to this heading">#</a></h2>
<p>Inkrementalno reševanje temelji na ideji, da v kolikor ima funkcija <span class="math notranslate nohighlight">\(f(x)\)</span> pri <span class="math notranslate nohighlight">\(x_0\)</span> in <span class="math notranslate nohighlight">\(x_1\)</span> različna predznaka, potem je vmes vsaj ena ničla. Zaprti interval <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> razdelimo torej na odseke širine <span class="math notranslate nohighlight">\(\Delta x\)</span>; na odseku, kjer opazimo spremembo predznaka, je vsaj ena ničla funkcije.</p>
<p>Metoda je prikazana na sliki.
<img src='./fig/inkrementalna.png' width=400></p>
<p>Za ničlo zahtevamo:</p>
<div class="math notranslate nohighlight">
\[\left|x_{i+1}-x_i\right|&lt;\varepsilon\quad\textrm{in}\quad \left|f(x_{i+1})\right|+\left|f(x_{i})\right|&lt;D,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\epsilon\)</span> zahtevana natančnost rešitve in <span class="math notranslate nohighlight">\(D\)</span> izbrana majhna vrednost, ki prepreči, da bi kot ničlo razpoznali pol (kar sicer zaradi pogoja zveznosti ni mogoče).</p>
<p>Inkrementalna metoda ima nekatere slabosti:</p>
<ul class="simple">
<li><p>je zelo počasna,</p></li>
<li><p>lahko zgreši dve ničli, ki sta si zelo blizu,</p></li>
<li><p>večkratne sode ničle (lokalni ekstrem, ki se samo dotika abscise) ne zazna.</p></li>
</ul>
<p>Inkrementalna metoda spada med t. i. <em>zaprte</em> (angl. <em>bracketed</em>) metode, saj išče ničle funkcije samo na intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>. Pozneje bomo spoznali tudi <em>odprte</em> metode, ki lahko konvergirajo k ničli zunaj podanega intervala.</p>
<p>Zaradi vseh zgoraj navedenih slabosti inkrementalno metodo pogosto uporabimo samo za izračun začetnega približka ničle.</p>
<section id="numericna-implementacija">
<h3>Numerična implementacija<a class="headerlink" href="#numericna-implementacija" title="Permalink to this heading">#</a></h3>
<p>Poglejmo si sedaj inkrementalno iskanje ničel funkcije:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inkrementalna</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">dx</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne prvi interval (x1, x2) kjer leži ničla</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničle iščemo</span>
<span class="sd">    :param x1:  spodnja meja iskanja</span>
<span class="sd">    :param x2:  zgornja meja iskanja</span>
<span class="sd">    :param dx:  inkrement iskanja</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>   <span class="c1"># pripravimo x vrednosti</span>
    <span class="n">f_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x_d</span><span class="p">))</span>       <span class="c1"># pripravimo predznake funkcije</span>
    <span class="n">f_d</span> <span class="o">=</span> <span class="n">f_d</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="n">f_d</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>        <span class="c1"># pomnožimo sosednje elemente</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">f_d</span><span class="p">)</span>            <span class="c1"># prvi prehod skozi ničlo</span>
    <span class="c1"># vsota abs funk vrednosti</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">x_d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x_d</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">]),</span> <span class="n">D</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo sedaj uporabo na zgoraj definiranem polinomu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez_inkr</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">inkrementalna</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">rez_inkr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.734, 0.735])
</pre></div>
</div>
</div>
</div>
<p>Ničla je izolirana z natančnostjo 0,001, preverimo še vsoto absolutnih funkcijskih vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.013071529000000304
</pre></div>
</div>
</div>
</div>
<p>Ugotovimo, da je relativno majhna; bomo pa se s sledečimi metodami trudili rezultat bistveno izboljšati.</p>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_r</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># horizontalna črta</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># vertikalna črta</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># vetrikalna črta</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">rez_inkr</span><span class="p">),</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inkrementalna metoda&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.73</span><span class="p">,</span><span class="mf">0.74</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/477cb371ab73376be7a8a0316aa19a707bc56ce3ae4383c5b1c8782e78560e92.png" src="_images/477cb371ab73376be7a8a0316aa19a707bc56ce3ae4383c5b1c8782e78560e92.png" />
</div>
</div>
<p>Da smo torej na intervalu <span class="math notranslate nohighlight">\([0, 1]\)</span> izračunali rešitev z natančnostjo <span class="math notranslate nohighlight">\(\Delta x=0,001\)</span>, smo morali 1000-krat klicati funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>. Gre za zelo neučinkovito metodo, zato bomo iskali boljše načine; najprej s preprostim iterativnim inkrementalnim pristopom.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="iterativna-inkrementalna-metoda">
<h2>Iterativna inkrementalna metoda<a class="headerlink" href="#iterativna-inkrementalna-metoda" title="Permalink to this heading">#</a></h2>
<p>Iterativna inkrementalna metoda v prvi iteraciji z inkrementalno metodo omeji interval iskanja ničel pri relativno velikem koraku. Interval, najden v prvi iteraciji, se v drugi iteraciji razdeli na manjše intervale in ponovi se inkrementalno iskanje ničle. Tretja iteracija se nato omeji na interval določen v drugi in tako dalje. Z iteracijami zaključimo, ko smo dosegli predpisano natančnost rešitve <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<p>Metoda je prikazana na sliki:
<img src='./fig/iterativna_inkrementalna.png' width=400></p>
<section id="id1">
<h3>Numerična implementacija<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inkrementalna_super</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">iteracij</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne interval (x0, x1) kjer leži ničla</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničlo iščemo</span>
<span class="sd">    :param x0:  spodnja meja iskanja</span>
<span class="sd">    :param x1:  zgornja meja iskanja</span>
<span class="sd">    :iteraci:   število iteracij inkrementalne metode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iteracij</span><span class="p">):</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
        <span class="n">x0x1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">inkrementalna</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x0x1</span>
    <span class="c1"># vsota abs funk vrednosti</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>        
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">]),</span> <span class="n">D</span>
</pre></div>
</div>
</div>
</div>
<p>S 30 klici funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> tako dobimo podobno natančnost kot prej v 1000:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez30</span><span class="p">,</span> <span class="n">D30</span> <span class="o">=</span> <span class="n">inkrementalna_super</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">iteracij</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">rez30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.734, 0.735])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez_inkr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.734, 0.735])
</pre></div>
</div>
</div>
</div>
<p>Seveda pa lahko natančnost bistveno izboljšamo z večanjem števila iteracij:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rez80</span><span class="p">,</span> <span class="n">D80</span> <span class="o">=</span> <span class="n">inkrementalna_super</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">iteracij</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">rez80</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.7346035 , 0.73460351])
</pre></div>
</div>
</div>
</div>
<p>Preverimo še kriterij vsote absolutnih funkcijskih vrednosti, ki mora biti majhen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D80</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3073143190212022e-07
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bisekcijska-metoda">
<h2>Bisekcijska metoda<a class="headerlink" href="#bisekcijska-metoda" title="Permalink to this heading">#</a></h2>
<p>Na intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>, kjer vemo, da obstaja ničla funkcije (predznaka <span class="math notranslate nohighlight">\(f(x_0)\)</span> in <span class="math notranslate nohighlight">\(f(x_1)\)</span> se razlikujeta), lahko uporabimo <em>bisekcijsko metodo</em>.</p>
<p>Ideja metode je:</p>
<ul class="simple">
<li><p>interval <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> razdelimo na pol (od tukaj ime: <em>bi-sekcija</em>): <span class="math notranslate nohighlight">\(x_2 = (x_0+x_1)/2\)</span>,</p></li>
<li><p>če imata <span class="math notranslate nohighlight">\(f(x_0)\)</span> in <span class="math notranslate nohighlight">\(f(x_2)\)</span> različne predznake, je nov interval iskanja ničle <span class="math notranslate nohighlight">\([x_0, x_2]\)</span>, sicer pa: <span class="math notranslate nohighlight">\([x_2, x_1]\)</span>,</p></li>
<li><p>glede na predhodni korak definiramo nov zaprt interval <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> in nadaljujemo z iterativnim postopkom, dokler ne dosežemo želene natančnosti <span class="math notranslate nohighlight">\(\left|x_1-x_0\right|&lt;\varepsilon\)</span>.</p></li>
</ul>
<p>Slika metode:
<img src='./fig/bisekcijska.png' width=400></p>
<p>Bisekcijska metoda spada med <em>zaprte</em> metode, ki vrne ničlo funkcije na podanem intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>.</p>
<section id="ocena-napake">
<h3>Ocena napake<a class="headerlink" href="#ocena-napake" title="Permalink to this heading">#</a></h3>
<p>Če v začetku začnemo z intervalom <span class="math notranslate nohighlight">\(\Delta x = \left|x_1-x_0\right|\)</span>, potem je natančnost bisekcijske metode po prvem koraku bisekcije:
$<span class="math notranslate nohighlight">\(\varepsilon_1 = \Delta x/2,\)</span><span class="math notranslate nohighlight">\(
po drugem koraku: 
\)</span><span class="math notranslate nohighlight">\(\varepsilon_2 = \Delta x/2^2\)</span><span class="math notranslate nohighlight">\(
in po \)</span>n<span class="math notranslate nohighlight">\( korakih: 
\)</span><span class="math notranslate nohighlight">\(\varepsilon_n = \Delta x/2^n.\)</span>$</p>
<p>Ponavadi zahtevamo, da je rešitev podana z natančnostjo <span class="math notranslate nohighlight">\(\varepsilon\)</span> in iz zgornje enačbe lahko izpeljemo število potrebnih korakov bisekcijske metode:</p>
<div class="math notranslate nohighlight">
\[n = \frac{\log\left(\frac{\Delta x}{\varepsilon}\right)}{\log(2)}.\]</div>
<p>Seveda je število korakov celo število.</p>
</section>
<section id="id2">
<h3>Numerična implementacija<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bisekcija</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">Dtol</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne ničlo z natančnostjo tol</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničlo iščemo</span>
<span class="sd">    :param x0:  spodnja meja iskanja</span>
<span class="sd">    :param x1:  zgornja meja iskanja</span>
<span class="sd">    :param tol: zahtevana natančnost</span>
<span class="sd">    :param Dtol:največja vsota absolutnih vrednosti rešitve </span>
<span class="sd">    :izpis:     ali na koncu izpiše kratko poročilo</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Ničla ni izolirana. Root is not bracketed.&#39;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">tol</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># števil iteracij</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">f3</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span><span class="o">!=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)):</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">x2</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">D</span> <span class="o">&gt;</span> <span class="n">Dtol</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Verjetnost pola ali več ničel.&#39;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
        <span class="n">decimalk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tol</span><span class="p">))</span> <span class="c1"># ne deluje vedno in za vse primere:)    </span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rešitev: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">5.</span><span class="si">{</span><span class="n">decimalk</span><span class="si">}</span><span class="s1">f</span><span class="si">}</span><span class="s1">, število iteracij: </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">g</span><span class="si">}</span><span class="s1">, D: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">5.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj poskusimo najti ničlo z natančnostjo <code class="docutils literal notranslate"><span class="pre">1e-3</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisekcija</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: 0.735, število iteracij: 10, D: 0.01277
</pre></div>
</div>
</div>
</div>
<p>V desetih iteracijah smo dobili isto natančen rezultat kakor zgoraj pri iterativni inkrementalni metodi <code class="docutils literal notranslate"><span class="pre">rez30</span></code>. Poglejmo še izračun ničle s še večjo natančnostjo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisekcija</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: 0.734603, število iteracij: 20, D: 0.00001
</pre></div>
</div>
</div>
</div>
<p>Hitrost izvajanja lahko preverimo s t. i. <em>magic funkcijo</em> <code class="docutils literal notranslate"><span class="pre">timeit</span></code> (<a class="reference external" href="http://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">dokumentacija</a>), ki večkrat požene funkcijo in analizira čas izvajanja. Če je pred magic funkcijo dvojni znak <code class="docutils literal notranslate"><span class="pre">%%</span></code>, se izvede in meri čas celotne celice, če pa le enojni <code class="docutils literal notranslate"><span class="pre">%</span></code>, pa samo ene vrstice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">bisekcija</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>337 µs ± 8.17 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<section id="iskanje-nicle-v-okolici-pola">
<h4>Iskanje ničle v okolici pola<a class="headerlink" href="#iskanje-nicle-v-okolici-pola" title="Permalink to this heading">#</a></h4>
<p>Poglejmo sedaj iskanje ničle funkcije <code class="docutils literal notranslate"><span class="pre">tan</span></code> v okolici pola (ničla dejansko ne obstaja):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x_t</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tan(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1d8683411766e68166efab45c31f9372aae304d8a487af4ad328b819bb6a28fd.png" src="_images/1d8683411766e68166efab45c31f9372aae304d8a487af4ad328b819bb6a28fd.png" />
</div>
</div>
<p>V primeru iskanja na intervalu <span class="math notranslate nohighlight">\([-1, 1]\)</span> najdemo pravo ničlo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisekcija</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: -0.000, število iteracij: 11, D: 0.00098
</pre></div>
</div>
</div>
</div>
<p>V primeru iskanja v okolici pola, pa nas program na to opozori (klic funkcije je tukaj zakomentiran, sicer se avtomatsko generiranje tukaj prekine):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bisekcija(np.tan, -3, 0, tol=1e-6)</span>
</pre></div>
</div>
</div>
</div>
<p>V <code class="docutils literal notranslate"><span class="pre">scipy</span></code> vgrajena bisekcijska metoda takega preverjanja nima (zaradi hitrosti) in bo vrnila rezultat, ki bo pa napačen. Pri uporabi moramo torej biti previdni.</p>
</section>
</section>
<section id="uporaba-scipy-optimize-bisect">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.bisect</span></code><a class="headerlink" href="#uporaba-scipy-optimize-bisect" title="Permalink to this heading">#</a></h3>
<p>Bisekcijska metoda je <em>počasna</em>, vendar zanesljiva metoda iskanja ničel in je implementirana znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code>. Najprej jo uvozimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">bisect</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">2e-12</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">8.8817841970012523e-16</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> 
    <span class="n">full_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">bisect</span></code> zahteva tri parametre: funkijo <code class="docutils literal notranslate"><span class="pre">f</span></code> ter parametra <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">b</span></code>, ki definirata zaprti interval <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b]</span></code>. Predznaka <code class="docutils literal notranslate"><span class="pre">f(a)</span></code> in <code class="docutils literal notranslate"><span class="pre">f(b)</span></code> morata biti različna. Ostali parametri, npr. absolutna <code class="docutils literal notranslate"><span class="pre">xtol</span></code> in relativna <code class="docutils literal notranslate"><span class="pre">rtol</span></code> napaka ter največje število iteracij <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> so opcijski - imajo privzete vrednosti. Za več glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.bisect.html">dokumentacijo</a>.</p>
<p>Poglejmo uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7353515625
</pre></div>
</div>
</div>
</div>
<p>in hitrost:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> bisect(f, 0, 1, xtol=1e-3)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88.4 µs ± 4.65 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Ugotovimo, da je <em>naša</em> implementacija bisekcijske metode približno 5-krat počasnejša.</p>
<p>Preverimo še lahko funkcijo <code class="docutils literal notranslate"><span class="pre">tan(x)</span></code>, najprej na intervalu, kjer je funkcija zvezna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>Potem še v okolici pola, kjer ni zvezna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bisect</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.5707963267941523
</pre></div>
</div>
</div>
</div>
<p>kar je napačna rešitev!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="sekantna-metoda">
<h2>Sekantna metoda<a class="headerlink" href="#sekantna-metoda" title="Permalink to this heading">#</a></h2>
<p>Sekantna metoda zahteva dva začetna približka <span class="math notranslate nohighlight">\(x_0\)</span> in <span class="math notranslate nohighlight">\(x_1\)</span> in funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>. Ob predpostavki linearne interpolacije med točkama <span class="math notranslate nohighlight">\(x_0, f(x_0)\)</span> in <span class="math notranslate nohighlight">\(x_1, f(x_1)\)</span> (skozi točki potegnemo <em>sekanto</em>, od tukaj tudi ime), se določi <span class="math notranslate nohighlight">\(x_2\)</span>, kjer ima linearna interpolacijska funkcija ničlo. <span class="math notranslate nohighlight">\(x_2\)</span> predstavlja nov približek ničle.</p>
<p>Glede na sliko:
<img src='./fig/sekantna.png' width=400></p>
<p>lahko zapišemo (podobna trikotnika sta na sliki označena z rumeno):</p>
<div class="math notranslate nohighlight">
\[\frac{f(x_1)}{x_2 − x_1}= \frac{f(x_0) − f(x_1)}{x_1 − x_0}.\]</div>
<p>Sledi, da je nov približek ničle:</p>
<div class="math notranslate nohighlight">
\[x_2= x_1-f(x_1)\,\frac{x_1 − x_0}{f(x_1) - f(x_0)}.\]</div>
<p>V naslednjem koraku pri sekantni metodi izvedemo sledeče zamenjave: <span class="math notranslate nohighlight">\(x_0=x_1\)</span> in <span class="math notranslate nohighlight">\(x_1=x_2\)</span>.</p>
<p>Sekantna metoda spada med <em>odprte</em> metode, saj lahko najde ničlo funkcije, ki se nahaja zunaj območja <span class="math notranslate nohighlight">\([x_0, x_1]\)</span>.</p>
<section id="id3">
<h3>Ocena napake<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>Konzervativno lahko napako ocenimo iz razlike med dvema zaporednima približkoma:</p>
<div class="math notranslate nohighlight">
\[\varepsilon = \left|x_{n-1} -x_{n}\right|\]</div>
</section>
<section id="konvergenca-in-red-konvergence">
<h3>Konvergenca in red konvergence<a class="headerlink" href="#konvergenca-in-red-konvergence" title="Permalink to this heading">#</a></h3>
<p>Konvergenca pomeni, da zaporedje približkov konvergira k rešitvi enačbe <span class="math notranslate nohighlight">\(\alpha\)</span> (<span class="math notranslate nohighlight">\(\alpha\)</span> je rešitev enačbe).</p>
<p><strong>Red konvergence</strong> označuje hitrost konvergiranja.</p>
<p>Če <span class="math notranslate nohighlight">\(\varepsilon\)</span> označimo napako približka in napako z vsakim korakom iteracije linearno zmanjšamo (<span class="math notranslate nohighlight">\(C\)</span> je konstanta):</p>
<div class="math notranslate nohighlight">
\[\varepsilon_n = C\,\varepsilon_{n-1}^1,\]</div>
<p>govorimo o <strong>redu konvergence 1</strong> (<span class="math notranslate nohighlight">\(\varepsilon\)</span> ima potenco 1)!</p>
<p>Pri predhodno obravnavani bisekcijski metodi napako na vsakem koraku zmanjšamo za <span class="math notranslate nohighlight">\(1/2\)</span> (<span class="math notranslate nohighlight">\(\varepsilon_n/\varepsilon_{n-1} = C = 1/2\)</span>). <em>Bisekcijska metoda ima red konvergence 1.</em></p>
<p>Red konvergence <em>sekantne metode je višji</em> in jo je mogoče oceniti z:</p>
<div class="math notranslate nohighlight">
\[\varepsilon_n = C\,\varepsilon_{n-1}^{1.618}.\]</div>
<p>Iz zgornje ocene sledi, da se na vsakem koraku iteracije število točnih cifer poveča za približno 60%. Ker je red konvergence višji od 1 in manjši od kvadratične, tako konvergenco imenujemo <em>superlinearna</em> konvergenca.</p>
<p>Še boljšo, kvadratično, konvergenco ima Newtonova metoda. Pri kvadratični konvergenci se na vsakem koraku iteracije število točnih cifer podvoji. Isti red konvergence ima tudi <em>Ridderjeva</em>  metoda, ki je implementirana v paketu <code class="docutils literal notranslate"><span class="pre">scipy</span></code> (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.ridder.html">dokumentacijo</a>) in je zaprtega tipa ter sorodna sekantni metodi. Kljub uporabnosti si je tukaj ne bomo podrobno ogledali.</p>
</section>
<section id="id4">
<h3>Numerična implementacija<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sekantna</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">Dtol</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne ničlo z natančnostjo tol</span>
<span class="sd">    </span>
<span class="sd">    :param fun: funkcija katere ničlo iščemo</span>
<span class="sd">    :param x0:  spodnja meja iskanja</span>
<span class="sd">    :param x1:  zgornja meja iskanja</span>
<span class="sd">    :param tol: zahtevana natančnost</span>
<span class="sd">    :max_iter:  maksimalno število iteracij preden se izvajanje prekine</span>
<span class="sd">    :param Dtol:največja vsota absolutnih vrednosti rešitve </span>
<span class="sd">    :izpis:     ali na koncu izpiše kratko poročilo</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Ničla ni izolirana. Root is not bracketed.&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">f0</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">f1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:g}</span><span class="s1">. korak: x0=</span><span class="si">{:g}</span><span class="s1">, x1=</span><span class="si">{:g}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">D</span> <span class="o">&gt;</span> <span class="n">Dtol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Verjetnost pola ali več ničel.&#39;</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
                <span class="n">decimalk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tol</span><span class="p">))</span> <span class="c1"># ne deluje vedno in za vse primere:)    </span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rešitev: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">5.</span><span class="si">{</span><span class="n">decimalk</span><span class="si">}</span><span class="s1">f</span><span class="si">}</span><span class="s1">, D: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">5.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">r</span>        
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sekantna</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.e-8</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. korak: x0=1, x1=0.555556.
2. korak: x0=0.555556, x1=0.707845.
3. korak: x0=0.707845, x1=0.737957.
4. korak: x0=0.737957, x1=0.734549.
5. korak: x0=0.734549, x1=0.734603.
6. korak: x0=0.734603, x1=0.734604.
7. korak: x0=0.734604, x1=0.734604.
Rešitev: 0.73460351, D: 0.00000
</pre></div>
</div>
</div>
</div>
<p>in hitrost</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> sekantna(f, 0, 1., tol=1.e-8, izpis=False)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>130 µs ± 2.27 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Kakor smo zapisali zgoraj, je sekantna metoda odprtega tipa. Rešitev enačbe je lahko zunaj podanega intervala. Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sekantna</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. korak: x0=2, x1=1.41615.
2. korak: x0=1.41615, x1=1.85165.
3. korak: x0=1.85165, x1=1.69887.
4. korak: x0=1.69887, x1=1.97485.
5. korak: x0=1.97485, x1=2.09379.
6. korak: x0=2.09379, x1=2.43519.
7. korak: x0=2.43519, x1=2.76579.
8. korak: x0=2.76579, x1=3.05013.
9. korak: x0=3.05013, x1=3.13625.
10. korak: x0=3.13625, x1=3.14158.
11. korak: x0=3.14158, x1=3.14159.
Rešitev: 3.142, D: 0.00002
</pre></div>
</div>
</div>
</div>
</section>
<section id="uporaba-scipy-optimize-newton">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code><a class="headerlink" href="#uporaba-scipy-optimize-newton" title="Permalink to this heading">#</a></h3>
<p>Znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je sekantna metoda definirana v okviru <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code> funkcije. Če le-tej namreč ne podamo funkcije, ki definira prvi odvod, potem je uporabljena sekantna metoda (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.newton.html">dokumentacijo</a>).</p>
<p>Najprej jo uvozimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">newton</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.48e-08</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">fprime2</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">newton</span></code> zahteva dva parametra: funkcijo <code class="docutils literal notranslate"><span class="pre">func</span></code> ter začetno vrednost <code class="docutils literal notranslate"><span class="pre">x0</span></code>. Opcijska parametra sta še <code class="docutils literal notranslate"><span class="pre">fprime</span></code> in <code class="docutils literal notranslate"><span class="pre">fprime2</span></code> za prvi in drugi odvod funkcije <code class="docutils literal notranslate"><span class="pre">func</span></code>; če nista podana, se uporabi sekantna metoda (več o odvodih spodaj pri Newtonovi metodi). Največje število iteracij definira <code class="docutils literal notranslate"><span class="pre">maxiter</span></code>.</p>
<p>V primeru sekantne metode, se druga meja intervala izračuna glede na kodo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x0</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-4</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-4</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1e-4</span>
</pre></div>
</div>
<p>Poglejmo si uporabo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.e-8</span><span class="p">)</span>
<span class="sa">f</span><span class="s1">&#39;Rezultat: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">2.8f</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Rezultat: 0.73460351&#39;
</pre></div>
</div>
</div>
</div>
<p>in hitrost</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> newton(f, x0=0.1, tol=1.e-8)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>374 µs ± 9.04 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Ugotovimo, da je naša implementacija sekantne metode podobno hitra.</p>
<p>Uporabimo še Ridderjevo metodo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">ridder</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">ridder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1.e-8</span><span class="p">)</span>
<span class="sa">f</span><span class="s1">&#39;Rezultat: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">2.8f</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Rezultat: 0.73460350&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="newtonova-metoda">
<h2>Newtonova metoda<a class="headerlink" href="#newtonova-metoda" title="Permalink to this heading">#</a></h2>
<p>V literaturi za <strong>Newtonovo</strong> metodo tudi najdemo izraza <strong>tangentna</strong> in <strong>Newton-Raphsonova</strong> metoda. Potrebuje en začetni približek <span class="math notranslate nohighlight">\(x_0\)</span>, poleg definicije funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> pa tudi njen odvod <span class="math notranslate nohighlight">\(f'(x)\)</span>.</p>
<p>Princip delovanja metode je prikazan na sliki:
<img src="./fig/newtonova.png" width=400></p>
<p>Metodo bi lahko izpeljali grafično (s  slike), tukaj pa si poglejmo izpeljavo s pomočjo Taylorjeve vrste:
$<span class="math notranslate nohighlight">\(f(x_{i+1})=f(x_i)+f'(x_i)\,\left(x_{i+1}-x_i\right)+O^2\left(x_{i+1}-x_i\right),\)</span><span class="math notranslate nohighlight">\(
če naj bo pri \)</span>x_{i+1}<span class="math notranslate nohighlight">\( vrednost funkcije nič, potem velja:
\)</span><span class="math notranslate nohighlight">\(0=f(x_i)+f'(x_i)\,\left(x_{i+1}-x_i\right)+O^2\left(x_{i+1}-x_i\right).\)</span>$</p>
<p>Naredimo napako metode in zanemarimo člene višjega reda v Taylorjevi vrsti. Lahko izpeljemo:</p>
<div class="math notranslate nohighlight">
\[x_{i+1}=x_i-\frac{f(x_i)}{f'(x_i)}.\]</div>
<p><span class="math notranslate nohighlight">\(x_{i+1}\)</span> je tako nov približek iskane ničle.</p>
<p>Algoritem Newtonove metode je:</p>
<ol class="arabic simple">
<li><p>izračunamo nov približek <span class="math notranslate nohighlight">\(x_{i+1}\)</span>,</p></li>
<li><p>računanje prekinemo, če je največje število iteracij doseženo (rešitve enačbe nismo našli),</p></li>
<li><p>če velja <span class="math notranslate nohighlight">\(\left|x_{i+1}-x_i\right|&lt;\varepsilon\)</span> računanje prekinemo (izračunali smo približek ničle), sicer povečamo indeks <span class="math notranslate nohighlight">\(i\)</span> in gremo v prvi korak.</p></li>
</ol>
<p>Opombi:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\varepsilon\)</span> je zahtevana absolutna natančnost,</p></li>
<li><p><em>Newtonova</em> metoda lahko divergira, zato v algoritmu predpišemo največje število iteracij.</p></li>
</ul>
<p>Zgoraj smo omenili, da je Newtonova metoda ena izmed boljših metod za iskanje ničel funkcij. Ima pa tudi nekaj slabosti/omejitev:</p>
<ul class="simple">
<li><p>spada med <em>odprte</em> metode,</p></li>
<li><p>kvadratična konvergenca je zagotovljena le v dovolj majhni okolici rešitve enačbe,</p></li>
<li><p>poznati moramo odvod funkcije.</p></li>
</ul>
<section id="red-konvergence">
<h3>Red konvergence<a class="headerlink" href="#red-konvergence" title="Permalink to this heading">#</a></h3>
<p>Red konvergence Newtonove metode je kvadraten:
$<span class="math notranslate nohighlight">\(\varepsilon_n = C\,\varepsilon_{n-1}^{2},\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>C<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(C=-\frac{f''(x)}{2\,f'(x)}.\)</span>$</p>
<p>Konvergenca je torej hitra, v vsaki novi iteraciji se število točnih števk v približku podvoji.</p>
</section>
<section id="id5">
<h3>Numerična implementacija<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newtonova</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">dfun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">Dtol</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">izpis</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> 
    <span class="c1"># ime `newtonova` zato ker je `newton` vgrajena funkcija v `scipy`</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Vrne ničlo z natančnostjo tol</span>
<span class="sd">    </span>
<span class="sd">    :param fun:  funkcija katere ničlo iščemo</span>
<span class="sd">    :param dfun: f&#39;</span>
<span class="sd">    :param x0:   začetni približek</span>
<span class="sd">    :param tol:  zahtevana natančnost</span>
<span class="sd">    :max_iter:  maksimalno število iteracij preden se izvajanje prekine</span>
<span class="sd">    :param Dtol:največja vsota absolutnih vrednosti rešitve </span>
<span class="sd">    :izpis:     ali na koncu izpiše kratko poročilo</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">dfun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">D</span> <span class="o">&gt;</span> <span class="n">Dtol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Verjetnost pola ali več ničel.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">izpis</span><span class="p">:</span>
                <span class="n">decimalk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tol</span><span class="p">))</span> <span class="c1"># ne deluje vedno in za vse primere:)    </span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rešitev: </span><span class="si">{</span><span class="n">x1</span><span class="si">:</span><span class="s1">5.</span><span class="si">{</span><span class="n">decimalk</span><span class="si">}</span><span class="s1">f</span><span class="si">}</span><span class="s1">, število iteracij: </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">, D: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">5.8f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x1</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Metoda po </span><span class="si">{:g}</span><span class="s1"> iteracijah ne konvergira&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_iter</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo polinom <code class="docutils literal notranslate"><span class="pre">f</span></code> in njegov prvi odvod <code class="docutils literal notranslate"><span class="pre">df</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span>
<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">20</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo sedaj ničlo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtonova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">dfun</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rešitev: 0.73460351, število iteracij: 5, D: 0.00000000
</pre></div>
</div>
</div>
</div>
<p>Preverimo hitrost izvajanja:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> newtonova(fun=f, dfun=df, x0=1, tol=1e-8, izpis=False)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.75 µs ± 370 ns per loop (mean ± std. dev. of 7 runs, 100,000 loops each)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code><a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>Znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je Newtonova metoda definirana v okviru <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code> funkcije, ki smo jo že spoznali zgoraj pri sekantni metodi (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.newton.html">dokumentacijo</a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.48e-08</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">fprime2</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Če v funkcijo <code class="docutils literal notranslate"><span class="pre">newton</span></code> poleg funkcije <code class="docutils literal notranslate"><span class="pre">func</span></code> in začetne vrednosti <code class="docutils literal notranslate"><span class="pre">x0</span></code> podamo tudi prvi odvod <code class="docutils literal notranslate"><span class="pre">fprime</span></code>, se dejansko uporabi Newtonova metoda.</p>
<p>Če podamo tudi drugi odvod <code class="docutils literal notranslate"><span class="pre">fprime2</span></code>, se uporabi Halleyeva metoda, ki temelji na izrazu:</p>
<div class="math notranslate nohighlight">
\[x_{n+1}=x_{n}-\frac{2f(x_{n})f'(x_{n})}{2\,f'^{2}(x_{n})-f(x_{n})f''(x_{n})}\]</div>
<p>Poglejmo si primer uporabe Newtonove metode v <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="sa">f</span><span class="s1">&#39;Rezultat: </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">2.8f</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Rezultat: 0.73460351&#39;
</pre></div>
</div>
</div>
</div>
<p>In izmerimo hitrost:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> newton(func=f, x0=1., fprime=df)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>163 µs ± 2.99 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resevanje-sistemov-nelinarnih-enacb">
<h2>Reševanje sistemov nelinarnih enačb*<a class="headerlink" href="#resevanje-sistemov-nelinarnih-enacb" title="Permalink to this heading">#</a></h2>
<p>Rešujemo sistem enačb, ki ga v vektorski obliki zapišemo takole:
$<span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x})=\mathbf{0}.\)</span><span class="math notranslate nohighlight">\(
V skalarni obliki zgornji vektorski izraz zapišemo:
\)</span><span class="math notranslate nohighlight">\(\begin{array}{rcl}
f_0(x_0,x_1,\dots, x_{n-1})&amp;=&amp;0\\
f_1(x_0,x_1,\dots, x_{n-1})&amp;=&amp;0\\
&amp;\vdots&amp;\\
f_{n-1}(x_0,x_1,\dots, x_{n-1})&amp;=&amp;0.\\
\end{array}\)</span>$</p>
<p>Reševanje sistema <span class="math notranslate nohighlight">\(n\)</span> nelinearnih enačb je bistveno bolj zahtevno kot reševanje ene same nelinearne enačbe. Tak sistem enačb ima lahko več rešitev in katero izračunamo, je odvisno od začetnih pogojev. Ponavadi nam pri dobri izbiri začetnih pogojev pomaga fizikalni problem, ki ga rešujemo.</p>
<p>Za računanje rešitve sistema enačb se <em>Newtonova</em> metoda izkaže kot najenostavnejša in pogosto tudi najboljša (obstajajo tudi druge metode, ki pa so velikokrat variacije Newtonove metode).</p>
<p>Podobno kot pri izpeljavi Newtonove metode za reševanje ene enačbe, tudi tukaj začnemo z razvojem funkcije <span class="math notranslate nohighlight">\(f_i\)</span> v Taylorjevo vrsto:
$<span class="math notranslate nohighlight">\(f_i(\mathbf{x}+\Delta \mathbf{x})=f_i(\mathbf{x})+\sum_{j=1}^n \frac{\partial f_i}{\partial x_j}\,\Delta x_j+O^2(\mathbf{\Delta x}).\)</span>$</p>
<p>Naredimo napako metode, ko zanemarimo člene drugega in višjih redov ter zapišemo izraz v matrični obliki:
$<span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x}+\Delta \mathbf{x})=\mathbf{f}(\mathbf{x})+\mathbf{J}(\mathbf{x})\,\Delta \mathbf{x},\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>\mathbf{J}(\mathbf{x})<span class="math notranslate nohighlight">\( *Jakobijeva* matrika pri vrednostih \)</span>\mathbf{x}<span class="math notranslate nohighlight">\(. Elementi Jakobijeve matrike so: 
\)</span><span class="math notranslate nohighlight">\(J_{ij}=\frac{\partial f_i}{\partial x_j}.\)</span>$</p>
<p>Če naj bo <span class="math notranslate nohighlight">\(\mathbf{x}+\Delta \mathbf{x}\)</span> rešitev sistema enačb, mora veljati:
$<span class="math notranslate nohighlight">\(\mathbf{0}=\mathbf{f}(\mathbf{x})+\mathbf{J}(\mathbf{x})\,\Delta \mathbf{x}\)</span><span class="math notranslate nohighlight">\(
in torej sledi:
\)</span><span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x})\,\Delta \mathbf{x}=-\mathbf{f}(\mathbf{x}).\)</span>$</p>
<p>Izpeljali smo sistem linearnih enačb, matrika koeficientov je označena z <span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x})\)</span>, vektor neznank je <span class="math notranslate nohighlight">\(\Delta\mathbf{x}\)</span> in vektor konstant <span class="math notranslate nohighlight">\(-\mathbf{f}(\mathbf{x}).\)</span></p>
<p>Opomba: analitično računanje Jakobijeve matrike je lahko zamudno in zato jo pogosto približno izračunamo pri <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> numerično:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f_i}{\partial x_j}\approx
\frac{f_i(\mathbf{x}+\mathbf{e}_j\,h)-f_i(\mathbf{x})}{h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(h\)</span> majhen premik in je <span class="math notranslate nohighlight">\(\mathbf{e}_j\)</span> enotski pomik v smeri <span class="math notranslate nohighlight">\(x_j\)</span>. Če se Jakobijeva matrika izračuna numerično, govorimo o sekantni metodi in ne Newtonovi.</p>
<p>Pri numeričnem izračunu si lahko pomagamo s funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.optimize.approx_fprime</span></code> (za podrobnosti glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.approx_fprime.html">dokumentacijo</a>).</p>
<section id="id7">
<h3>Numerična implementacija<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<p>Algoritem torej je:</p>
<ol class="arabic simple">
<li><p>Izberemo začetni približek <span class="math notranslate nohighlight">\(\mathbf{x}_0\)</span>, največje število iteracij in postavimo indeks na nič: <span class="math notranslate nohighlight">\(i=0\)</span>.</p></li>
<li><p>Izračunamo Jakobijevo matriko <span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x_i})\)</span> in rešimo linearni sistem: <span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{x}_i)\,\Delta \mathbf{x}_i=-\mathbf{f}(\mathbf{x}_i)\)</span>.</p></li>
<li><p>Izračunamo nov približek: <span class="math notranslate nohighlight">\(\mathbf{x}_{i+1}=\mathbf{x}_{i}+\Delta\mathbf{x}_i\)</span>.</p></li>
<li><p>Če je napaka manjša od zahtevane, se postopek prekine*. Postopek prekinemo tudi, če je število iteracij večje od dovoljenega, sicer povečamo indeks <span class="math notranslate nohighlight">\(i=i+1\)</span> in se vrnemo v korak 2.</p></li>
</ol>
<p>* Opomba:</p>
<p>Napako lahko ocenimo z normo razlike dveh zaporednih približkov:</p>
<div class="math notranslate nohighlight">
\[\sum_j^{n-1}\left|x_{i,j}-x_{i-1,j}\right|&lt;\varepsilon,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(i\)</span> indeks iteracije in <span class="math notranslate nohighlight">\(j\)</span> indeks elementa.</p>
</section>
<section id="uporaba-scipy-optimize-root">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root</span></code><a class="headerlink" href="#uporaba-scipy-optimize-root" title="Permalink to this heading">#</a></h3>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root</span></code> ima obsežno <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html">dokumentacijo</a> in omogoča večje število različnih pristopov:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hybr&#39;</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Če uporabimo privzete parametre, moramo definirati zgolj vektorsko funkcijo <code class="docutils literal notranslate"><span class="pre">fun</span></code> in začetno vrednost <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<p>Uvozimo funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si uporabo na zgledu (gre za zgled na str. 76, Jože Petrišič, Reševanje enačb, 1996, FS, UNI-LJ):</p>
<div class="math notranslate nohighlight">
\[f_0(\mathbf{x})=x_0^2+x_0\,x_1-10=0,\]</div>
<div class="math notranslate nohighlight">
\[f_1(\mathbf{x})=x_1+3\,x_0\,x_1^2-57=0,\]</div>
<p>kjer je vektor <span class="math notranslate nohighlight">\(\mathbf{x}=[x_0, x_1]\)</span>.</p>
<p>Najprej definirajmo Python funkcijo, ki vrne seznam rezultatov funkcij <span class="math notranslate nohighlight">\([f_0(\mathbf{x}),f_1(\mathbf{x})]\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">57</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo še Jakobijevo matriko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                     <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>   <span class="mi">1</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
</pre></div>
</div>
</div>
</div>
<p>Uporabimo začetne vrednosti <span class="math notranslate nohighlight">\(x_0=1,5\)</span> in <span class="math notranslate nohighlight">\(x_1=3,5\)</span> ter rešimo problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span> <span class="n">jac</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">rešitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> message: The solution converged.
 success: True
  status: 1
     fun: [-6.972e-12  3.148e-11]
       x: [ 2.000e+00  3.000e+00]
    nfev: 10
    njev: 1
    fjac: [[-2.235e-01 -9.747e-01]
           [ 9.747e-01 -2.235e-01]]
       r: [-2.954e+01 -3.782e+01 -6.940e+00]
     qtf: [-2.836e-08 -1.324e-08]
</pre></div>
</div>
</div>
</div>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">root</span></code> vrne obsežen rezultat. Najbolj pomembna sta atribut <code class="docutils literal notranslate"><span class="pre">x</span></code>, ki predstavlja iskano rešitev, in atribut <code class="docutils literal notranslate"><span class="pre">success</span></code>, ki pove, ali je rešitev konvergirala:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2., 3.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span><span class="o">.</span><span class="n">success</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic">
<li><p>V simbolni obliki definirajte izraz:
$<span class="math notranslate nohighlight">\(f(x) = x^4 - 6.4\,x^3 + 6.45\,x^2 + 20.538\,x - 31.752.\)</span>$</p></li>
<li><p>Narišite funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>. Koliko ničel pričakujemo za funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span>?</p></li>
<li><p>V simbolni obliki določite ničlo polinoma <span class="math notranslate nohighlight">\(f(x)\)</span> (uporabite sympy).</p></li>
<li><p>Kako preverimo, ali je ničla ekstrem?</p></li>
<li><p>Numerično najdite vse ničle z bisekcijsko metodo (uporabite <code class="docutils literal notranslate"><span class="pre">scipy</span></code>).</p></li>
<li><p>Numerično najdite vse ničle s sekantno metodo (uporabite <code class="docutils literal notranslate"><span class="pre">scipy</span></code>).</p></li>
<li><p>Numerično najdite vse ničle z Newtonovo metodo (uporabite <code class="docutils literal notranslate"><span class="pre">scipy</span></code>).</p></li>
<li><p>Podatke:
$<span class="math notranslate nohighlight">\(x=[0, 1, 2, 3, 4, 5]\)</span><span class="math notranslate nohighlight">\(
 \)</span><span class="math notranslate nohighlight">\(y=[0.95, 0.93, 0.87, 0.77, 0.64, 0.49]\)</span><span class="math notranslate nohighlight">\(
aproksimirajte s funkcijo \)</span>\cos(a,x)<span class="math notranslate nohighlight">\( (z uporabo ``scipy.optimize.curve_fit`` določite konstanto \)</span>a$).</p></li>
<li><p>Na intervalu <span class="math notranslate nohighlight">\(x=[0, 50]\)</span> z bisekcijsko metodo poiščite vse ničle najdene funkcije <span class="math notranslate nohighlight">\(\cos(a\,x)\)</span>.</p></li>
<li><p>Na intervalu <span class="math notranslate nohighlight">\(x=[0, 50]\)</span> z Newtonovo metodo poiščite vse ničle najdene funkcije <span class="math notranslate nohighlight">\(\cos(a\,x)\)</span>.</p></li>
<li><p>S pomočjo <code class="docutils literal notranslate"><span class="pre">sympy</span></code> najdite simbolno rešitev za:
$<span class="math notranslate nohighlight">\(x^2 + y -2=0\qquad\textrm{in}\qquad  y^2 - 4=0.\)</span>$</p></li>
<li><p>Zgoraj definirani problem rešite še numerično s pomočjo <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root</span></code>.</p></li>
<li><p>Na predhodnem vprašanju preizkusite različne metode (glejte pomoč).</p></li>
<li><p>Z uporabo bisekcijske metode dimenzionirajte prikazani upogibno obremenjeni nosilec dolžine <span class="math notranslate nohighlight">\(L\)</span> (obremenjen s točkovno silo <span class="math notranslate nohighlight">\(F\)</span>). Določite velikost polnega krožnega prereza <span class="math notranslate nohighlight">\(d\)</span>.
<img src="./fig/nal-num_iskanje_nicel-1.jpg">
<span class="math notranslate nohighlight">\(F = 1 \mathrm{kN}\)</span></p>
<p><span class="math notranslate nohighlight">\(L = 1 \mathrm{m}\)</span><br>
<span class="math notranslate nohighlight">\(\sigma_{dop} = 120 \mathrm{MPa}\)</span></p>
<p>Reševanje:</p>
<p><span class="math notranslate nohighlight">\(\sigma_u \leq \sigma_{dop} \to \frac{F\,L}{W} = \frac{F\,L\,32}{\pi\,d^3} = \sigma_{dop}\)</span></p>
</li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<p>Tisti, ki ste navdušeni nad <a class="reference external" href="https://www.raspberrypi.org/">Raspberry Pi</a> in uporabljate njihovo kamero (npr. <a class="reference external" href="https://www.raspberrypi.org/products/pi-noir-camera/">tole brez infrardečega filtra</a>), vas bo morebiti zanimala knjižnica <a class="reference external" href="http://picamera.readthedocs.org/">picamera</a>.</p>
<section id="uporaba-sympy-solve-za-resevanje-enacb">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">sympy.solve</span></code> za reševanje enačb<a class="headerlink" href="#uporaba-sympy-solve-za-resevanje-enacb" title="Permalink to this heading">#</a></h3>
<p>Za manjše sisteme lahko rešitev najdemo tudi simbolno. Poglejmo si zgornji primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">funkcije</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">57</span><span class="p">]</span>
<span class="n">funkcije</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/506cc29ae356f93b39fd2c9b4327b826c18f0f60c5d4e4e7ba1602a54dfffb3b.png" src="_images/506cc29ae356f93b39fd2c9b4327b826c18f0f60c5d4e4e7ba1602a54dfffb3b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">funkcije</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Število rešitev: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Prva rešitev: </span><span class="si">{</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Število rešitev: 4
Prva rešitev: (2, 3)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-notebooks/Predavanje 10 - Numerično odvajanje"></span><section class="tex2jax_ignore mathjax_ignore" id="numericno-odvajanje">
<h2>Numerično odvajanje<a class="headerlink" href="#numericno-odvajanje" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h2>Uvod<a class="headerlink" href="#uvod" title="Permalink to this heading">#</a></h2>
<p>Vsako elementarno funkcijo lahko analitično odvajamo. Definicija odvoda je:</p>
<div class="math notranslate nohighlight">
\[
f'(x)=\lim_{\Delta x \rightarrow 0}\frac{f(x+\Delta x)-f(x)}{\Delta x}.
\]</div>
<p>Neposredna uporaba zgornje enačbe vodi v odštevanje zelo podobnih funkcijskih vrednostih (<span class="math notranslate nohighlight">\(f(x+\Delta x)\)</span>, <span class="math notranslate nohighlight">\(f(x)\)</span>), obremenjenih z zaokrožitveno napako, ki jih delimo z majhno vrednostjo <span class="math notranslate nohighlight">\(\Delta x\)</span>; posledično ima odvod bistveno manj signifikantnih števk kakor pa funkcijske vrednosti. Numeričnemu odvajanju se izognemo, če imamo to možnost; je pa v nekaterih primerih (npr. reševanje diferencialnih enačb) nepogrešljivo orodje!</p>
<p>Pri numeričnem odvajanju imamo dva, v principu različna, pristopa:</p>
<ol class="arabic simple">
<li><p>najprej izvedemo <strong>interpolacijo/aproksimacijo</strong>, nato pa na podlagi znanih interpolacijskih/aproksimacijskih funkcij izračunamo odvod (o tej temi smo že govorili pri interpolaciji oz. aproksimaciji) in</p></li>
<li><p>računanje odvoda <strong>neposredno iz vrednosti iz tabele</strong>.</p></li>
</ol>
<p>V okviru tega poglavja se bomo seznanili s tem, kako numerično izračunamo odvod funkcije <span class="math notranslate nohighlight">\(f(x)\)</span>; pri tem so vrednosti funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> podane tabelarično (pari <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(y_i\)</span>), kakor je prikazano na sliki:
<img src='./fig/odvajanje_tabela.png' width=400>
Najprej se bomo osredotočili na ekvidistantno, s korakom <span class="math notranslate nohighlight">\(h\)</span>, razporejene vrednosti <span class="math notranslate nohighlight">\(x_i\)</span>; vrednosti funkcije pa bodo <span class="math notranslate nohighlight">\(y_i=f(x_i)\)</span>.</p>
<p>Glede na zgornjo definicijo odvoda, bi prvi odvod (za mesto <span class="math notranslate nohighlight">\(i\)</span>) lahko zapisali:</p>
<div class="math notranslate nohighlight">
\[
y_i'=\frac{y_{i+1}-y_{i}}{h},
\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(h=x_{i+1}-x_{i}\)</span>. S preoblikovanjem enačbe:</p>
<div class="math notranslate nohighlight">
\[
y_i'=-\frac{y_{i}}{h}+\frac{y_{i+1}}{h},
\]</div>
<p>lahko tudi rečemo, da za prvi odvod funkcije na mestu <span class="math notranslate nohighlight">\(i\)</span>, <strong>utežimo</strong> funkcijsko vrednost pri <span class="math notranslate nohighlight">\(i\)</span> z <span class="math notranslate nohighlight">\(-1/h\)</span> in funkcijsko vrednost pri <span class="math notranslate nohighlight">\(i+1\)</span> z <span class="math notranslate nohighlight">\(+1/h\)</span>.</p>
<p>V nadaljevanju si bomo pogledali teoretično ozadje kako določimo ustrezne <strong>uteži</strong> za različne stopnje odvodov, katere možnosti pri tem imamo in kako to vpliva na red natančnosti.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="aproksimacija-prvega-odvoda-po-metodi-koncnih-razlik">
<h2>Aproksimacija prvega odvoda po metodi končnih razlik<a class="headerlink" href="#aproksimacija-prvega-odvoda-po-metodi-koncnih-razlik" title="Permalink to this heading">#</a></h2>
<p>Za uvod si oglejmo spodnji video:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;YYuGL-VP2BE&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/YYuGL-VP2BE"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>Odvod <span class="math notranslate nohighlight">\(f'(x)\)</span> lahko aproksimiramo na podlagi razvoja Taylorjeve vrste. To metodo imenujemo <strong>metoda končnih razlik</strong> ali tudi <strong>diferenčna metoda</strong>.</p>
<p>Razvijmo <strong>Taylorjevo vrsto naprej</strong> (naprej, zaradi člena <span class="math notranslate nohighlight">\(+h\)</span>):</p>
<div class="math notranslate nohighlight">
\[
f{\left (x + h \right )} =\sum_{n=0}^{\infty}\frac{h^n}{n!}\frac{d^n}{dx^n}f(x)= f{\left (x \right )} + h\, f'\left (x \right ) + \underbrace{\frac{h^2}{2}\,f''(x)+\cdots}_{\mathcal{O}\left(h^{2}\right)}
\]</div>
<p>Člen <span class="math notranslate nohighlight">\(\mathcal{O}\left(h^{2}\right)\)</span> označuje napako drugega reda. Če iz enačbe izrazimo prvi odvod:</p>
<div class="math notranslate nohighlight">
\[
f'{\left (x \right )}=\frac{1}{h}\left(f{\left (x + h \right )} - f{\left (x \right )}\right) - \underbrace{\frac{h}{2}\,f''(x)+\cdots}_{\mathcal{O}\left(h^{1}\right)}
\]</div>
<p>Ugotovimo, da lahko ocenimo prvi odvod v točki <span class="math notranslate nohighlight">\(x_i\)</span> (to je: <span class="math notranslate nohighlight">\(f_o'(x_i)\)</span>) na podlagi dveh zaporednih funkcijskih vrednosti:</p>
<div class="math notranslate nohighlight">
\[
f_o'(x_i)=\frac{1}{h}\left(y_{i+1}-y_i\right)
\]</div>
<p>in pri tem naredimo <strong>napako metode</strong>, ki je prvega reda <span class="math notranslate nohighlight">\(\mathcal{O}\left(h^{1}\right)\)</span>.</p>
<p>Uporabili smo <span class="math notranslate nohighlight">\(y_i=f(x_i)\)</span> (glejte sliko zgoraj).</p>
<p>Napaka je:</p>
<div class="math notranslate nohighlight">
\[e=-\frac{h}{2}\,f''(\xi),\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\xi\)</span> neznana vrednost na intervalu <span class="math notranslate nohighlight">\([x_i, x_{i+1}]\)</span> in smo zanemarili višje člene.</p>
<p>Velja torej izraz:</p>
<div class="math notranslate nohighlight">
\[f'(x_i)=f_o'(x_i)+e\]</div>
<p>Sedaj si poglejmo, kako pridemo do istega rezultata s strojno izpeljavo; najprej uvozimo <code class="docutils literal notranslate"><span class="pre">sympy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo simbole:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, h&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nato nadaljujemo z razvojem <strong>Taylorjeve vrste naprej</strong> (angl. <em>forward Taylor series</em>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/90a4107c3529fda9ec1f3e58e05546cef2da70362e1f3a590d00716091001428.png" src="_images/90a4107c3529fda9ec1f3e58e05546cef2da70362e1f3a590d00716091001428.png" />
</div>
</div>
<p>Člen <span class="math notranslate nohighlight">\(\mathcal{O}\left(h^{2}\right)\)</span> vsebuje člene drugega in višjega reda. V zgornji enačbi je uporabljena začasna spremenljivko za odvajanje <span class="math notranslate nohighlight">\(\xi_1\)</span>; izvedmo odvajanje in vstavimo <span class="math notranslate nohighlight">\(\xi_1=x\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c2f11a9cc0ce37e3e0a755dfe486be6d8e7009f053b1f65bc0a738fd0946f8c7.png" src="_images/c2f11a9cc0ce37e3e0a755dfe486be6d8e7009f053b1f65bc0a738fd0946f8c7.png" />
</div>
</div>
<p>Zapišemo enačbo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">enačba</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">enačba</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3ebe8d4aafe92065cbed7539aac63b807e45769ff730fe69910b58186ae08281.png" src="_images/3ebe8d4aafe92065cbed7539aac63b807e45769ff730fe69910b58186ae08281.png" />
</div>
</div>
<p>Rešimo jo za prvi odvod <span class="math notranslate nohighlight">\(f'(x)\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_naprej_točno</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">enačba</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">f1_naprej_točno</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/046eb7a3722b69f74910776f2707801d3a7187f96f1dbea19fa594b727f84e5c.png" src="_images/046eb7a3722b69f74910776f2707801d3a7187f96f1dbea19fa594b727f84e5c.png" />
</div>
</div>
<p>V kolikor odvoda drugega in višjih redov ne upoštevamo, smo naredili torej napako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_naprej_O</span> <span class="o">=</span> <span class="n">f1_naprej_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>
<span class="n">f1_naprej_O</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dba3cf105aae8161400070e9beaf8e51e70f43b51586a4cb3c37d019c17866f3.png" src="_images/dba3cf105aae8161400070e9beaf8e51e70f43b51586a4cb3c37d019c17866f3.png" />
</div>
</div>
<p>Napaka <span class="math notranslate nohighlight">\(\mathcal{O}\left(h^{1}\right)\)</span> je torej prvega reda in če ta člen zanemarimo, naredimo <em>napako metode</em> in dobimo oceno odvoda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_naprej_ocena</span> <span class="o">=</span> <span class="n">f1_naprej_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
<span class="n">f1_naprej_ocena</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/13d9df2cf53b349f327d1fd3628f4dd4ab38bdfae4be4b5efb691b1b099f6fce.png" src="_images/13d9df2cf53b349f327d1fd3628f4dd4ab38bdfae4be4b5efb691b1b099f6fce.png" />
</div>
</div>
<p>Ugotovimo, da gre za isti izraz, kakor smo ga izpeljali zgoraj, torej je:</p>
<div class="math notranslate nohighlight">
\[y_i'=\frac{1}{h}\left(-y_i+y_{i+1}\right).\]</div>
<p>Uteži torej so:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{h}\cdot\)</span></p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="centralna-diferencna-shema">
<h2>Centralna diferenčna shema<a class="headerlink" href="#centralna-diferencna-shema" title="Permalink to this heading">#</a></h2>
<section id="odvod-f-x">
<h3>Odvod <span class="math notranslate nohighlight">\(f'(x)\)</span><a class="headerlink" href="#odvod-f-x" title="Permalink to this heading">#</a></h3>
<p>Najprej si poglejmo razvoj <strong>Taylorjeve vrste nazaj</strong> (angl. <em>backward Taylor series</em>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/40b3597ea528f7945bd87d8d8dadd33d42a0e083c51cfb4b1a4772d6b9e72561.png" src="_images/40b3597ea528f7945bd87d8d8dadd33d42a0e083c51cfb4b1a4772d6b9e72561.png" />
</div>
</div>
<p>Ugotovimo, da se pri razliki vrste naprej in nazaj odštevajo členi sodega reda; definirajmo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">razlika</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">razlika</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c319f03984e378cb551addc99289b2eec4a681dd494a19f2eeeb4bea81342142.png" src="_images/c319f03984e378cb551addc99289b2eec4a681dd494a19f2eeeb4bea81342142.png" />
</div>
</div>
<p>Izvedemo sledeče korake:</p>
<ol class="arabic simple">
<li><p>Taylorjevo vrsto nazaj odštejemo od vrste naprej, sodi odvodi se odštejejo,</p></li>
<li><p>rešimo enačbo za prvi odvod,</p></li>
<li><p>določimo napako metode,</p></li>
<li><p>določimo oceno odvoda.</p></li>
</ol>
<p>Izvedimo zgornje korake:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_cent_točno</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
           <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">),</span> <span class="n">razlika</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)),</span> <span class="c1"># 1 korak</span>
           <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>                       <span class="c1"># 2.korak</span>
<span class="n">f1_cent_O</span> <span class="o">=</span> <span class="n">f1_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>         <span class="c1"># 3.korak</span>
<span class="n">f1_cent_ocena</span> <span class="o">=</span> <span class="n">f1_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>  <span class="c1"># 4.korak</span>
</pre></div>
</div>
</div>
</div>
<p>Ocena 1. odvoda torej je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_cent_ocena</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c5d646016aedbeafe676dc9ce7d75f4a9ea6ad8208726cdf0a9f833be7a985cc.png" src="_images/c5d646016aedbeafe676dc9ce7d75f4a9ea6ad8208726cdf0a9f833be7a985cc.png" />
</div>
</div>
<p>Ali:</p>
<div class="math notranslate nohighlight">
\[y_i'=\frac{1}{2h}\left(-y_{i-1}+y_{i+1}\right)\]</div>
<p>Uteži torej so:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{2h}\cdot\)</span></p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Napaka metode pa je torej drugega reda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_cent_O</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" src="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" />
</div>
</div>
</section>
<section id="zgled-exp-x">
<h3>Zgled: <span class="math notranslate nohighlight">\(\exp(-x)\)</span><a class="headerlink" href="#zgled-exp-x" title="Permalink to this heading">#</a></h3>
<p>Poglejmo si zgled eksponentne funkcije <span class="math notranslate nohighlight">\(f(x)=\exp(-x)\)</span> in za točko <span class="math notranslate nohighlight">\(x=1,0\)</span> izračunajmo prvi odvod <span class="math notranslate nohighlight">\(f'(x)=-\exp(-x)\)</span> pri koraku <span class="math notranslate nohighlight">\(h_0=1\)</span> in <span class="math notranslate nohighlight">\(h_1=0,1\)</span>.</p>
<p>Najprej pripravimo tabelo numeričnih vrednosti in točen rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span> <span class="c1"># korak h=1</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>
<span class="n">h0</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span> <span class="c1"># korak h=0.1</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">f1_točno0</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># točen rezultat</span>
<span class="n">f1_točno1</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># točen rezultat</span>
</pre></div>
</div>
</div>
</div>
<p>Potem uporabimo shemo naprej:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_naprej_ocena</span> <span class="c1"># da se spomnimo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/13d9df2cf53b349f327d1fd3628f4dd4ab38bdfae4be4b5efb691b1b099f6fce.png" src="_images/13d9df2cf53b349f327d1fd3628f4dd4ab38bdfae4be4b5efb691b1b099f6fce.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_naprej0</span> <span class="o">=</span> <span class="p">(</span><span class="n">y0</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">y0</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">h0</span>   <span class="c1"># korak h_0</span>
<span class="n">f1_naprej1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">y1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">h1</span>   <span class="c1"># korak h_1</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo napako pri <span class="math notranslate nohighlight">\(x=1,0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_točno0</span> <span class="o">-</span> <span class="n">f1_naprej0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ba2fbab0f8540d26aacbb07b4225bbacc5bbe4a833bf73db16ed03735c523109.png" src="_images/ba2fbab0f8540d26aacbb07b4225bbacc5bbe4a833bf73db16ed03735c523109.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_točno1</span> <span class="o">-</span> <span class="n">f1_naprej1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># korak h1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/230835bb62689df61dac8a529ce62054eb1037c322afe7099dd0527b4a1197c1.png" src="_images/230835bb62689df61dac8a529ce62054eb1037c322afe7099dd0527b4a1197c1.png" />
</div>
</div>
<p>Potrdimo lahko, da je napaka pri koraku <span class="math notranslate nohighlight">\(h/10\)</span> res približno 1/10 tiste pri koraku <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>Poglejmo sedaj še napako za centralno diferenčno shemo, ki je drugega reda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_cent_ocena</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c5d646016aedbeafe676dc9ce7d75f4a9ea6ad8208726cdf0a9f833be7a985cc.png" src="_images/c5d646016aedbeafe676dc9ce7d75f4a9ea6ad8208726cdf0a9f833be7a985cc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_cent0</span> <span class="o">=</span> <span class="p">(</span><span class="n">y0</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">-</span><span class="n">y0</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h0</span><span class="p">)</span> <span class="c1"># korak h_0</span>
<span class="n">f1_cent1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">-</span><span class="n">y1</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h1</span><span class="p">)</span> <span class="c1"># korak h_1</span>
</pre></div>
</div>
</div>
</div>
<p>Analizirajmo napako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_točno0</span> <span class="o">-</span> <span class="n">f1_cent0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># korak h0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bf9b126dbc8e9633c43bcd96179f4ef5c677c52b9fd8cfd9963da1c84a342942.png" src="_images/bf9b126dbc8e9633c43bcd96179f4ef5c677c52b9fd8cfd9963da1c84a342942.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_točno1</span> <span class="o">-</span> <span class="n">f1_cent1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># korak h1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f4a69bd8d8abae044936a87ca89d67c5c26c096b9872d38204eeb2279a6b2b46.png" src="_images/f4a69bd8d8abae044936a87ca89d67c5c26c096b9872d38204eeb2279a6b2b46.png" />
</div>
</div>
<p>Potrdimo lahko, da je napaka pri koraku <span class="math notranslate nohighlight">\(h/10\)</span> res približno 1/100 tiste pri koraku <span class="math notranslate nohighlight">\(h\)</span>.</p>
</section>
<section id="id1">
<h3>Odvod <span class="math notranslate nohighlight">\(f''(x)\)</span><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>Če Taylorjevo vrsto naprej in nazaj seštejemo, se odštejejo lihi odvodi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">vsota</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">vsota</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/55774f8d7ead89855a2ced7f8e76db0b5c6bdea27e0682e892d11d2af0d7cd80.png" src="_images/55774f8d7ead89855a2ced7f8e76db0b5c6bdea27e0682e892d11d2af0d7cd80.png" />
</div>
</div>
<p>Določimo drugi odvod:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f2_cent_točno</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
           <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">),</span> <span class="n">vsota</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)),</span>   <span class="c1"># 1 korak</span>
           <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>                     <span class="c1"># 2.korak</span>
<span class="n">f2_cent_O</span> <span class="o">=</span> <span class="n">f2_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>         <span class="c1"># 3.korak</span>
<span class="n">f2_cent_ocena</span> <span class="o">=</span> <span class="n">f2_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>  <span class="c1"># 4.korak</span>
</pre></div>
</div>
</div>
</div>
<p>Ocena drugega odvoda je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f2_cent_ocena</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f4d02b9c7b7289d758b9ea5faf94e74206b9f7bbd572aef685dc2a886c541bd4.png" src="_images/f4d02b9c7b7289d758b9ea5faf94e74206b9f7bbd572aef685dc2a886c541bd4.png" />
</div>
</div>
<p>Ali:</p>
<div class="math notranslate nohighlight">
\[y_i''=\frac{1}{h^2}\left(y_{i-1}-2\,y_{i}+y_{i+1}\right)\]</div>
<p>Uteži torej so:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i''=\frac{1}{h^2}\cdot\)</span></p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-2</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Napaka metode pa je ponovno drugega reda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f2_cent_O</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" src="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" />
</div>
</div>
</section>
<section id="id2">
<h3>Odvod <span class="math notranslate nohighlight">\(f'''(x)\)</span><a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>Če želimo določiti tretji odvod, moramo Taylorjevo vrsto razviti do stopnje 5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq_h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">),</span> <span class="n">razlika</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="n">eq_h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b59256f34c5d1f21b7df31f0b603b1e859c2cd04431768435f2a08d0af51780b.png" src="_images/b59256f34c5d1f21b7df31f0b603b1e859c2cd04431768435f2a08d0af51780b.png" />
</div>
</div>
<p>Uporaba 1. odvoda, ki smo ga izpeljali zgoraj, nam ne bi koristila, saj je red napake <span class="math notranslate nohighlight">\(\mathcal{O}\left(h^{2}\right)\)</span>, kar pomeni, da bi v zgornji pri deljenju s <span class="math notranslate nohighlight">\(h^3\)</span> dobili <span class="math notranslate nohighlight">\(\mathcal{O}\left(h^{-1}\right)\)</span>.</p>
<p>Uporabimo trik: ponovimo razvoj, vendar na podlagi dodatnih točk, ki sta od <span class="math notranslate nohighlight">\(x\)</span> oddaljeni za <span class="math notranslate nohighlight">\(2h\)</span> in <span class="math notranslate nohighlight">\(-2h\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq_2h</span> <span class="o">=</span> <span class="n">eq_h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
<span class="n">eq_2h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/83ef55e404a14700050cba26f98b24a508817b5958ecc39486fec79a10be3236.png" src="_images/83ef55e404a14700050cba26f98b24a508817b5958ecc39486fec79a10be3236.png" />
</div>
</div>
<p>Sedaj imamo dve enačbi in dve neznanki; sistem bomo rešili po korakih:</p>
<ol class="arabic simple">
<li><p>enačbo <code class="docutils literal notranslate"><span class="pre">eq_h</span></code> rešimo za prvi odvod,</p></li>
<li><p>enačbo <code class="docutils literal notranslate"><span class="pre">eq_2h</span></code> rešimo za prvi odvod,</p></li>
<li><p>enačimo rezultata prvih dveh korakov in rešimo za tretji odvod,</p></li>
<li><p>določimo napako metode,</p></li>
<li><p>določimo oceno odvoda.</p></li>
</ol>
<p>Izvedimo navedene korake:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f3_cent_točno</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
        <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eq_h</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># 1. korak</span>
        <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eq_2h</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">]),</span>       <span class="c1"># 2. korak</span>
        <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>                        <span class="c1"># 3. korak</span>
<span class="n">f3_cent_O</span> <span class="o">=</span> <span class="n">f3_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>         <span class="c1"># 4.korak</span>
<span class="n">f3_cent_ocena</span> <span class="o">=</span> <span class="n">f3_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>  <span class="c1"># 5.korak</span>
</pre></div>
</div>
</div>
</div>
<p>Ocena 3. odvoda je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f3_cent_ocena</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/11662643d87704e75600f1afe387e226a454cb9b3b12e5931c4fcf25a3908bae.png" src="_images/11662643d87704e75600f1afe387e226a454cb9b3b12e5931c4fcf25a3908bae.png" />
</div>
</div>
<p>Ali:</p>
<div class="math notranslate nohighlight">
\[y_i'''=\frac{1}{h^3}\left(-y_{i-2}/2+y_{i-1}-y_{i+1}+y_{i+2}/2\right)\]</div>
<p>Uteži torej so:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+2}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'''=\frac{1}{h^3}\cdot\)</span></p></td>
<td class="text-center"><p>-0.5</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>0.5</p></td>
</tr>
</tbody>
</table>
<p>Potrdimo, da je napaka metode drugega reda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f3_cent_O</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" src="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" />
</div>
</div>
</section>
<section id="odvod-f-4-x">
<h3>Odvod <span class="math notranslate nohighlight">\(f^{(4)}(x)\)</span><a class="headerlink" href="#odvod-f-4-x" title="Permalink to this heading">#</a></h3>
<p>Ponovimo podoben postopek kot za 3. odvod, vendar za 4. odvod seštevamo Taylorjevo vrsto (do stopnje 6) naprej in nazaj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq_h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">),</span> <span class="n">vsota</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
<span class="n">eq_h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ac18da98ea6603074ac533367e7bc53d3b46830e6ea8cdf149fac4789cfdd94c.png" src="_images/ac18da98ea6603074ac533367e7bc53d3b46830e6ea8cdf149fac4789cfdd94c.png" />
</div>
</div>
<p>Pripravimo dodatno enačbo na podlagi točk, ki sta od <span class="math notranslate nohighlight">\(x\)</span> oddaljeni za <span class="math notranslate nohighlight">\(2h\)</span> in <span class="math notranslate nohighlight">\(-2h\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq_2h</span> <span class="o">=</span> <span class="n">eq_h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
<span class="n">eq_2h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a714764c31548424ad22a685c32b856fd15fb6ffa9f2ea81c62f1d65d1cc7867.png" src="_images/a714764c31548424ad22a685c32b856fd15fb6ffa9f2ea81c62f1d65d1cc7867.png" />
</div>
</div>
<p>Iz dveh enačb določimo 4. odvod:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f4_cent_točno</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
        <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eq_h</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># 1. korak</span>
        <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eq_2h</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]),</span>       <span class="c1"># 2. korak</span>
        <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>                          <span class="c1"># 3. korak</span>
<span class="n">f4_cent_O</span> <span class="o">=</span> <span class="n">f4_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>           <span class="c1"># 4.korak</span>
<span class="n">f4_cent_ocena</span> <span class="o">=</span> <span class="n">f4_cent_točno</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>    <span class="c1"># 5.korak</span>
</pre></div>
</div>
</div>
</div>
<p>Ocena 4. odvoda je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f4_cent_ocena</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0ef22f4420460966850efe04c9869996c4ffb8332b3185b1846f7329497c2fc1.png" src="_images/0ef22f4420460966850efe04c9869996c4ffb8332b3185b1846f7329497c2fc1.png" />
</div>
</div>
<p>Ali:</p>
<div class="math notranslate nohighlight">
\[y_i^{(4)}=\frac{1}{h^4}\left(y_{i-2}-4\,y_{i-1}+6\,y_i-4\,y_{i+1}+y_{i+2}\right)\]</div>
<p>Uteži torej so:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+2}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i^{(4)}=\frac{1}{h^4}\cdot\)</span></p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>6</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Potrdimo, da je napaka metode drugega reda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f4_cent_O</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" src="_images/919118b034b43743a94213d4a29a41281772708497d122d00de7afe6b3f67e16.png" />
</div>
</div>
</section>
<section id="povzetek-centralne-diferencne-sheme">
<h3>Povzetek centralne diferenčne sheme*<a class="headerlink" href="#povzetek-centralne-diferencne-sheme" title="Permalink to this heading">#</a></h3>
<p>Zgoraj smo izpeljali prve štiri odvode z napako metode 2. reda. Bistvo zgornjih izpeljav je, da nam dajo <strong>uteži</strong>, s katerimi moramo množiti funkcijske vrednosti, da izračunamo približek določenega odvoda. Iz tega razloga bomo tukaj te uteži zbrali. Če ste neučakani, lahko skočite na tabelo spodaj. Z branjem nadaljujte, če pa želite spoznati, kako predhodno izpeljane izraze strojno uredimo.</p>
<p>Najprej zberimo vse ocene odvodov v seznam:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odvodi</span> <span class="o">=</span> <span class="p">[</span><span class="n">f1_cent_ocena</span><span class="p">,</span> <span class="n">f2_cent_ocena</span><span class="p">,</span> <span class="n">f3_cent_ocena</span><span class="p">,</span> <span class="n">f4_cent_ocena</span><span class="p">]</span>
<span class="n">odvodi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9aabdb9f5752a81563ddeaab54d089e0839bcae8975140c824ec878bdd1ae5a1.png" src="_images/9aabdb9f5752a81563ddeaab54d089e0839bcae8975140c824ec878bdd1ae5a1.png" />
</div>
</div>
<p>Na razpolago imamo 5 funkcijskih vrednosti (pri legah <span class="math notranslate nohighlight">\(x-2h, x-h, x, x+h, x+2h\)</span>), ki jih damo v seznam:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">funkcijske_vrednosti</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Utež prvega odvoda za funkcijsko vrednosti <span class="math notranslate nohighlight">\(f(x-h)\)</span> izračunamo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_cent_ocena</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">funkcijske_vrednosti</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5c19f8685f6f08fe29758af67c15a08d9b640c75611f4318035ff2ef7c4e42ba.png" src="_images/5c19f8685f6f08fe29758af67c15a08d9b640c75611f4318035ff2ef7c4e42ba.png" />
</div>
</div>
<p>Sedaj posplošimo in izračunajmo uteži za vse funkcijske vrednosti in za vse ocene odvodov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centralna_diff_shema</span> <span class="o">=</span> <span class="p">[[</span><span class="n">odvod</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">fv</span><span class="p">)</span> <span class="k">for</span> <span class="n">fv</span> <span class="ow">in</span> <span class="n">funkcijske_vrednosti</span><span class="p">]</span> \
                        <span class="k">for</span> <span class="n">odvod</span> <span class="ow">in</span> <span class="n">odvodi</span><span class="p">]</span>
<span class="n">centralna_diff_shema</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c6f6af67dd9b2723986985cc66c3578128ddb4784699f5eeb663db8548128b43.png" src="_images/c6f6af67dd9b2723986985cc66c3578128ddb4784699f5eeb663db8548128b43.png" />
</div>
</div>
<p>Zgornje povzetke lahko tudi zapišemo v tabelarični obliki:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+2}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{h}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-0.5</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0.5</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i''=\frac{1}{h^2}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-2</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'''=\frac{1}{h^3}\cdot\)</span></p></td>
<td class="text-center"><p>-0.5</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>0.5</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i^{(4)}=\frac{1}{h^4}\cdot\)</span></p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>6</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Prikazana centralna diferenčna shema ima napako 2. reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2})\)</span>.</p>
</section>
<section id="uporaba-scipy-misc-central-diff-weights">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.misc.central_diff_weights</span></code><a class="headerlink" href="#uporaba-scipy-misc-central-diff-weights" title="Permalink to this heading">#</a></h3>
<p>Uteži za centralno diferenčno metodo lahko izračunamo tudi z uporabo <code class="docutils literal notranslate"><span class="pre">scipy.misc.central_diff_weights()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.misc.central_diff_weights.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">central_diff_weights</span><span class="p">(</span><span class="n">Np</span><span class="p">,</span> <span class="n">ndiv</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Np</span></code> predstavlja število točk, čez katere želimo izračunati odvod, <code class="docutils literal notranslate"><span class="pre">ndiv</span></code> pa stopnjo odvoda (privzeto 1).
Za več informacij glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.misc.central_diff_weights.html">dokumentacijo</a>.</p>
<p>Uvozimo funkcijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">central_diff_weights</span>
</pre></div>
</div>
</div>
</div>
<p>3<span class="math notranslate nohighlight">\(.\)</span> odvod (čez pet točk), napaka reda  <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2})\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central_diff_weights</span><span class="p">(</span><span class="n">Np</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ndiv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\janko\AppData\Local\Temp\ipykernel_23776\2871079054.py:1: DeprecationWarning: scipy.misc.central_diff_weights is deprecated in SciPy v1.10.0; and will be completely removed in SciPy v1.12.0. You may consider using findiff: https://github.com/maroba/findiff or numdifftools: https://github.com/pbrod/numdifftools
  central_diff_weights(Np=5, ndiv=3)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-5.00000000e-01,  1.00000000e+00, -4.16333634e-17, -1.00000000e+00,
        5.00000000e-01])
</pre></div>
</div>
</div>
</div>
<p>Opomba: <code class="docutils literal notranslate"><span class="pre">SymPy.finite_diff_weights</span></code> omogoča izračun uteži tudi pri nekonstantnem koraku; v podrobnosti ne bomo šli in radovednega bralca napotimo na <a class="reference external" href="http://docs.sympy.org/latest/modules/calculus/index.html#sympy.calculus.finite_diff.finite_diff_weights">dokumentacijo</a>.</p>
</section>
<section id="izboljsan-priblizek-richardsonova-ekstrapolacija">
<h3>Izboljšan približek - Richardsonova ekstrapolacija<a class="headerlink" href="#izboljsan-priblizek-richardsonova-ekstrapolacija" title="Permalink to this heading">#</a></h3>
<p>Če je točen odvod je izračunan kot:</p>
<div class="math notranslate nohighlight">
\[f'(x_i)=f_o'(x_i)+e,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(f_o'(x_i)\)</span> numerično izračunan odvod v točki <span class="math notranslate nohighlight">\(x_i\)</span> in <span class="math notranslate nohighlight">\(e\)</span> ocena napake.</p>
<p>Za metodo reda točnosti <span class="math notranslate nohighlight">\(n\)</span>: <span class="math notranslate nohighlight">\(\mathcal{O}(h^{n})\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> velja:
$<span class="math notranslate nohighlight">\(f'(x_i)=f_o'(x_i, h)+K\,h^n,\)</span><span class="math notranslate nohighlight">\(
kjer je \)</span>K$ neznana konstanta.</p>
<p>Če korak razpolovimo in predpostavimo, da se <span class="math notranslate nohighlight">\(K\)</span> ne spremeni, velja:
$<span class="math notranslate nohighlight">\(f'(x_i)=f_o'\left(x_i, \frac{h}{2}\right)+K\,\left(\frac{h}{2}\right)^n.\)</span>$</p>
<p>Iz obeh enačb izločimo konstanto <span class="math notranslate nohighlight">\(K\)</span> in določimo izboljšan približek:
$<span class="math notranslate nohighlight">\(\overline{f}'(x_i)=\frac{2^n\,f_o'\left(x_i, \frac{h}{2}\right)-f_o'(x_i, h)}{2^n-1}\)</span>$</p>
<section id="zgled">
<h4>Zgled<a class="headerlink" href="#zgled" title="Permalink to this heading">#</a></h4>
<p>Poglejmo si zgled <span class="math notranslate nohighlight">\(f(x)=\sin(x)\)</span> (analitični odvod je: <span class="math notranslate nohighlight">\(f'(x)=\cos(x)\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pri koraku <span class="math notranslate nohighlight">\(h\)</span> imamo funkcijske vrednosti definirane pri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.        , 0.78539816, 1.57079633, 2.35619449, 3.14159265,
       3.92699082, 4.71238898, 5.49778714, 6.28318531])
</pre></div>
</div>
</div>
</div>
<p>Numerični odvod pri <span class="math notranslate nohighlight">\(x=\pi\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2d9f72456ab4a8087babd6d0004d973c33824617aa24362d01151805d0c09784.png" src="_images/2d9f72456ab4a8087babd6d0004d973c33824617aa24362d01151805d0c09784.png" />
</div>
</div>
<p>in koraku <span class="math notranslate nohighlight">\(h\)</span> je</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">f_ocena_h</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="n">h</span>
<span class="n">f_ocena_h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eab88a604ae9462da1c12f43991d2c05eede1cb71adbdc55fce14b2709ba2533.png" src="_images/eab88a604ae9462da1c12f43991d2c05eede1cb71adbdc55fce14b2709ba2533.png" />
</div>
</div>
<p>Izračun pri koraku <span class="math notranslate nohighlight">\(2h\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h2</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">f_ocena_2h</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="o">/</span><span class="n">h2</span>
<span class="n">f_ocena_2h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c1e9135fbef07e1784bc40bb390537f61454298874ba426c9bd9ddc4a59114bc.png" src="_images/c1e9135fbef07e1784bc40bb390537f61454298874ba426c9bd9ddc4a59114bc.png" />
</div>
</div>
<p>Izračunajmo izboljšano oceno za <span class="math notranslate nohighlight">\(x=\pi\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_ocena_izboljšana</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f_ocena_h</span> <span class="o">-</span> <span class="n">f_ocena_2h</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">f_ocena_izboljšana</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cc3ea6ca61de57503b1f74e466e64cc6f8d6334f051c2d0c38b57aad613463d9.png" src="_images/cc3ea6ca61de57503b1f74e466e64cc6f8d6334f051c2d0c38b57aad613463d9.png" />
</div>
</div>
<p>Vidimo, da je izboljšana ocena najbližje teoretični vrednosti <span class="math notranslate nohighlight">\(\cos(\pi)=-1\)</span>.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="necentralna-diferencna-shema">
<h2>Necentralna diferenčna shema<a class="headerlink" href="#necentralna-diferencna-shema" title="Permalink to this heading">#</a></h2>
<p>Centralna diferenčna shema, ki smo jo spoznali zgoraj, je zelo uporabna in relativno natančna. Ker pa je ne moremo vedno uporabiti (recimo na začetku ali koncu tabele), si moramo pomagati z <strong>necentralnimi diferenčnimi shemami</strong> za računanje odvodov.</p>
<p>Poznamo:</p>
<ul class="simple">
<li><p><strong>diferenčno shemo naprej</strong>, ki odvod točke aproksimira z vrednostmi funkcije v naslednjih  točkah in</p></li>
<li><p><strong>diferenčno shemo nazaj</strong>, ki odvod točke aproksimira z vrednostmi v predhodnih točkah.</p></li>
</ul>
<p>Izpeljave so podobne, kakor smo prikazali za centralno diferenčno shemo, zato jih tukaj ne bomo obravnavali in bomo prikazali samo končni rezultat.</p>
<section id="diferencna-shema-naprej">
<h3>Diferenčna shema naprej<a class="headerlink" href="#diferencna-shema-naprej" title="Permalink to this heading">#</a></h3>
<p>Diferenčna shema naprej z redom napake <span class="math notranslate nohighlight">\(\mathcal{O}(h^{1})\)</span>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+3}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+4}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{h}\cdot\)</span></p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i''=\frac{1}{h^2}\cdot\)</span></p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-2</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'''=\frac{1}{h^3}\cdot\)</span></p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>3</p></td>
<td class="text-center"><p>-3</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i^{(4)}=\frac{1}{h^4}\cdot\)</span></p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>6</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Diferenčna shema naprej z redom napake <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2})\)</span>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+3}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+5}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{2h}\cdot\)</span></p></td>
<td class="text-center"><p>-3</p></td>
<td class="text-center"><p>4</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i''=\frac{1}{h^2}\cdot\)</span></p></td>
<td class="text-center"><p>2</p></td>
<td class="text-center"><p>-5</p></td>
<td class="text-center"><p>4</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'''=\frac{1}{2h^3}\cdot\)</span></p></td>
<td class="text-center"><p>-5</p></td>
<td class="text-center"><p>18</p></td>
<td class="text-center"><p>-24</p></td>
<td class="text-center"><p>14</p></td>
<td class="text-center"><p>-3</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i^{(4)}=\frac{1}{h^4}\cdot\)</span></p></td>
<td class="text-center"><p>3</p></td>
<td class="text-center"><p>-14</p></td>
<td class="text-center"><p>26</p></td>
<td class="text-center"><p>-24</p></td>
<td class="text-center"><p>11</p></td>
<td class="text-center"><p>-2</p></td>
</tr>
</tbody>
</table>
</section>
<section id="diferencna-shema-nazaj">
<h3>Diferenčna shema nazaj<a class="headerlink" href="#diferencna-shema-nazaj" title="Permalink to this heading">#</a></h3>
<p>Diferenčna shema nazaj z redom napake <span class="math notranslate nohighlight">\(\mathcal{O}(h^{1})\)</span>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-3}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{h}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i''=\frac{1}{h^2}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-2</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'''=\frac{1}{h^3}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>3</p></td>
<td class="text-center"><p>-3</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i^{(4)}=\frac{1}{h^4}\cdot\)</span></p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>6</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Diferenčna shema nazaj z redom napake <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2})\)</span>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-5}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-3}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{2h}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>3</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i''=\frac{1}{h^2}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>4</p></td>
<td class="text-center"><p>-5</p></td>
<td class="text-center"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'''=\frac{1}{2h^3}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>3</p></td>
<td class="text-center"><p>-14</p></td>
<td class="text-center"><p>24</p></td>
<td class="text-center"><p>-18</p></td>
<td class="text-center"><p>5</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i^{(4)}=\frac{1}{h^4}\cdot\)</span></p></td>
<td class="text-center"><p>-2</p></td>
<td class="text-center"><p>11</p></td>
<td class="text-center"><p>-24</p></td>
<td class="text-center"><p>26</p></td>
<td class="text-center"><p>-14</p></td>
<td class="text-center"><p>3</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uporaba-numpy-gradient">
<h2>Uporaba <code class="docutils literal notranslate"><span class="pre">numpy.gradient</span></code><a class="headerlink" href="#uporaba-numpy-gradient" title="Permalink to this heading">#</a></h2>
<p>Za izračun numeričnih odvodov (centralna diferenčna shema 2. reda) lahko uporabimo tudi <code class="docutils literal notranslate"><span class="pre">numpy.gradient()</span></code> (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.gradient.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gradient</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">varargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer <code class="docutils literal notranslate"><span class="pre">f</span></code> predstavlja tabelo vrednosti (v obliki numeričnega polja) funkcije, katere odvod iščemo. <code class="docutils literal notranslate"><span class="pre">f</span></code> je lahko ene ali več dimenzij. Pozicijski parametri <code class="docutils literal notranslate"><span class="pre">varargs</span></code> definirajo razdaljo med vrednostmi argumenta funkcije <code class="docutils literal notranslate"><span class="pre">f</span></code>; privzeta vrednost je 1. Ta vrednost je lahko skalar, lahko pa tudi seznam vrednosti neodvisne spremenljivke (ali tudi kombinacija obojega). Gradientna metoda na robovih uporabi shemo naprej oziroma nazaj; parameter <code class="docutils literal notranslate"><span class="pre">edge_order</span></code> definira red sheme, ki se uporabi na robovih (izbiramo lahko med 1 ali 2, privzeta vrednost je 1).</p>
<p>Rezultat funkcije <code class="docutils literal notranslate"><span class="pre">gradient</span></code> je numerični seznam (ali seznam numeričnih seznamov) z izračunanimi odvodi.</p>
<p>Za podrobnosti glejte <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.gradient.html">dokumentacijo</a>.</p>
<section id="id3">
<h3>Zgled<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>Pogledali si bomo zgled, kako uporabimo <strong>uteži</strong>, funkcijo gradient in posebnosti na robovih. Najprej pripravimo tabelo podatkov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Uteži diferenčih shem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centralna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span> <span class="c1"># bi lahko tudi pridobili prek central_diff_weights(3,1)</span>
<span class="n">naprej</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="n">nazaj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj izvedemo odvod notranjih točk (prvi način je z izpeljevanjem seznamov, drugi je vektoriziran):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odvod_notranje</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">@</span> <span class="n">centralna</span><span class="o">/</span><span class="n">h</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span> <span class="c1"># izpeljevanje seznamov</span>
<span class="n">odvod_notranje</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">centralna</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span> <span class="c1"># vektoriziran</span>
</pre></div>
</div>
</div>
</div>
<p>Na robovih uporabimo diferenčno shemo naprej oziroma nazaj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odvod_prva</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">naprej</span><span class="p">)]</span> <span class="o">@</span> <span class="n">naprej</span> <span class="o">/</span> <span class="n">h</span>  <span class="c1"># naprej</span>
<span class="n">odvod_zadnja</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nazaj</span><span class="p">):]</span> <span class="o">@</span> <span class="n">nazaj</span> <span class="o">/</span> <span class="n">h</span> <span class="c1"># nazaj</span>
</pre></div>
</div>
</div>
</div>
<p>Sestavimo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odvod_cel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">odvod_prva</span><span class="p">,</span> <span class="n">odvod_notranje</span><span class="p">,</span> <span class="n">odvod_zadnja</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat skupaj z rezultatom funkcije <code class="docutils literal notranslate"><span class="pre">np.gradient</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">odvod_cel</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lastna implementacija&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="s1">&#39;g.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;np.gradient, edge_order=1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">edge_order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;np.gradient, edge_order=2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8c866f5e38f192deb04afe67d988cafd986488cf07af8b76eb00009b3ae1bafa.png" src="_images/8c866f5e38f192deb04afe67d988cafd986488cf07af8b76eb00009b3ae1bafa.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="zaokrozitvena-napaka-pri-numericnem-odvajanju">
<h2>Zaokrožitvena napaka pri numeričnem odvajanju*<a class="headerlink" href="#zaokrozitvena-napaka-pri-numericnem-odvajanju" title="Permalink to this heading">#</a></h2>
<p>Zgoraj smo se osredotočili na napako metode. Pri numeričnem odvajanju pa moramo biti zelo pozorni tudi na <strong>zaokrožitveno</strong> (ali tudi <em>upodobitveno</em>) napako! Poglejmo si prvi odvod (po centralni diferenčni shemi) zapisan z napako metode (<span class="math notranslate nohighlight">\(k\,h^2\)</span>) in zaokrožitveno napako <span class="math notranslate nohighlight">\(\varepsilon\)</span>:</p>
<div class="math notranslate nohighlight">
\[y_i'=\frac{1}{2h}\left((-y_{i-1}\pm\varepsilon)+(y_{i+1}\pm\varepsilon)\right) + k\,h^2\]</div>
<p>V najslabšem primeru se zaokrožitvena napaka sešteje in je skupna napaka:</p>
<div class="math notranslate nohighlight">
\[n=\frac{\varepsilon}{h}+k\,h^2\]</div>
<p>Ko je <span class="math notranslate nohighlight">\(h\)</span> velik prevladuje napaka metode <span class="math notranslate nohighlight">\(k\,h^2\)</span>; ko pa je <span class="math notranslate nohighlight">\(h\)</span> majhen, pa prevladuje zaokrožitvena napaka. Napaka ima minimum, ko velja:</p>
<div class="math notranslate nohighlight">
\[n'=-\frac{\varepsilon}{h^2}+2\,k\,h=0.\]</div>
<p>Sledi:</p>
<div class="math notranslate nohighlight">
\[h=\sqrt[3]{\frac{\varepsilon}{2\,k}}.\]</div>
<section id="id4">
<h3>Zgled<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>Spodaj si bomo pogledali primer, kjer bomo natančnost spreminjali v treh korakih:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">float16</span></code> -
16-bitni zapis: predznak 1 bit, 5 bitov eksponent, 10 bitov mantisa</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float32</span></code> -
32-bitni zapis: predznak 1 bit, 8 bitov eksponent, 23 bitov mantisa</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float64</span></code> -
64-bitni zapis: predznak 1 bit, 11 bitov eksponent, 52 bitov mantisa (to je privzeta natančnost).</p></li>
</ol>
<p>Za več o tipih v <code class="docutils literal notranslate"><span class="pre">numpy</span></code> glejte <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.types.html">dokumentacijo</a></p>
<p>Določimo sedaj osnovno zaokrožitveno napako za posamezni tip:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps16</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
<span class="n">eps32</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
<span class="n">eps64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Osnovna zaokrožitvena napaka za tipe </span><span class="se">\</span>
<span class="s1">`float16`, `float32` in `float64` je:</span><span class="se">\n</span><span class="si">{</span><span class="p">[</span><span class="n">eps16</span><span class="p">,</span><span class="w"> </span><span class="n">eps32</span><span class="p">,</span><span class="w"> </span><span class="n">eps64</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Osnovna zaokrožitvena napaka za tipe `float16`, `float32` in `float64` je:
[0.000977, 1.1920929e-07, 2.220446049250313e-16]
</pre></div>
</div>
</div>
</div>
<p>Kot primer si poglejmo seštevanje: k številu <code class="docutils literal notranslate"><span class="pre">1.</span></code> prištejemo polovico osnovne zaokrožitvene napake <code class="docutils literal notranslate"><span class="pre">eps16</span></code> in pretvorimo v tip <code class="docutils literal notranslate"><span class="pre">float16</span></code>, ugotovimo, da je nova vrednost še vedno enaka vrednosti <code class="docutils literal notranslate"><span class="pre">1.</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eps16</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float16&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Definirajmo najprej funkcijo <span class="math notranslate nohighlight">\(\exp(x)\)</span>, ki bo dala rezultat natančnosti, ki jo definira parameter <code class="docutils literal notranslate"><span class="pre">dtype</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span> <span class="c1"># funkcija</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dtype</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[58], line 1
----&gt; 1 def fun(x, dtype=np.float): # funkcija
      2     return np.exp(-dtype(x)).astype(dtype)

File ~\AppData\Local\Programs\Python\Python311\Lib\site-packages\numpy\__init__.py:319, in __getattr__(attr)
    314     warnings.warn(
    315         f&quot;In the future `np.{attr}` will be defined as the &quot;
    316         &quot;corresponding NumPy scalar.&quot;, FutureWarning, stacklevel=2)
    318 if attr in __former_attrs__:
--&gt; 319     raise AttributeError(__former_attrs__[attr])
    321 if attr == &#39;testing&#39;:
    322     import numpy.testing as testing

AttributeError: module &#39;numpy&#39; has no attribute &#39;float&#39;.
`np.float` was a deprecated alias for the builtin `float`. To avoid this error in existing code, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
The aliases was originally deprecated in NumPy 1.20; for more details and guidance see the original release note at:
    https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
</pre></div>
</div>
</div>
</div>
<p>Definirajmo še funkcijo za analitično določljiv odvod (to bomo pozneje potrebovali za določitev relativne napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="c1"># &quot;točen&quot; odvod funkcije</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Podobno kakor zgoraj pri seštevanju, lahko tudi pri vrednosti funkcije ugotovimo, da sprememba vrednosti <span class="math notranslate nohighlight">\(x\)</span>, ki je manjša od <span class="math notranslate nohighlight">\(\epsilon\)</span>, vodi v isti rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eps16</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Uporabimo sedaj centralno diferenčno shemo za prvi odvod. Pri tem naj bodo števila zapisana z natančnostjo <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, s pomočjo točnega odvoda pa se izračuna še relativna napaka:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1_CDS</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
    <span class="n">f1_ocena</span> <span class="o">=</span> <span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span><span class="o">-</span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dtype</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
    <span class="n">f1_točno</span> <span class="o">=</span> <span class="n">f1_fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">relativna_napaka</span> <span class="o">=</span> <span class="p">(</span><span class="n">f1_točno</span> <span class="o">-</span> <span class="n">f1_ocena</span><span class="p">)</span> <span class="o">/</span> <span class="n">f1_točno</span>
    <span class="k">return</span> <span class="n">f1_ocena</span><span class="p">,</span> <span class="n">relativna_napaka</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo primer odvoda pri <span class="math notranslate nohighlight">\(x=1,0\)</span> (Python funkcija vrne vrednost in relativno napako):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_CDS</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_CDS</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo sedaj korak:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">=</span><span class="mf">0.25</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">h</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunamo oceno odvodov za različne natančnosti zapisa (zaradi deljenja z 0 dobimo opozorilo):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_16</span> <span class="o">=</span> <span class="n">f1_CDS</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="n">f1_32</span> <span class="o">=</span> <span class="n">f1_CDS</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">f1_64</span> <span class="o">=</span> <span class="n">f1_CDS</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izrišemo različne tipe v odvisnosti od velikosti koraka <span class="math notranslate nohighlight">\(h\)</span>. Najprej uvozimo potrebne knjižnice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Definirajmo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_ocena</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f1_16</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;float16&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f1_32</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f1_64</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;float64=float&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ocena odvoda za različne tipe natančnosti&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$h$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ocena odvoda: $-\exp(-1)=−0.3678794$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.365</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo jo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_ocena</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Pri relativno velikem koraku <span class="math notranslate nohighlight">\(h\)</span> prevladuje napaka metode, pri majhnem koraku pa zaokrožitvnea napaka; optimalni korak lahko ocenimo glede na:</p>
<div class="math notranslate nohighlight">
\[h=\sqrt[3]{\frac{\varepsilon}{2\,k}}.\]</div>
<p>V konkretnem primeru velja:</p>
<div class="math notranslate nohighlight">
\[k=-\frac{f'''(x)}{6}=-\frac{-e^{-x}}{6}=\frac{1}{6\,e}\qquad(x=1)\]</div>
<p>Sledi:</p>
<div class="math notranslate nohighlight">
\[h=\sqrt[3]{3\,\varepsilon\,e}.\]</div>
<p>Izračunamo primeren korak za 16, 32 in 64-bitni zapis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">eps16</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">eps32</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">eps64</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Najbolje se izkaže 64-bitni zapis, vendar pa tudi pri tem korak manjši od cca <code class="docutils literal notranslate"><span class="pre">1e-5</span></code> ni priporočen!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="aproksimacija-odvoda-s-kompleksnim-korakom">
<h2>Aproksimacija odvoda s kompleksnim korakom*<a class="headerlink" href="#aproksimacija-odvoda-s-kompleksnim-korakom" title="Permalink to this heading">#</a></h2>
<p>Aproksimacija odvoda s kompleksnim korakom je uporabna takrat, ko imamo definirano analitično funkcijo, vendar pa nimamo na voljo analitičnega izraza za prvi odvod, za podrobnosti glejte <a class="reference external" href="https://nhigham.com/2020/10/06/what-is-the-complex-step-approximation/">vir</a>. Ideja izhaja iz razvoja funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> v Taylorjevo vrsto, vendar se izvede korak v smeri imaginarne osi <span class="math notranslate nohighlight">\(i\,h\)</span> (<span class="math notranslate nohighlight">\(i=\sqrt(-1)\)</span>):</p>
<div class="math notranslate nohighlight">
\[f{\left(x + i\,h \right)} = f{\left(x \right)} + i\,h\,\frac{d}{d x} f{\left(x \right)} - \frac{h^{2}}{2} \frac{d^{2}}{d x^{2}} f{\left(x \right)} + O\left(h^{3}\right)\]</div>
<p>Če sedaj predpostavimo, da funkcija <span class="math notranslate nohighlight">\(f(x)\)</span> realne vrednosti slika na realno os in da sta <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(h\)</span> realni vrednosti, potem lahko izpeljemo:</p>
<div class="math notranslate nohighlight">
\[\mathbf{Im} \left( f{\left(x + i\,h \right)}\right)= h\,\frac{d}{d x} f{\left(x \right)}+ O\left(h^{3}\right)\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{Re} \left( f{\left(x + i\,h \right)}\right) = f{\left(x \right)} - \frac{h^{2}}{2} \frac{d^{2}}{d x^{2}} f{\left(x \right)} + O\left(h^{3}\right)\rightarrow
\mathbf{Re} \left( f{\left(x + i\,h \right)}\right) = f{\left(x \right)} + O\left(h^{2}\right)\]</div>
<p>Iz prve enačbe (zgoraj) potem izpeljemo izraz za prvi odvod:</p>
<div class="math notranslate nohighlight">
\[f'{\left(x \right)}=\frac{\mathbf{Im} \left( f{\left(x + i\,h \right)}\right)}{h}+ O\left(h^{2}\right)\]</div>
<p>Rezultat je na nek način zelo presenetljiv. Zgoraj smo z eno koračno shemo naprej uspeli pridobiti natančnost <span class="math notranslate nohighlight">\(O\left(h^{1}\right)\)</span>, tukaj pa <span class="math notranslate nohighlight">\(O\left(h^{2}\right)\)</span>!</p>
<p>Če pogledamo sedaj uporabo metoda na primeru od zgoraj <span class="math notranslate nohighlight">\(\exp(-x)\)</span>, spomnimo se najprej točnega rezultata pri vrednosti <span class="math notranslate nohighlight">\(x=1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_točno0</span>
</pre></div>
</div>
</div>
</div>
<p>Pri klicu s korakom <span class="math notranslate nohighlight">\(h=0.1\)</span> dobimo točni dve (tri) števki (podobno kakor pri centralni diferenčni shemi), zmanjšanjem koraka na desetino pa bi število točnih števk približno podvojili:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h1_kompleksno</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">y1_kompleksno</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">1.</span><span class="n">j</span><span class="o">*</span><span class="n">h1_kompleksno</span><span class="p">))</span>
<span class="n">f1_kompleksno</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">y1_kompleksno</span><span class="p">)</span><span class="o">/</span><span class="n">h1_kompleksno</span>
<span class="n">f1_kompleksno</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic">
<li><p>Za batni mehanizem na spodnji sliki strojno izpeljite kinematiko gibanja bata, če se kolenasta gred giblje po zakonu <span class="math notranslate nohighlight">\(\varphi(t)=\omega\,t\)</span>.
<img src='./fig/batni_mehanizem.png' width=300></p></li>
<li><p>Za kotno hitrosti <span class="math notranslate nohighlight">\(\omega=2\,\pi\,50\,\)</span>rad/s izrišite lego bata v treh obratih gredi. Uporabite: <span class="math notranslate nohighlight">\(r=0,03\,\)</span>m in <span class="math notranslate nohighlight">\(l=0,1\,\)</span>m.</p></li>
<li><p>Simbolno odvajajte lego <span class="math notranslate nohighlight">\(x(t)\)</span>, da pridobite pospešek <span class="math notranslate nohighlight">\(\ddot x(t)\)</span>.</p></li>
<li><p>Pripravite funkcijo za klicanje simbolnih izrazov za lego <span class="math notranslate nohighlight">\(x(t)\)</span> in pospešek <span class="math notranslate nohighlight">\(\ddot x(t)\)</span> iz <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p></li>
<li><p>S pomočjo <code class="docutils literal notranslate"><span class="pre">scipy</span></code> pripravite centralno diferenčno shemo za 2. odvod čez 3, 5, in 7 točk.</p></li>
<li><p>Raziščite funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.convolve</span></code> in z njo na podlagi numeričnih vrednosti za <span class="math notranslate nohighlight">\(x\)</span> numerično izračunajte pospešek <span class="math notranslate nohighlight">\(\ddot x\)</span>. Kje je odvod pravilen?</p></li>
<li><p>S centralno diferenčno shemo 2. odvoda čez tri točke ste izračunali notranje točke, nastavite diferenčno shemo naprej za izračun prve točke z natančnostjo <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2})\)</span>.</p></li>
<li><p>Dodajte podatkom lege, določeno mero šuma in preverite, zakaj ni primerna uporaba numeričnega odvajanja na šumnih podatkih.</p></li>
<li><p>S centralno diferenčno shemo 2. odvoda čez tri točke ste doslej izračunali notranje točke, nastavite diferenčno shemo nazaj za izračun zadnje točke z natančnostjo <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2})\)</span>.</p></li>
<li><p>Raziščite vpliv časovnega koraka na izračun 2. odvoda.</p></li>
<li><p>Izmerjene imamo sledeče pozicije (gibanja) avtomobila:</p>
<p><span class="math notranslate nohighlight">\(t = [ 0. ,  0.1,  0.2,  0.3,  0.4,  0.5,  0.6,  0.7,  0.8,  0.9,  1. ]\)</span> [h]</p>
<p><span class="math notranslate nohighlight">\(s = [0, 3, 10, 13, 17, 25, 33, 46, 58, 75]\)</span> [km]</p>
<p>Izračunajte hitrost in pospešek avtomobila pri času 0,5 h. Hitrost in pospešek prikažite tudi v grafični obliki.</p>
</li>
</ol>
<p>Opomba:
Dodatek k domačim nalogam: 6. vprašanje bi lahko nadaljevali in zašumljene podatke gladili ter nato izvedli odvajanje. Glajenje izvedite s konvolucijo med [0,21194156,  0,57611688,  0,21194156] in <span class="math notranslate nohighlight">\(x\)</span>.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://www.youtube.com/watch?v=ZJkGI5DZQv8&amp;list=PLYdroRCLMg5OvLx1EtY1ByvveJeTEXQd_&amp;index=18">Video predavanja na temo numeričnega odvajanja</a>.</p>
</section>
<span id="document-notebooks/Predavanje 11 - Numerično integriranje"></span><section class="tex2jax_ignore mathjax_ignore" id="numericno-integriranje">
<h2>Numerično integriranje<a class="headerlink" href="#numericno-integriranje" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h2>Uvod<a class="headerlink" href="#uvod" title="Permalink to this heading">#</a></h2>
<p>V okviru tega poglavja bomo za dano funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span> izračunali določen integral:</p>
<div class="math notranslate nohighlight">
\[\int_a^b\,f(x)\,\textrm{d}x\]</div>
<p>kjer sta <span class="math notranslate nohighlight">\(a\)</span> in <span class="math notranslate nohighlight">\(b\)</span> meji integriranja, <span class="math notranslate nohighlight">\(f(x)\)</span> pa so vrednosti funkcije, ki jih pridobimo iz tabele vrednosti ali s pomočjo analitične funkcije.</p>
<p>Pri numeričnem integriranju integral ocenimo z <span class="math notranslate nohighlight">\(I\)</span> in velja</p>
<div class="math notranslate nohighlight">
\[\int_a^b\,f(x)\,\textrm{d}x= I + E,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(E\)</span> napaka ocene integrala.</p>
<p>Numerični integral bomo računali na podlagi diskretne vsote:</p>
<div class="math notranslate nohighlight">
\[I=\sum_{i=0}^{m}A_i\,f(x_i),\]</div>
<p>kjer so <span class="math notranslate nohighlight">\(A_i\)</span> uteži, <span class="math notranslate nohighlight">\(x_i\)</span> pa vozlišča na intervalu <span class="math notranslate nohighlight">\([a, b]\)</span> in je <span class="math notranslate nohighlight">\(m+1\)</span> število vozlišč.</p>
<p>Ogledali si bomo dva različna pristopa k numerični integraciji:</p>
<ol class="arabic simple">
<li><p><em>Newton-Cotesov pristop</em>, ki temelji na ekvidistantnih vozliščih (konstanten korak integracije) in</p></li>
<li><p><em>Gaussov integracijski pristop</em>, kjer so vozlišča postavljena tako, da se doseže natančnost za polinome.</p></li>
</ol>
<section id="motivacijski-primer">
<h3>Motivacijski primer<a class="headerlink" href="#motivacijski-primer" title="Permalink to this heading">#</a></h3>
<p>Pri numeričnem integriranju si bomo pomagali s konkretnim primerom:</p>
<div class="math notranslate nohighlight">
\[\int_1^2 x\,\sin(x)\,\textrm{d}x\]</div>
<p>Pripravimo si vozlišča. Osnovni korak naj bo <span class="math notranslate nohighlight">\(h=0.25\)</span>, v tem primeru imamo štiri podintervale in pet vozlišč, pri koraku <span class="math notranslate nohighlight">\(2h\)</span> so tri vozliščne točke in pri koraku <span class="math notranslate nohighlight">\(4h\)</span> samo dve (skrajni):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">xg</span><span class="p">,</span> <span class="n">hg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># goste točke (za prikaz)</span>
<span class="n">x2v</span><span class="p">,</span> <span class="n">h2v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h2v = 1 (2 vozlišči)</span>
<span class="n">x3v</span><span class="p">,</span> <span class="n">h3v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h3v = 0.5 (3 vozlišča)</span>
<span class="n">x4v</span><span class="p">,</span> <span class="n">h4v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h4v = 0.33.. (4 vozlišča)</span>
<span class="n">x5v</span><span class="p">,</span> <span class="n">h5v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h5v = 0.25 (5 vozlišč)</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo še funkcijske vrednosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yg</span> <span class="o">=</span> <span class="n">xg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
<span class="n">y2v</span> <span class="o">=</span> <span class="n">x2v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x2v</span><span class="p">)</span>
<span class="n">y3v</span> <span class="o">=</span> <span class="n">x3v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x3v</span><span class="p">)</span>
<span class="n">y4v</span> <span class="o">=</span> <span class="n">x4v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x4v</span><span class="p">)</span>
<span class="n">y5v</span> <span class="o">=</span> <span class="n">x5v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x5v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo prikaz podatkov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span> <span class="c1"># to uvozimo, da so fonti na sliki latex ustrezni</span>
<span class="c1">#rc(&#39;font&#39;,**{&#39;family&#39;:&#39;sans-serif&#39;,&#39;sans-serif&#39;:[&#39;Helvetica&#39;]})</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">def</span> <span class="nf">fig_motivacija</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\int_1^2\,x\,\sin(x)\,\textrm</span><span class="si">{d}</span><span class="s1">x$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h2v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo podatke:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_motivacija</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8738614c98cd77ca3edd3b6b4c1de30b1b28636e7d8cf02f8f29ae3adcf73b43.png" src="_images/8738614c98cd77ca3edd3b6b4c1de30b1b28636e7d8cf02f8f29ae3adcf73b43.png" />
</div>
</div>
<p>Analitično izračunajmo točen rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">I_točno</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">evalf</span><span class="p">())</span>
<span class="n">I_točno</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/26909ba8c14fbec069579b853678e4e6f357406fe993c288d692f617c6315e7d.png" src="_images/26909ba8c14fbec069579b853678e4e6f357406fe993c288d692f617c6315e7d.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="newton-cotesov-pristop">
<h2>Newton-Cotesov pristop<a class="headerlink" href="#newton-cotesov-pristop" title="Permalink to this heading">#</a></h2>
<p>Na sliki je prikazan splošen primer, kjer je razdalja med vozlišči <span class="math notranslate nohighlight">\(x_i\)</span> enaka <span class="math notranslate nohighlight">\(h\)</span> (gre za <strong>ekvidistantno delitev</strong>).
<img src='./fig/integriranje.png' width=400></p>
<p>V okviru tega poglavja si bomo najprej pogledali trapezno ter sestavljeno trapezno pravilo, pozneje pa bosta sledili še Simpsonova ter Rombergova metoda.</p>
<section id="trapezno-pravilo">
<h3>Trapezno pravilo<a class="headerlink" href="#trapezno-pravilo" title="Permalink to this heading">#</a></h3>
<p>Trapezno pravilo vrednosti podintegralske funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> na (pod)intervalu <span class="math notranslate nohighlight">\([x_0, x_1]\)</span> interpolira z linearno funkcijo. Za dve vozliščni točki to pomeni, da površino pod grafom funkcije približno izračunamo kot:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{trapezno}}=\sum_{i=0}^{n=1}A_i\,f(x_i)=\frac{h}{2}\cdot\left(f(x_0)+f(x_1)\right).\]</div>
<p>In so uteži:</p>
<div class="math notranslate nohighlight">
\[A_0 = A_1 = \frac{1}{2}\,h.\]</div>
<section id="numericna-implementacija">
<h4>Numerična implementacija<a class="headerlink" href="#numericna-implementacija" title="Permalink to this heading">#</a></h4>
<p>Numerična implementacija je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trapezno</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trapezno pravilo integriranja.</span>
<span class="sd">    </span>
<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="numericni-zgled">
<h4>Numerični zgled<a class="headerlink" href="#numericni-zgled" title="Permalink to this heading">#</a></h4>
<p>V konkretnem primeru to pomeni, da prvo in zadnjo funkcijsko vrednost utežimo s <span class="math notranslate nohighlight">\(h/2\)</span>. V našem primeru je <span class="math notranslate nohighlight">\(h=1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_trapezno</span> <span class="o">=</span> <span class="n">trapezno</span><span class="p">(</span><span class="n">y2v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h2v</span><span class="p">)</span>
<span class="n">I_trapezno</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fd163f9e85f80f214eaa5499e65acd97b012874290e4006609dc3791728aa5bb.png" src="_images/fd163f9e85f80f214eaa5499e65acd97b012874290e4006609dc3791728aa5bb.png" />
</div>
</div>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_trapezno</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm</span><span class="si">{trapezno}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h2v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_trapezno</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eda1d1d15044e3dcc9b847f02f1ae745733eb6513cf2924a54478b4b10f7581e.png" src="_images/eda1d1d15044e3dcc9b847f02f1ae745733eb6513cf2924a54478b4b10f7581e.png" />
</div>
</div>
</section>
<section id="napaka-trapeznega-pravila">
<h4>Napaka trapeznega pravila<a class="headerlink" href="#napaka-trapeznega-pravila" title="Permalink to this heading">#</a></h4>
<p>Razlika med analitično vrednostjo integrala in numeričnim približkom <span class="math notranslate nohighlight">\(I\)</span> je napaka metode:</p>
<div class="math notranslate nohighlight">
\[E = \int_a^bf(x)\,d x-I,\]</div>
<p>Če je funkcija <span class="math notranslate nohighlight">\(f(x)\)</span> vsaj dvakrat odvedljiva, se lahko (glejte npr. vir: Burden, Faires, Burden: Numerical Analysis 10th Ed) izpelje ocena napake, ki velja samo za trapezni približek prek celega integracijskega intervala:</p>
<div class="math notranslate nohighlight">
\[E_{\textrm{trapezno}}=-\frac{h^3}{12}f''(\xi),\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(h=b-a\)</span> in <span class="math notranslate nohighlight">\(\xi\)</span> neznana vrednost na intervalu <span class="math notranslate nohighlight">\([a,b]\)</span>.</p>
</section>
</section>
<section id="sestavljeno-trapezno-pravilo">
<h3>Sestavljeno trapezno pravilo<a class="headerlink" href="#sestavljeno-trapezno-pravilo" title="Permalink to this heading">#</a></h3>
<p>Če razdelimo interval <span class="math notranslate nohighlight">\([a, b]\)</span> na <span class="math notranslate nohighlight">\(n\)</span> podintervalov in na vsakem uporabimo trapezno pravilo integriranja,  govorimo o <em>sestavljenem trapeznem pravilu</em> (angl. <em>composite trapezoidal rule</em>).</p>
<p>V tem primeru za vsak podinterval <span class="math notranslate nohighlight">\(i\)</span> uporabimo trapezno pravilo in torej za meje podinterval <span class="math notranslate nohighlight">\(x_i\)</span> in <span class="math notranslate nohighlight">\(x_{i+1}\)</span> uporabimo uteži <span class="math notranslate nohighlight">\(A_i=A_{i+i}=h/2\)</span>. Ker so notranja vozlišča podvojena, sledi:</p>
<div class="math notranslate nohighlight">
\[A_0=A_{n}=\frac{h}{2}\quad\textrm{in za ostala vozlišča:}\quad A_i=h.\]</div>
<p>Pri tem smo predpostavili podintervale enake širine:</p>
<div class="math notranslate nohighlight">
\[h=\frac{x_{n}-x_0}{n}\]</div>
<p>Sledi torej:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{trapezno sest}}=\sum_{i=0}^{n}A_i\,f(x_i)=\left(\frac{y_0}{2} + y_1+y_2+\cdots+y_{n-1}+\frac{y_{n}}{2}\right)\,h.\]</div>
<section id="id1">
<h4>Numerična implementacija<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<p>Numerična implementacija je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trapezno_sest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sestavljeno trapezno pravilo integriranja.</span>
<span class="sd">    </span>
<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">h</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h4>Numerični zgled<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<p>Zgoraj smo že pripravili podatke za dva podintervala (tri vozlišča):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x3v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1. , 1.5, 2. ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h3v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7efe720fddad2f2c0bec67864c94b93795408965e88b7751c3c50cdc7a021cf9.png" src="_images/7efe720fddad2f2c0bec67864c94b93795408965e88b7751c3c50cdc7a021cf9.png" />
</div>
</div>
<p>Izračunajmo oceno integrala s sestavljenim trapeznim pravilom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_trapezno_sest</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y3v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h3v</span><span class="p">)</span>
<span class="n">I_trapezno_sest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/79cc101636eb262145439cb33ab30ae35c5996b95bf735b91d2302be00a10957.png" src="_images/79cc101636eb262145439cb33ab30ae35c5996b95bf735b91d2302be00a10957.png" />
</div>
</div>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_trapezno_sest</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{trapezno sestavljeno}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_trapezno_sest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/103db5d12b4173e481f21e9dd8b93bf77d700d0328ee166ecb415e477d29d030.png" src="_images/103db5d12b4173e481f21e9dd8b93bf77d700d0328ee166ecb415e477d29d030.png" />
</div>
</div>
</section>
<section id="napaka-sestavljenega-trapeznega-pravila">
<h4>Napaka sestavljenega trapeznega pravila<a class="headerlink" href="#napaka-sestavljenega-trapeznega-pravila" title="Permalink to this heading">#</a></h4>
<p>Napaka sestavljenega trapeznega pravila izhaja iz napake trapeznega pravila; pri tem tako napako naredimo <span class="math notranslate nohighlight">\(n\)</span>-krat.</p>
<p>Ker velja <span class="math notranslate nohighlight">\(h\cdot n=b-a\)</span>, izpeljemo napako sestavljenega trapeznega pravila kot:</p>
<div class="math notranslate nohighlight">
\[E_{\textrm{trapezno sest}}=-\frac{h^2(b-a)}{12}f''(\eta),\]</div>
<p><span class="math notranslate nohighlight">\(\eta\)</span> je vrednost na intervalu <span class="math notranslate nohighlight">\([a,b]\)</span>. Napaka je drugega reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span>.</p>
</section>
<section id="boljsi-priblizek-integrala">
<h4>Boljši približek integrala<a class="headerlink" href="#boljsi-priblizek-integrala" title="Permalink to this heading">#</a></h4>
<p>V nadaljevanju si bomo pogledali t. i. <strong>Richardsonovo ekstrapolacijo</strong>, pri kateri na podlagi ocene integrala s korakom <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> izračunamo boljši približek.</p>
<p>V kolikor integral <span class="math notranslate nohighlight">\(I\)</span> numerično izračunamo pri dveh različnih korakih <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2\,h\)</span>, velja:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,\textrm{d}x = I_h + E_h = I_{2h} + E_{2h},\]</div>
<p>kjer sta <span class="math notranslate nohighlight">\(I_h\)</span> in <span class="math notranslate nohighlight">\(I_{2h}\)</span> približka integrala s korakom <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> ter <span class="math notranslate nohighlight">\(E_h\)</span> in <span class="math notranslate nohighlight">\(E_{2h}\)</span> oceni napake pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span>. Izpeljemo <span class="math notranslate nohighlight">\(I_{2h}-I_{h} = E_{h}-E_{2h}\)</span></p>
<p>Naprej zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_h=-\frac{h^2(b-a)}{12}f''(\eta)=h^2\,K.\]</div>
<p>Ob predpostavki, da je <span class="math notranslate nohighlight">\(f''\left (\eta \right )\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> enak (<span class="math notranslate nohighlight">\(\eta\)</span> je pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> dejansko različen), zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_{2h}=-\frac{(2h)^2(b-a)}{12}f''(\eta)=4\,h^2\,K\]</div>
<p>Sledi:</p>
<div class="math notranslate nohighlight">
\[I_{2h}-I_h=-3K\,h^2.\]</div>
<p>Sedaj lahko ocenimo napako pri koraku <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_h=h^2\,K=\frac{I_h-I_{2h}}{3}.\]</div>
<p>Na podlagi ocene napake lahko izračunamo boljši numerični približek  <span class="math notranslate nohighlight">\(I_{h}^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[I_h^* = I_h + \frac{1}{3}\,(I_{h}-I_{2h})\]</div>
<p>ali</p>
<div class="math notranslate nohighlight">
\[I_h^* = \frac{4}{3}\,I_h - \frac{1}{3}\,I_{2h}\]</div>
</section>
<section id="id3">
<h4>Numerični zgled<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<p>Predhodno smo s trapeznim pravilom že izračunali integral pri koraku <span class="math notranslate nohighlight">\(h=1\)</span> in pri koraku <span class="math notranslate nohighlight">\(h=0,5\)</span>, rezultata sta bila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">I_trapezno</span><span class="p">,</span> <span class="n">I_trapezno_sest</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fd71406904ad62446ac4b1792b71ee2183a6375e9b0806ffeabf7cb122b3b4e5.png" src="_images/fd71406904ad62446ac4b1792b71ee2183a6375e9b0806ffeabf7cb122b3b4e5.png" />
</div>
</div>
<p>S pomočjo zgornje formule izračunamo boljši približek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_trapezno_boljši</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I_trapezno_sest</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I_trapezno</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Točen rezultat:   </span><span class="si">{</span><span class="n">I_točno</span><span class="si">}</span><span class="se">\n</span><span class="s1">Boljši približek: </span><span class="si">{</span><span class="n">I_trapezno_boljši</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Točen rezultat:   1.4404224209802097
Boljši približek: 1.4408392930139313
</pre></div>
</div>
</div>
</div>
</section>
<section id="numpy-implementacija-sestavljenega-trapeznega-pravila">
<h4><code class="docutils literal notranslate"><span class="pre">numpy</span></code> implementacija sestavljenega trapeznega pravila<a class="headerlink" href="#numpy-implementacija-sestavljenega-trapeznega-pravila" title="Permalink to this heading">#</a></h4>
<p>Sestavljeno trapezno pravilo je implementirano tudi v paketu <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, s funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.trapz</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> predstavlja tabelo funkcijskih vrednosti,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> je opcijski parameter in definira vozlišča; če parameter ni definiran, se privzame ekvidistančna vozlišča na razdalji <code class="docutils literal notranslate"><span class="pre">dx</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code> definira (konstanten) korak integracije, ima privzeto vrednost 1,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> definira <em>os</em> po kateri se integrira (v primeru, da je <code class="docutils literal notranslate"><span class="pre">y</span></code> večdimenzijsko numerično polje).</p></li>
</ul>
<p>Funkcija vrne izračunani integral po sestavljenem trapeznem pravilu. Več informacij lahko najdete v <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.trapz.html">dokumentaciji</a>.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">I_trapezno_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y3v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h3v</span><span class="p">)</span>
<span class="n">I_trapezno_np</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/79cc101636eb262145439cb33ab30ae35c5996b95bf735b91d2302be00a10957.png" src="_images/79cc101636eb262145439cb33ab30ae35c5996b95bf735b91d2302be00a10957.png" />
</div>
</div>
</section>
</section>
<section id="simpsonova-in-druge-metode">
<h3>Simpsonova in druge metode<a class="headerlink" href="#simpsonova-in-druge-metode" title="Permalink to this heading">#</a></h3>
<p>Zgoraj smo si pogledali trapezno pravilo, ki temelji na linearni interpolacijski funkciji na posameznem podintervalu. Z interpolacijo višjega reda lahko izpeljemo še druge integracijske metode.</p>
<p>Izračunati moramo:</p>
<div class="math notranslate nohighlight">
\[\int_{a}^b f(x)\,dx.\]</div>
<p>Tabeliramo podintegralsko funkcijo <span class="math notranslate nohighlight">\(f(x)\)</span> in tabelo interpoliramo z Lagrangevim interpolacijskim polinomom <span class="math notranslate nohighlight">\(P_n(x)\)</span> stopnje <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="math notranslate nohighlight">
\[P_n(x)=\sum_{i=0}^{n}\,f(x_i)\,l_i(x),\]</div>
<p>kjer so <span class="math notranslate nohighlight">\(y_i=f(x_i)\)</span> funkcijske vrednosti v vozliščih <span class="math notranslate nohighlight">\(x_i\)</span> in je Lagrangev polinom <span class="math notranslate nohighlight">\(l_i\)</span> definiran kot:</p>
<div class="math notranslate nohighlight">
\[l_i(x)=\prod_{j=0, j\ne i}^n \frac{x-x_j}{x_i-x_j}.\]</div>
<p>Za numerični izračun integrala <span class="math notranslate nohighlight">\(\int_{a}^b f(x)\,dx\)</span> (meje so: <span class="math notranslate nohighlight">\(a=x_0\)</span>, <span class="math notranslate nohighlight">\(b=x_n\)</span>) namesto funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> vstavimo v integral interpolacijski polinom <span class="math notranslate nohighlight">\(P_n(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[I=\int_{x_0}^{x_{n}} P_n(x)\,dx=\int_{x_0}^{x_{n}} \sum_{i=0}^{n}\,f(x_i)\,l_i(x)\,dx.\]</div>
<p>Ker je integriranje linearna operacija, lahko zamenjamo integriranje in vsoto:</p>
<div class="math notranslate nohighlight">
\[I=\sum_{i=0}^{n}\,f(x_i)\,\underbrace{\int_{x_0}^{x_{n}} l_i(x)\,dx}_{A_i}.\]</div>
<p>Lagrangev polinom integriramo in dobimo uteži <span class="math notranslate nohighlight">\(A_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[A_i = \int_{x_0}^{x_{n}} l_i(x)\,dx\]</div>
<section id="izpeljava-trapeznega-pravila-z-uporabo-lagrangevih-polinomov">
<h4>Izpeljava trapeznega pravila z uporabo Lagrangevih polinomov<a class="headerlink" href="#izpeljava-trapeznega-pravila-z-uporabo-lagrangevih-polinomov" title="Permalink to this heading">#</a></h4>
<p>Poglejmo si kako z Lagrangevim interpolacijskim polinomom prve stopnje strojno izpeljemo uteži <span class="math notranslate nohighlight">\(A_i\)</span> v primeru trapeznega pravila.</p>
<p>Najprej v simbolni obliki definirajmo spremenljivko <code class="docutils literal notranslate"><span class="pre">x</span></code>, vozlišči <code class="docutils literal notranslate"><span class="pre">x0</span></code> in <code class="docutils literal notranslate"><span class="pre">x1</span></code> ter korak <code class="docutils literal notranslate"><span class="pre">h</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x x0, x1, h&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo Python funkcijo, ki v simbolni obliki vrne seznam <span class="math notranslate nohighlight">\(n\)</span> koeficientov Lagrangevih polinomov <span class="math notranslate nohighlight">\([l_0(x), l_1(x),\dots, l_{n-1}(x)]\)</span> stopnje <span class="math notranslate nohighlight">\(n-1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lagrange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">vozlišča_predpona</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vozlišča_predpona</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">vozlišča</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">vozlišča_predpona</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">numer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span>    <span class="o">-</span> <span class="n">vozlišča</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">denom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vozlišča</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">vozlišča</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        
        <span class="n">numer</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">numer</span><span class="p">)</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">denom</span><span class="p">)</span>

        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numer</span><span class="o">/</span><span class="n">denom</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeffs</span>    
</pre></div>
</div>
</div>
</div>
<p>Najprej poglejmo Lagrangeva polinoma za linearno interpolacijo (<span class="math notranslate nohighlight">\(n=2\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lag</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">lag</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/43da3eee486ca3106e6e041e37b1514723ee4e1adf5dab8f3b8dca9de33d95cb.png" src="_images/43da3eee486ca3106e6e041e37b1514723ee4e1adf5dab8f3b8dca9de33d95cb.png" />
</div>
</div>
<p>Sedaj Lagrangev polinom <span class="math notranslate nohighlight">\(l_0(x)\)</span> integriramo čez celotni interval:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">lag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span>
<span class="n">int0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee80d48945eb76a56b9b5f21f398b231f4e5caae21d9f1ad91901ec8d8a3cdb5.png" src="_images/ee80d48945eb76a56b9b5f21f398b231f4e5caae21d9f1ad91901ec8d8a3cdb5.png" />
</div>
</div>
<p>Izraz poenostavimo in dobimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int1</span> <span class="o">=</span> <span class="n">int0</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="n">int1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9ce85029e6be4af3881765324f9e7f13e0bb36492056bc96c1e9c8be9293c8b1.png" src="_images/9ce85029e6be4af3881765324f9e7f13e0bb36492056bc96c1e9c8be9293c8b1.png" />
</div>
</div>
<p>Ker je širina podintervala konstantna je <span class="math notranslate nohighlight">\(x_1=h_0+h\)</span>, izvedemo zamenjavo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">}</span>
<span class="n">int1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e2abba0eab29227f23842e1010ee6629320fc4e5ebed65cb5028343b83902c77.png" src="_images/e2abba0eab29227f23842e1010ee6629320fc4e5ebed65cb5028343b83902c77.png" />
</div>
</div>
<p>Zgornje korake za Lagrangev polinom  <span class="math notranslate nohighlight">\(l_0(x)\)</span> lahko posplošimo za seznam Lagrangevih polinomov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_trapez</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>  <span class="c1"># za vsak lagrangev polimom `li` v seznamu lagrange(2,x)</span>
<span class="n">A_trapez</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/33018400b6c11fb53a5d48e29609e202b0a742f68ade5a165d3da768c56900d0.png" src="_images/33018400b6c11fb53a5d48e29609e202b0a742f68ade5a165d3da768c56900d0.png" />
</div>
</div>
<p>Izpeljali smo uteži, ki smo jih uporabili pri trapezni metodi:</p>
<div class="math notranslate nohighlight">
\[A_0=h/2\qquad A_1=h/2.\]</div>
<p>Trapezno pravilo je:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{trapezno}}=\frac{h}{2}\left(y_0+y_1\right)\]</div>
<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):</p>
<div class="math notranslate nohighlight">
\[E_{\textrm{trapezno}}= -\frac{h^3}{12}f''(\xi).\]</div>
</section>
<section id="izracun-utezi-za-simpsonovo-pravilo">
<h4>Izračun uteži za Simpsonovo pravilo<a class="headerlink" href="#izracun-utezi-za-simpsonovo-pravilo" title="Permalink to this heading">#</a></h4>
<p>Potem ko smo zgoraj pokazali strnjen izračun za trapezno pravilo, lahko podobno izvedemo za kvadratno interpolacijo čez tri točke (<span class="math notranslate nohighlight">\(n=3\)</span>).</p>
<p>Izračun uteži je analogen zgornjemu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, x2, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_Simpson1_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> 
             <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
<span class="n">A_Simpson1_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/657cca233d95e9117fe9390d993ac8216e82c5f8ad90329a14551e4540d9666a.png" src="_images/657cca233d95e9117fe9390d993ac8216e82c5f8ad90329a14551e4540d9666a.png" />
</div>
</div>
<p>Simpsonovo pravilo (to pravilo se imenuje tudi Simpsonovo 1/3 pravilo) je:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{Simpsonovo}}=\frac{h}{3}\left(y_0+4\,y_1+y_2\right)\]</div>
<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):</p>
<div class="math notranslate nohighlight">
\[E_{\textrm{Simpsonovo}}= -\frac{h^5}{90}f^{(4)}(\xi).\]</div>
<p>Pri tem je treba izpostaviti, da je napaka lokalno 5 reda  <span class="math notranslate nohighlight">\(\mathcal{O}(h^5)\)</span> in definirana z neznano vrednostjo četrtega odvoda <span class="math notranslate nohighlight">\(f^{(4)}(\xi)\)</span>, posledično je to pravilo točno za polinome stopnje 3 ali manj.</p>
<p>Primer uporabe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps</span> <span class="o">=</span> <span class="n">h3v</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y3v</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">I_Simps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5672fd4bdb9d1e0247ebfa0c2c7ce571762709b236679524e42c7cc3b0e1c8bf.png" src="_images/5672fd4bdb9d1e0247ebfa0c2c7ce571762709b236679524e42c7cc3b0e1c8bf.png" />
</div>
</div>
<p>Pripravimo sliko. Ker Simsonovo pravilo temelji na kvadratni interpolaciji, moramo naprej pripraviti interpolacijski polinom (pomagamo si s <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm</span><span class="si">{Simpsonovo}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_Simpsonovo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cdf5e59cb6861f079197033e17f8ccc78d11adb196ce3195bb4f2ab151d48c57.png" src="_images/cdf5e59cb6861f079197033e17f8ccc78d11adb196ce3195bb4f2ab151d48c57.png" />
</div>
</div>
</section>
<section id="scipy-integrate-newton-cotes">
<h4><code class="docutils literal notranslate"><span class="pre">scipy.integrate.newton_cotes</span></code><a class="headerlink" href="#scipy-integrate-newton-cotes" title="Permalink to this heading">#</a></h4>
<p>Koeficiente integracijskega pristopa Newton-Cotes pridobimo tudi s pomočjo <code class="docutils literal notranslate"><span class="pre">scipy.integrate.newton_cotes()</span></code> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.newton_cotes.html#scipy.integrate.newton_cotes">dokumentacija</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newton_cotes</span><span class="p">(</span><span class="n">rn</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer sta parametra:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rn</span></code>, ki definira število podintervalov (mogoč je tudi nekonstanten korak, glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.newton_cotes.html#scipy.integrate.newton_cotes">dokumentacijo</a>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">equal</span></code>, ki definira ali se zahteva konstantno široke podintervale.</p></li>
</ul>
<p>Funkcija vrne terko, pri čemer prvi element predstavlja numerično polje uteži in drugi člen oceno napake.</p>
<p>Poglejmo si primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="n">integrate</span><span class="o">.</span><span class="n">newton_cotes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0.33333333, 1.33333333, 0.33333333]), -0.011111111111111112)
</pre></div>
</div>
</div>
</div>
</section>
<section id="izracun-utezi-za-simpsonovo-3-8-pravilo">
<h4>Izračun uteži za Simpsonovo 3/8 pravilo<a class="headerlink" href="#izracun-utezi-za-simpsonovo-3-8-pravilo" title="Permalink to this heading">#</a></h4>
<p>Nadaljujemo lahko s kubično interpolacijo čez štiri točke (<span class="math notranslate nohighlight">\(n=4\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, x2, x3, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">x3</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_Simpson3_8</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x3</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> 
                <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
<span class="n">A_Simpson3_8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/741b558237322d5bc1b12046bc08698334783715558e171cf39d236a9216e2b3.png" src="_images/741b558237322d5bc1b12046bc08698334783715558e171cf39d236a9216e2b3.png" />
</div>
</div>
<p>Simpsonovo 3/8 pravilo je:</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{Simpsonovo 3/8}}=\frac{3h}{8}\left(y_0+3\,y_1+3\,y_2+y_3\right)\]</div>
<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):</p>
<div class="math notranslate nohighlight">
\[E_{\textrm{Simpsonovo 3/8}}= -\frac{3\,h^5}{80}f^{(4)}(\xi).\]</div>
<p>Poglejmo si primer uporabe. Uporabimo pripravljeno tabelo vrednosti funkcije v štirih točkah:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y4v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.84147098, 1.2959172 , 1.65901326, 1.81859485])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps38</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">h4v</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y4v</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">I_Simps38</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1d0fae70c47542f027aaaded1a5021104f8f5272a01c558b8fc6aa55715d24d3.png" src="_images/1d0fae70c47542f027aaaded1a5021104f8f5272a01c558b8fc6aa55715d24d3.png" />
</div>
</div>
<p>Pripravimo še prikaz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo38</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="n">y4v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y4v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{Simpsonovo 3/8}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.47</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="n">y4v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h4v</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_Simpsonovo38</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/97d7e468a904e0694d0ad4568a2b8fe4d2d648aa75a1a7b81a032d0f3b5dac41.png" src="_images/97d7e468a904e0694d0ad4568a2b8fe4d2d648aa75a1a7b81a032d0f3b5dac41.png" />
</div>
</div>
</section>
</section>
<section id="sestavljeno-simpsonovo-pravilo">
<h3>Sestavljeno Simpsonovo pravilo<a class="headerlink" href="#sestavljeno-simpsonovo-pravilo" title="Permalink to this heading">#</a></h3>
<p>Interval <span class="math notranslate nohighlight">\([a, b]\)</span> razdelimo na sodo število <span class="math notranslate nohighlight">\(n\)</span> podintervalov enake širine <span class="math notranslate nohighlight">\(h=(b - a)/n\)</span>, s čimer so definirana vozlišča <span class="math notranslate nohighlight">\(x_i=a+i\,h\)</span> za <span class="math notranslate nohighlight">\(i=0,1,\dots,n\)</span>. V tem primeru zapišemo sestavljeno Simpsonovo pravilo:</p>
<div class="math notranslate nohighlight">
\[\int_{a}^{b}f(x)\,\textrm{d}x=
\frac{h}{3}\left(
f(x_0)
+4\sum_{i=1}^{n/2}f(x_{2i-1})
+2\sum_{i=1}^{n/2-1}f(x_{2i})
+f(x_n)
\right)
\underbrace{
-\frac{b-a}{180}h^4\,f^{(4)}(\eta)
}_{E_{\textrm{Sestavljeno Simpsonovo 1/3}}}
,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\eta\)</span> neznana vrednost na intervalu <span class="math notranslate nohighlight">\([a, b]\)</span>. Napaka je četrtega reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^4)\)</span>.</p>
<p>Numerična implementacija:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simpsonovo_sest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sestavljeno Simpsonovo pravilo integriranja.</span>

<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">h</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps_sest</span> <span class="o">=</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y5v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h5v</span><span class="p">)</span>
<span class="n">I_Simps_sest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/401f6a1728821b8a32601f93d8ce62269c219cae6aeed2506b7dfb4518772660.png" src="_images/401f6a1728821b8a32601f93d8ce62269c219cae6aeed2506b7dfb4518772660.png" />
</div>
</div>
<p>Pripravimo sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo_sest</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="n">y5v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>       
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y5v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{Simpsonovo sestavljeno}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.70</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="n">y5v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h5v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_Simpsonovo_sest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f8d9964df776d8cff4cfb3d92a14358fc6d5eb5e227c2486ea7bdab951d981e9.png" src="_images/f8d9964df776d8cff4cfb3d92a14358fc6d5eb5e227c2486ea7bdab951d981e9.png" />
</div>
</div>
<section id="boljsa-ocena-integrala">
<h4>Boljša ocena integrala<a class="headerlink" href="#boljsa-ocena-integrala" title="Permalink to this heading">#</a></h4>
<p>Napaka sestavljene Simpsonove metode je definirana z:</p>
<div class="math notranslate nohighlight">
\[E_{\textrm{Sestavljeno Simpsonovo 1/3}}= 
-\frac{b-a}{180}h^4\,f^{(4)}(\eta),\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(\eta\)</span> neznana vrednost na intervalu <span class="math notranslate nohighlight">\([a, b]\)</span>.</p>
<p>Izboljšano oceno integrala določimo na podoben način kakor pri sestavljeni trapezni metodi; integral <span class="math notranslate nohighlight">\(I\)</span> ocenjujemo pri dveh različnih korakih <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2\,h\)</span>, velja natančno:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,\textrm{d}x = I_h + E_h = I_{2h} + E_{2h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(I_h\)</span> približek integrala s korakom <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(E_h\)</span> ocena napake pri koraku <span class="math notranslate nohighlight">\(h\)</span>; analogno velja za <span class="math notranslate nohighlight">\(I_{2h}\)</span> in <span class="math notranslate nohighlight">\(E_{2h}\)</span>.</p>
<p>Če predpostavimo, da je <span class="math notranslate nohighlight">\(f^{(4)}\left (\eta \right )\)</span> v obeh primerih enak, lahko določimo razliko <span class="math notranslate nohighlight">\(I_{2h}-I_{h} = E_{h}-E_{2h}\)</span>.</p>
<p>Naprej zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_h=-\frac{b-a}{180}h^4\,f^{(4)}(\eta)=h^4\,K.\]</div>
<p>Ob predpostavki, da je <span class="math notranslate nohighlight">\(f^{(4)}\left (\eta \right )\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> enak (<span class="math notranslate nohighlight">\(\eta\)</span> je pri koraku <span class="math notranslate nohighlight">\(h\)</span> in <span class="math notranslate nohighlight">\(2h\)</span> dejansko različen), zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_{2h}=-\frac{(b-a)}{180}(2h)^4\,f^{(4)}(\eta)=16\,h^4\,K\]</div>
<p>Sledi:</p>
<div class="math notranslate nohighlight">
\[I_{2h}-I_h=-15K\,h^4.\]</div>
<p>Sedaj lahko ocenimo napako pri koraku <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_h=h^4\,K=\frac{I_h-I_{2h}}{15}.\]</div>
<p>Na podlagi ocene napake lahko izračunamo boljši približek  <span class="math notranslate nohighlight">\(I_{h}^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[I_h^* = I_h + \frac{1}{15}\,(I_{h}-I_{2h})\]</div>
<p>ali</p>
<div class="math notranslate nohighlight">
\[I_h^* = \frac{16}{15}\,I_h - \frac{1}{15}\,I_{2h}\]</div>
</section>
<section id="id4">
<h4>Numerični zgled<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p>Predhodno smo s Simpsonovim pravilom že izračunali integral pri koraku <span class="math notranslate nohighlight">\(h=0,5\)</span> in pri koraku <span class="math notranslate nohighlight">\(h=0,25\)</span>, rezultata sta bila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">I_Simps</span><span class="p">,</span> <span class="n">I_Simps_sest</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80e5d1c9299aa98f76f5ab21c9cfd77a097ced33b30608ae988697162851cb42.png" src="_images/80e5d1c9299aa98f76f5ab21c9cfd77a097ced33b30608ae988697162851cb42.png" />
</div>
</div>
<p>S pomočjo zgornje formule izračunamo boljši približek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_Simps_boljši</span> <span class="o">=</span> <span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">I_Simps_sest</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">I_Simps</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Točen rezultat:   </span><span class="si">{</span><span class="n">I_točno</span><span class="si">}</span><span class="se">\n</span><span class="s1">Boljši približek: </span><span class="si">{</span><span class="n">I_Simps_boljši</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Točen rezultat:   1.4404224209802097
Boljši približek: 1.4404218714139077
</pre></div>
</div>
</div>
</div>
<p>Pridobimo boljši numerični približek, izgubimo pa oceno napake!</p>
</section>
<section id="simpsonova-metoda-v-scipy-integrate-simps">
<h4>Simpsonova metoda v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.simps</span></code><a class="headerlink" href="#simpsonova-metoda-v-scipy-integrate-simps" title="Permalink to this heading">#</a></h4>
<p>V <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je implementirano sestavljeno Simpsonovo pravilo v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.simps()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.simps.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="s1">&#39;avg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> tabela funkcijskih vrednosti, ki jih integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> vozlišča, gre za opcijski parameter, če je <code class="docutils literal notranslate"><span class="pre">x=None</span></code>, se predpostavi ekvidistantne podintervale širine <code class="docutils literal notranslate"><span class="pre">dx</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code> širina ekvidistantnih podintervalov oz korak integriranja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> os integriranja (pomembno v primeru večdimenzijskega numeričnega polja)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">even</span></code> je lahko {<code class="docutils literal notranslate"><span class="pre">'avg'</span></code>, <code class="docutils literal notranslate"><span class="pre">'first'</span></code>, <code class="docutils literal notranslate"><span class="pre">'last'</span></code>} in definira način integriranja v primeru lihega števila podintervalov.</p></li>
</ul>
<p>Poglejmo si primer, najprej uvozimo funkcijo <code class="docutils literal notranslate"><span class="pre">simps</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">simps</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">simps</span><span class="p">(</span><span class="n">y5v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h5v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/401f6a1728821b8a32601f93d8ce62269c219cae6aeed2506b7dfb4518772660.png" src="_images/401f6a1728821b8a32601f93d8ce62269c219cae6aeed2506b7dfb4518772660.png" />
</div>
</div>
</section>
</section>
<section id="rombergova-metoda">
<h3>Rombergova metoda*<a class="headerlink" href="#rombergova-metoda" title="Permalink to this heading">#</a></h3>
<p>Rombergova metoda temelji na Richardsonovi ekstrapolaciji. Predpostavimo, da integral <span class="math notranslate nohighlight">\(\int_a^b f(x)\textrm{d}x\)</span> integriramo na intervalu <span class="math notranslate nohighlight">\([a,b]\)</span>, ki ga razdelimo na <span class="math notranslate nohighlight">\(2^{n-1}\)</span> podintervalov (<span class="math notranslate nohighlight">\(n=1,2,4,8, \dots\)</span>).</p>
<p>Rezultat trapeznega pravila pri <span class="math notranslate nohighlight">\(n=1\)</span> označimo z <span class="math notranslate nohighlight">\(R_{\underbrace{1}_{n},\underbrace{1}_{j}}\)</span>, pri čemer <span class="math notranslate nohighlight">\(j\)</span> označuje natančnost pridobljenega rezultata <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2j})\)</span>.</p>
<p>Če uporabimo trapezno integracijsko pravilo pri <span class="math notranslate nohighlight">\(n=1,2,4 \dots\)</span> podintervalih, izračunamo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{1,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_1=h\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_1^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{2,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_2=h/2\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_2^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{3,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_3=h/4\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_3^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{4,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_4=h/8\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_4^2)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\dots\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{n,1}\)</span>, korak <span class="math notranslate nohighlight">\(h_4=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^2)\)</span>.</p></li>
</ul>
<p>Na podlagi Richardsonove ekstrapolacije izračunamo boljši približek</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{2,2} = R_{2,1} + \frac{1}{3}\left(R_{2,1}-R_{1,1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_2=h/2\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_2^4)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{3,2} = R_{3,1} + \frac{1}{3}\left(R_{3,1}-R_{2,1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_3=h/4\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_3^4)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\dots\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{n,2} = R_{n,1} + \frac{1}{3}\left(R_{n,1}-R_{n-1,1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_n=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^4)\)</span>.</p></li>
</ul>
<p>Nato nadaljujemo z Richardsonovo ekstrapolacijo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{3,3} = R_{3,2} + \frac{1}{15}\left(R_{3,2}-R_{2,2}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_3=h/4\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_3^6)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\dots\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{n,3} = R_{n,2} + \frac{1}{15}\left(R_{n,2}-R_{n-1,2}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_n=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^6)\)</span>.</p></li>
</ul>
<p>Richardsonovo extrapolacijo lahko posplošimo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{n,j} = R_{n,j-1} + \frac{1}{4^{j-1}-1}\left(R_{n,j-1}-R_{n-1,j-1}\right)\)</span>, korak <span class="math notranslate nohighlight">\(h_n=h/(2^{n-1})\)</span>, red natančnosti <span class="math notranslate nohighlight">\(\mathcal{O}(h_n^{2j})\)</span></p></li>
</ul>
<p>Pri tem je boljši približek <span class="math notranslate nohighlight">\(R_{2,2}\)</span> pri koraku <span class="math notranslate nohighlight">\(h/2\)</span> enak rezultatu, ki ga dobimo po Simpsonovi metodi pri koraku <span class="math notranslate nohighlight">\(h/2\)</span>. Podobno je boljši približek <span class="math notranslate nohighlight">\(R_{3,2}\)</span> pri koraku <span class="math notranslate nohighlight">\(h/4\)</span> enak numeričnemu integralu Simpsonove metode pri koraku <span class="math notranslate nohighlight">\(h/4\)</span>. In je dalje <span class="math notranslate nohighlight">\(R_{3,3}\)</span> enak popravljenemu približku Simpsonove metode pri koraku <span class="math notranslate nohighlight">\(h/4\)</span>.</p>
<p>Pripravimo numerične podatke:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x9v</span><span class="p">,</span> <span class="n">h9v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h9v = 0.125 (9 vozlišč)</span>
<span class="n">y9v</span> <span class="o">=</span> <span class="n">x9v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x9v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si primer od zgoraj. Najprej s sestavljeno trapezno metodo izračunamo integral pri različnih korakih (drugi red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h^2)</span>
<span class="n">R1_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">8</span><span class="p">],</span> <span class="mi">8</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=1.0</span>
<span class="n">R2_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.5</span>
<span class="n">R3_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.25</span>
<span class="n">R4_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.125</span>
<span class="p">[</span><span class="n">R1_1</span><span class="p">,</span> <span class="n">R2_1</span><span class="p">,</span> <span class="n">R3_1</span><span class="p">,</span> <span class="n">R4_1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/27bc323d6f05cb9e28580567a63bbde6dcb23d52723489817382b53bf57fbec3.png" src="_images/27bc323d6f05cb9e28580567a63bbde6dcb23d52723489817382b53bf57fbec3.png" />
</div>
</div>
<p>Nato izračunamo boljše približke (dobimo četrti red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h^4)</span>
<span class="n">R2_2</span> <span class="o">=</span> <span class="n">R2_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R2_1</span> <span class="o">-</span> <span class="n">R1_1</span><span class="p">)</span>
<span class="n">R3_2</span> <span class="o">=</span> <span class="n">R3_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R3_1</span> <span class="o">-</span> <span class="n">R2_1</span><span class="p">)</span>
<span class="n">R4_2</span> <span class="o">=</span> <span class="n">R4_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_1</span> <span class="o">-</span> <span class="n">R3_1</span><span class="p">)</span>
<span class="p">[</span><span class="n">R2_2</span><span class="p">,</span> <span class="n">R3_2</span><span class="p">,</span> <span class="n">R4_2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee93cee80ddf3c1a87b073ddd7cc5bdfd850159f07466065b86412b05a005fa8.png" src="_images/ee93cee80ddf3c1a87b073ddd7cc5bdfd850159f07466065b86412b05a005fa8.png" />
</div>
</div>
<p>Rezultati predstavljajo rezultat Simpsonove metode pri koraku <span class="math notranslate nohighlight">\(h=0,5\)</span>, <span class="math notranslate nohighlight">\(h=0,25\)</span> in <span class="math notranslate nohighlight">\(h=0.125\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee93cee80ddf3c1a87b073ddd7cc5bdfd850159f07466065b86412b05a005fa8.png" src="_images/ee93cee80ddf3c1a87b073ddd7cc5bdfd850159f07466065b86412b05a005fa8.png" />
</div>
</div>
<p>Ponovno izračunamo boljše približke (dobimo šesti red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h6)</span>
<span class="n">R3_3</span> <span class="o">=</span> <span class="n">R3_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">R3_2</span> <span class="o">-</span> <span class="n">R2_2</span><span class="p">)</span>
<span class="n">R4_3</span> <span class="o">=</span> <span class="n">R4_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_2</span> <span class="o">-</span> <span class="n">R3_2</span><span class="p">)</span>

<span class="p">[</span><span class="n">R3_3</span><span class="p">,</span> <span class="n">R4_3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/86ea210bd8b225e995eb1e86f982de22aadffa7dcd2ae9052705fb01f7827288.png" src="_images/86ea210bd8b225e995eb1e86f982de22aadffa7dcd2ae9052705fb01f7827288.png" />
</div>
</div>
<p>Rezultat predstavlja boljši rezultat Simpsonove pri koraku <span class="math notranslate nohighlight">\(h=0,25\)</span> in <span class="math notranslate nohighlight">\(h=0.125\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a4h</span><span class="p">,</span> <span class="n">a2h</span><span class="p">,</span> <span class="n">ah</span> <span class="o">=</span> <span class="p">[</span><span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a2h</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a4h</span><span class="p">,</span> <span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">ah</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a2h</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/86ea210bd8b225e995eb1e86f982de22aadffa7dcd2ae9052705fb01f7827288.png" src="_images/86ea210bd8b225e995eb1e86f982de22aadffa7dcd2ae9052705fb01f7827288.png" />
</div>
</div>
<p>Ponovno izračunamo boljše približke (dobimo osmi red napake):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># O(h8)</span>
<span class="n">R4_4</span> <span class="o">=</span> <span class="n">R4_3</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">63</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_3</span> <span class="o">-</span> <span class="n">R3_3</span><span class="p">)</span>
<span class="n">R4_4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a4c32bdbe555daf0bdb70c21c87d236beb5830339acf9f4ba804cf9552c78207.png" src="_images/a4c32bdbe555daf0bdb70c21c87d236beb5830339acf9f4ba804cf9552c78207.png" />
</div>
</div>
<p>Rombergova metoda nam torej ponuja visoko natančnost rezultata za relativno majhno numerično ceno. Napako pa ocenimo:</p>
<div class="math notranslate nohighlight">
\[E = \left|R_{n,n}-R_{n-1,n-1}\right|.\]</div>
<section id="rombergova-metoda-v-scipy-integrate-romb">
<h4>Rombergova metoda v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.romb</span></code><a class="headerlink" href="#rombergova-metoda-v-scipy-integrate-romb" title="Permalink to this heading">#</a></h4>
<p>V <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je implementirana Rombergova metoda v <code class="docutils literal notranslate"><span class="pre">scipy.integrate.romb()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.romb.html#scipy.integrate.romb">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">romb</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> tabela funkcijskih vrednosti, ki jih integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code> širina ekvidistantnih podintervalov oz korak integriranja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> or integriranja (pomembno v primeru večdimenzijskega numeričnega polja),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show</span></code> če je <code class="docutils literal notranslate"><span class="pre">True</span></code> prikaže elemente Richardsonove ekstrapolacije.</p></li>
</ul>
<p>Poglejmo si primer od zgoraj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">romb</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y9v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.84147098, 1.01505104, 1.18623077, 1.34872795, 1.49624248,
       1.62261343, 1.72197541, 1.78891084, 1.81859485])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">romb</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h9v</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Richardson Extrapolation Table for Romberg Integration
======================================================
 1.33003 
 1.41314  1.44084 
 1.43362  1.44045  1.44042 
 1.43872  1.44042  1.44042  1.44042 
======================================================
</pre></div>
</div>
<img alt="_images/a4c32bdbe555daf0bdb70c21c87d236beb5830339acf9f4ba804cf9552c78207.png" src="_images/a4c32bdbe555daf0bdb70c21c87d236beb5830339acf9f4ba804cf9552c78207.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="gaussov-integracijski-pristop">
<h2>Gaussov integracijski pristop<a class="headerlink" href="#gaussov-integracijski-pristop" title="Permalink to this heading">#</a></h2>
<p>Newton-Cotesov pristop temelji na polinomu <span class="math notranslate nohighlight">\(n\)</span>-te stopnje in napaka je <span class="math notranslate nohighlight">\(n+1\)</span> stopnje. To pomeni, da integracija daje točen rezultat, če je integrirana funkcija polinom stopnje <span class="math notranslate nohighlight">\(n\)</span> ali manj.</p>
<p>Gaussov integracijski pristop je v principu drugačen: cilj je integral funkcije <span class="math notranslate nohighlight">\(f(x)\)</span> nadomestiti z uteženo vsoto vrednosti funkcije pri diskretnih vrednostih <span class="math notranslate nohighlight">\(f(x_i)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_a^bf(x)\,\textrm{d}x\approx \sum_{i=0}^{n-1} A_i\, f(x_i).\]</div>
<p>Pri tem je neznana utež <span class="math notranslate nohighlight">\(A_i\)</span> in tudi lega vozlišča <span class="math notranslate nohighlight">\(x_i\)</span>. Za stopnje polinoma <span class="math notranslate nohighlight">\(n\)</span> bomo potrebovali tudi več  točk <span class="math notranslate nohighlight">\((x_i, f(x_i))\)</span>.</p>
<p>V nadaljevanju bomo spoznali, da lahko zelo učinkovito izračunamo numerično točen integral. Prednost Gaussove integracije je tudi, da lahko izračuna integral funkcij s singularnostmi (npr: <span class="math notranslate nohighlight">\(\int_0^1\sin(x)/\sqrt{(x)}\,dx\)</span>).</p>
<section id="gaussova-kvadratura-z-enim-vozliscem">
<h3>Gaussova kvadratura z enim vozliščem<a class="headerlink" href="#gaussova-kvadratura-z-enim-vozliscem" title="Permalink to this heading">#</a></h3>
<p>Predpostavimo, da želimo integrirati polinom stopnje <span class="math notranslate nohighlight">\(n=1\)</span> (linearna funkcija):</p>
<div class="math notranslate nohighlight">
\[f(x)=P_1(x)=a_0+a_1\,x.\]</div>
<p>Izračunajmo:</p>
<div class="math notranslate nohighlight">
\[\int_{x_L}^{x_D}P_1(x)\,\textrm{d}x=\left(a_0\,x+a_1\,\frac{x^2}{2}\right)_{x_L}^{x_D}=-a_0\,x_L+a_0\,x_D-\frac{a_1\,x_L^2}{2}+\frac{a_1\,x_D^2}{2}.\]</div>
<p>Po drugi strani pa želimo integral izračunati glede na ustrezno uteženo <span class="math notranslate nohighlight">\(A_0\)</span> vrednost funkcije <span class="math notranslate nohighlight">\(f(x_0)\)</span> v neznanem vozlišču <span class="math notranslate nohighlight">\(x_0\)</span> (samo eno vozlišče!):</p>
<div class="math notranslate nohighlight">
\[\int_{x_L}^{x_D}P_1(x)\,\textrm{d}x = A_0\,P_1(x_0)= A_0\,a_0+A_0\,a_1\,x_0.\]</div>
<p>Z enačenjem zgornjih izrazov izpeljemo:</p>
<div class="math notranslate nohighlight">
\[-a_0\,x_L+a_0\,x_D-\frac{a_1\,x_L^2}{2}+\frac{a_1\,x_D^2}{2}=A_0\,a_0+A_0\,a_1\,x_0.\]</div>
<p><span class="math notranslate nohighlight">\(a_0\)</span> in <span class="math notranslate nohighlight">\(a_1\)</span> sta koeficienta linearne funkcije, ki lahko zavzame poljubne vrednosti, zato velja:</p>
<div class="math notranslate nohighlight">
\[a_0\,\left(-x_L+x_D-A_0\right)=0\qquad\textrm{in}\qquad a_1\left(-\frac{x_L^2}{2}+\frac{x_D^2}{2}-A_0\,x_0\right)=0.\]</div>
<p>Gre za sistem linearnih enačb z rešitvijo:</p>
<div class="math notranslate nohighlight">
\[A_0= x_D-x_L, \qquad x_0=\frac{x_L+x_D}{2}.\]</div>
<p>Če je integrirana funkcija linearna, bomo samo na podlagi vrednosti v eni točki izračunali pravo vrednost!</p>
<p>Da je Gaussov integracijski pristop neodvisen od mej integriranja <span class="math notranslate nohighlight">\(x_L\)</span>, <span class="math notranslate nohighlight">\(x_D\)</span>, pa uvedemo standardne meje.</p>
<section id="standardne-meje-x-l-1-in-x-d-1">
<h4>Standardne meje: <span class="math notranslate nohighlight">\(x_L=-1\)</span> in <span class="math notranslate nohighlight">\(x_D=1\)</span><a class="headerlink" href="#standardne-meje-x-l-1-in-x-d-1" title="Permalink to this heading">#</a></h4>
<p>Zaradi splošnosti meje <span class="math notranslate nohighlight">\(x\in[x_L, x_D]\)</span> transformiramo v <span class="math notranslate nohighlight">\(\xi\in[-1, +1]\)</span> s pomočjo:</p>
<div class="math notranslate nohighlight">
\[x=\frac{x_D+x_L}{2}+\frac{x_D-x_L}{2}\xi\]</div>
<p>in</p>
<div class="math notranslate nohighlight">
\[\textrm{d}x=\frac{x_D-x_L}{2}\textrm{d}\xi.\]</div>
<p>Velja:</p>
<div class="math notranslate nohighlight">
\[\int_{x_L}^{x_D}f(x)\,\textrm{d}x=\int_{-1}^1 g\left(\xi\right)\,\textrm{d}\xi,\]</div>
<p>kjer je:</p>
<div class="math notranslate nohighlight">
\[g(\xi)=\frac{x_D-x_L}{2}\,f\left(\frac{x_L+x_d}{2}+\frac{x_D-x_L}{2}\xi\right).\]</div>
<p>V primeru standardnih mej, je pri eni Gaussovi točki utež <span class="math notranslate nohighlight">\(A_0=2\)</span> in <span class="math notranslate nohighlight">\(x_0=0\)</span> vrednost, pri kateri moramo izračunati funkcijo <span class="math notranslate nohighlight">\(f(x_0)\)</span>.</p>
</section>
<section id="strojno-izpeljevanje-utezi-in-gaussove-tocke">
<h4>Strojno izpeljevanje uteži in Gaussove točke<a class="headerlink" href="#strojno-izpeljevanje-utezi-in-gaussove-tocke" title="Permalink to this heading">#</a></h4>
<p>Definirajmo simbole in nastavimo enačbo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_0</span><span class="p">,</span> <span class="n">a_1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x_L</span><span class="p">,</span> <span class="n">x_D</span><span class="p">,</span> <span class="n">A_0</span><span class="p">,</span> <span class="n">x_0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a_0, a_1, x, x_L, x_D, A_0, x_0&#39;</span><span class="p">)</span> <span class="c1"># simboli</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">a_0</span> <span class="o">+</span> <span class="n">a_1</span><span class="o">*</span><span class="n">x</span>                                                   <span class="c1"># linearni polinom</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">integrate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">x_L</span><span class="p">,</span> <span class="n">x_D</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span> <span class="n">A_0</span><span class="o">*</span><span class="n">P1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_0</span><span class="p">))</span> <span class="c1"># teoretični integral = ocen z utežmi</span>
<span class="n">eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9b02ccd8b5001feec5b6fefed06c5122e81efd3775d4c2e49d611a0d03ddd109.png" src="_images/9b02ccd8b5001feec5b6fefed06c5122e81efd3775d4c2e49d611a0d03ddd109.png" />
</div>
</div>
<p>Pripravimo dve enačbi (za prvo predpostavimo <span class="math notranslate nohighlight">\(a_0=0, a_1=1\)</span>, za drugo predpostavimo <span class="math notranslate nohighlight">\(a_0=1, a_1=0\)</span>) ter rešimo sistem za <code class="docutils literal notranslate"><span class="pre">A_0</span></code> in <code class="docutils literal notranslate"><span class="pre">x_0</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a_0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a_1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a_0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">A_0</span><span class="p">,</span> <span class="n">x_0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bd4306b4884cd00ab7937f2f699e2ebf15aa3ae248c6fbac2889a1a8ad50ec85.png" src="_images/bd4306b4884cd00ab7937f2f699e2ebf15aa3ae248c6fbac2889a1a8ad50ec85.png" />
</div>
</div>
<p>Za dodatno razlago priporočam <a class="reference external" href="https://www.youtube.com/watch?v=iQ5-4hx25Rw">video posnetek</a>.</p>
</section>
</section>
<section id="gaussova-integracijska-metoda-z-vec-vozlisci">
<h3>Gaussova integracijska metoda z več vozlišči<a class="headerlink" href="#gaussova-integracijska-metoda-z-vec-vozlisci" title="Permalink to this heading">#</a></h3>
<p>Izpeljati želimo Gaussovo integracijsko metodo, ki bo upoštevala na intervalu <span class="math notranslate nohighlight">\([a,b]\)</span> <span class="math notranslate nohighlight">\(v\)</span> vozlišč in bo točno izračunala integral polinomov do stopnje <span class="math notranslate nohighlight">\(n=2v-1\)</span>. Veljati mora:</p>
<div class="math notranslate nohighlight">
\[\int_a^bP_{2v-1}(x)\,\textrm{d}x = \sum_{i=0}^{v-1} A_i\,P_{2v-1}(x_i).\]</div>
<p>Pri izpeljavi se bomo omejili na standardne meje <span class="math notranslate nohighlight">\(x_L=-1\)</span>, <span class="math notranslate nohighlight">\(x_D=1\)</span>,</p>
<p>kjer je polinom stopnje <span class="math notranslate nohighlight">\(n=2v-1\)</span> definiran kot:</p>
<div class="math notranslate nohighlight">
\[P_{2v-1}(x)=\sum_{i=0}^{2v-1} a_i\,x^i.\]</div>
<p>Z dvema Gaussovima točkama/vozliščema točno izračunamo integral polinoma do tretjega reda, s tremi Gausovimi vozlišči pa točno izračunamo integral polinoma do petega reda!</p>
<section id="strojno-izpeljevanje">
<h4>Strojno izpeljevanje<a class="headerlink" href="#strojno-izpeljevanje" title="Permalink to this heading">#</a></h4>
<p>Pripravimo si najprej simbolni zapis polinoma in ustreznih spremenljivk:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P_etc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>                       <span class="c1"># n je stopnja polinoma</span>
    <span class="n">ai</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># seznam a_i</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                              <span class="c1"># spremenljivka x</span>
    <span class="k">return</span> <span class="n">ai</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">ai</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj pa poiščimo uteži <span class="math notranslate nohighlight">\(A_i\)</span> in vozlišča <span class="math notranslate nohighlight">\(x_i\)</span> za primer dveh Gaussovih vozlišč; polinom je torej tretje stopnje.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># število vozlišč</span>
<span class="n">ai</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">P_etc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># seznam x_i</span>
<span class="n">Ai</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># seznam w_i</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Vozlišča: </span><span class="si">{</span><span class="n">xi</span><span class="si">}</span><span class="se">\n</span><span class="s1">Uteži:    </span><span class="si">{</span><span class="n">Ai</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vozlišča: (x0, x1)
Uteži:    (A0, A1)
</pre></div>
</div>
</div>
</div>
<p>Polinom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/32e028fd5609ca12334873fc55397f43dab8a571e401a8514bf5b33aaf0b31bd.png" src="_images/32e028fd5609ca12334873fc55397f43dab8a571e401a8514bf5b33aaf0b31bd.png" />
</div>
</div>
<p>Podobno kakor zgoraj za eno vozlišče, tukaj definirajmo enačbe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">integrate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">a_</span><span class="p">),</span>\
              <span class="nb">sum</span><span class="p">([</span><span class="n">Ai</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> \
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">a_</span><span class="p">))</span> \
       <span class="k">for</span> <span class="n">a_</span> <span class="ow">in</span> <span class="n">ai</span><span class="p">]</span>
<span class="n">eqs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/46fe99ea7d6cdc3d2de1fd82d92f2f19bde8dc4f4def9894c56d9573063b3b52.png" src="_images/46fe99ea7d6cdc3d2de1fd82d92f2f19bde8dc4f4def9894c56d9573063b3b52.png" />
</div>
</div>
<p>Rešimo jih za za neznane <span class="math notranslate nohighlight">\(x_i\)</span> in <span class="math notranslate nohighlight">\(w_i\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">flatten</span><span class="p">((</span><span class="n">xi</span><span class="p">,</span> <span class="n">Ai</span><span class="p">)))</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5b91ccfc6463b71ee43f15768f2d0d634486d0ef2f95754c5ac14c003ff37ccb.png" src="_images/5b91ccfc6463b71ee43f15768f2d0d634486d0ef2f95754c5ac14c003ff37ccb.png" />
</div>
</div>
<p>Določili smo seznam dveh (enakih) rešitev.</p>
<p>Najprej sta definirani vozlišči: <span class="math notranslate nohighlight">\(x_0=-\sqrt{3}/3\)</span> in <span class="math notranslate nohighlight">\(x_1=\sqrt{3}/3\)</span>, katerima pripadata uteži <span class="math notranslate nohighlight">\(A_0=A_1=1\)</span>.</p>
<p>Koda zgoraj je izpeljana v splošnem - število vozlišč <code class="docutils literal notranslate"><span class="pre">v</span></code> lahko povečate ter izračunate vozlišča ter pripadajoče uteži.</p>
<p>Spodaj je podana tabela vozlišč in uteži za eno, dve in tri vozlišča (za meje <span class="math notranslate nohighlight">\(a=-1\)</span>, <span class="math notranslate nohighlight">\(b=1\)</span>):</p>
<p><strong>Število točk 1:</strong></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="head text-center"><p>Vozlišče  <span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="head text-center"><p>Utež <span class="math notranslate nohighlight">\(A_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>2</p></td>
</tr>
</tbody>
</table>
<p><strong>Število točk 2:</strong></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="head text-center"><p>Vozlišče  <span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="head text-center"><p>Utež <span class="math notranslate nohighlight">\(A_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(-\frac{\sqrt{3}}{3}\)</span></p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(+\frac{\sqrt{3}}{3}\)</span></p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p><strong>Število točk 3:</strong></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="head text-center"><p>Vozlišče  <span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="head text-center"><p>Utež <span class="math notranslate nohighlight">\(A_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(-\frac{\sqrt{15}}{5}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{5}{9}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{8}{9}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{\sqrt{15}}{5}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{5}{9}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Za več vozlišč in tudi oceno napake, glejte <a class="reference external" href="http://mathworld.wolfram.com/Legendre-GaussQuadrature.html">Mathworld  Legendre-Gauss Quadrature</a>.</p>
<p>Za primer treh Gaussovih točk numerični integral izračunamo (standardne meje):</p>
<div class="math notranslate nohighlight">
\[I_{\textrm{Gauss3}}= \frac{5}{9}\,f\left(-\frac{\sqrt{15}}{5}\right) + \frac{8}{9}\,f\left(0\right)+\frac{5}{9}\,f\left(\frac{\sqrt{15}}{5}\right).\]</div>
</section>
<section id="id5">
<h4>Numerična implementacija<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h4>
<p>Numerična implementacija (vključno s transformacijo mej) za eno, dve ali tri vozlišča:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Gaussova integracijska metoda.</span>

<span class="sd">    :param fun: objekt funkcije, ki jo integriramo</span>
<span class="sd">    :param a:   spodnja meja</span>
<span class="sd">    :param b:   zgornja meja</span>
<span class="sd">    :param vozlišča: število vozlišč (1, 2 ali 3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">xi</span><span class="p">):</span> <span class="c1"># funkcija za transformacijo mej</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fun</span><span class="p">((</span><span class="n">b</span><span class="o">+</span><span class="n">a</span> <span class="o">+</span><span class="n">xi</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>        
    <span class="k">elif</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si zgled. Najprej definirajmo funkcijo, ki jo želimo integrirati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj pa funkcijo (v konkretnem primeru <code class="docutils literal notranslate"><span class="pre">f</span></code>) in ne vrednosti (npr. <code class="docutils literal notranslate"><span class="pre">f(0.)</span></code>) posredujemo funkciji <code class="docutils literal notranslate"><span class="pre">Gaussova</span></code>. Najprej za eno vozlišče, nato dve in tri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d35e3f32b3af1179dc6153c3d9a61be55d95ee95a0d4df17a5c3ea25c05da0d5.png" src="_images/d35e3f32b3af1179dc6153c3d9a61be55d95ee95a0d4df17a5c3ea25c05da0d5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f98083914cb29f9a498e733ffba2b3b9cab80dadc9e634fabb93f2a19c75138d.png" src="_images/f98083914cb29f9a498e733ffba2b3b9cab80dadc9e634fabb93f2a19c75138d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d2086d525a42eebeae44cbc9597e1a42736ca7ca5a6a6cf4858c19fba7e9a6b.png" src="_images/7d2086d525a42eebeae44cbc9597e1a42736ca7ca5a6a6cf4858c19fba7e9a6b.png" />
</div>
</div>
</section>
<section id="scipy-integrate-fixed-quad">
<h4><code class="docutils literal notranslate"><span class="pre">scipy.integrate.fixed_quad</span></code><a class="headerlink" href="#scipy-integrate-fixed-quad" title="Permalink to this heading">#</a></h4>
<p>Znotraj <code class="docutils literal notranslate"><span class="pre">scipy</span></code> je Gaussova integracijska metoda implementirana v okviru funkcije <code class="docutils literal notranslate"><span class="pre">scipy.integrate.fixed_quad()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.fixed_quad.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fixed_quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>kjer so parametri:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> je ime funkcije, ki jo kličemo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> je spodnja meja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> je zgornja meja,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code> je terka morebitnih dodatnih argumentov funkcije <code class="docutils literal notranslate"><span class="pre">func</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> je število vozlišč Gaussove integracije, privzeto <code class="docutils literal notranslate"><span class="pre">n=5</span></code>.</p></li>
</ul>
<p>Funkcija vrne terko z rezultatom integriranja <code class="docutils literal notranslate"><span class="pre">val</span></code> in vrednost <code class="docutils literal notranslate"><span class="pre">None</span></code>: <code class="docutils literal notranslate"><span class="pre">(val,</span> <span class="pre">None)</span></code></p>
<p>Poglejmo primer od zgoraj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">fixed_quad</span>
<span class="n">fixed_quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d2086d525a42eebeae44cbc9597e1a42736ca7ca5a6a6cf4858c19fba7e9a6b.png" src="_images/7d2086d525a42eebeae44cbc9597e1a42736ca7ca5a6a6cf4858c19fba7e9a6b.png" />
</div>
</div>
<p>Rezultat je enak predhodnemu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d2086d525a42eebeae44cbc9597e1a42736ca7ca5a6a6cf4858c19fba7e9a6b.png" src="_images/7d2086d525a42eebeae44cbc9597e1a42736ca7ca5a6a6cf4858c19fba7e9a6b.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="scipy-integrate">
<h2><code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code><a class="headerlink" href="#scipy-integrate" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> je močno orodje za numerično integriranje (glejte <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html">dokumentacijo</a>). V nadaljevanju si bomo pogledali nekatere funkcije.</p>
<section id="intergracijske-funkcije-ki-zahtevajo-definicijsko-funkcijo">
<h3>Intergracijske funkcije, ki zahtevajo definicijsko <em>funkcijo</em>:<a class="headerlink" href="#intergracijske-funkcije-ki-zahtevajo-definicijsko-funkcijo" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">quad(func,</span> <span class="pre">a,</span> <span class="pre">b[,</span> <span class="pre">args,</span> <span class="pre">full_output,</span> <span class="pre">...])</span></code>	izračuna določeni integral <code class="docutils literal notranslate"><span class="pre">func(x)</span></code> v mejah [<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>],</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dblquad(func,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">gfun,</span> <span class="pre">hfun[,</span> <span class="pre">args,</span> <span class="pre">...])</span></code>	izračuna določeni integral <code class="docutils literal notranslate"><span class="pre">func(x,y)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tplquad(func,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">gfun,</span> <span class="pre">hfun,</span> <span class="pre">qfun,</span> <span class="pre">rfun)</span></code>	izračuna določeni integral <code class="docutils literal notranslate"><span class="pre">func(x,y,z)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nquad(func,</span> <span class="pre">ranges[,</span> <span class="pre">args,</span> <span class="pre">opts,</span> <span class="pre">full_output])</span></code>	izračuna določeni integral <span class="math notranslate nohighlight">\(n\)</span> dimenzijske funkcije <code class="docutils literal notranslate"><span class="pre">func(</span> <span class="pre">...)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">romberg(function,</span> <span class="pre">a,</span> <span class="pre">b[,</span> <span class="pre">args,</span> <span class="pre">tol,</span> <span class="pre">rtol,</span> <span class="pre">...])</span></code>	integracija Romberg za funkcijo <code class="docutils literal notranslate"><span class="pre">function</span></code>,</p></li>
</ul>
<section id="scipy-integrate-quad">
<h4><code class="docutils literal notranslate"><span class="pre">scipy.integrate.quad</span></code><a class="headerlink" href="#scipy-integrate-quad" title="Permalink to this heading">#</a></h4>
<p>Poglejmo si zelo uporabno funkcijo za integriranje, <code class="docutils literal notranslate"><span class="pre">scipy.integrate.quad()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> 
     <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wopts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxp1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">limlst</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Izbrani parametri so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> Python funkcija, ki jo integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> spodnja meja integriranja (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> zgornja meja integriranja (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full_output</span></code> za prikaz vseh rezultatov, privzeto 0,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsabs</span></code> dovoljena absolutna napaka,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsrel</span></code> dovoljena relativna napaka.</p></li>
</ul>
<p>Poglejmo primer od zgoraj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cb01a33cdff4d9d87f6873d7e54cddb25543e4254ffbe38a4bce47844ec425e1.png" src="_images/cb01a33cdff4d9d87f6873d7e54cddb25543e4254ffbe38a4bce47844ec425e1.png" />
</div>
</div>
</section>
<section id="scipy-integrate-dblquad">
<h4><code class="docutils literal notranslate"><span class="pre">scipy.integrate.dblquad</span></code><a class="headerlink" href="#scipy-integrate-dblquad" title="Permalink to this heading">#</a></h4>
<p>Gre za podobno funkcijo kot <code class="docutils literal notranslate"><span class="pre">quad</span></code>, vendar za integriranje po dveh spremenljivkah (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.dblquad.html#scipy.integrate.dblquad">dokumentacija</a>).
Funkcija <code class="docutils literal notranslate"><span class="pre">scipy.integrate.dblquad()</span></code> izračuna dvojni integral <code class="docutils literal notranslate"><span class="pre">func(y,</span> <span class="pre">x)</span></code> v mejah od <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">[a,</span> <span class="pre">b]</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">[gfun(x),</span> <span class="pre">hfun(x)]</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dblquad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">gfun</span><span class="p">,</span> <span class="n">hfun</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">)</span>
</pre></div>
</div>
<p>Izbrani parametri so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> je Python funkcija, ki jo integriramo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> je spodnja meja integriranja <code class="docutils literal notranslate"><span class="pre">x</span></code> (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> je zgornja meja integriranja <code class="docutils literal notranslate"><span class="pre">x</span></code> (lahko se uporabi <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> za mejo v neskončnosti),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gfun</span></code> je Python funkcija, ki definira spodnjo mejo <code class="docutils literal notranslate"><span class="pre">y</span></code> v odvisnosti od <code class="docutils literal notranslate"><span class="pre">x</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hfun</span></code> je Python funkcija, ki definira zgornjo mejo <code class="docutils literal notranslate"><span class="pre">y</span></code> v odvisnosti od <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
<p>Poglejmo primer izračuna površine polkroga s polmerom 1:</p>
<div class="math notranslate nohighlight">
\[\int_{-1}^{1}\left(\int_0^{\sqrt{1-x^2}}1\,\textrm{d}y\right)\,\textrm{d}x=\frac{\pi}{2}\]</div>
<p>Definirajmo ustrezne Python funkcije in izračunajmo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="c1"># integracijska funkcija je enostavna, konstanta = 1!</span>
    <span class="k">return</span> <span class="mf">1.</span>
<span class="k">def</span> <span class="nf">gfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>    <span class="c1"># spodnja meja = 0</span>
    <span class="k">return</span> <span class="mf">0.</span>
<span class="k">def</span> <span class="nf">hfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>    <span class="c1"># zgornja meja</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gfun</span><span class="o">=</span><span class="n">gfun</span><span class="p">,</span> <span class="n">hfun</span><span class="o">=</span><span class="n">hfun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/18fc0987acb303934df0f10f5e4d72fec59179d1e3e2a8baa3763ff4fc6d55a9.png" src="_images/18fc0987acb303934df0f10f5e4d72fec59179d1e3e2a8baa3763ff4fc6d55a9.png" />
</div>
</div>
</section>
</section>
<section id="intergracijske-funkcije-ki-zahtevajo-tabelo-vrednosti">
<h3>Intergracijske funkcije, ki zahtevajo tabelo vrednosti:<a class="headerlink" href="#intergracijske-funkcije-ki-zahtevajo-tabelo-vrednosti" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trapz(y[,</span> <span class="pre">x,</span> <span class="pre">dx,</span> <span class="pre">axis])</span></code> sestavljeno trapezno pravilo,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cumtrapz(y[,</span> <span class="pre">x,</span> <span class="pre">dx,</span> <span class="pre">axis,</span> <span class="pre">initial])</span></code> kumulativni integral podintegralske funkcije (vrne rezultat v vsakem vozlišču),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simps(y[,</span> <span class="pre">x,</span> <span class="pre">dx,</span> <span class="pre">axis,</span> <span class="pre">even])</span></code>	Simpsonova metoda,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">romb(y[,</span> <span class="pre">dx,</span> <span class="pre">axis,</span> <span class="pre">show])</span></code>	Rombergova metoda.</p></li>
</ul>
<p>Tukaj si bomo na primeru ogledali funkcijo <code class="docutils literal notranslate"><span class="pre">cumtrapz</span></code>. Kot primer si, ko na maso <span class="math notranslate nohighlight">\(m=1\)</span> (enote izpustimo) deluje sila <span class="math notranslate nohighlight">\(F=\sin(t)\)</span>. Iz 2. Newtonovega zakona sledi: <span class="math notranslate nohighlight">\(F=m\,\ddot x\)</span>. Pospešek integriramo, da izračunamo hitrost; nato integriramo še enkrat za pomik. Definirajmo najprej funkcijo za pospešek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pospešek</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">/</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Zanima nas dogajanje v času 3 sekund:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo tabelo pospeškov ter nato integrirajmo za hitrost (pri tem je pomembno, da definiramo začetno vrednost):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pospešek</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hitrost sedaj še enkrat integrirajmo, da izračunamo pot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pospesek&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hitrost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7c46ebbfd7052419d3745b1fe71004c205fe496c57490b1d68b0bed63e1aaa45.png" src="_images/7c46ebbfd7052419d3745b1fe71004c205fe496c57490b1d68b0bed63e1aaa45.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Na sliki (vir: J. Slavič: Dinamika, meh. nihanja …, 2014) je prikazan trikotnik s stranicami dolžine <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, z debelino <span class="math notranslate nohighlight">\(h\)</span> in gostoto <span class="math notranslate nohighlight">\(\rho\)</span>.
<img src="./fig/Slavic_2014_str_242_slika_5.4.png" width=200>
V simbolni obliki določite masni vztrajnostni moment glede na prikazano os <span class="math notranslate nohighlight">\(y\)</span>:
$<span class="math notranslate nohighlight">\(J_{yy}=\int_0^b y^2\,\rho\,h\,(a-a/b\,y)\,\textrm{d}y.\)</span><span class="math notranslate nohighlight">\(
Upoštevajte tudi: \)</span>m=a,b,h,\rho/2$. Za izmišljene vrednosti izračunajte numerični rezultat.</p></li>
<li><p>Izračunajte integral tudi numerično. Uporabite <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> in integrirajte glede na pravila: trapezno, Simpsonovo 1/3. Rezultat primerjajte tudi z Gaussovo kvadraturo.
Raziščite natančnost in hitrost metod.</p></li>
<li><p>Preštudirajte <code class="docutils literal notranslate"><span class="pre">scipy.special.legendre</span></code>, ki vam vrne objekt <code class="docutils literal notranslate"><span class="pre">orthopoly1d</span></code>. Ta objekt ima metodo <code class="docutils literal notranslate"><span class="pre">weights</span></code>, ki vrne seznam <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">w,</span> <span class="pre">mu0]</span></code> vrednosti, ki jih uporabimo pri Gaussovi kvadraturi. (Če vsega ne razumete, ne skrbite preveč, bo asistent pokazal/komentiral). Opazite lahko, da smo vrednosti izpeljali na predavanjih!</p></li>
<li><p>S pomočjo zgoraj pridobljenih uteži in vozlišč izračunajte integral s pomočjo Gaussove kvadrature: <span class="math notranslate nohighlight">\(\sum_iw_i\,f(x_i)\)</span>. Pazite na transformacijo mej.</p></li>
<li><p>Preprost integral <span class="math notranslate nohighlight">\(\int_0^2x^2\,dx\)</span> izrabite za prikaz trapeznega in Simpsonovega 1/3 pravila (osnovno pravilo, ne sestavljeno). Uteži izračunajte z uporabo <code class="docutils literal notranslate"><span class="pre">scipy</span></code>.</p></li>
<li><p>Integral predhodne točke razširite za sestavljeno trapezno pravilo (lastna koda). Prikažite vpliv števila podintervalov, primerjajte napako izračuna s predhodnim številom podintervalov in prikažite konvergenco.</p></li>
<li><p>Integral predhodne točke razširite za sestavljeno Simpsonovo 1/3 pravilo (lastna koda). Prikažite vpliv števila podintervalov, primerjajte napako izračuna s predhodnim številom podintervalov in prikažite konvergenco.</p></li>
<li><p>Z različnimi metodami izračunajte integrala (namig: vse metode niso primerne):
<span class="math notranslate nohighlight">\(\int_1^2\frac{\sin(x)}{\sqrt{x}}.\)</span></p></li>
<li><p>S pomočjo numeričnega integriranja določite ekvivalentno silo porazdeljene obremenitve (<span class="math notranslate nohighlight">\(Q\)</span>) ter njeno prijemališče vzdolž nosilca (<span class="math notranslate nohighlight">\(x_Q\)</span>) dolžine <span class="math notranslate nohighlight">\(L = 2\,\)</span>m. Konstanta obremenitve: <span class="math notranslate nohighlight">\(q_0 = 5\,\)</span>kN/m.
<img src="./fig/nal-num_integriranje_1-1.jpg" width=350>
Rešitev:
ekvivalentna obremenitev <span class="math notranslate nohighlight">\(Q = \int_0^L{q(x) \mathrm{d}x}\)</span>, pozicija (težišče) <span class="math notranslate nohighlight">\(x_Q = \frac{ \int_0^L{x\,q(x) \mathrm{d}x} }{ \int_0^L{q(x) \mathrm{d}x} }\)</span></p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno">
<h2>Dodatno<a class="headerlink" href="#dodatno" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Obravnavajte prikazan enoosni primer, obremenjen s porazdeljeno obremenitvijo <span class="math notranslate nohighlight">\(n(x)\)</span> ter točkovno silo <span class="math notranslate nohighlight">\(F=10\,\)</span>kN. Dolžina palice je <span class="math notranslate nohighlight">\(L = 2\,\)</span>m, konstanta <span class="math notranslate nohighlight">\(n_0 = 15\,\)</span>kN/m in <span class="math notranslate nohighlight">\(EA = 200000\,\mathrm{MPa} \times 50×50\, \mathrm{mm^2}\)</span>.
<img src="./fig/nal-num_integriranje_2-2.jpg" width=350>
Naloga:</p>
<ol class="arabic simple">
<li><p>S pomočjo simbolnega integriranja določite funkcijo notranje osne sile <span class="math notranslate nohighlight">\(N(x)\)</span>.</p></li>
<li><p>S pomočjo numeričnega integriranja izračunajte pomik prostega konca palice <span class="math notranslate nohighlight">\(u_0\)</span>.</p></li>
</ol>
</li>
</ol>
</section>
<span id="document-notebooks/Predavanje 12 - Numerično reševanje diferencialnih enačb - začetni problem"></span><section class="tex2jax_ignore mathjax_ignore" id="numericno-resevanje-diferencialnih-enacb-zacetni-problem">
<h2>Numerično reševanje diferencialnih enačb - začetni problem<a class="headerlink" href="#numericno-resevanje-diferencialnih-enacb-zacetni-problem" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uvod">
<h2>Uvod<a class="headerlink" href="#uvod" title="Permalink to this heading">#</a></h2>
<section id="zapis-ene-diferencialne-enacbe">
<h3>Zapis (ene) diferencialne enačbe<a class="headerlink" href="#zapis-ene-diferencialne-enacbe" title="Permalink to this heading">#</a></h3>
<p>Predpostavimo, da je mogoče diferencialno enačbo prvega reda zapisati v <em>eksplicitni</em> obliki:</p>
<div class="math notranslate nohighlight">
\[y'=f(t, y),\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(f(t, y)\)</span> podana funkcija in velja <span class="math notranslate nohighlight">\(y'=dy/dx\)</span>.</p>
<p>Dodatno je podan začetni pogoj:</p>
<div class="math notranslate nohighlight">
\[y(t_0)=y_0.\]</div>
<p>Cilj reševanja diferencialne enačbe je izračunati funkcijo <span class="math notranslate nohighlight">\(y(t)\)</span>, ki reši zgoraj definiran začetni problem. Ob določenih pogojih funkcije <span class="math notranslate nohighlight">\(f(t, y)\)</span> ima začetni problem enolično rešitev na intevalu, ki vsebuje <span class="math notranslate nohighlight">\(t_0\)</span>.</p>
<p>Pri numeričnem reševanju vedno računamo tabelo funkcije <span class="math notranslate nohighlight">\(y(t_i)\)</span>, ki reši dan začetni problem. Pri tem so vozlišča <span class="math notranslate nohighlight">\(t_i\)</span> običajno ekvidistantna:</p>
<div class="math notranslate nohighlight">
\[t_0, t_0+h, t_0+2h,\dots\]</div>
<p>in <span class="math notranslate nohighlight">\(h\)</span> imenujemo (časovni) korak (integracije).</p>
<p>Tukaj si bomo pogledali nekatere numerične metode za reševanje diferencialnih enačb pri začetnem pogoju.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="eulerjeva-metoda">
<h2>Eulerjeva metoda<a class="headerlink" href="#eulerjeva-metoda" title="Permalink to this heading">#</a></h2>
<p><strong>Eksplicitna Eulerjeva metoda</strong> temelji na razvoju funkcije <span class="math notranslate nohighlight">\(y\)</span> v Taylorjevo vrsto:</p>
<div class="math notranslate nohighlight">
\[y(t+h)=y(t)+y'(t, y(t))\,h + 
\mathcal{O}(h^2).\]</div>
<p>Naredimo napako metode <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span>, ker zanemarimo odvode drugega in višjih redov; sedaj lahko ob znani vrednosti <span class="math notranslate nohighlight">\(y(t)\)</span> in odvodu <span class="math notranslate nohighlight">\(y'(t)=f(t,y)\)</span> ocenimo vrednosti pri naslednjem časovnem koraku <span class="math notranslate nohighlight">\(t+h\)</span>. Ko imamo enkrat znane vrednosti pri <span class="math notranslate nohighlight">\(t+h\)</span>, ponovimo postopek!</p>
<p>Koraki Eulerjeve metode:</p>
<ol class="arabic simple">
<li><p>Postavimo <span class="math notranslate nohighlight">\(i=0\)</span>, <span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(y_0=y(t_0)\)</span>.</p></li>
<li><p>Izračun vrednosti funkcije pri <span class="math notranslate nohighlight">\(t_{i+1}=t_i+h\)</span>: <span class="math notranslate nohighlight">\(y_{i+1}= y_i + f(t_i, y_i)\,h.\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(i=i+1\)</span> in nadaljevanje v koraku 2.</p></li>
</ol>
<p>Diferencialno enačbo rešujemo na intervalu <span class="math notranslate nohighlight">\([t_0,t_n]\)</span> in velja <span class="math notranslate nohighlight">\(h=(t_n-t_0)/n\)</span>. <span class="math notranslate nohighlight">\(n\)</span> je število integracijskih korakov (kolikokrat izvedemo korak 2 v zgornjem algoritmu).</p>
<p>Numerična rešitev začetnega problema:</p>
<div class="math notranslate nohighlight">
\[y_0, y_1, y_2,\dots, y_{n}\]</div>
<p>pri vrednostih neodvisne spremenljivke:</p>
<div class="math notranslate nohighlight">
\[t_0, t_1, t_2\, \dots \, t_n.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;cfZ8v0b-R8o&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/cfZ8v0b-R8o"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<section id="napaka-eulerjeve-metode">
<h3>Napaka Eulerjeve metode<a class="headerlink" href="#napaka-eulerjeve-metode" title="Permalink to this heading">#</a></h3>
<p>Napaka Eulerjeve metode na vsakem koraku je reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span>.</p>
<p>Ker na intervalu od <span class="math notranslate nohighlight">\(t_0\)</span> do <span class="math notranslate nohighlight">\(t_n\)</span> tako napako naredimo <span class="math notranslate nohighlight">\(n\)</span>-krat, je kumulativna napaka <span class="math notranslate nohighlight">\(n\,\mathcal{O}(h^2)=\frac{t_n-t_0}{h}\,\mathcal{O}(h^2)=\mathcal{O}(h)\)</span>.</p>
<p>Lokalno je napaka drugega reda, globalno pa je napaka prvega reda in ker je Eulerjeva metoda tako nenatančna jo redko uporabljamo v praksi!</p>
<section id="ocena-napake">
<h4>Ocena napake<a class="headerlink" href="#ocena-napake" title="Permalink to this heading">#</a></h4>
<p>Točna rešitev <span class="math notranslate nohighlight">\(y(t_n)\)</span> pri velikosti koraka <span class="math notranslate nohighlight">\(h\)</span> je:</p>
<div class="math notranslate nohighlight">
\[y(t_n)=y_{n,h}+E_h,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(y_{n,h}\)</span> numerični približek in <span class="math notranslate nohighlight">\(E_h\)</span> napaka metode. Ker je globalna napaka prvega reda, lahko napako zapišemo kot:</p>
<div class="math notranslate nohighlight">
\[E_h=k\,h.\]</div>
<p>Podobno lahko za velikost koraka <span class="math notranslate nohighlight">\(2h\)</span> zapišemo:</p>
<div class="math notranslate nohighlight">
\[y(t_n)=y_{n,2h}+E_{2h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(y_{n,2h}\)</span> numerični približek in <span class="math notranslate nohighlight">\(E_{2h}\)</span> napaka metode:</p>
<div class="math notranslate nohighlight">
\[E_{2h}=k\,2\,h.\]</div>
<p>Ob predpostavki, da je konstanta <span class="math notranslate nohighlight">\(k\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in koraku <span class="math notranslate nohighlight">\(2h\)</span> enaka, lahko določimo oceno napake pri boljšem približku <span class="math notranslate nohighlight">\(E_h\)</span>. Očitno velja:</p>
<div class="math notranslate nohighlight">
\[y_{n,h}+k\,h=y_{n,2h}+2\,k\,h\]</div>
<p>nato določimo <em>oceno napake</em>:</p>
<div class="math notranslate nohighlight">
\[E_h=k\,h=y_{n,h}-y_{n,2h}.\]</div>
</section>
</section>
<section id="komentar-na-implicitno-eulerjevo-metodo">
<h3>Komentar na implicitno Eulerjevo metodo<a class="headerlink" href="#komentar-na-implicitno-eulerjevo-metodo" title="Permalink to this heading">#</a></h3>
<p>Pri eksplicitni Eulerjevi metodi računamo rešitev pri <span class="math notranslate nohighlight">\(t_{i+1}\)</span> iz izračunane vrednosti pri <span class="math notranslate nohighlight">\(t_i\)</span>.</p>
<p>V kolikor bi nastopala neznana vrednost rešitve pri <span class="math notranslate nohighlight">\(t_{i+1}\)</span>, to je <span class="math notranslate nohighlight">\(y_{i+1}\)</span>, tudi na desni strani, bi govorili o <strong>implicitni Eulerjevi metodi</strong> (ali <em>povratni Eulerjevi metodi</em>):</p>
<div class="math notranslate nohighlight">
\[y_{i+1}=y_i+f(t_{i+1}, y_{i+1})\,h.\]</div>
<p>Ker se iskana vrednost <span class="math notranslate nohighlight">\(y_{i+1}\)</span> nahaja na obeh straneh enačbe, moramo za določitev <span class="math notranslate nohighlight">\(y_{i+1}\)</span> rešiti (nelinearno) enačbo. Prednost implicitne Eulerjeve metode je, da je bolj stabilna (npr. v primeru togih sistemov, ki jih bomo spoznali pozneje) kakor eksplicitna oblika, vendar pa je numerično bolj zahtevna (zaradi računanja rešitve enačbe).</p>
</section>
<section id="numericna-implementacija">
<h3>Numerična implementacija<a class="headerlink" href="#numericna-implementacija" title="Permalink to this heading">#</a></h3>
<p>Najprej uvozimo potrebne knjižnice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Nato definirajmo Eulerjevo metodo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Eulerjeva metoda za reševanje sistema diferencialnih enačb: y&#39; = f(t, y)</span>
<span class="sd">    </span>
<span class="sd">    :param f:  funkcija, ki vrne prvi odvod - f(t, y)</span>
<span class="sd">    :param t:  časovni vektor kjer računamo rešitev</span>
<span class="sd">    :param y0: začetna vrednosti</span>
<span class="sd">    :param args: dodatni argumenti funkcije f (brezimenski)</span>
<span class="sd">    :param kwargs: dodatni argumenti funkcije f (poimenovani)</span>
<span class="sd">    :return y: vrne np.array ``y`` vrednosti funkcije.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>        
    <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo funkcijo za oceno napake (v numeričnem smislu bi bilo bolje oceno napake vključiti v funkcijo <code class="docutils literal notranslate"><span class="pre">euler</span></code>, vendar jo zaradi jasnosti predstavimo ločeno):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler_napaka</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Ocena napake Eulerjeve metode; argumenti so isti kakor za funkcijo `euler`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Vozlišč mora biti vsaj 5.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">2</span>==0: # sodo vozlišč; odstrani eno točko in spremeni na liho (da je sodo odsekov)
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">y_h</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">y_2h</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">E_h</span> <span class="o">=</span> <span class="n">y_h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_2h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">E_h</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="numericni-zgled">
<h3>Numerični zgled<a class="headerlink" href="#numericni-zgled" title="Permalink to this heading">#</a></h3>
<p>Kot primer rešimo diferencialno enačbo, ki opisuje padanje telesa, ki je izpostavljeno sili teže in zračnemu uporu:
<img width=150 src="fig/padanje_telesa.png"></p>
<p>Glede na II. Newtonov zakon, lahko zapišemo diferencialno enačbo:</p>
<div class="math notranslate nohighlight">
\[m\,g-c\,v=m\,v',\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(m\)</span> masa, <span class="math notranslate nohighlight">\(g\)</span> gravitacijski pospešek, <span class="math notranslate nohighlight">\(c\)</span> koeficient zračnega upora in <span class="math notranslate nohighlight">\(v\)</span> hitrost. Diferencialno enačbo bi hoteli rešiti glede na začetni pogoj:</p>
<div class="math notranslate nohighlight">
\[v(0)=0\,\textrm{m/s}.\]</div>
<p>Funkcija desne strani / prvega odvoda <span class="math notranslate nohighlight">\(f(t,y)\)</span> je:</p>
<div class="math notranslate nohighlight">
\[f(t,y)=g-c\,
\frac{y}{m}\]</div>
<p>in začetni pogoj:</p>
<div class="math notranslate nohighlight">
\[y_0=0.\]</div>
<p>Definirajmo funkcijo desnih strani:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_zračni_upor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">g</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo začetni pogoj in časovni vektor, kjer nas zanima rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])
</pre></div>
</div>
</div>
</div>
<p>Kličemo funkcijo <code class="docutils literal notranslate"><span class="pre">euler</span></code> za izračun vrednosti <span class="math notranslate nohighlight">\(y\)</span> (hitrost <span class="math notranslate nohighlight">\(v\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">)</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        ,  9.81      , 14.715     , 17.1675    , 18.39375   ,
       19.006875  , 19.3134375 , 19.46671875, 19.54335938, 19.58167969,
       19.60083984])
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hitrost mase v odvisnosti od časa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hitrost $v$ [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/75645ef948695591bc62e5027f5c6c2c65b8cde2c99a15ece960d16c72494ccd.png" src="_images/75645ef948695591bc62e5027f5c6c2c65b8cde2c99a15ece960d16c72494ccd.png" />
</div>
</div>
<p>Preverimo sedaj vpliv časovnega koraka:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">1001</span><span class="p">]:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Časovni korak: </span><span class="si">{</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">1.0e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hitrost mase v odvisnosti od časa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hitrost $v$ [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c2b737051f2b5a94b2a057a158ca0d6a50ce1db13098fbaf5d8646fd858c5eba.png" src="_images/c2b737051f2b5a94b2a057a158ca0d6a50ce1db13098fbaf5d8646fd858c5eba.png" />
</div>
</div>
<p>Opazimo, da se numerična napaka pri spremembi koraka iz 1 na 0,1 bistveno zmanjša!</p>
<p>Ocenimo še napako pri 100 in 1000 odsekih:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">101</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">euler_napaka</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/af92a0d5b323264402a0f8b6cfae982296366ad3a47ea6d05bd8831880175044.png" src="_images/af92a0d5b323264402a0f8b6cfae982296366ad3a47ea6d05bd8831880175044.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">1001</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">euler_napaka</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/af741ef24380f56d4b1835e9683a5506a7645a31fc60ff758d67ef74fd0fc794.png" src="_images/af741ef24380f56d4b1835e9683a5506a7645a31fc60ff758d67ef74fd0fc794.png" />
</div>
</div>
<p>Ko smo korak zmanjšali na desetino, se je proporcionalno zmanjšala tudi napaka (prvi red napake).</p>
<p>Poglejmo še primer, ko je zračni upor <code class="docutils literal notranslate"><span class="pre">c</span></code> argument funkcije <code class="docutils literal notranslate"><span class="pre">euler</span></code> in je prek <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> posredovan v funkcijo <code class="docutils literal notranslate"><span class="pre">f_zračni_upor()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$c=</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hitrost mase v odvisnosti od časa pri različnem koef. zračnega upora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hitrost $v$ [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3a4769e3038ad1ba663fc01f70cb8083743a3044917328ddf74aa2d924f5c5d.png" src="_images/d3a4769e3038ad1ba663fc01f70cb8083743a3044917328ddf74aa2d924f5c5d.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="metoda-runge-kutta-drugega-reda">
<h2>Metoda Runge-Kutta drugega reda<a class="headerlink" href="#metoda-runge-kutta-drugega-reda" title="Permalink to this heading">#</a></h2>
<p>Eulerjeva metoda je prvega reda (prvega reda je namreč globalna napaka <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span>). Če bi želeli izpeljati metodo drugega reda napake, bi si morali pomagati z razvojem <span class="math notranslate nohighlight">\(y(t+h)\)</span> v Taylorjevo vrsto, kjer bomo zanemarili tretji in višje odvode:</p>
<div class="math notranslate nohighlight">
\[y(t+h)=y(t)+y'(t)\,h + \frac{1}{2}y''(t)\,h^2+\mathcal{O}(h^3).\]</div>
<p>Lokalna napaka metode bo tako tretjega reda, globalna pa drugega reda.</p>
<p>Uporabimo zamenjavi <span class="math notranslate nohighlight">\(y'(t)=f(t,y)\)</span> in <span class="math notranslate nohighlight">\(y''(t)=f'(t,y)\)</span>:</p>
<div class="math notranslate nohighlight">
\[y(t+h)=y(t)+f(t,y)\,h + \frac{1}{2}f'(t,y)\,h^2+\mathcal{O}(h^3).\]</div>
<p>Ker je desna stran <span class="math notranslate nohighlight">\(f(t,y)\)</span> odvisna od neodvisne <span class="math notranslate nohighlight">\(t\)</span> in odvisne spremenljivke <span class="math notranslate nohighlight">\(y\)</span>, moramo uporabiti implicitno odvajanje:</p>
<div class="math notranslate nohighlight">
\[f'(t,y)=\frac{\partial f(t,y)}{\partial t}+\frac{\partial f(t,y)}{\partial y}\,\underbrace{\frac{\textrm{d} y}{\textrm{d} t}}_{y'=f(t,y)}
=\frac{\partial f(t,y)}{\partial t}+\frac{\partial f(t,y)}{\partial y}\,{f(t, y)}.\]</div>
<p>Vstavimo v izraz za Taylorjevo vrsto:</p>
<div class="math notranslate nohighlight">
\[y(t+h)_{\textrm{Taylor}}=y(t+h)=y(t)+f(t,y)\,h + \frac{1}{2}\,{\LARGE(}
\frac{\partial f(t,y)}{\partial t}+\frac{\partial f(t,y)}{\partial y}\,{f(t, y)}
{\LARGE)}\,h^2.\]</div>
<p>Kot je razvidno iz zgornjega izraza, potrebujemo dodatne odvode. To predstavlja določeno težavo, ki se ji lahko izognemo na različne načine; v nadaljevanju si bomo pogledali pristop <em>Runge-Kutta</em>. Ker bomo zgornji izraz pozneje še potrebovali, smo ga tukaj poimenovali <span class="math notranslate nohighlight">\(y(t+h)_{\textrm{Taylor}}\)</span>.</p>
<section id="ideja-pristopa-runge-kutta">
<h3>Ideja pristopa Runge-Kutta<a class="headerlink" href="#ideja-pristopa-runge-kutta" title="Permalink to this heading">#</a></h3>
<p>Zgornjo dilemo metoda <em>Runge-Kutta</em> (razvita leta 1901) rešuje z idejo, ki smo jo sicer že srečali pri Gaussovi integraciji: točnejšo rešitev poskuša najti z uteženo dodatno vrednostjo funkcije <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="math notranslate nohighlight">
\[y(t+h)_{\textrm{Runge-Kutta}}=y(t)+c_0\,f\left(t,y\right)\,h +c_1
\underbrace{f{\large(}t+p\,h,y+q\,h\,f(t,y){\large)}}_{A}\,h.\]</div>
<p>kjer so <span class="math notranslate nohighlight">\(c_0\)</span>, <span class="math notranslate nohighlight">\(c_1\)</span>, <span class="math notranslate nohighlight">\(p\)</span> in <span class="math notranslate nohighlight">\(q\)</span> neznane konstante (načeloma od 0 do vključno 1). Če bi v zgornjem izrazu uporabili <span class="math notranslate nohighlight">\(c_1=0\)</span>, bi izpeljali metodo prvega reda; z dodatno funkcijsko vrednostjo (<span class="math notranslate nohighlight">\(A\)</span>) pa se bo izkazalo, da  bomo izpeljali metodo drugega reda.</p>
<p>Iskanje neznanih konstant <span class="math notranslate nohighlight">\(c_0\)</span>, <span class="math notranslate nohighlight">\(c_1\)</span>, <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(q\)</span> nadaljujemo z zapisom <span class="math notranslate nohighlight">\(A\)</span> v obliki Taylorjeve vrste prvega reda:</p>
<div class="math notranslate nohighlight">
\[f{\large(}t+p\,h,y+q\,h\,f(t,y){\large)}=
\underbrace{
f{\large(}t,y{\large)}+
\frac{\partial f(t,y)}{\partial t}\,\left(p\,h\right)+
\frac{\partial f(t,y)}{\partial y}\,\left(q\,h\,f(t, y)\right)
}_{B}.\]</div>
<p>Vstavimo sedaj izpeljani <span class="math notranslate nohighlight">\(B\)</span> nazaj v izraz za <span class="math notranslate nohighlight">\(y(t+h)_{\textrm{Runge-Kutta}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[y(t+h)_{\textrm{Runge-Kutta}}=y(t)+c_0\,f\left(t,y\right)\,h +c_1
{\LARGE(}
f{\large(}t,y{\large)}+
\frac{\partial f(t,y)}{\partial t}\,\left(p\,h\right)+
\frac{\partial f(t,y)}{\partial y}\,\left(q\,h\,f(t, y)\right)
{\LARGE)}
\,h.\]</div>
<p>Nadaljujemo z izpeljevanjem in enačbo preoblikujemo, da bo podobna zgoraj izpeljani s Taylorjevo vrsto <span class="math notranslate nohighlight">\(y(t+h)_{\textrm{Taylor}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[y(t+h)_{\textrm{Runge-Kutta}}=y(t)+(c_0+c_1)\,f\left(t,y\right)\,h +\frac{1}{2}
{\LARGE(}
\frac{\partial f(t,y)}{\partial t}\,2\,c_1\,p+
2\,c_1\,q\,\frac{\partial f(t,y)}{\partial y}\,f(t, y)
{\LARGE)}
\,h^2.\]</div>
<p>Primerjajmo sedaj z zgoraj izpeljanim izrazom:</p>
<div class="math notranslate nohighlight">
\[y(t+h)_{\textrm{Taylor}}=y(t)+f(t,y)\,h + \frac{1}{2}\,{\LARGE(}
\frac{\partial f(t,y)}{\partial t}+\frac{\partial f(t,y)}{\partial y}\,{f(t, y)}
{\LARGE)}\,h^2.\]</div>
<p>Ugotovimo, da za enakost mora veljati:</p>
<div class="math notranslate nohighlight">
\[c_0+c_1=1,\qquad 2\,c_1\,p=1,\qquad 2\,c_1\,q=1.\]</div>
<p>Imamo torej tri enačbe in štiri neznanke. Eno od konstant si tako lahko poljubno izberemo, ostale tri pa izračunamo. Če na primer izberemo <span class="math notranslate nohighlight">\(c_0=0\)</span>, bi to imenovali <em>spremenjena Eulerjeva metoda</em> in bi ostali parametri bili: <span class="math notranslate nohighlight">\(c_1=1\)</span>, <span class="math notranslate nohighlight">\(p=q=1/2\)</span>. Izbira parametrov nima bistvenega vpliva na rešitev. Sicer pa velja omeniti, da tudi metodo Runge-Kutta drugega reda redko uporabljamo, saj obstajajo boljše metode.</p>
<p>Parametre <span class="math notranslate nohighlight">\(c_0\)</span>, <span class="math notranslate nohighlight">\(c_1\)</span>, <span class="math notranslate nohighlight">\(p\)</span> in <span class="math notranslate nohighlight">\(q\)</span> vstavimo v prvo enačbo tega poglavja. Ko je definiran začetni čas <span class="math notranslate nohighlight">\(t_0\)</span> in začetni pogoj <span class="math notranslate nohighlight">\(y_0\)</span>, uporabimo metodo Runge-Kutta drugega reda:</p>
<div class="math notranslate nohighlight">
\[y_{i+1} = y_i + f\left(t_i+\frac{1}{2}\,h, y_i+\frac{1}{2}\,h\,f(t_i,y_i)\right)\,h.\]</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="metoda-runge-kutta-cetrtega-reda">
<h2>Metoda Runge-Kutta četrtega reda<a class="headerlink" href="#metoda-runge-kutta-cetrtega-reda" title="Permalink to this heading">#</a></h2>
<p>Podobno kot smo izpeljali metodo Runge-Kutta drugea reda, se izpelje metodo Runge Kutta četrtega reda. Tudi pri metodi četrtega reda obstaja več različic in kot metoda Runge-Kutta četrtega reda razumemo naslednjo metodo:</p>
<div class="math notranslate nohighlight">
\[y_{i+1}=y_i+\frac{1}{6}(k_0+2\,k_1+2\,k_2+k_3),\]</div>
<p>kjer so:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
k_0&amp;=h\,f(t_i,y_i)\\
k_1&amp;=h\,f\left(t_i+\frac{h}{2},y_i+\frac{k_0}{2}\right)\\
k_2&amp;=h\,f\left(t_i+\frac{h}{2},y_i+\frac{k_1}{2}\right)\\
k_3&amp;=h\,f\left(t_i+h,y_i+k_2\right).
\end{align}
\end{split}\]</div>
<p>Koraki metode Runge-Kutta četrtega reda so:</p>
<ol class="arabic simple">
<li><p>Določitev <span class="math notranslate nohighlight">\(i=0\)</span> in <span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(y_0=y(t_0)\)</span>,</p></li>
<li><p>Izračun koeficintov: <span class="math notranslate nohighlight">\(k_0\)</span>, <span class="math notranslate nohighlight">\(k_1\)</span>, <span class="math notranslate nohighlight">\(k_2\)</span>, <span class="math notranslate nohighlight">\(k_3\)</span>,</p></li>
<li><p>Izračun vrednosti rešitve diferencialne enačbe pri <span class="math notranslate nohighlight">\(t_{i+1}=t_i+h\)</span>:   <span class="math notranslate nohighlight">\(\quad y_{i+1}=y_i+\frac{1}{6}(k_0+2\,k_1+2\,k_2+k_3),\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(i=i+1\)</span> in nadaljevanje v koraku 2.</p></li>
</ol>
<section id="napaka-metode-runge-kutta-cetrtega-reda">
<h3>Napaka metode Runge-Kutta četrtega reda<a class="headerlink" href="#napaka-metode-runge-kutta-cetrtega-reda" title="Permalink to this heading">#</a></h3>
<p>Metodo Runge-Kutta četrtega reda imenujemo tako zato, ker ima lokalno napako petega reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^5)\)</span>, vendar pa to napako naredimo <span class="math notranslate nohighlight">\(n\)</span>-krat, zato je globalna napaka četrtega reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^4)\)</span>.</p>
<section id="id1">
<h4>Ocena napake<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<p>Točen rezultat <span class="math notranslate nohighlight">\(y(t_n)\)</span> pri velikosti koraka <span class="math notranslate nohighlight">\(h\)</span> je:</p>
<div class="math notranslate nohighlight">
\[y(t_n)=y_{n,h}+E_h,\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(y_{n,h}\)</span> numerični približek rešitve in <span class="math notranslate nohighlight">\(E_h\)</span> napaka metode. Ker je globalna napaka četrtega reda, lahko napako zapišemo tako:</p>
<div class="math notranslate nohighlight">
\[E_h=k\,h^4.\]</div>
<p>Podobno lahko za velikost koraka <span class="math notranslate nohighlight">\(2h\)</span> zapišemo:</p>
<div class="math notranslate nohighlight">
\[y(t_n)=y_{n,2h}+E_{2h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(y_{n,2h}\)</span> numerični približek rešitve in <span class="math notranslate nohighlight">\(E_{2h}\)</span> napaka metode:</p>
<div class="math notranslate nohighlight">
\[E_{2h}=k\,(2\,h)^4=16\,k\,h^4.\]</div>
<p>Ob predpostavki, da je konstanta <span class="math notranslate nohighlight">\(k\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in koraku <span class="math notranslate nohighlight">\(2h\)</span> enaka, lahko izračunamo oceno napake pri boljšem približku <span class="math notranslate nohighlight">\(E_h\)</span>.</p>
<p>Najprej je res:</p>
<div class="math notranslate nohighlight">
\[y_{n,h}+k\,h^4=y_{n,2h}+16\,k\,h^4,\]</div>
<p>sledi:</p>
<div class="math notranslate nohighlight">
\[15\,k\,h^4=y_{n,h}-y_{n,2h}\]</div>
<p>in nato določimo <em>oceno napake</em> natančnejše rešitve:</p>
<div class="math notranslate nohighlight">
\[E_h=\frac{y_{n,h}-y_{n,2h}}{15}.\]</div>
</section>
</section>
<section id="id2">
<h3>Numerična implementacija<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">runge_kutta_4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Metoda Runge-Kutta 4. reda za reševanje diferencialne enačbe: y&#39; = f(t, y)</span>
<span class="sd">    </span>
<span class="sd">    :param f: funkcija, ki jo kličemo s parametroma t in y in vrne </span>
<span class="sd">              vrednost prvega odvoda</span>
<span class="sd">    :param t: ekvidistanten časovni vektor oz. neodvisna spremenljivka</span>
<span class="sd">    :param y0: začetna vrednost</span>
<span class="sd">    :param args: dodatni argumenti funkcije f (brezimenski)</span>
<span class="sd">    :param kwargs: dodatni argumenti funkcije f (poimenovani)</span>
<span class="sd">    :return y: funkcijske vrednosti.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">k0</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">k0</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">k1</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">k2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">k0</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span><span class="o">/</span><span class="mf">6.0</span>
    
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">RK4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ti</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>Funkcija za oceno napake:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">runge_kutta_4_napaka</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Ocena napake metode Runge Kutta 4; argumenti isti kakor za `runge_kutta_4`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Vozlišč mora biti vsaj 5.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">2</span>==0: # sodo vozlišč; odstrani eno točko in spremeni na liho (da je sodo odsekov)
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">y_h</span> <span class="o">=</span> <span class="n">runge_kutta_4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">y_2h</span> <span class="o">=</span> <span class="n">runge_kutta_4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">E_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_2h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">15</span>
    <span class="k">return</span> <span class="n">E_h</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>Numerični zgled<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>Poglejmo sedaj primer izračuna hitrosti padajoče mase:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_zračni_upor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">g</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Podajmo začetni pogoj in časovni vektor, kjer nas zanima rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])
</pre></div>
</div>
</div>
</div>
<p>Za primerjavo izračunajmo rešitev s funkcijo <code class="docutils literal notranslate"><span class="pre">euler</span></code> ter <code class="docutils literal notranslate"><span class="pre">runge_kutta_4</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_euler</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">y_rk4</span> <span class="o">=</span> <span class="n">runge_kutta_4</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_euler</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_rk4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;RK4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hitrost mase v odvisnosti od časa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hitrost $v$ [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d7f881178b8d0047364403cb6ccc88eb59ba63a0136ad85f8e24fec7f63c003d.png" src="_images/d7f881178b8d0047364403cb6ccc88eb59ba63a0136ad85f8e24fec7f63c003d.png" />
</div>
</div>
<p>Poglejmo še numerično napako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">101</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">runge_kutta_4_napaka</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d05695ac9287ea3022c1920c259dd8f88df7d4dffe4fe2dc1713d1d4aa1d5398.png" src="_images/d05695ac9287ea3022c1920c259dd8f88df7d4dffe4fe2dc1713d1d4aa1d5398.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">1001</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">runge_kutta_4_napaka</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4f5d5187b654803e6e0186eca634c21b1f8ab185e6119d29a571217dc9aba7b5.png" src="_images/4f5d5187b654803e6e0186eca634c21b1f8ab185e6119d29a571217dc9aba7b5.png" />
</div>
</div>
<p>Pri zmanjšanju koraka na desetino, se je napaka zmanjšala za približno <span class="math notranslate nohighlight">\(10^4\)</span>-krat (kar ustreza pričakovanjem za metodo četrtega reda).</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="uporaba-scipy-za-resevanje-navadnih-diferencialnih-enacb">
<h2>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy</span></code> za reševanje navadnih diferencialnih enačb<a class="headerlink" href="#uporaba-scipy-za-resevanje-navadnih-diferencialnih-enacb" title="Permalink to this heading">#</a></h2>
<p>Paket <code class="docutils literal notranslate"><span class="pre">scipy</span></code> ima implementiranih <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#solving-initial-value-problems-for-ode-systems">veliko numeričnih metod</a> za reševanje začetnih problemov navadnih diferencialnih enačb. Tukaj si bomo ogledali funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code>, ki je primerna za večino začetnih problemov.</p>
<section id="scipy-integrate-solve-ivp">
<h3><code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code><a class="headerlink" href="#scipy-integrate-solve-ivp" title="Permalink to this heading">#</a></h3>
<p>Sintaksa za uporabo (IVP - <em>angl.</em> Initial Value Problem):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">,</span> 
                          <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                          <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>Pojasnilo vseh argumentov je v <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#scipy-integrate-solve-ivp">dokumentaciji</a>, tukaj bomo izpostavili nekatere:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fun</span></code> je desna stran (<code class="docutils literal notranslate"><span class="pre">func(t,</span> <span class="pre">y...)</span></code>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_span</span></code> terka (<code class="docutils literal notranslate"><span class="pre">t0</span></code>, <code class="docutils literal notranslate"><span class="pre">tf</span></code>), ki definira začetni <code class="docutils literal notranslate"><span class="pre">t0</span></code> in končni čas <code class="docutils literal notranslate"><span class="pre">tf</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y0</span></code> <strong>seznam</strong> začetne(ih) vrednosti,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code> definira numerično metodo (privzeta je eksplicitna ‚RK45‘, za toge sisteme pa so boljše: ‚Radau‘, ‚BDF‘, ‚LSODA‘),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_eval</span></code> uporabimo, če želimo rešitve ob določenih vrednosti neodvisne spremenljivke,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dense_output</span></code> ali se pripravi tudi zvezna rešitev, privzeto <code class="docutils literal notranslate"><span class="pre">False</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">events</span></code> za sledenje dogodkov, ki ustavijo reševanje začetnega problema.</p></li>
</ul>
<p>Rezultat klicanja <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code> je objekt z atributi (izbrani):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> vrednosti neodvisne spremenljivke pri katerih je izračunan rezultat,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> rezultat,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sol</span></code> funkcija zvezne rešitve (samo v primeru <code class="docutils literal notranslate"><span class="pre">dense_output=True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code> je <code class="docutils literal notranslate"><span class="pre">True</span></code>, če je bila rešitev uspešno izračunana ali prekinjena zaradi dogodka (<code class="docutils literal notranslate"><span class="pre">events</span></code>).</p></li>
</ul>
<section id="id4">
<h4>Numerični zgled<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p>Definirajmo začetni pogoj in časovni vektor, kjer nas zanima rezultat (prikažemo samo prvih deset elementov):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">t</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9])
</pre></div>
</div>
</div>
</div>
<p>Argumente (npr.: <code class="docutils literal notranslate"><span class="pre">c=0.4</span></code>) v funkcijo <code class="docutils literal notranslate"><span class="pre">fun</span></code> vpeljemo prek <code class="docutils literal notranslate"><span class="pre">lambda</span></code> izraza (<a class="reference external" href="https://docs.python.org/tutorial/controlflow.html#lambda-expressions">dokumentacija</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="n">y_ivp</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">f_zračni_upor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y0</span><span class="o">=</span><span class="p">[</span><span class="n">v0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Zgoraj uporabljen <code class="docutils literal notranslate"><span class="pre">lambda</span></code> izraz <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">t,</span> <span class="pre">y:</span> <span class="pre">f_zračni_upor(t,</span> <span class="pre">y,</span> <span class="pre">c=0.4)</span></code> je ekvivalenten:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ime_funkcije</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f_zračni_upor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
<p>Poglejmo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_ivp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  message: The solver successfully reached the end of the integration interval.
  success: True
   status: 0
        t: [ 0.000e+00  1.000e-04  1.100e-03  1.110e-02  1.111e-01
             1.111e+00  2.982e+00  5.236e+00  7.948e+00  1.000e+01]
        y: [[ 0.000e+00  9.810e-04  1.079e-02  1.086e-01  1.066e+00
              8.800e+00  1.708e+01  2.150e+01  2.350e+01  2.407e+01]]
      sol: None
 t_events: None
 y_events: None
     nfev: 56
     njev: 0
      nlu: 0
</pre></div>
</div>
</div>
</div>
<p>Ker je <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code> že pripravljen za sistem navadnih diferencialnih enačb prvega reda, je rezultat podan v dveh dimenzijah. Iskan rezultat je torej: <code class="docutils literal notranslate"><span class="pre">y_ivp.y[0]</span></code>.</p>
<p>Za primerjavo še rezultat z lastno implementacijo Runge-Kutta 4. reda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_rk4</span> <span class="o">=</span> <span class="n">runge_kutta_4</span><span class="p">(</span><span class="n">f_zračni_upor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_rk4</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.        , 0.96163898, 1.88557156, 2.77327623, 3.6261735 ,
       4.44562819, 5.23295161, 5.98940363, 6.71619474, 7.41448797])
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_ivp</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ode_ivp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_rk4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;RK4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hitrost mase v odvisnosti od časa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hitrost $v$ [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a946a15a233650ebd2d73a092fe17f1680a39be6be122f4a48fa1072f4c8cf01.png" src="_images/a946a15a233650ebd2d73a092fe17f1680a39be6be122f4a48fa1072f4c8cf01.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="sistem-navadnih-diferencialnih-enacb">
<h2>Sistem navadnih diferencialnih enačb<a class="headerlink" href="#sistem-navadnih-diferencialnih-enacb" title="Permalink to this heading">#</a></h2>
<p>Zgoraj smo si pogledali reševanje začetnega problema ene navadne diferencialne enačbe; sedaj bomo reševanje posplošili na <em>začetni problem za sistem <span class="math notranslate nohighlight">\(m\)</span> navadnih diferencialnih enačb prvega reda</em>.</p>
<p>Takšen sistem zapišemo:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y}'=\mathbf{f}(t, \mathbf{y}),\]</div>
<p>kjer so podani dodatni (začetni) pogoji:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y}(t_0)=\mathbf{y}_0.\]</div>
<p>S <span class="math notranslate nohighlight">\(t\)</span> smo označili neodvisno spremenljivko (ni nujno, da je to vedno čas) in <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> vektor desnih strani.</p>
<p>Računamo rešitev sistema <span class="math notranslate nohighlight">\(m\)</span> diferencialnih enačb <span class="math notranslate nohighlight">\(\mathbf{y}'=\mathbf{f}(t, \mathbf{y})\)</span> pri <span class="math notranslate nohighlight">\(a=t_0, t_1,\dots,t_{n-1}=b\)</span>, to je <span class="math notranslate nohighlight">\(m\)</span> funkcijskih vrednosti na vsakem koraku <span class="math notranslate nohighlight">\(y_k(t_i)\)</span>, <span class="math notranslate nohighlight">\(k=0,1,\dots,m-1\)</span> in <span class="math notranslate nohighlight">\(i=0,1,\dots,n-1\)</span>. Lahko se dokaže, da lahko uporabimo vsako metodo, ki smo jo izpeljali za diferencialne enačbe prvega reda tudi za sistem navadnih diferencialnih enačb prvega reda, če zamenjamo skalarne veličine z ustreznimi vektorskimi.</p>
<section id="id5">
<h3>Numerična implementacija<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>Metodi Euler in Runge-Kutta četrtega reda potrebujeta zgolj malenkostne popravke (<code class="docutils literal notranslate"><span class="pre">y0</span></code> je numerično polje <code class="docutils literal notranslate"><span class="pre">f</span></code> vrne seznam vrednosti odvodov):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler_sistem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Eulerjeva metoda za reševanje sistema navadnih diferencialnih enačb prvega reda : y&#39; = f(t, y)</span>
<span class="sd">    </span>
<span class="sd">    :param f:  funkcija, ki jo kličemo s parametroma t in y in vrne seznam </span>
<span class="sd">               funkcij desnih strani</span>
<span class="sd">    :param t:  ekvidistantni (časovni) vektor neodvisne spremenljivke</span>
<span class="sd">    :param y0: seznam začetnih vrednosti</span>
<span class="sd">    :param args: dodatni argumenti funkcije f (brezimenski)</span>
<span class="sd">    :param kwargs: dodatni argumenti funkcije f (poimenovani)</span>
<span class="sd">    :return y: vrne np.array ``y`` funkcijskih vrednosti.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">y0</span><span class="p">)))</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="c1"># tukaj je bistvo Eulerjeve metode</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">*</span><span class="n">h</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">runge_kutta_4_sistem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Metoda Runge-Kutta 4. reda za reševanje sistema navadnih diferencialnih enačb prvega reda: y&#39; = f(t, y)</span>
<span class="sd">    </span>
<span class="sd">    :param f:  funkcija, ki jo kličemo s parametroma t in y in vrne seznam </span>
<span class="sd">               funkcij desnih strani</span>
<span class="sd">    :param t:  ekvidistantni (časovni) vektor neodvisne spremenljivke</span>
<span class="sd">    :param y0: seznam začetnih vrednosti</span>
<span class="sd">    :param args: dodatni argumenti funkcije f (brezimenski)</span>
<span class="sd">    :param kwargs: dodatni argumenti funkcije f (poimenovani)</span>
<span class="sd">    :return y: vrne np.array ``y`` funkcijskih vrednosti.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">k0</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">k0</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">k1</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">k2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">k0</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span><span class="o">/</span><span class="mf">6.0</span>
    
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">y0</span><span class="p">)))</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">RK4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ti</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<section id="id6">
<h4>Numerični zgled<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h4>
<p>Padanje mase nadgradimo v ravninsko gibanje; velikost sile upora zraka naj bo definirana kot:
$<span class="math notranslate nohighlight">\(|\mathbf{F}(\mathbf{v})|=c\,|\mathbf{v}|^2.\)</span>$
Sila upora zraka deluje v nasprotno stran kot kaže vektor hitrosti.
<img width=250 src="fig/padanje_telesa_vezano.png"></p>
<p>Ob pomoči slike, definiramo silo v <span class="math notranslate nohighlight">\(x\)</span> smeri:</p>
<div class="math notranslate nohighlight">
\[F_x=-c\,\left(v_x^2+v_y^2\right)\,\cos(\alpha)=-c\,\left(v_x^2+v_y^2\right)\,\frac{v_x}{\sqrt{v_x^2+v_y^2}}=-c\,v_x\,\sqrt{v_x^2+v_y^2}.\]</div>
<p>Podobno je sila v <span class="math notranslate nohighlight">\(y\)</span> smeri:</p>
<div class="math notranslate nohighlight">
\[F_y=-c\,v_y\,\sqrt{v_x^2+v_y^2}.\]</div>
<p>Glede na drugi Newtonov zakon zapišemo sistem dveh (vezanih) diferencialnih enačb prvega reda:</p>
<div class="math notranslate nohighlight">
\[F_x=m\,v_x',\]</div>
<div class="math notranslate nohighlight">
\[m\,g+F_y=m\,v_y',\]</div>
<p><span class="math notranslate nohighlight">\(m\)</span> je masa, <span class="math notranslate nohighlight">\(g\)</span> gravitacijski pospešek, <span class="math notranslate nohighlight">\(c\)</span> koeficient zračnega upora ter <span class="math notranslate nohighlight">\(v_x\)</span> in <span class="math notranslate nohighlight">\(v_y\)</span> hitrost v <span class="math notranslate nohighlight">\(x\)</span> oz <span class="math notranslate nohighlight">\(y\)</span> smeri. Diferencialno enačbo bi želeli rešiti glede na začetni pogoj:</p>
<div class="math notranslate nohighlight">
\[v_x(0)=v_y(0)=5\,\textrm{m/s}.\]</div>
<p>Definirajmo seznam desnih strani:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_zračni_upor_sila</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">vx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">,</span> <span class="n">g</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">vy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo začetni pogoj in časovni vektor, kjer nas zanima rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">t</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.  , 0.05, 0.1 , 0.15, 0.2 ])
</pre></div>
</div>
</div>
</div>
<p>Za primerjavo izračunajmo rešitev s funkcijo <code class="docutils literal notranslate"><span class="pre">runge_kutta_4</span></code> ter <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_RK4</span> <span class="o">=</span> <span class="n">runge_kutta_4_sistem</span><span class="p">(</span><span class="n">f_zračni_upor_sila</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">)</span>
<span class="n">y_ivp</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">f_zračni_upor_sila</span><span class="p">,</span> <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5.        , 4.23209907, 3.63858619, 3.16619484, 2.78087608],
       [5.        , 4.68459713, 4.48359747, 4.35932897, 4.28742151]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_RK4</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5.        , 4.23211316, 3.6399137 , 3.16660748, 2.77780226],
       [5.        , 4.68462761, 4.48494405, 4.35999931, 4.28466858]])
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hitrost mase (upor in sila) v odvisnosti od časa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hitrost $v$ [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/81f61676b43bcddd293a20bf30f6c5d7063166c3292142d4d1803b2be9aee86b.png" src="_images/81f61676b43bcddd293a20bf30f6c5d7063166c3292142d4d1803b2be9aee86b.png" />
</div>
</div>
</section>
</section>
<section id="preoblikovanje-diferencialne-enacbe-visjega-reda-v-sistem-diferencialnih-enacb-prvega-reda">
<h3>Preoblikovanje diferencialne enačbe višjega reda v sistem diferencialnih enačb prvega reda<a class="headerlink" href="#preoblikovanje-diferencialne-enacbe-visjega-reda-v-sistem-diferencialnih-enacb-prvega-reda" title="Permalink to this heading">#</a></h3>
<p>Pogledali si bomo, kako navadno diferencialno enačbo poljubnega reda <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="math notranslate nohighlight">
\[y^{(n)}=f(t, y, y', y'',\dots,y^{(n-1)}),\]</div>
<p>pri začetnih pogojih:</p>
<div class="math notranslate nohighlight">
\[y(t_0)=k_0,\quad y'(t_0)=k_1,\quad\dots\quad y^{(n-1)}(t_0)=k_{n-1}\]</div>
<p>preoblikujemo v sistem diferencialnih enačb prvega reda.</p>
<p>Najprej namesto odvodov vpeljemo nove spremenljivke:</p>
<div class="math notranslate nohighlight">
\[y_i=y^{(i)}, \qquad i=0,1,\dots,n-1.\]</div>
<p>Diferencialna enačba <span class="math notranslate nohighlight">\(n\)</span>-tega reda zapisana z novimi spremenljivkami je:</p>
<div class="math notranslate nohighlight">
\[y_{n-1}'=f(t, y_0, y_1, y_2,\dots,y_{n-1}).\]</div>
<p>Nove funkcije odvajamo po neodvisni spremenljivki:</p>
<div class="math notranslate nohighlight">
\[y_i'=y^{(i+1)}=y_{i+1}, \qquad i=0,1,\dots,n-2\]</div>
<p>in
$<span class="math notranslate nohighlight">\(y_{n-1}'=f(t, y_0, y_1, y_2,\dots,y_{n-1}).\)</span>$</p>
<p>Dobili smo sistem navadnih diferencialnih enačb prvega reda:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
y_0'&amp;=&amp;y_1\\
y_1'&amp;=&amp;y_2\\
&amp;\dots\\
y_{n-1}'&amp;=&amp;f(t, y_0, y_1, y_2,\dots,y_{n-1})\\
\end{array}
\end{split}\]</div>
<p>pri začetenih pogojih:</p>
<div class="math notranslate nohighlight">
\[y_0(t_0)=k_0,\quad y_1(t_0)=k_1,\quad\dots\quad y_{(n-1)}(t_0)=k_{n-1}.\]</div>
<section id="id7">
<h4>Numerični zgled<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h4>
<p>Vrnemo se  k padajoči masi:
<img width=250 src="fig/padanje_telesa_vezano.png"></p>
<p>Vendar tokrat drugi Newtonov zakon zapišimo glede na pomik (diferencialna enačba drugega reda):</p>
<div class="math notranslate nohighlight">
\[F_x=m\,x'',\]</div>
<div class="math notranslate nohighlight">
\[m\,g+F_y=m\,y'',\]</div>
<p><span class="math notranslate nohighlight">\(m\)</span> je masa, <span class="math notranslate nohighlight">\(g\)</span> gravitacijski pospešek, <span class="math notranslate nohighlight">\(c\)</span> koeficient zračnega upora ter <span class="math notranslate nohighlight">\(x''\)</span> in <span class="math notranslate nohighlight">\(y''\)</span> pospešek v izbranem koordinatnem sistemu. Začetni pogoji:</p>
<div class="math notranslate nohighlight">
\[x(0)=y(0)=0\,\textrm{m}\qquad\textrm{in}\qquad x'(0)= y'(0)=5\,\textrm{m/s}.\]</div>
<p>Imamo sistem dveh diferencialnih enačb drugega reda. Z uvedbo novih spremenljivk <span class="math notranslate nohighlight">\(y_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[y_0= x,\quad y_1= x',\quad y_2= y,\quad y_3= y'.\]</div>
<p>Pripravimo sistem diferencialnih enačb prvega reda:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
y_0'&amp;=&amp;y_1\\
y_1'&amp;=&amp;F_x/m\\
y_2'&amp;=&amp;y_3\\
y_3'&amp;=&amp;g+F_y/m
\end{array}
\end{split}\]</div>
<p>Definirajmo Pythonovo funkcijo desnih strani / prvih odvodov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_zračni_upor_vezana</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vx</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">vx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">g</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">vy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo začetni pogoj in časovni vektor, kjer nas zanima rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">t</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.  , 0.05, 0.1 , 0.15, 0.2 ])
</pre></div>
</div>
</div>
</div>
<p>Izračunamo rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_ivp</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">f_zračni_upor_vezana</span><span class="p">,</span> <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Poglejmo rezultat (<span class="math notranslate nohighlight">\([x, x', y, y']\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.        , 0.22992477, 0.42611996, 0.59587483, 0.74424286],
       [5.        , 4.23183658, 3.64002431, 3.16703014, 2.77775353],
       [0.        , 0.24153615, 0.47038377, 0.69124852, 0.9072755 ],
       [5.        , 4.68435696, 4.48497294, 4.36034218, 4.28444004]])
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultate; najprej hitrost, nato lego (<span class="math notranslate nohighlight">\(y\)</span> koordinata je pozitivna navzdol)!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hitrost mase v odvisnosti od časa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hitrost [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/67458a6594f8eef6ad5f7b8b90113e2b5fdd1cd96decbdd45031b4015911e1e9.png" src="_images/67458a6594f8eef6ad5f7b8b90113e2b5fdd1cd96decbdd45031b4015911e1e9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_ivp</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Lega mase&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/671eabd53cc78f5f4eaed3bb0d4f99f6dfb1629b13d594b3431c7a541a2ad565.png" src="_images/671eabd53cc78f5f4eaed3bb0d4f99f6dfb1629b13d594b3431c7a541a2ad565.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stabilnost-resevanja-diferencialnih-enacb">
<h2>Stabilnost reševanja diferencialnih enačb*<a class="headerlink" href="#stabilnost-resevanja-diferencialnih-enacb" title="Permalink to this heading">#</a></h2>
<p>Numerično reševane diferencialnih enačb je izpostavljeno <em>napaki metode</em> in <em>zaokrožitveni napaki</em>. Te napake so pri različnih numeričnih metodah različne.</p>
<p>Reševanje diferencialne enačbe je <strong>stabilno</strong>, če majhna sprememba začetnega pogoja vodi v majhno spremembo izračunane rešitve; sicer govorimo o <strong>nestabilnosti reševanja</strong>.</p>
<p>Stabilnost je odvisna od diferencialne enačbe, od uporabljene numerične metode in od koraka integracije <span class="math notranslate nohighlight">\(h\)</span>.</p>
<section id="primer-preprostega-nihala">
<h3>Primer preprostega nihala<a class="headerlink" href="#primer-preprostega-nihala" title="Permalink to this heading">#</a></h3>
<p>Poglejmo si najprej primer reševanja diferencialne enačbe preprostega nihala.
<img src="./fig/Slavic-slika-3.6.png" width=150></p>
<p>Slika (vir: Slavič, Dinamika, mehanska nihanja in mehanika tekočin, 2017) prikazuje dinamski sistem (masa <span class="math notranslate nohighlight">\(m\)</span>, togost <span class="math notranslate nohighlight">\(k\)</span>), katerega diferencialna enačba je</p>
<div class="math notranslate nohighlight">
\[m\, x'' + k\,x=0.\]</div>
<p>Tako diferencialno enačbo preoblikujemo v standardno obliko lastnega nihanja:</p>
<div class="math notranslate nohighlight">
\[x'' + \omega_0^2\,x=0,\]</div>
<p>kjer je lastna krožna frekvenca:</p>
<div class="math notranslate nohighlight">
\[\omega_0=\sqrt{\frac{k}{m}}\]</div>
<p>in pričakujemo odziv oblike:</p>
<div class="math notranslate nohighlight">
\[x(t)=A\,\cos(\omega_0\,t)+B\,\sin(\omega_0\,t).\]</div>
<p>Če so začetni pogoji:</p>
<div class="math notranslate nohighlight">
\[x(0\,\textrm{s})=x_0\qquad\textrm{in}\qquad x'(0\,\textrm{s})=0\,\textrm{m/s},\]</div>
<p>je rešitev začetnega problema:</p>
<div class="math notranslate nohighlight">
\[x(t)=x_0\,\cos(\omega_0\,t).\]</div>
<section id="id8">
<h4>Numerični zgled<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h4>
<p>Najprej definirajmo vektor začetnih pogojev in funkcijo desnih strani / prvih odvodov (diferencialno enačbo drugega reda pretvorimo v sistem diferencialnih enačb prvega reda <span class="math notranslate nohighlight">\(\mathbf{y}'=\mathbf{f}(t, \mathbf{y})\)</span>), kjer velja <span class="math notranslate nohighlight">\(y_0=x, y_1=x'\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_nihalo</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Funkcija desnih strani za nihalo z eno prostostno stopnjo</span>
<span class="sd">    </span>
<span class="sd">    :param t: čas</span>
<span class="sd">    :param y: seznam začetnih vrednosti</span>
<span class="sd">    :param omega: lastna krožna frekvenca</span>
<span class="sd">    :return y&#39;: seznam vrednosti odvodov</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">omega0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo podatke in analitično rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">x_zacetni_pogoji</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="n">t1</span> <span class="o">=</span> <span class="mf">4.</span>
<span class="n">cas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">pomik</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega0</span><span class="o">*</span><span class="n">cas</span><span class="p">)</span> <span class="c1"># analitična rešitev</span>
<span class="n">hitrost</span> <span class="o">=</span> <span class="o">-</span><span class="n">x0</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega0</span><span class="o">*</span><span class="n">cas</span><span class="p">)</span> <span class="c1"># analitična rešitev</span>
</pre></div>
</div>
</div>
</div>
<p>Rešitev s pomočjo metod Euler in Runge-Kutta četrtega reda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_Eu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">t_RK4</span> <span class="o">=</span> <span class="n">t_Eu</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t_Eu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">x_Eu</span> <span class="o">=</span> <span class="n">euler_sistem</span><span class="p">(</span><span class="n">f_nihalo</span><span class="p">,</span> <span class="n">t_Eu</span><span class="p">,</span> <span class="n">x_zacetni_pogoji</span><span class="p">)</span>
<span class="n">x_RK4</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">f_nihalo</span><span class="p">,</span> <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t_RK4</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_RK4</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y0</span><span class="o">=</span><span class="n">x_zacetni_pogoji</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_RK4</span><span class="p">)</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažimo rezultate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cas</span><span class="p">,</span> <span class="n">pomik</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analitična rešitev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_Eu</span><span class="p">,</span> <span class="n">x_Eu</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_RK4</span><span class="p">,</span> <span class="n">x_RK4</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Runge-Kutta 4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Stabilnost različnih metod&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pomik [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f179398defe65bc016fc29ac7645b6e65975cb8b561ededbfd0365870d42512a.png" src="_images/f179398defe65bc016fc29ac7645b6e65975cb8b561ededbfd0365870d42512a.png" />
</div>
</div>
<p>Opazimo, da je Eulerjeva metoda nestabilna in če bi povečali korak, bi postala nestabilna tudi metoda Runge-Kutta četrtega reda.</p>
</section>
<section id="zakaj-je-eulerjeva-metoda-tako-nestabilna">
<h4>Zakaj je Eulerjeva metoda tako nestabilna?<a class="headerlink" href="#zakaj-je-eulerjeva-metoda-tako-nestabilna" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_Eu</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.        ,  1.        ,  0.93683453,  0.8105036 ,  0.62499707,
        0.3882947 ,  0.1121141 , -0.18859332, -0.49638247, -0.79225904])
</pre></div>
</div>
</div>
</div>
<p>Spomnimo se Eulerjeve metode:</p>
<div class="math notranslate nohighlight">
\[x(t+h)=x(t)+x'(t)\,h,\]</div>
<p>ki nam pove, da pomik <span class="math notranslate nohighlight">\(x(t+h)\)</span> določimo glede na lego <span class="math notranslate nohighlight">\(x(t)\)</span> in hitrost <span class="math notranslate nohighlight">\(x'(t)\)</span>. Začetni pogoji izhajajo iz skrajnega odmika <span class="math notranslate nohighlight">\(x(t=0)=1\)</span> in takrat je hitrost <span class="math notranslate nohighlight">\(x'(t=0)=0\)</span>, kar pomeni, da bo <span class="math notranslate nohighlight">\(x(t+h)=1\)</span>. Že v prvem koraku torej naredimo razmeroma veliko napako. Vendar zakaj potem začne vrednost alternirajoče naraščati?</p>
<p>Spomnimo se, da je analitična rešitev <span class="math notranslate nohighlight">\(x(t)=x_0\,\cos(\omega_0\,t)\)</span> in je torej <span class="math notranslate nohighlight">\(x'(t)=-\omega_0\,x_0\,\sin(\omega_0\,t)\)</span>.</p>
<p>Vstavimo pripravljena izraza v Eulerjevo metodo in uredimo:</p>
<div class="math notranslate nohighlight">
\[x(t+h)=x(t)+x'(t)\,h=x_0\,\left(\cos(\omega_0\,t)-\omega_0\,h\,\sin(\omega_0\,t)\right).\]</div>
<p>Predpostavimo, da gledamo stanje ob takem času <span class="math notranslate nohighlight">\(t=\pi/(2\omega_0)\)</span>, ko velja <span class="math notranslate nohighlight">\(\cos(\omega_0\,t)=0\)</span> in <span class="math notranslate nohighlight">\(\sin(\omega_0\,t)=1\)</span>:</p>
<div class="math notranslate nohighlight">
\[x(t+h)=x_0\,\underbrace{\left(-\omega_0\,h\right)}_{A}.\]</div>
<p>V kolikor bo absolutna vrednost izraza <span class="math notranslate nohighlight">\(A\)</span> večja kot 1, bo pri času <span class="math notranslate nohighlight">\(t+h\)</span> vrednost večja kot v predhodnem koraku in v sledečem verjetno spet. Sledi, da lahko pride do nestabilnosti. Da se je izognemo, mora veljati:</p>
<div class="math notranslate nohighlight">
\[|A|&lt;1\qquad\rightarrow\qquad h&lt;\frac{1}{\omega_0}.\]</div>
<p>Opomba: v nekaterih knjigah boste videli tudi vrednost <span class="math notranslate nohighlight">\(h&lt;2/\omega_0\)</span>; enoliče meje za vse diferencialne enačbe ni mogoče definirati; v splošnem pa velja, da je korak definiran relativno glede na najkrajšo periodo <span class="math notranslate nohighlight">\(T\)</span> v diferencialni enačbi (npr.: <span class="math notranslate nohighlight">\(h&lt;2/\omega_0\)</span> je v bistvu enako <span class="math notranslate nohighlight">\(h&lt;2/(2\pi/T)\)</span> oziroma <span class="math notranslate nohighlight">\(h&lt;T/\pi\)</span>). Perioda <span class="math notranslate nohighlight">\(T\)</span> je definirana glede na najvišjo lastno frekvenco sistema <span class="math notranslate nohighlight">\(T=1/f_{\textrm{max}}\)</span>, ki jo izračunamo iz lastne vrednosti sistema.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Na sliki (vir: Numerical Methods in Engineering With Python 3, 3rd Ed, Jaan Kiusalaas) je prikazan izstrelek mase <span class="math notranslate nohighlight">\(m\)</span>, ki ga izstrelimo s hitrosjo <span class="math notranslate nohighlight">\(v_0\)</span> pod kotom <span class="math notranslate nohighlight">\(\alpha\)</span>. Če je sila upora zraka: <span class="math notranslate nohighlight">\(F=c\,v^{3/2}\)</span>, potem sta gibalni enačbi:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\ddot x(t)=-F\,\cos(\alpha)/m\qquad\ddot y(t)=-F\,\sin(\alpha)/m-g.\]</div>
<p>Opomba: <span class="math notranslate nohighlight">\(v=\sqrt{\dot x^2+\dot y^2}.\)</span> Ustrezne parametre si izmislite.
<img src="./fig/Jaan_Kiusalaas_stran_265_n13.png" width=300>
Sistem dveh diferencialnih enačb drugega reda zapišite v sistem diferencialnih enačb prvega reda.
2. Določite vektor začetnih pogojev, ki smo ga zgoraj označili z <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>.
3. Določite funkcijo desnih strani, <code class="docutils literal notranslate"><span class="pre">c</span></code> naj bo parameter.
4. Definirajte začetne pogoje in rešite nalogo s poljubnimi podatki.
5. Prikažite <span class="math notranslate nohighlight">\((x, y)\)</span> lego masne točke, spreminjajte koeficient upora <span class="math notranslate nohighlight">\(c\)</span>.
6. Prikažite hitrost v odvisnosti od časa. Določite minimum hitrosti in čas, pri katerem nastane.</p>
<section id="primer-van-der-polovega-nihala">
<h3>Primer Van der Polovega nihala<a class="headerlink" href="#primer-van-der-polovega-nihala" title="Permalink to this heading">#</a></h3>
<p>Namen tega primera je pokazati, kako lahko izbira integratorja vpliva na hitrost reševanja problema! Van der Polovo nihalo je opisano <a class="reference external" href="http://en.wikipedia.org/wiki/Van_der_Pol_oscillator">tukaj</a>.</p>
<p>Definirajmo seznam odvodov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_van_der_pol</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Funkcija desnih strani za Van der Pol nihalo</span>
<span class="sd">    </span>
<span class="sd">    :param t: čas</span>
<span class="sd">    :param y: seznam začetnih vrednosti</span>
<span class="sd">    :param mu: parameter dušenja in nelinearnosti</span>
<span class="sd">    :return y&#39;: seznam vrednosti odvodov</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mu</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_zacetni_pogoji</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">t1</span> <span class="o">=</span> <span class="mi">3000</span>
</pre></div>
</div>
</div>
</div>
<p>Rešitev po metodi RK45 (gre za eksplicitno shemo, ki ni primerna za toge sisteme diferencialnih enačb; reševanje je zelo počasno, zato rešitev računamo samo do <code class="docutils literal notranslate"><span class="pre">t1/100</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vp_RK45</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">f_van_der_pol</span><span class="p">,</span> <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">t1</span><span class="o">/</span><span class="mi">100</span><span class="p">),</span> <span class="n">y0</span><span class="o">=</span><span class="n">x_zacetni_pogoji</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Implicitna shema BDF (<em>angl.</em> Backward Differentiation Formulas) se tukaj izkaže kot bistveno bolj primerna. Zaradi stabilnosti, so koraki lahko bistveno večji in zato je reševanje bistveno hitrejše:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vp_BDF</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">f_van_der_pol</span><span class="p">,</span> <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="n">y0</span><span class="o">=</span><span class="n">x_zacetni_pogoji</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vp_BDF</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">vp_BDF</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C1.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pomik - BDF [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vp_RK45</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">vp_RK45</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C0.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pomik - RK4 [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/88cd56fdae436c81a755e73390d8bdf8a861a78b12024240c75d4aa93c688458.png" src="_images/88cd56fdae436c81a755e73390d8bdf8a861a78b12024240c75d4aa93c688458.png" />
</div>
</div>
</section>
<section id="simbolno-resevanje-diferencialne-enacbe-drugega-reda">
<h3>Simbolno reševanje diferencialne enačbe drugega reda<a class="headerlink" href="#simbolno-resevanje-diferencialne-enacbe-drugega-reda" title="Permalink to this heading">#</a></h3>
<p>Pogledali si bomo primer, prikazan na sliki, kjer je masa <span class="math notranslate nohighlight">\(m\)</span> na klancu naklona <span class="math notranslate nohighlight">\(\alpha\)</span>. Koeficient trenja je <span class="math notranslate nohighlight">\(\mu\)</span>, težnostni pospešek pa <span class="math notranslate nohighlight">\(g\)</span>. Začetna hitrost je <span class="math notranslate nohighlight">\(\dot y(0\,\textrm{s})=v_0\)</span>, pomik <span class="math notranslate nohighlight">\(y(0\,\textrm{s})=0\,\textrm{m}\)</span>.
<img src="./fig/masa_na_klancu.png" width=350>
Gibalna enačba (samo za smer <span class="math notranslate nohighlight">\(y\)</span>) je definirana glede na II. Newtonov zakon (glejte diagram sil na prosto telo).</p>
<section id="izpeljava-gibalne-enacbe">
<h4>Izpeljava gibalne enačbe<a class="headerlink" href="#izpeljava-gibalne-enacbe" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;m, mu, g, alpha, t, v0&#39;</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>  <span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span><span class="p">)</span>
<span class="n">eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5f2d7d32d7242f783a1e0564b4d61fcd0b33ca367ae8cdb7c63d222d83c461a0.png" src="_images/5f2d7d32d7242f783a1e0564b4d61fcd0b33ca367ae8cdb7c63d222d83c461a0.png" />
</div>
</div>
<p>Rešitev enačbe je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">dsol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d5e5a5780922d88b71eb3820a7347ba8ebf6ef758d187f5be8d68440adaabd1e.png" src="_images/d5e5a5780922d88b71eb3820a7347ba8ebf6ef758d187f5be8d68440adaabd1e.png" />
</div>
</div>
<p>Da določimo <span class="math notranslate nohighlight">\(C_1\)</span> in <span class="math notranslate nohighlight">\(C_2\)</span>, vstavimo <span class="math notranslate nohighlight">\(t=0\,\textrm{s}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsol</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5f7bf9ba829159c91e758f632c7d0c8a92b4284f08a4b6b1779ecbab7a41f6a.png" src="_images/f5f7bf9ba829159c91e758f632c7d0c8a92b4284f08a4b6b1779ecbab7a41f6a.png" />
</div>
</div>
<p>Nato odvajamo po času in ponovno vstavimo <span class="math notranslate nohighlight">\(t=0\,\textrm{s}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsol</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/629ad01e812063aebe23c53dca45494c5b32b45db9bd7f21c32ec10b6ac4114c.png" src="_images/629ad01e812063aebe23c53dca45494c5b32b45db9bd7f21c32ec10b6ac4114c.png" />
</div>
</div>
<p>Glede na začetne pogoje smo torej določili konstante:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zacetni_pogoji</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">:</span> <span class="n">v0</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Sledi rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resitev</span> <span class="o">=</span> <span class="n">dsol</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zacetni_pogoji</span><span class="p">)</span>
<span class="n">resitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0e97dcf2ac07d529843beb87960b05f5e87ef42d0ba623f58709fe58d0e41d96.png" src="_images/0e97dcf2ac07d529843beb87960b05f5e87ef42d0ba623f58709fe58d0e41d96.png" />
</div>
</div>
<p>Pripravimo si funkciji za numerični klic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">podatki</span> <span class="o">=</span> <span class="p">{</span><span class="n">mu</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="mi">15</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="n">v0</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="mf">9.81</span><span class="p">}</span> <span class="c1">#tukaj uporabimo np.pi, da imamo numerično vrednost</span>

<span class="n">pomik</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">resitev</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">podatki</span><span class="p">),</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="n">hitrost</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">resitev</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">podatki</span><span class="p">),</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pomik pri 0s: </span><span class="si">{:g}</span><span class="s1">m&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pomik</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hitrost pri 0s: </span><span class="si">{:g}</span><span class="s1">m/s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hitrost</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pomik pri 0s: 0m
Hitrost pri 0s: 1m/s
</pre></div>
</div>
</div>
</div>
<p>Pripravimo prikaz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">cas2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slika</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cas</span><span class="p">,</span> <span class="n">pomik</span><span class="p">(</span><span class="n">cas</span><span class="p">),</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pomik [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cas</span><span class="p">,</span> <span class="n">hitrost</span><span class="p">(</span><span class="n">cas</span><span class="p">),</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hitrost [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cas2</span><span class="p">,</span> <span class="n">pomik</span><span class="p">(</span><span class="n">cas2</span><span class="p">),</span> <span class="s1">&#39;C0o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pomik - velik korak[m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cas2</span><span class="p">,</span> <span class="n">hitrost</span><span class="p">(</span><span class="n">cas2</span><span class="p">),</span> <span class="s1">&#39;C1o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hitrost - velik korak [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas [s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pomik [m] / Hitrost [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slika</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/414c248b3e6483a811275aa7658b73f844fca22c077c4454f170c9455c0bb79d.png" src="_images/414c248b3e6483a811275aa7658b73f844fca22c077c4454f170c9455c0bb79d.png" />
</div>
</div>
</section>
<section id="simbolno-preoblikovanje-diferencialne-enacbe-v-sistem-diferencialnih-enacb-prvega-reda">
<h4>Simbolno preoblikovanje diferencialne enačbe v sistem diferencialnih enačb prvega reda<a class="headerlink" href="#simbolno-preoblikovanje-diferencialne-enacbe-v-sistem-diferencialnih-enacb-prvega-reda" title="Permalink to this heading">#</a></h4>
<p>Spomnimo se izvorne diferencialne enačbe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5f2d7d32d7242f783a1e0564b4d61fcd0b33ca367ae8cdb7c63d222d83c461a0.png" src="_images/5f2d7d32d7242f783a1e0564b4d61fcd0b33ca367ae8cdb7c63d222d83c461a0.png" />
</div>
</div>
<p>Definirajmo nove spremenljivke in pripravimo funkcijo <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;y0&#39;</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;y1&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/72c2d0b9632062a542d17c8412e471abb5372f383cf7f4016d0bbc809f0aecb5.png" src="_images/72c2d0b9632062a542d17c8412e471abb5372f383cf7f4016d0bbc809f0aecb5.png" />
</div>
</div>
<p>Povežimo sedaj nove spremenljivke.</p>
<p><span class="math notranslate nohighlight">\(d y_0/dt\)</span> naj bo enako <span class="math notranslate nohighlight">\(y_1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">y0</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">eq1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c2f3ddb89f3be60a21edf8757dfa79c669931bb6217b653d97ef24b940363bfc.png" src="_images/c2f3ddb89f3be60a21edf8757dfa79c669931bb6217b653d97ef24b940363bfc.png" />
</div>
</div>
<p>Odvod <span class="math notranslate nohighlight">\(d y_1/dt\)</span> (v bistvu je to <span class="math notranslate nohighlight">\(y''\)</span>) naj bo enak funkciji <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">f</span><span class="p">)</span>
<span class="n">eq2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/63f3ed65938763aa249a0debbdf93f2dbca6fbddb424a0251649f4e7532c948e.png" src="_images/63f3ed65938763aa249a0debbdf93f2dbca6fbddb424a0251649f4e7532c948e.png" />
</div>
</div>
<p>Zgornje izraze zapišemo v vektorski obliki:
$<span class="math notranslate nohighlight">\(\mathbf{y}'=\mathbf{f}(t, \mathbf{y}).\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_odvod</span> <span class="o">=</span> <span class="p">[</span><span class="n">y0</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
<span class="n">y_odvod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4dd8e7c725c5eeeb0d7219282e827c1b12f174fa7d0bd4ea956769b6a86f4073.png" src="_images/4dd8e7c725c5eeeb0d7219282e827c1b12f174fa7d0bd4ea956769b6a86f4073.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">f</span><span class="p">]</span>
<span class="n">f_vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3ad3b51158bee3c718a63ad9e9295beb58402f87882941dd134a1eeefe023ba9.png" src="_images/3ad3b51158bee3c718a63ad9e9295beb58402f87882941dd134a1eeefe023ba9.png" />
</div>
</div>
<p>Spomnimo se sedaj <code class="docutils literal notranslate"><span class="pre">f_vec</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3ad3b51158bee3c718a63ad9e9295beb58402f87882941dd134a1eeefe023ba9.png" src="_images/3ad3b51158bee3c718a63ad9e9295beb58402f87882941dd134a1eeefe023ba9.png" />
</div>
</div>
<p>Če rešujemo numerično, potem funkcijo <span class="math notranslate nohighlight">\(\mathbf{f}(t, \mathbf{y})\)</span> zapišemo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pospesek</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span><span class="n">eq</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">podatki</span><span class="p">))</span>
<span class="n">pospesek</span> <span class="c1">#raziščite zakaj smo tukaj tako definirali! namig: type(pospesek)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e3791e88bd44e736e10d151d3c119ca424f7ad1c6221a1440ac3fb5e9afd8ad.png" src="_images/4e3791e88bd44e736e10d151d3c119ca424f7ad1c6221a1440ac3fb5e9afd8ad.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">F_klada</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pospesek</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Preverimo funkcijo pri začetnem času <span class="math notranslate nohighlight">\(t=0\,\)</span>s in pri začetnih pogojih <span class="math notranslate nohighlight">\([y_0, y_1]=[0, v_0]\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_zacetni_pogoji</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">podatki</span><span class="p">[</span><span class="n">v0</span><span class="p">]])</span>
<span class="n">y_zacetni_pogoji</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 1.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_klada</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">y_zacetni_pogoji</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.        , -0.30370487])
</pre></div>
</div>
</div>
</div>
<p>Uporabimo sedaj Eulerjevo metodo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">x_Eu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">y_Eu</span> <span class="o">=</span> <span class="n">euler_sistem</span><span class="p">(</span><span class="n">F_klada</span><span class="p">,</span> <span class="n">x_Eu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="n">y_Eu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.        ,  1.        ],
       [ 1.        ,  0.69629513],
       [ 1.69629513,  0.39259025],
       [ 2.08888538,  0.08888538],
       [ 2.17777075, -0.2148195 ]])
</pre></div>
</div>
</div>
</div>
<p>Prikažemo in primerjamo z analitično rešitvijo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">narisi_euler</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">x_Eu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">y_Eu</span> <span class="o">=</span> <span class="n">euler_sistem</span><span class="p">(</span><span class="n">F_klada</span><span class="p">,</span> <span class="n">x_Eu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eulerjeva metoda s korakom $h=</span><span class="si">{:g}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_Eu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x_Eu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cas</span><span class="p">,</span> <span class="n">pomik</span><span class="p">(</span><span class="n">cas</span><span class="p">),</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pomik - analitično [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cas</span><span class="p">,</span> <span class="n">hitrost</span><span class="p">(</span><span class="n">cas</span><span class="p">),</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hitrost - analitično [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_Eu</span><span class="p">,</span> <span class="n">y_Eu</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C0.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pomik - Euler [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_Eu</span><span class="p">,</span> <span class="n">y_Eu</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;C1.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hitrost - Euler [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Čas [s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pomik [m] / Hitrost [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">narisi_euler</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "43b5bd4a696842e0bf15cd748e9d259f"}</script></div>
</div>
</section>
</section>
</section>
<span id="document-notebooks/Predavanje 13 - Numerično reševanje diferencialnih enačb - robni problem"></span><section class="tex2jax_ignore mathjax_ignore" id="numericno-resevanje-diferencialnih-enacb-robni-problem">
<h2>Numerično reševanje diferencialnih enačb - robni problem<a class="headerlink" href="#numericno-resevanje-diferencialnih-enacb-robni-problem" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resevanje-dvotockovnih-robnih-problemov">
<h2>Reševanje dvotočkovnih robnih problemov<a class="headerlink" href="#resevanje-dvotockovnih-robnih-problemov" title="Permalink to this heading">#</a></h2>
<p>Pod dvotočkovnim robnim problemom razumemo navadno diferencialno enačbo drugega reda oblike:</p>
<div class="math notranslate nohighlight">
\[\ddot y=f(t, y, \dot y),\]</div>
<p>ob predpisanih <em>robnih pogojih</em>:</p>
<div class="math notranslate nohighlight">
\[y(a)=\alpha\qquad\textrm{in}\qquad y(b)=\beta.\]</div>
<p>Metode, ki smo jih spoznali pri reševanju <em>začetnih problemov</em>, tukaj neposredno niso uporabne, ker nimamo podanega odvoda v začetni točki pri <span class="math notranslate nohighlight">\(t=a\)</span>.</p>
<p>V nadaljevanju si bomo pogledali dva različna pristopa k reševanju robnih problemov:</p>
<ol class="arabic simple">
<li><p>t. i. <strong>strelska metoda</strong>,</p></li>
<li><p><strong>metoda končnih razlik</strong>.</p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="strelska-metoda">
<h2>Strelska metoda<a class="headerlink" href="#strelska-metoda" title="Permalink to this heading">#</a></h2>
<p>Rešujemo robni problem:</p>
<div class="math notranslate nohighlight">
\[\ddot y=f(t, y, \dot y),\qquad y(a)=\alpha,\quad y(b)=\beta,\]</div>
<p>ki ga prevedemo na začetni problem tako, da si izberemo:</p>
<div class="math notranslate nohighlight">
\[\dot y (a)=u.\]</div>
<p>Problem rešimo z numeričnimi metodami reševanja začetnega problema in rešitev označimo z <span class="math notranslate nohighlight">\(\theta(u, t)\)</span>.</p>
<p>Robni problem rešimo, ko izberemo <span class="math notranslate nohighlight">\(u\)</span> tako, da velja:</p>
<div class="math notranslate nohighlight">
\[r(u)=\theta(u,b)-\beta=0.\]</div>
<p>Dobili smo nelinearno enačbo, ki jo moramo rešiti; za izračun vrednosti mejnih preostankov <span class="math notranslate nohighlight">\(r(u)\)</span> moramo numerično rešiti začetni problem.</p>
<p>Za rešitev enačbe <span class="math notranslate nohighlight">\(r(u)=0\)</span> lahko uporabimo sekantno metodo. Izberemo <span class="math notranslate nohighlight">\(u_0\)</span> in <span class="math notranslate nohighlight">\(u_1\)</span> in na <span class="math notranslate nohighlight">\(i\)</span>-tem koraku izračunamo:</p>
<div class="math notranslate nohighlight">
\[u_{i+1}=u_i-r(u_i)\,\frac{u_{i}-u_{i-1}}{r(u_{i})-r(u_{i-1})},\qquad i=2,3,\dots\]</div>
<p>Zaključimo, ko je:</p>
<div class="math notranslate nohighlight">
\[\left|r(u_{i+1})\right|&lt;\epsilon.\]</div>
<p>Rešitev strelske metode je obremenjena z napako metode reševanja nelinearne enačbe <span class="math notranslate nohighlight">\(\epsilon\)</span> in z napako numerične metode za reševanje začetnega problema.</p>
<section id="numericni-zgled-posevni-met">
<h3>Numerični zgled: poševni met<a class="headerlink" href="#numericni-zgled-posevni-met" title="Permalink to this heading">#</a></h3>
<p>Na sliki je prikazan izstrelek mase <span class="math notranslate nohighlight">\(m\)</span>, ki ga izstrelimo s hitrostjo <span class="math notranslate nohighlight">\(\textbf{v}_0\)</span>.
<img src="./fig/posevni_met.png" width=300></p>
<p>Velikost sile upora zraka je <span class="math notranslate nohighlight">\(|\textbf{F}|=c\,|\textbf{v}|^2\)</span>, potem sta gibalni enačbi:</p>
<div class="math notranslate nohighlight">
\[x''(t)=-F_x/m\qquad\ddot y(t)=-F_y/m-g.\]</div>
<p>Komponente sile so (glejte izpeljavo pri poglavju iz reševanja začetnega problema sistema diferencialnih enačb):</p>
<div class="math notranslate nohighlight">
\[F_x=-c\,x'\,\sqrt{x'^2+y'^2},\qquad F_y=-c\,y'\,\sqrt{x'^2+y'^2}.\]</div>
<section id="vertikalni-met">
<h4>Vertikalni met<a class="headerlink" href="#vertikalni-met" title="Permalink to this heading">#</a></h4>
<p>Najprej predpostavimo, da je <span class="math notranslate nohighlight">\(\varphi=90\)</span>° in torej v <span class="math notranslate nohighlight">\(x\)</span> smeri nimamo gibanja. Zanima nas rešitev, ko izstrelek izstrelimo iz višine <span class="math notranslate nohighlight">\(y=0\,\)</span>m in mora pri času <span class="math notranslate nohighlight">\(t=b=1\,\)</span>s biti na višini <span class="math notranslate nohighlight">\(y(b)=10\,\)</span>m. Definirali smo robni problem:</p>
<div class="math notranslate nohighlight">
\[y''(t)=F_y\,/m-g,\qquad y(0)=0,\quad y(1)=10.\]</div>
<p>Najprej moramo enačbo drugega reda:</p>
<div class="math notranslate nohighlight">
\[y''=f(t, y, y') = F_y/m-g\]</div>
<p>preoblikovati na sistem dveh enačb prvega reda. Uporabimo <span class="math notranslate nohighlight">\(y_i=y^{i}\)</span> ter upoštevamo <span class="math notranslate nohighlight">\(F_y=-c\,y'\,\sqrt{y'^2}\)</span>.</p>
<p>Odvajamo <span class="math notranslate nohighlight">\(y_i'=y_{i+1}\)</span> in pripravimo sistem enačb prvega reda:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
y'_0&amp;=&amp;y_1\\
y'_1&amp;=&amp;-c\,y'\,\sqrt{y'^2}/m-g
\end{array}
\end{split}\]</div>
<p>Pripravimo seznam funkcij desnih strani:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_vert</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">g</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Uvozimo modula <code class="docutils literal notranslate"><span class="pre">numpy</span></code> in <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
</pre></div>
</div>
</div>
</div>
<p>ter pripravimo funkcijo za izračun mejnega preostanka pri času <span class="math notranslate nohighlight">\(b\)</span> v odvisnosti od začetne hitrosti <span class="math notranslate nohighlight">\(v_0\)</span> (privzeti zračni upor je <span class="math notranslate nohighlight">\(c=0.1\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ciljna_lega</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">f_vert_tmp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> <span class="c1"># pripravimo funkcijo z željenimi parametri</span>
        <span class="k">return</span> <span class="n">f_vert</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">f_vert_tmp</span><span class="p">,</span> <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="n">v0</span><span class="p">]))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ciljna_lega</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>Preverimo mejni preostanek pri začetnem pogoju <span class="math notranslate nohighlight">\(v_0=y'=50\)</span> m/s:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">r</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.634550939997352
</pre></div>
</div>
</div>
</div>
<p>Opazimo, da je masa pri 1 sekundi 5,635 m nad ciljno višino.</p>
<p>Naš cilj je, da pri 1 sekundi masa doseže lego 10 m z natančnostjo <code class="docutils literal notranslate"><span class="pre">1e-6</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ciljna_lega</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>
</pre></div>
</div>
</div>
</div>
<p>Izvedimo sedaj sekantno metodo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x1</span> <span class="o">=</span> <span class="mi">50</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">f0</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">ciljna_lega</span><span class="o">=</span><span class="n">ciljna_lega</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">ciljna_lega</span><span class="o">=</span><span class="n">ciljna_lega</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">f1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">ciljna_lega</span><span class="o">=</span><span class="n">ciljna_lega</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Novi približek je </span><span class="si">{</span><span class="n">x2</span><span class="si">}</span><span class="s1">, napaka je </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="o">&lt;</span><span class="n">epsilon</span><span class="p">:</span>
        <span class="n">rešitev</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rešitev </span><span class="si">{</span><span class="n">rešitev</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Novi približek je 5.644178759347213, napaka je -9.67253633180436.
Novi približek je 33.67258709458855, napaka je 2.218701772528018.
Novi približek je 28.442965190719487, napaka je 0.8225839451367207.
Novi približek je 25.361704474139344, napaka je -0.10153714557799809.
Novi približek je 25.700255797214545, napaka je 0.004276366407140131.
Novi približek je 25.6865735228251, napaka je 2.1630891907875593e-05.
Novi približek je 25.686503962732044, napaka je -4.623817773108385e-09.
Rešitev 25.686503962732044
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si sedaj izračunano rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">f_vert</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
                <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="n">rešitev</span><span class="p">]),</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span>
               <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Zgoraj smo uporabili <code class="docutils literal notranslate"><span class="pre">lambda</span></code> izraz (<a class="reference external" href="https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions">dokumentacija</a>). Izraz <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">t,</span> <span class="pre">y:</span> <span class="pre">f_vert(t,</span> <span class="pre">y,</span> <span class="pre">c=0.1)</span></code> je ekvivalenten:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ime_funkcije</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f_vert</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>Uvozimo <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertikalni met&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">ciljna_lega</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ciljna lega&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lega $y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e0f14ee486151f79e14cfb4d5e61e1de4e16d8b30f4ede336333b4acc4ba38bb.png" src="_images/e0f14ee486151f79e14cfb4d5e61e1de4e16d8b30f4ede336333b4acc4ba38bb.png" />
</div>
</div>
</section>
<section id="posevni-met">
<h4>Poševni met<a class="headerlink" href="#posevni-met" title="Permalink to this heading">#</a></h4>
<p>Poglejmo si sedaj splošen poševni met (diferencialne enačbe so definirana že zgoraj). Najprej moramo sistem diferencialnih enačb drugega reda preoblikovati v sistem enačb prvega reda.</p>
<p>Uporabimo:</p>
<div class="math notranslate nohighlight">
\[y_0=x,~ y_1=x',~ y_2=y,~ y_3=y'\]</div>
<p>in dobimo sistem diferencialnih enačb prvega reda:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
y_0'&amp;=&amp;y_1\\
y_1'&amp;=&amp;F_x/m\\
y_2'&amp;=&amp;y_3\\
y_3'&amp;=&amp;F_y/m-g.\\
\end{array}
\end{split}\]</div>
<p>Pripravimo seznam funkcij desnih strani:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_poševno</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vx</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">vx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="o">-</span><span class="n">g</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">vy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Pripravimo še funkcijo za izračun mejnega preostanka pri času <span class="math notranslate nohighlight">\(b=1\)</span> v odvisnosti od vektorja začetne hitrosti <span class="math notranslate nohighlight">\(\mathbf{v}_0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">r_poševno</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">],</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ciljna_lega</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mf">5.</span><span class="p">]),</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">f_poševno</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">),</span>
                      <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                      <span class="n">y0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">v0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v0</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ciljna_lega</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>Preverimo mejni preostanek pri začetnem pogoju <span class="math notranslate nohighlight">\(\mathbf{v}_0=[100., 100.]\,\)</span>m/s:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_poševno</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="p">[</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">],</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 9.66195325, 11.84726075])
</pre></div>
</div>
</div>
</div>
<p>Za iskanje korena sistema nelinearnih funkcij smo že spoznali funkcijo <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hybr&#39;</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
     <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Najprej jo uvozimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</pre></div>
</div>
</div>
</div>
<p>Potem uporabimo z začetnim ugibanjem <span class="math notranslate nohighlight">\(\mathbf{v}_0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">r_poševno</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">]),</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Rešitev je:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rešitev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> message: The solution converged.
 success: True
  status: 1
     fun: [ 1.101e-13 -3.357e-13]
       x: [ 1.938e+01  1.655e+01]
    nfev: 17
    fjac: [[-9.339e-01  3.575e-01]
           [-3.575e-01 -9.339e-01]]
       r: [-4.078e-01  2.409e-01 -3.754e-01]
     qtf: [ 1.067e-09 -1.311e-09]
</pre></div>
</div>
</div>
</div>
<p>Atribut <code class="docutils literal notranslate"><span class="pre">rešitev.x</span></code> vsebuje vektor izračunanih rešitev (<code class="docutils literal notranslate"><span class="pre">[19.37894314,</span>&#160; <span class="pre">16.55482478]</span></code>). Preverimo mejni preostanek pri izračunani rešitvi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_poševno</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="n">rešitev</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.10134124e-13, -3.35731443e-13])
</pre></div>
</div>
</div>
</div>
<p>Poglejmo si sedaj izračunano rešitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">f_poševno</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span>
                <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">y0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">rešitev</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rešitev</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Poševni met&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ciljna lega za $x$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ciljna lega za $y$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lega $x$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lega $y$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/abeff98e4f5f6cf18076d28a25189dabd7c02f5fa75578b7bef7e933913471e5.png" src="_images/abeff98e4f5f6cf18076d28a25189dabd7c02f5fa75578b7bef7e933913471e5.png" />
</div>
</div>
</section>
</section>
<section id="uporaba-scipy-integrate-solve-bvp">
<h3>Uporaba <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_bvp</span></code><a class="headerlink" href="#uporaba-scipy-integrate-solve-bvp" title="Permalink to this heading">#</a></h3>
<p>Namesto <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code> in <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> lahko uporabimo vgrajeno funkcijo za reševanje robnih problemov <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_bvp</span></code> (BVP - <em>angl.</em> Boundary Value Problem):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_bvp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
                          <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fun_jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bc_jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                          <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_nodes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Pojasnilo vseh argumentov je v <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_bvp.html#scipy-integrate-solve-bvp">dokumentaciji</a>, tukaj bomo izpostavili nekatere:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fun</span></code> je desna stran (<code class="docutils literal notranslate"><span class="pre">func(t,</span> <span class="pre">y...)</span></code>),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bc</span></code> je mejni preostanek: <code class="docutils literal notranslate"><span class="pre">bc(y(a),</span> <span class="pre">y(b))</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> numerično polje (dimenzija <code class="docutils literal notranslate"><span class="pre">(m)</span></code>) neodvisne spremenljivke <code class="docutils literal notranslate"><span class="pre">x[0]=a</span></code> in <code class="docutils literal notranslate"><span class="pre">x[-1]=b</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> numerično polje (dimenzija <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">m)</span></code>) začetnih vrednosti.</p></li>
</ul>
<p>Rezultat klicanja <code class="docutils literal notranslate"><span class="pre">solve_bvp</span></code> je objekt z atributi (izbrani):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> vrednosti neodvisne spremenljivke pri katerih je izračunan rezultat,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> rezultat,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sol</span></code> rezultat v obliki kubičnega zlepka,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code> je <code class="docutils literal notranslate"><span class="pre">True</span></code>, če je bila rešitev konvergirala.</p></li>
</ul>
<p>Poglejmo primer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_bvp</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo neodvisno spremenljivko</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In mejni preostanek (želimo, da je pri času <code class="docutils literal notranslate"><span class="pre">b</span></code> lega <span class="math notranslate nohighlight">\(x=10\)</span> m in <span class="math notranslate nohighlight">\(y=5\)</span> m):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mejni_preostanek</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">yb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo še začetne vrednosti hitrosti (kot začetno ugibanje):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">y0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>   <span class="c1"># hitrost v x smeri</span>
<span class="n">y0</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># hitrost v y smeri</span>
</pre></div>
</div>
</div>
</div>
<p>In rešimo robni problem in opis rezultata</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">f_poševno</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> 
                <span class="n">bc</span><span class="o">=</span><span class="n">mejni_preostanek</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;The algorithm converged to the desired accuracy.&#39;
</pre></div>
</div>
</div>
</div>
<p>Prikažimo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Poševni met&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ciljna lega za $x$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ciljna lega za $y$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lega $x$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lega $y$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5d8620c681f3aff15c0f000c91c0c39b4cddb2b3b1a979af13bcf8fe5d6f1755.png" src="_images/5d8620c681f3aff15c0f000c91c0c39b4cddb2b3b1a979af13bcf8fe5d6f1755.png" />
</div>
</div>
</section>
<section id="numericni-zgled-nosilec-z-obremenitvijo">
<h3>Numerični zgled: nosilec z obremenitvijo<a class="headerlink" href="#numericni-zgled-nosilec-z-obremenitvijo" title="Permalink to this heading">#</a></h3>
<p>Poglejmo si nosilec:
<img src='./fig/nosilec.png' width=400></p>
<p>Poves <span class="math notranslate nohighlight">\(w(x)\)</span> nosilca popiše diferencialna enačba četrtega reda:</p>
<div class="math notranslate nohighlight">
\[-E\,I\frac{\textrm{d}^4}{\textrm{d}x^4}w(x)+q(x)=0.\]</div>
<p>Znane konstante so <span class="math notranslate nohighlight">\(E,I,l\)</span> in je <span class="math notranslate nohighlight">\(q(x)\)</span> porazdeljena obremenitev.</p>
<p>Robni pogoji (členkasto vpet nosilec):</p>
<div class="math notranslate nohighlight">
\[w(0)=w(l)=0\quad\textrm{in}\quad w''(0)=w''(l)=0\]</div>
<p>Parametri so:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I=2.1\cdot10^{-5}\,\)</span>m<span class="math notranslate nohighlight">\(^4\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(E=2.1\cdot10^{11}\,N/\)</span>m<span class="math notranslate nohighlight">\(^2\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(l=10\,\)</span>m.</p></li>
</ul>
<p>Porazdeljena obremenitev <span class="math notranslate nohighlight">\(q(x)\)</span> bo definirana pozneje.</p>
<p>Najprej moramo diferencialno enačbo četrtega reda preoblikovati v sistem diferencialnih enačb prvega reda.
Uporabimo:</p>
<div class="math notranslate nohighlight">
\[y_0=w,~ y_1=w',~ y_2=w'',~ y_3=w'''\]</div>
<p>in dobimo sistem diferencialnih enačb prvega reda:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
y_0'&amp;=&amp;y_1\\
y_1'&amp;=&amp;y_2\\
y_2'&amp;=&amp;y_3\\
y_3'&amp;=&amp;q(x)/(EI).\\
\end{array}
\end{split}\]</div>
<p>Pripravimo različne porazdeljene obremenitve:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">q_konstanta</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F_0</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">F_0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">q_trikotna</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F_0</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">F_0</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">l</span>

<span class="k">def</span> <span class="nf">q_pol_sinusna</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F_0</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">F_0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo dolžino (ostale parametre, <span class="math notranslate nohighlight">\(I, E\)</span>, bomo uporabili privzete):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="mf">10.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q_konstanta</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Konstantna&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q_pol_sinusna</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pol-sinusna&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q_trikotna</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trikotna&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Porazdeljena obremenitev $q(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/81147fb872b082a0498afb24d31d966eca29b623d8728943e4dc91eebf70a580.png" src="_images/81147fb872b082a0498afb24d31d966eca29b623d8728943e4dc91eebf70a580.png" />
</div>
</div>
<p>Pripravimo seznam funkcij desne strani:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_nosilec_konstanta</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">E</span><span class="o">=</span><span class="mf">2.1e11</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mf">2.1e-5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">q_konstanta</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f_nosilec_pol_sinusna</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">E</span><span class="o">=</span><span class="mf">2.1e11</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mf">2.1e-5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">q_pol_sinusna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">f_nosilec_trikotna</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">E</span><span class="o">=</span><span class="mf">2.1e11</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mf">2.1e-5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">q_trikotna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo sedaj robne pogoje oz. mejni preostanek (poves in moment sta na robovih enaka nič):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mejni_nosilec</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yb</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo še začetne vrednosti hitrosti (kot začetno ugibanje):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">y0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c1"># w&#39;</span>
<span class="n">y0</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c1"># w&#39;&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>In rešimo robni problem (za vse tri tipe obremenitve):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol_ko</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="n">f_nosilec_konstanta</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="n">mejni_nosilec</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y0</span><span class="p">)</span>
<span class="n">sol_pol_sin</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="n">f_nosilec_pol_sinusna</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="n">mejni_nosilec</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y0</span><span class="p">)</span>
<span class="n">sol_trikotna</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="n">f_nosilec_trikotna</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="n">mejni_nosilec</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Rezultat prikažimo za konstantno obremenitev:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">sol_ko</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_ko</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Poves $w$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">sol_ko</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_ko</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Naklon $w</span><span class="se">\&#39;</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Konstantna obremenitev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6c909e805a1b3f4800fe16ea447a953cfcd26fe11cc195497c6a55bec5f5be7d.png" src="_images/6c909e805a1b3f4800fe16ea447a953cfcd26fe11cc195497c6a55bec5f5be7d.png" />
</div>
</div>
<p>In primerjavo povesa za različne tipe obremenitve:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">sol_ko</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_ko</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Konstantna $w$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">sol_pol_sin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_pol_sin</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pol-sinusna $w$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">sol_trikotna</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_trikotna</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trikotna $w$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Poves pri različnem tipu obremenitve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7930017c43d4fbc61583afc53af3050f416e96af138fd0a3b04072fd0ff4090c.png" src="_images/7930017c43d4fbc61583afc53af3050f416e96af138fd0a3b04072fd0ff4090c.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="metoda-koncnih-razlik">
<h2>Metoda končnih razlik<a class="headerlink" href="#metoda-koncnih-razlik" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;YozKGsNYZ6Y&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="800"
            height="300"
            src="https://www.youtube.com/embed/YozKGsNYZ6Y"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>Rešujemo robni problem:</p>
<div class="math notranslate nohighlight">
\[y''=f(t, y, y'),\qquad y(a)=\alpha,\quad y(b)=\beta.\]</div>
<p>Velja torej:</p>
<div class="math notranslate nohighlight">
\[a=t_0,\quad b=t_{n-1}.\]</div>
<p>Pri metodi končnih razlik za reševanje robnega problema uporabimo diferenčno shemo. Predpostavimo, da imamo interval <span class="math notranslate nohighlight">\([a,b]\)</span>, na katerem rešujemo diferencialno enačbo (neodvisna spremenljivka) razdeljeno na enake podintervale (točk je <span class="math notranslate nohighlight">\(n\)</span>):</p>
<div class="math notranslate nohighlight">
\[t=[t_0, t_1,\dots, t_{n-1}].\]</div>
<p>Odvode nadomestimo s centralno diferenčno shemo:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Odvod<span class="math notranslate nohighlight">\(\downarrow\)</span> <span class="math notranslate nohighlight">\(\backslash\)</span> Vrednosti <span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-2}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i-1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+1}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(y_{i+2}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'=\frac{1}{h}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-0.5</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0.5</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i''=\frac{1}{h^2}\cdot\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-2</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i'''=\frac{1}{h^3}\cdot\)</span></p></td>
<td class="text-center"><p>-0.5</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>-1</p></td>
<td class="text-center"><p>0.5</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(y_i^{(4)}=\frac{1}{h^4}\cdot\)</span></p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>6</p></td>
<td class="text-center"><p>-4</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Prikazana centralna diferenčna shema ima napako drugega reda <span class="math notranslate nohighlight">\(\mathcal{O}(h^{2})\)</span>.</p>
<p>V <span class="math notranslate nohighlight">\(i\)</span>-ti točki navadno differencialno enačbo drugega reda s centralimi diferencami zapišemo:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{h^2}\left(y_{i-1}-2\,y_{i}+y_{i+1}\right)+\mathcal{O}(h^{2})=f\left(t_i, y_i, 
\frac{1}{2h}\left(-y_{i-1}+y_{i+1}\right)+\mathcal{O}(h^{2})\right).\]</div>
<p>Če zanemarimo napako metode:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{h^2}\left(y_{i-1}-2\,y_{i}+y_{i+1}\right)=f\left(t_i, y_i, 
\frac{1}{2h}\left(-y_{i-1}+y_{i+1}\right)\right),\qquad i=1,2,\dots,n-2.\]</div>
<p>Zgornjo enačbo lahko zapišemo za <span class="math notranslate nohighlight">\(n-2\)</span> notranjih točk, kar pomeni, da nam do rešljivega sistema enačb za <span class="math notranslate nohighlight">\(n\)</span> neznank manjkata še dve enačbi. Ti dve enačbi sta robna pogoja:</p>
<div class="math notranslate nohighlight">
\[y_0=\alpha,\quad y_{n-1}=\beta.\]</div>
<p>V primeru linearnega robnega problema moramo za izračun <span class="math notranslate nohighlight">\(n\)</span> neznank <span class="math notranslate nohighlight">\(y_i\)</span> rešiti sistem <span class="math notranslate nohighlight">\(n\)</span> linearnih enačb (če je pa nelinearen, pa sistem nelinearnih enačb).</p>
<section id="ocena-napake">
<h3>Ocena napake<a class="headerlink" href="#ocena-napake" title="Permalink to this heading">#</a></h3>
<p>Točen rezultat <span class="math notranslate nohighlight">\(y(t_{i})\)</span> pri velikosti koraka <span class="math notranslate nohighlight">\(h\)</span> je:</p>
<div class="math notranslate nohighlight">
\[y(t_{i})=y_{i,h}+E_{i,h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(y_{i,h}\)</span> numerični približek in <span class="math notranslate nohighlight">\(E_h\)</span> napaka metode. Ker je globalna napaka drugega reda, lahko napako zapišemo:</p>
<div class="math notranslate nohighlight">
\[E_{i,h}=k\,h^2,\]</div>
<p>Podobno lahko za velikost koraka <span class="math notranslate nohighlight">\(2h\)</span> zapišemo:</p>
<div class="math notranslate nohighlight">
\[y(t_{j})=y_{j,2h}+E_{j,2h},\]</div>
<p>kjer je <span class="math notranslate nohighlight">\(y_{j,2h}\)</span> numerični približek in <span class="math notranslate nohighlight">\(E_{2h}\)</span> napaka metode in je:</p>
<div class="math notranslate nohighlight">
\[E_{j,2h}=k\,(2\,h)^2=4\,k\,h^2\]</div>
<p>Ob predpostavki, da je konstanta <span class="math notranslate nohighlight">\(k\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in koraku <span class="math notranslate nohighlight">\(2h\)</span> enaka, lahko določimo oceno napake pri boljšem približku <span class="math notranslate nohighlight">\(E_h\)</span>. Najprej izenačimo točna rezultat <span class="math notranslate nohighlight">\(y(t_{i})\)</span> pri koraku <span class="math notranslate nohighlight">\(h\)</span> in rezultat <span class="math notranslate nohighlight">\(y(t_{j})\)</span> pri koraku <span class="math notranslate nohighlight">\(2h\)</span> (velja <span class="math notranslate nohighlight">\(i=2\,j\)</span>, <span class="math notranslate nohighlight">\(j=1,2,\dots\)</span>):</p>
<div class="math notranslate nohighlight">
\[y_{i,h}+k\,h^2=y_{j,2h}+4\,k\,h^2\]</div>
<p>sledi:</p>
<div class="math notranslate nohighlight">
\[3\,k\,h^2=y_{2j,h}-y_{j,2h}\]</div>
<p>in nato izračunamo <em>oceno napake</em>:</p>
<div class="math notranslate nohighlight">
\[E_{j,h}=\frac{y_{2j,h}-y_{j,2h}}{3}.\]</div>
</section>
<section id="numericni-zgled-vertikalni-met">
<h3>Numerični zgled: vertikalni met<a class="headerlink" href="#numericni-zgled-vertikalni-met" title="Permalink to this heading">#</a></h3>
<p>Zgoraj smo vertikalni met rešili s strelsko metodo; uporabimo sedaj metodo končnih razlik. Najprej robni problem:
$<span class="math notranslate nohighlight">\(y''(t)=F_y/m-g,\qquad y(0)=0,\quad y(1)=10.\)</span><span class="math notranslate nohighlight">\(
zapisati s pomočjo centralne diferenčne sheme (\)</span>F_y=-c,y‘$):</p>
<div class="math notranslate nohighlight">
\[\frac{1}{h^2}\left(y_{i-1}-2\,y_{i}+y_{i+1}\right)= -c\left(\frac{1}{2h}\left(-y_{i-1}+y_{i+1}\right)\right)/m-g.\]</div>
<p>(Tukaj smo predpostavili, da je zračni upor linearno odvisen od hitrost. V nasprotnem primeru bi imeli nelinearni robni problem, in posledično razvili sistem nelinearnih enačb.)</p>
<p>Zgornji izraz preoblikujemo:</p>
<div class="math notranslate nohighlight">
\[(2-c\,h/m)\,y_{i-1}-4\,y_{i}+(2+c\,h/m)\,y_{i+1}=-2\,g\,h^2,\qquad i=1,2,\dots,n-2.\]</div>
<p>Robna pogoja sta:</p>
<div class="math notranslate nohighlight">
\[y_0=0,\qquad y_{n-1}=10\]</div>
<p>Robni problem smo torej preoblikovali na sistem <span class="math notranslate nohighlight">\(n\)</span> linearnih enačb. Poglejmo si sedaj konkreten izračun za <span class="math notranslate nohighlight">\(n=11\)</span>; najprej definirajmo konstante, časovni vektor <code class="docutils literal notranslate"><span class="pre">t</span></code> in korak <code class="docutils literal notranslate"><span class="pre">h</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">11</span> <span class="c1"># liho število</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Nato nadaljujemo z izračunom tridiagonalne matrike koeficientov <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>Pomagamo si s funkcijo <code class="docutils literal notranslate"><span class="pre">numpy.diag()</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.diag.html">dokumentacija</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>s parametroma:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> vektor, ki bo prirejen diagonali,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> diagonala, kateri se priredi <code class="docutils literal notranslate"><span class="pre">v</span></code>. <code class="docutils literal notranslate"><span class="pre">k=0</span></code> uporabimo za glavno diagonalo, <code class="docutils literal notranslate"><span class="pre">k&lt;0</span></code> oz. <code class="docutils literal notranslate"><span class="pre">k&gt;0</span></code> uporabimo za  diagonale pod oz. nad glavno diagonalo.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> \
    <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> \
    <span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">A</span><span class="p">[:</span><span class="mi">4</span><span class="p">,:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.  ,  2.05,  0.  ,  0.  ],
       [ 1.95, -4.  ,  2.05,  0.  ],
       [ 0.  ,  1.95, -4.  ,  2.05],
       [ 0.  ,  0.  ,  1.95, -4.  ]])
</pre></div>
</div>
</div>
</div>
<p>Definirajmo še vektor konstant:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sedaj <em>popravimo</em> matriko koeficientov <code class="docutils literal notranslate"><span class="pre">A</span></code> in vektor konstant <code class="docutils literal notranslate"><span class="pre">b</span></code>, da zadostimo robnim pogojem:</p>
<div class="math notranslate nohighlight">
\[y_0=0,\quad y_{n-1}=10.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>
</pre></div>
</div>
</div>
</div>
<p>Rešimo sistem linearnih enačb:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_mkr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertikalni met (upor zraka: $-c\,\dot y$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ciljna lega&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_mkr</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Metoda končnih razlik&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee120e5b5d9f5947bab19e39750356390299a45a163d8cd1eba9a7613609c3ad.png" src="_images/ee120e5b5d9f5947bab19e39750356390299a45a163d8cd1eba9a7613609c3ad.png" />
</div>
</div>
<p>S pomočjo funkcije <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.gradient.html"><code class="docutils literal notranslate"><span class="pre">numpy.gradient()</span></code></a> izračunamo še hitrost in pospešek:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_mkr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">y_mkr</span><span class="p">,</span><span class="n">h</span><span class="p">,</span> <span class="n">edge_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">a_mkr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">v_mkr</span><span class="p">,</span><span class="n">h</span><span class="p">,</span> <span class="n">edge_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">v_mkr</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([17.99109496, 16.20009044, 14.45276895, 12.79068266])
</pre></div>
</div>
</div>
</div>
<p>Izračunajmo sedaj še rezultat z dvojnim korakom:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n2h</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="n">t2h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n2h</span><span class="p">)</span>
<span class="n">h2h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A2h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n2h</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> \
    <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">h2h</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n2h</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> \
    <span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">h2h</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n2h</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">b2h</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">h2h</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n2h</span><span class="p">)</span>
<span class="n">A2h</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A2h</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A2h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A2h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b2h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">b2h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">y2h_mkr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A2h</span><span class="p">,</span> <span class="n">b2h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Primerjajmo prvih šest rezultatov pri koraku <span class="math notranslate nohighlight">\(2h\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y2h_mkr</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        ,  2.40584652,  4.59862736,  6.58873597,  8.38605878,
       10.        ])
</pre></div>
</div>
</div>
</div>
<p>z vsakim drugim rezultatom pri koraku <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_mkr</span><span class="p">[:</span><span class="mi">12</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([4.55476113e-16, 3.24001809e+00, 5.79815462e+00, 7.73931207e+00,
       9.12221538e+00, 1.00000000e+01])
</pre></div>
</div>
</div>
</div>
<p>Sedaj lahko ocenimo napako:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">y_mkr</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">y2h_mkr</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.51825371e-16, 2.78057188e-01, 3.99842419e-01, 3.83525367e-01,
       2.45385533e-01, 0.00000000e+00])
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Numerični zgled: nosilec z obremenitvijo<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>Vrnimo se k robnemu problemu nosilca s polsinusno obremenitvijo (<span class="math notranslate nohighlight">\(q(x)=-F_0\,\sin(\pi\,x/l))\)</span>), ki smo ga že obravnavali s strelsko metodo.</p>
<p>Diferencialno enačbo četrtega reda zapišemo s pomočjo centralne diferenčne sheme (za <span class="math notranslate nohighlight">\(i\)</span>-to točko):</p>
<div class="math notranslate nohighlight">
\[-\frac{E\,I}{h^4}\left(1\,w_{i-2} - 4\,w_{i-1} + 6\,w_{i} - 4\,w_{i+1} + 1\, w_{i+2}\right) - F_0\,\sin(\pi\,x_i/l)= 0.\]</div>
<p>Robni pogoji so štirje, najprej poves na robovih:</p>
<div class="math notranslate nohighlight">
\[w_0=w_{n-1}=0\]</div>
<p>Ker na robovih ni momenta, je drugi odvod nič. S centralno diferenčno shemo torej zapišemo dodatne enačbe:</p>
<div class="math notranslate nohighlight">
\[w_{-1}-2\,w_{0}+w_{1}=0\qquad w_{n-2}-2\,w_{n-1}+w_{n}=0.\]</div>
<p>Če za neodvisno spremenljivko <span class="math notranslate nohighlight">\(x\)</span> uporabimo <span class="math notranslate nohighlight">\(n\)</span> ekvidistantnih točk, potem diferencialno enačbo četrtega reda zapišemo za <span class="math notranslate nohighlight">\(n-2\)</span> notranje točke. S tem pridobimo dodatni nefizikalni točki <span class="math notranslate nohighlight">\(w_{-1}\)</span> in <span class="math notranslate nohighlight">\(w_n\)</span>. Če dodamo še štiri robne pogoje, imamo rešljiv sistem linearnih enačb z <span class="math notranslate nohighlight">\(n+2\)</span> neznakami in <span class="math notranslate nohighlight">\(n+2\)</span> enačbami.</p>
<p>Najprej pripravimo podatke, neodvisno spremenljivko <code class="docutils literal notranslate"><span class="pre">x</span></code> in korak <code class="docutils literal notranslate"><span class="pre">h</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">2.1e11</span>
<span class="n">I</span> <span class="o">=</span> <span class="mf">2.1e-5</span>
<span class="n">F_0</span><span class="o">=</span> <span class="mf">1e3</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Nato pripravimo matriko koeficientov (matrika je dimenzije <code class="docutils literal notranslate"><span class="pre">(n+2,</span> <span class="pre">n+2)</span></code>, v prvi in v zadnji dve vrstici bi lahko zapisali tudi vrednosti 0, to bomo pozneje popravili):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> \
    <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> \
    <span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>  \
    <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>  \
    <span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="n">A</span><span class="p">[:</span><span class="mi">4</span><span class="p">,:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 6., -4.,  1.,  0.],
       [-4.,  6., -4.,  1.],
       [ 1., -4.,  6., -4.],
       [ 0.,  1., -4.,  6.]])
</pre></div>
</div>
</div>
</div>
<p>Definirajmo še vektor konstant (dodamo en element na koncu in en na začetku):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">h</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">F_0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">l</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="n">b</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.00000000e+00,  0.00000000e+00, -7.48966545e-10, -1.49717894e-09])
</pre></div>
</div>
</div>
</div>
<p>Sedaj <em>popravimo</em> matriko koeficientov <code class="docutils literal notranslate"><span class="pre">A</span></code> in vektor konstant <code class="docutils literal notranslate"><span class="pre">b</span></code>, da zadostimo
robnim pogojem.</p>
<p>Najprej <span class="math notranslate nohighlight">\(w_0=w_{n-1}=0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>Nato <span class="math notranslate nohighlight">\(w_{-1}-2\,w_{0}+w_{1}=0\)</span> in <span class="math notranslate nohighlight">\(w_{n-2}-2\,w_{n-1}+w_{n}=0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.,  1.,  0.,  0.,  0.],
       [ 1., -2.,  1.,  0.,  0.],
       [ 1., -4.,  6., -4.,  1.],
       [ 0.,  1., -4.,  6., -4.],
       [ 0.,  0.,  1., -4.,  6.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:,</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 6., -4.,  1.,  0.,  0.],
       [-4.,  6., -4.,  1.,  0.],
       [ 1., -4.,  6., -4.,  1.],
       [ 0.,  0.,  1., -2.,  1.],
       [ 0.,  0.,  0.,  1.,  0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.00000000e+00,  0.00000000e+00, -7.48966545e-10, -1.49717894e-09,
       -2.24388381e-09])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-2.24388381e-09, -1.49717894e-09, -7.48966545e-10,  0.00000000e+00,
        0.00000000e+00])
</pre></div>
</div>
</div>
</div>
<p>Rešimo sistem linearnih enačb:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_mkr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Prikažemo rezultat:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Poves ob polsinusni obremenitvi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol_pol_sin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_pol_sin</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Strelska metoda&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_mkr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Metoda končnih razlik&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$w$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c02f4a294072b876d4be59b0ff67edbea1a5d43ce0c8411319724115b03b94cc.png" src="_images/c02f4a294072b876d4be59b0ff67edbea1a5d43ce0c8411319724115b03b94cc.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dodatno-simbolna-resitev-nosilca">
<h2>Dodatno: simbolna rešitev nosilca<a class="headerlink" href="#dodatno-simbolna-resitev-nosilca" title="Permalink to this heading">#</a></h2>
<p>Tukaj si bomo pogledali simbolno reševanje robnega problema. Poudariti je treba, da gre tukaj zgolj za zgled, ki ga lahko naredimo za obravnavani nosilec z relativno enostavno polsinusno obremenitvijo. <strong>V praksi so seveda obremenitve in tudi oblike nosilca lahko bistveno bolj zahtevne in takrat druge poti kot numeričnega reševanja skoraj nimamo na voljo.</strong></p>
<p>Najprej uvozimo <code class="docutils literal notranslate"><span class="pre">sympy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo spremenljivke:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">F_0</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, E, I, F_0, l&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Definirajmo differencialno enačbo (robne pogoje dodamo pozneje):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">w</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="n">F_0</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">l</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dfbfec111f863632a07677e68d14b6377d0ae609b86f76f9816975551706a303.png" src="_images/dfbfec111f863632a07677e68d14b6377d0ae609b86f76f9816975551706a303.png" />
</div>
</div>
<p>Rešimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">w</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;nth_linear_constant_coeff_undetermined_coefficients&#39;</span><span class="p">,</span>
                 <span class="n">ics</span><span class="o">=</span><span class="p">{</span>
                     <span class="n">w</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span>                      <span class="c1">#poves pri x=0 je nič</span>
                     <span class="n">w</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span><span class="c1">#moment pri x=0 je nič</span>
                     <span class="n">w</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>                     <span class="c1">#poves pri x=l je nič</span>
                     <span class="n">w</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span> <span class="mi">0</span> <span class="c1">#moment pri x=l je nič                 </span>
                 <span class="p">})</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/679ef07ce43b429f1fae345c5276aa3b4d1953974b541f9c9419a06041211659.png" src="_images/679ef07ce43b429f1fae345c5276aa3b4d1953974b541f9c9419a06041211659.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">podatki</span> <span class="o">=</span> <span class="p">{</span><span class="n">E</span><span class="p">:</span> <span class="mf">2.1e11</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span> <span class="mf">2.1e-5</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">F_0</span><span class="p">:</span><span class="mf">1e3</span><span class="p">}</span>
<span class="n">resitev_np</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">podatki</span><span class="p">),</span> <span class="n">modules</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="n">x_ana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">podatki</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_ana</span> <span class="o">=</span> <span class="n">resitev_np</span><span class="p">(</span><span class="n">x_ana</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Upogib ob polsinusni obremenitvi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_ana</span><span class="p">,</span> <span class="n">y_ana</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analitična rešitev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$w$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b00333227b06312d8829e58d0c0bff0c6b9020e27b2a2250e06a34782a85c10d.png" src="_images/b00333227b06312d8829e58d0c0bff0c6b9020e27b2a2250e06a34782a85c10d.png" />
</div>
</div>
<p>Primerjajmo sedaj analitično rešitev, z rešitivijo z metodo končnih razlik in strelsko metodo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y_ana</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y_mkr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sol_pol_sin</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3d5a9e736a7ba23c87dc1df6c5dd1b2709e748c282b29a25c42e78c08150e012.png" src="_images/3d5a9e736a7ba23c87dc1df6c5dd1b2709e748c282b29a25c42e78c08150e012.png" />
</div>
</div>
</section>
<span id="document-notebooks/Predavanje 14 - Testiranje pravilnosti kode, uporabniški vmesnik"></span><section class="tex2jax_ignore mathjax_ignore" id="testiranje-pravilnosti-kode-uporabniski-vmesnik">
<h2>Testiranje pravilnosti kode, uporabniški vmesnik<a class="headerlink" href="#testiranje-pravilnosti-kode-uporabniski-vmesnik" title="Permalink to this heading">#</a></h2>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="testiranje-pravilnosti-kode">
<h2>Testiranje pravilnosti kode<a class="headerlink" href="#testiranje-pravilnosti-kode" title="Permalink to this heading">#</a></h2>
<p>Kadar razvijamo bolj obsežno kodo in pri tem sodeluje več oseb, se pojavi potreba po avtomatskem testiranju pravilnosti kode. To pomeni, da poleg kode, ki ima določen rezultat, definiramo tudi testirne funkcije; slednje preverjajo ali prve vračajo pričakovani rezultat.</p>
<p>Preprosti primer je:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># vsebina datoteke test_prvi.py (mapa moduli)</span>
<span class="k">def</span> <span class="nf">kvadrat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># očitna napaka glede na ime funkcije</span>

<span class="k">def</span> <span class="nf">test_kvadrat</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">kvadrat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Če poženemo funkcijo <code class="docutils literal notranslate"><span class="pre">test_kvadrat()</span></code> se testira pravilnost <code class="docutils literal notranslate"><span class="pre">kvadrat(2)</span> <span class="pre">==</span> <span class="pre">4</span></code>; v primeru, da je rezultat <code class="docutils literal notranslate"><span class="pre">True</span></code> se ne zgodi nič, če pa je rezultat <code class="docutils literal notranslate"><span class="pre">False</span></code> se sproži <code class="docutils literal notranslate"><span class="pre">AssertionError()</span></code> (glejte <a class="reference external" href="https://docs.python.org/reference/simple_stmts.html#assert">dokumentacijo</a> za ukaz <code class="docutils literal notranslate"><span class="pre">assert</span></code>). Ker funkcija <code class="docutils literal notranslate"><span class="pre">kvadrat()</span></code> vrne <code class="docutils literal notranslate"><span class="pre">x**2+1</span></code>, bo testiranje neuspešno.</p>
<p>Verjetno se sprašujete v čem je smisel takega <em>testiranja pravilnosti</em>. Ko koda postaja obsežna in na njej dela veliko oseb, postane nujno tudi prepletena. Tako se lahko zgodi, da razvijalec doda novo funkcionalnost in nehote poruši obstoječo. Če so vse funkcionalnosti testirane, bo testiranje zaznalo neustreznost predlagane spremembe.</p>
<p>Večina paketov ima tako dodano testiranje pravilnosti; za primer si lahko pogledate izvorno kodo paketa <em>NumPy</em>, ki se nahaja na <a class="reference external" href="https://github.com/numpy/numpy/tree/master/numpy/">githubu</a>; če pogledate <a class="reference external" href="https://github.com/numpy/numpy/tree/master/numpy/linalg">vsebino</a> podmodula <code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code> za linearno algebro:</p>
<img width=400 src='./fig/github_numpy_linalg.png'>
<p>opazimo podmapo <code class="docutils literal notranslate"><span class="pre">tests</span></code>. Slednja je v celoti namenjena testiranju in vsebuje množico Python datotek, ki preverjajo ustreznost podmodula.</p>
<p>Obstaja več možnosti testiranja kode, pogosto se uporabljajo sledeče:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/unittest.html"><code class="docutils literal notranslate"><span class="pre">unittest</span></code></a> (je vgrajen v Python),</p></li>
<li><p><a class="reference external" href="http://nose.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">nose</span></code></a>,</p></li>
<li><p><a class="reference external" href="https://docs.pytest.org/"><code class="docutils literal notranslate"><span class="pre">pytest</span></code></a>.</p></li>
</ul>
<p>Vsi trije pristopi imajo podobno funkcionalnost. V zadnjem obdobju pa se najpogosteje uporablja <code class="docutils literal notranslate"><span class="pre">pytest</span></code> (npr. NumPy/SciPy), katerega osnove si bomo tukaj pogledali.</p>
<section id="pytest">
<h3>pytest<a class="headerlink" href="#pytest" title="Permalink to this heading">#</a></h3>
<p>Modul <code class="docutils literal notranslate"><span class="pre">pytest</span></code> namestimo z ukazom <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<p>Nekatere lastnosti:</p>
<ul class="simple">
<li><p>vrne opis testa, ki ni bil uspešen,</p></li>
<li><p>samodejno iskanje testnih modulov in funkcij,</p></li>
<li><p>lahko vključuje <code class="docutils literal notranslate"><span class="pre">unittest</span></code> in <code class="docutils literal notranslate"><span class="pre">nose</span></code> teste.</p></li>
</ul>
<p>Če v ukazni vrstici poženete <code class="docutils literal notranslate"><span class="pre">pytest</span></code>, bo program sam poiskal trenutno mapo in vse podmape za datoteke oblike <code class="docutils literal notranslate"><span class="pre">test_*.py</span></code> ali <code class="docutils literal notranslate"><span class="pre">*_test.py</span></code> (napredno iskanje je navedeno v <a class="reference external" href="https://docs.pytest.org/en/latest/goodpractices.html#test-discovery">dokumentaciji</a>).</p>
<p>Če v ukazni vrstici poženemo ukaz:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span>
</pre></div>
</div>
<p>bomo dobili tako poročilo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">=============================</span> <span class="n">test</span> <span class="n">session</span> <span class="n">starts</span> <span class="o">=============================</span>
<span class="n">platform</span> <span class="n">win32</span> <span class="o">--</span> <span class="n">Python</span> <span class="mf">3.6.2</span><span class="p">,</span> <span class="n">pytest</span><span class="o">-</span><span class="mf">3.2.1</span><span class="p">,</span> <span class="n">py</span><span class="o">-</span><span class="mf">1.4.34</span><span class="p">,</span> <span class="n">pluggy</span><span class="o">-</span><span class="mf">0.4.0</span>
<span class="n">rootdir</span><span class="p">:</span> <span class="n">c</span><span class="p">:</span>\<span class="n">pypinm</span>\<span class="n">moduli</span><span class="p">,</span> <span class="n">inifile</span><span class="p">:</span>
<span class="n">collected</span> <span class="mi">4</span> <span class="n">items</span>

<span class="n">test_orodja</span><span class="o">.</span><span class="n">py</span> <span class="o">...</span>
<span class="n">test_prvi</span><span class="o">.</span><span class="n">py</span> <span class="n">F</span>

<span class="o">==================================</span> <span class="n">FAILURES</span> <span class="o">===================================</span>
<span class="n">________________________________</span> <span class="n">test_kvadrat</span> <span class="n">_________________________________</span>

    <span class="k">def</span> <span class="nf">test_kvadrat</span><span class="p">():</span>
<span class="o">&gt;</span>       <span class="k">assert</span> <span class="n">kvadrat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
<span class="n">E</span>       <span class="k">assert</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">4</span>
<span class="n">E</span>        <span class="o">+</span>  <span class="n">where</span> <span class="mi">5</span> <span class="o">=</span> <span class="n">kvadrat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">test_prvi</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span> <span class="ne">AssertionError</span>
<span class="o">=====================</span> <span class="mi">1</span> <span class="n">failed</span><span class="p">,</span> <span class="mi">3</span> <span class="n">passed</span> <span class="ow">in</span> <span class="mf">0.65</span> <span class="n">seconds</span> <span class="o">======================</span>
</pre></div>
</div>
<p>Iz poročila vidimo, da je program našel dve datoteki (<code class="docutils literal notranslate"><span class="pre">test_orodja.py</span></code> in <code class="docutils literal notranslate"><span class="pre">test_prvi.py</span></code>) in da je prišlo do napake pri eni funkciji (<code class="docutils literal notranslate"><span class="pre">test_kvadrat</span></code>), tri funkcije pa so uspešno prestale test.</p>
<p>Za osnovno uporabo pri numeričnih izračunih je treba še izpostaviti modul <code class="docutils literal notranslate"><span class="pre">numpy.testing</span></code> (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.testing.html#">dokumentacija</a>), ki nudi podporo za testiranje numeričnih polj.</p>
<p>Izbrane funkcije so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">assert_allclose(dejansko,</span> <span class="pre">pričakovano[,</span> <span class="pre">rtol,</span> <span class="pre">...])</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.testing.assert_allclose.html#numpy.testing.assert_allclose">dokumentacija</a>) preveri enakost do zahtevane natančnosti,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assert_array_less(x,</span> <span class="pre">y[,</span> <span class="pre">err_msg,</span> <span class="pre">verbose])</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.testing.assert_array_less.html#numpy.testing.assert_array_less">dokumentacija</a>) preveri, ali so elementi <code class="docutils literal notranslate"><span class="pre">x</span></code> manjši od elementov <code class="docutils literal notranslate"><span class="pre">y</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assert_string_equal(dejansko,</span> <span class="pre">pričakovano)</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.testing.assert_string_equal.html#numpy.testing.assert_string_equal">dokumentacija</a>) preveri enakost niza.</p></li>
</ul>
<section id="zgled-test-orodja-py">
<h4>Zgled: <code class="docutils literal notranslate"><span class="pre">test_orodja.py</span></code>:<a class="headerlink" href="#zgled-test-orodja-py" title="Permalink to this heading">#</a></h4>
<p>V datoteki <code class="docutils literal notranslate"><span class="pre">test_orodja.py</span></code> so pripravljene funkcije za testiranje modula <code class="docutils literal notranslate"><span class="pre">orodja.py</span></code>.</p>
<p>Tako so najprej pripravljeni podatki:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">zacetna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">zamenjana_0_1_stolpca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                                    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                                    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<p>Potem je definirana funkcija, ki kliče funkcijo <code class="docutils literal notranslate"><span class="pre">orodja.zamenjaj_stolpca()</span></code> in rezultat primerja s pričakovanim <code class="docutils literal notranslate"><span class="pre">zamenjana_0_1_stolpca</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_stolpec</span><span class="p">():</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">zacetna</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># naredimo kopijo podatkov</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">orodja</span><span class="o">.</span><span class="n">zamenjaj_stolpca</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># b (in tudi a) imata zamenjane stolpce</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">zamenjana_0_1_stolpca</span><span class="p">)</span>
</pre></div>
</div>
<p>Če funkcija <code class="docutils literal notranslate"><span class="pre">orodja.zamenjaj_stolpca()</span></code> deluje pravilno, se klicanje <code class="docutils literal notranslate"><span class="pre">pytest</span></code> v ukazni vrstici uspešno zaključi. Za preostale teste poglejte datoteko <code class="docutils literal notranslate"><span class="pre">test_orodja.py</span></code> in <a class="reference external" href="https://docs.pytest.org/">dokumentacijo</a> paketa <code class="docutils literal notranslate"><span class="pre">pytest</span></code>.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="graficni-uporabniski-vmesnik">
<h2>Grafični uporabniški vmesnik<a class="headerlink" href="#graficni-uporabniski-vmesnik" title="Permalink to this heading">#</a></h2>
<p>Uporabniški vmesnik se uporablja za interakcijo uporabnika s programsko kodo. Uporabniški vmesniki so lahko preko ukazne vrstice ali grafični. Za preproste uporabniške vmesnike preko ukazne vrstice je najbolje, da uporabimo kar <a class="reference external" href="https://docs.python.org/3/library/argparse.html"><code class="docutils literal notranslate"><span class="pre">argparse</span></code></a>, sicer pa se bomo tukaj predvsem osredotočili na <strong>grafični uporabniški vmesnik</strong>.</p>
<section id="graficni-uporabniski-vmesnik-znotraj-brskalnika">
<h3>Grafični uporabniški vmesnik znotraj brskalnika<a class="headerlink" href="#graficni-uporabniski-vmesnik-znotraj-brskalnika" title="Permalink to this heading">#</a></h3>
<p>V zadnjem obdobju je opaziti veliko napora pri podpori razvoja grafičnih vmesnikov znotraj okolja <em>Jupyter notebook</em> ali <em>Jupyter lab</em>. Takšen pristop ima predvsem to prednost, da je nadgradnja v obliki spletne aplikacije relativno enostavna, glejte npr.: <a class="reference external" href="https://www.youtube.com/watch?v=VtchVpoSdoQ">Dashboarding with Jupyter Notebooks, Voila and Widgets | SciPy 2019 | M. Breddels and M. Renou</a>.</p>
</section>
<section id="graficni-uporabniski-vmesnik-znotraj-operacijskega-sistema">
<h3>Grafični uporabniški vmesnik znotraj operacijskega sistema<a class="headerlink" href="#graficni-uporabniski-vmesnik-znotraj-operacijskega-sistema" title="Permalink to this heading">#</a></h3>
<p>v okviru tega poglavja si bomo pogledali klasične uporabniške vmesnike, ki jih poganjamo v okviru določenega operacijskega sistema. Tudi za programiranje grafičnega uporabniškega vmesnika obstaja veliko različnih načinov/modulov. Nekaj najpogosteje uporabljenih:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://riverbankcomputing.com/software/pyqt/intro">PyQt</a> temelji na <a class="reference external" href="https://www.qt.io/">Qt</a>, ki predstavlja najbolj razširjeno platforma za uporabniške vmesnike,</p></li>
<li><p><a class="reference external" href="https://wiki.qt.io/PySide">PySide</a> podobno kakor <em>PyQt</em>, vendar s širšo licenco <a class="reference external" href="http://qt-project.org/wiki/PySide">LGPL</a>, a žal tudi slabšo podporo (tukaj je dobra knjiga: <a class="reference external" href="https://www.packtpub.com/application-development/pyside-gui-application-development-second-edition">PySide GUI Application Development - SE</a>),</p></li>
<li><p><a class="reference external" href="http://kivy.org/">Kivy</a> za hiter razvoj modernih uporabniških vmesnikov (ni tako zrel kakor npr. Qt),</p></li>
<li><p><a class="reference external" href="https://www.wxwidgets.org/">wxWidgets</a> široko uporabljena prosta platforma za izdelavo uporabniških vmesnikov.</p></li>
</ul>
<p>Med vsemi naštetimi si bomo podrobneje pogledali <em>PyQt</em>, ki je verjetno najboljša in tudi najbolj dozorela izbira (za komercialno uporabo pa žal ni brezplačna).</p>
<p>Velja omeniti, da uporabniški vmesnik lahko:</p>
<ul class="simple">
<li><p><em>rišemo</em> s <a class="reference external" href="http://doc.qt.io/qt-5/qtdesigner-manual.html">QtDesignerjem</a> (glejte <a class="reference external" href="https://www.youtube.com/watch?v=GLqrzLIIW2E">video</a>), ali</p></li>
<li><p><em>kodiramo</em>.</p></li>
</ul>
<p>Tukaj bomo uporabniški vmesnik <em>kodirali</em>.</p>
</section>
<section id="zgled">
<h3>Zgled<a class="headerlink" href="#zgled" title="Permalink to this heading">#</a></h3>
<p>Najprej uvozimo paket za interakcijo in z grafičnimi objekti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span>     <span class="c1"># za interakcijo </span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span>  <span class="c1"># grafični objekti</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span>     <span class="c1"># za interakcijo </span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span>  <span class="c1"># grafični objekti</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;PyQt5&#39;
</pre></div>
</div>
</div>
</div>
<p>Potrebovali bomo tudi modul <code class="docutils literal notranslate"><span class="pre">sys</span></code> za poganjanje programa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>
</div>
<p>Uporabniški vmesnik tipično gradimo na razredu <code class="docutils literal notranslate"><span class="pre">QtWidgets.QMainWindow</span></code> (<a class="reference external" href="http://doc.qt.io/qt-5/qmainwindow.html">dokumentacija</a>), ki ima  spodaj prikazano strukturo:</p>
<img width=350 src="http://doc.qt.io/qt-5/images/mainwindowlayout.png"><p>Bistveni grafični elementi, ki jih pri takem uporabniškem vmesniku uporabimo, so:</p>
<ul class="simple">
<li><p><em>Menu Bar</em>,</p></li>
<li><p><em>Toolbars</em>,</p></li>
<li><p><em>Dock Widgets</em>,</p></li>
<li><p><em>Central Widget</em>,</p></li>
<li><p><em>Status bar</em>.</p></li>
</ul>
<p>Ni potrebno definirati vseh; spodaj si bomo pogledali primer, ko bomo definirali <em>Status bar</em>, <em>Central Widget</em> in <em>Menu Bar</em>. Ponavadi vse elemente definiramo pri inicializaciji instance razreda (metoda <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p>
<p>Tukaj izpostavimo, da grafični vmesnik temelji na t. i. <em>Widgetih</em>, (za na primer gumb, tabelo, datum itd.). Prikaz nekaterih možnosti je prikazan v:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://doc.qt.io/qt-5/gallery.html">Qt 5 Windows galeriji</a>,</p></li>
<li><p><a class="reference external" href="https://doc.qt.io/qt-5/gallery.html">Qt5 galeriji</a>.</p></li>
</ul>
<p>Zelo enostaven uporabniški vmesnik (z vrstičnimi komentarji kode) je prikazan spodaj.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span>

<span class="k">class</span> <span class="nc">GlavnOkno</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Glavno okno podeduje `QtWidgets.QMainWindow`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Konstruktor GlavnoOkno objekta</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="c1"># konstruktor starša</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Naslovno okno programa&#39;</span><span class="p">)</span>
 
        <span class="c1"># status bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moj_status_bar</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStatusBar</span><span class="p">()</span> <span class="c1"># novi widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moj_status_bar</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s1">&#39;Ta tekst po 10s izgine&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStatusBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moj_status_bar</span><span class="p">)</span> <span class="c1"># tukaj se self.moj_status_bar priredi predpripravljenemu v QMainWindow</span>

        <span class="c1"># central widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gumb1</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Gumb 1&#39;</span><span class="p">)</span> <span class="c1"># Gumb z napisom &#39;Gumb 1&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gumb1</span><span class="o">.</span><span class="n">pressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">akcija_pri_pritisku_gumba1</span><span class="p">)</span> <span class="c1"># povežemo pritisk s funkcijo za akcijo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gumb1</span><span class="p">)</span> <span class="c1"># dodamo gumb v `CentralWidget`</span>
        
        <span class="c1"># menuji</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moj_izhod_akcija</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&amp;Izhod&#39;</span><span class="p">,</span> 
                                             <span class="bp">self</span><span class="p">,</span> <span class="n">shortcut</span><span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QKeySequence</span><span class="o">.</span><span class="n">Close</span><span class="p">,</span>
                                             <span class="n">statusTip</span><span class="o">=</span><span class="s2">&quot;Izhod iz programa&quot;</span><span class="p">,</span>
                                             <span class="n">triggered</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moj_datoteka_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;&amp;Datoteka&#39;</span><span class="p">)</span> <span class="c1"># menu &#39;Datoteka&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moj_datoteka_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moj_izhod_akcija</span><span class="p">)</span> <span class="c1"># povezava do zgoraj definirane akcije `self.moj_izhod_akcija`</span>
        
    <span class="k">def</span> <span class="nf">akcija_pri_pritisku_gumba1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                <span class="s1">&#39;Naslov :)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;Tole se sproži pri pritisku gumba.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Program potem poženemo znotraj stavka <code class="docutils literal notranslate"><span class="pre">try</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">mainWindow</span> <span class="o">=</span> <span class="n">GlavnOkno</span><span class="p">()</span>
    <span class="n">mainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">SystemExit</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zapiram okno.&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Za naprednejši zgled glejte datoteki:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/01920e12eb7ec0c0ec6291e6b196ecbc/preprosti_uporabniski_vmesnik.py"><span class="xref download myst">preprosti_uporabniski_vmesnik.py</span></a>,</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/1705b0a79afee173784d4e734cdc7fa9/uporabniski_vmesnik.py"><span class="xref download myst">uporabniski_vmesnik.py</span></a> in</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/7fdeba448618e86ed949c5b1cd2d5939/brskalnik.py"><span class="xref download myst">brskalnik.py</span></a>.</p></li>
</ul>
<p>Nekaj komentarjev na <code class="docutils literal notranslate"><span class="pre">uporabniski_vmesnik.py</span></code>:</p>
<ol class="arabic simple">
<li><p>Poglejte prepis dogodka <code class="docutils literal notranslate"><span class="pre">mouseDoubleClickEvent</span></code> in prepišite podedovan dogodek <code class="docutils literal notranslate"><span class="pre">keyPressEvent</span></code>, ki naj ob pritisku katerekoli tipke zapre program (če se nahajate v TextEdit polju, potem seveda pritisk tipke izpiše vrednost te tipke).</p></li>
<li><p>Dodajte še kakšen <em>Widget</em> s <a class="reference external" href="http://doc.qt.io/qt-5/gallery-windows.html">seznama</a>.</p></li>
<li><p>Spremenite program, da se bo vedno izrisovala funkcija sinus, v vpisno polje <code class="docutils literal notranslate"><span class="pre">function_text</span></code> pa boste zapisali število diskretnih točk (sedaj je točk 100).  Povežite polje z ustreznimi funkcijami.</p></li>
<li><p>Uredite lovljenje napak pri zgornji spremembi.</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nekaj-vprasanj-za-razmislek">
<h2>Nekaj vprašanj za razmislek!<a class="headerlink" href="#nekaj-vprasanj-za-razmislek" title="Permalink to this heading">#</a></h2>
<ol class="arabic">
<li><p>V PyCharm-u pripravite modul, ki bo imel dve funkciji:</p>
<ul class="simple">
<li><p>za množenje matrike in vektorja,</p></li>
<li><p>za množenje dveh matrik.</p></li>
</ul>
</li>
<li><p>Za modul zgoraj pripravite skripto za testiranje (uporabite <code class="docutils literal notranslate"><span class="pre">numpy.testing</span></code>).</p></li>
<li><p>V <code class="docutils literal notranslate"><span class="pre">uporabniski_vmesnik_simple.py</span></code> inicializijski metodi <code class="docutils literal notranslate"><span class="pre">__init__</span></code> zakomentirajte vse klice na metode <code class="docutils literal notranslate"><span class="pre">self.init</span> <span class="pre">...</span></code> razen na metodo: <code class="docutils literal notranslate"><span class="pre">self.init_status_bar()</span></code>. Poženite program v navadnem načinu. Nastavite <em>break</em> točko na <code class="docutils literal notranslate"><span class="pre">self.setGeometry(50,</span> <span class="pre">50,</span> <span class="pre">600,</span> <span class="pre">400)</span></code> in poženite program v <em>debug</em> načinu.</p></li>
<li><p>Nadaljujte prejšnjo točko in poiščite bližnjico za pomikanje po vrsticah:</p>
<ul class="simple">
<li><p>s preskokom vrstice,</p></li>
<li><p>z vstopom v vrstico.</p></li>
</ul>
<p>Vstopite v <code class="docutils literal notranslate"><span class="pre">init_status_bar(self)</span></code> in se ustavite pri vrstici <code class="docutils literal notranslate"><span class="pre">self.setStatusBar(self.status_bar)</span></code>. Odprite konzolo (<em>console</em>) in prek ukazne vrstice spremenite vrednost <code class="docutils literal notranslate"><span class="pre">self.status_bar.showMessage()</span></code>.</p>
</li>
<li><p>Odkomentirajte prej (zgoraj) zakomentirane vrstice. Dodajte tretji gumb, ki naj program zapre.</p></li>
<li><p>Dodajte še kakšen <em>Widget</em> s <a class="reference external" href="http://doc.qt.io/qt-5/gallery-windows.html">seznama</a>.</p></li>
</ol>
</section>
<span id="document-bibliography"></span><span class="target" id="id1"></span></div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Vsebina
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Študijski in izpitni red">Študijski in izpitni red: 2023/24</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#predavanja-vaje">Predavanja / vaje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#sprotni-studij">Sprotni študij</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#izpit">Izpit</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#literatura">Literatura</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#pogoji-za-poslusanje-v-naprej">Pogoji za poslušanje v naprej?</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 01 - Uvod v Python">Uvod v Python</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#namestitev-pythona">Namestitev Pythona</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#jupyter-notebook-jupyter-lab">Jupyter notebook (Jupyter lab)</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#prvi-program-in-pep">Prvi program in PEP</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#osnove-pythona">Osnove Pythona</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#za-konec-plonk-list">Za konec: plonk list :)</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 02 - Print, delo z datotekami, funkcije, moduli">Funkcije, izjeme, moduli</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#funkcije">Funkcije</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#obravnavanje-izjem">Obravnavanje izjem</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#osnove-modulov">Osnove modulov</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uporaba-modulov-iz-spleta">Uporaba modulov iz spleta</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 03 - Moduli, numpy, matplotlib">Numpy, matplotlib</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#modul-numpy">Modul <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#modul-matplotlib">Modul <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 04 - Objektno programiranje, simbolno računanje">Objektno programiranje, simbolno računanje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#objektno-programiranje">Objektno programiranje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#simbolno-racunanje-s-sympy">Simbolno računanje s <code class="docutils literal notranslate"><span class="pre">SymPy</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 05 - Uvod v numerične metode in sistemi linearnih enačb 1">Uvod v numerične metode in sistemi linearnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod-v-numericne-metode">Uvod v numerične metode</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod-v-sisteme-linearnih-enacb">Uvod v sisteme linearnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#gaussova-eliminacija">Gaussova eliminacija</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 06 - Sistemi linearnih enačb 2">Sistemi linearnih enačb - nadaljevanje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#razcep-lu">Razcep LU</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#pivotiranje">Pivotiranje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#modul-scipy">Modul <code class="docutils literal notranslate"><span class="pre">SciPy</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#racunanje-inverzne-matrike">Računanje inverzne matrike</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#resevanje-predolocenih-sistemov">Reševanje predoločenih sistemov</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#iterativne-metode">Iterativne metode</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 07 - Interpolacija">Interpolacija</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#interpolacija-s-polinomom">Interpolacija s polinomom</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#lagrangeva-metoda">Lagrangeva metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#kubicni-zlepki">Kubični zlepki</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 08 - Aproksimacija">Aproksimacija</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-najmanjsih-kvadratov-za-linearno-funkcijo">Metoda najmanjših kvadratov za linearno funkcijo</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-najmanjsih-kvadratov-za-poljubni-polinom">Metoda najmanjših kvadratov za poljubni polinom</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#aproksimacija-s-poljubno-funkcijo">Aproksimacija s poljubno funkcijo</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 09 - Reševanje enačb">Reševanje enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#inkrementalna-metoda">Inkrementalna metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#iterativna-inkrementalna-metoda">Iterativna inkrementalna metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#bisekcijska-metoda">Bisekcijska metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#sekantna-metoda">Sekantna metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#newtonova-metoda">Newtonova metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#resevanje-sistemov-nelinarnih-enacb">Reševanje sistemov nelinarnih enačb*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 10 - Numerično odvajanje">Numerično odvajanje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#aproksimacija-prvega-odvoda-po-metodi-koncnih-razlik">Aproksimacija prvega odvoda po metodi končnih razlik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#centralna-diferencna-shema">Centralna diferenčna shema</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#necentralna-diferencna-shema">Necentralna diferenčna shema</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uporaba-numpy-gradient">Uporaba <code class="docutils literal notranslate"><span class="pre">numpy.gradient</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#zaokrozitvena-napaka-pri-numericnem-odvajanju">Zaokrožitvena napaka pri numeričnem odvajanju*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#aproksimacija-odvoda-s-kompleksnim-korakom">Aproksimacija odvoda s kompleksnim korakom*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 11 - Numerično integriranje">Numerično integriranje</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#newton-cotesov-pristop">Newton-Cotesov pristop</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#gaussov-integracijski-pristop">Gaussov integracijski pristop</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#scipy-integrate"><code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno">Dodatno</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 12 - Numerično reševanje diferencialnih enačb - začetni problem">Numerično reševanje diferencialnih enačb - začetni problem</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uvod">Uvod</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#eulerjeva-metoda">Eulerjeva metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-runge-kutta-drugega-reda">Metoda Runge-Kutta drugega reda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-runge-kutta-cetrtega-reda">Metoda Runge-Kutta četrtega reda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#uporaba-scipy-za-resevanje-navadnih-diferencialnih-enacb">Uporaba <code class="docutils literal notranslate"><span class="pre">scipy</span></code> za reševanje navadnih diferencialnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#sistem-navadnih-diferencialnih-enacb">Sistem navadnih diferencialnih enačb</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#stabilnost-resevanja-diferencialnih-enacb">Stabilnost reševanja diferencialnih enačb*</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 13 - Numerično reševanje diferencialnih enačb - robni problem">Numerično reševanje diferencialnih enačb - robni problem</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#resevanje-dvotockovnih-robnih-problemov">Reševanje dvotočkovnih robnih problemov</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#strelska-metoda">Strelska metoda</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#metoda-koncnih-razlik">Metoda končnih razlik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#dodatno-simbolna-resitev-nosilca">Dodatno: simbolna rešitev nosilca</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#document-notebooks/Predavanje 14 - Testiranje pravilnosti kode, uporabniški vmesnik">Testiranje pravilnosti kode, uporabniški vmesnik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#testiranje-pravilnosti-kode">Testiranje pravilnosti kode</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#graficni-uporabniski-vmesnik">Grafični uporabniški vmesnik</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="README.html#nekaj-vprasanj-za-razmislek">Nekaj vprašanj za razmislek!</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Avtor Janko Slavič
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>